var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(m,l,p){m instanceof String&&(m=String(m));for(var q=m.length,e=0;e<q;e++){var a=m[e];if(l.call(p,a,e,m))return{i:e,v:a}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(m,l,p){m!=Array.prototype&&m!=Object.prototype&&(m[l]=p.value)};$jscomp.getGlobal=function(m){return"undefined"!=typeof window&&window===m?m:"undefined"!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(m,l,p,q){if(l){p=$jscomp.global;m=m.split(".");for(q=0;q<m.length-1;q++){var e=m[q];e in p||(p[e]={});p=p[e]}m=m[m.length-1];q=p[m];l=l(q);l!=q&&null!=l&&$jscomp.defineProperty(p,m,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Array.prototype.find",function(m){return m?m:function(m,p){return $jscomp.findInternal(this,m,p).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(m){var l=0;return function(){return l<m.length?{done:!1,value:m[l++]}:{done:!0}}};
$jscomp.arrayIterator=function(m){return{next:$jscomp.arrayIteratorImpl(m)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(m,l){this.$jscomp$symbol$id_=m;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function m(p){if(this instanceof m)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(p||"")+"_"+l++,p)}var l=0;return m}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.iterator;m||(m=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[m]&&$jscomp.defineProperty(Array.prototype,m,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.asyncIterator;m||(m=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(m){$jscomp.initSymbolIterator();m={next:m};m[$jscomp.global.Symbol.iterator]=function(){return this};return m};
$jscomp.iteratorFromArray=function(m,l){$jscomp.initSymbolIterator();m instanceof String&&(m+="");var p=0,q={next:function(){if(p<m.length){var e=p++;return{value:l(e,m[e]),done:!1}}q.next=function(){return{done:!0,value:void 0}};return q.next()}};q[Symbol.iterator]=function(){return q};return q};$jscomp.polyfill("Array.prototype.keys",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6","es3");
$jscomp.owns=function(m,l){return Object.prototype.hasOwnProperty.call(m,l)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(m,l){for(var p=1;p<arguments.length;p++){var q=arguments[p];if(q)for(var e in q)$jscomp.owns(q,e)&&(m[e]=q[e])}return m};$jscomp.polyfill("Object.assign",function(m){return m||$jscomp.assign},"es6","es3");$jscomp.makeIterator=function(m){var l="undefined"!=typeof Symbol&&Symbol.iterator&&m[Symbol.iterator];return l?l.call(m):$jscomp.arrayIterator(m)};
$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(m){function l(){this.batch_=null}function p(a){return a instanceof e?a:new e(function(c,b){c(a)})}if(m&&!$jscomp.FORCE_POLYFILL_PROMISE)return m;l.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var c=this;this.asyncExecuteFunction(function(){c.executeBatch_()})}this.batch_.push(a)};var q=$jscomp.global.setTimeout;l.prototype.asyncExecuteFunction=function(a){q(a,0)};l.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var c=0;c<a.length;++c){var b=a[c];a[c]=null;try{b()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};l.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var c=this.createResolveAndReject_();try{a(c.resolve,c.reject)}catch(b){c.reject(b)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){b||(b=!0,a.call(c,d))}}var c=this,b=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var c=void 0;try{c=a.then}catch(b){this.reject_(b);return}"function"==typeof c?
this.settleSameAsThenable_(c,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,c){if(0!=this.state_)throw Error("Cannot settle("+a+", "+c+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=c;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=0;d<this.onSettledCallbacks_.length;++d)a.asyncExecute(this.onSettledCallbacks_[d]);
this.onSettledCallbacks_=null}};var a=new l;e.prototype.settleSameAsPromise_=function(a){var c=this.createResolveAndReject_();a.callWhenSettled_(c.resolve,c.reject)};e.prototype.settleSameAsThenable_=function(a,c){var b=this.createResolveAndReject_();try{a.call(c,b.resolve,b.reject)}catch(f){b.reject(f)}};e.prototype.then=function(a,c){function b(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(x){k(x)}}:b}var d,k,h=new e(function(a,b){d=a;k=b});this.callWhenSettled_(b(a,d),b(c,k));return h};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(d,c){function b(){switch(f.state_){case 1:d(f.result_);break;case 2:c(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?a.asyncExecute(b):this.onSettledCallbacks_.push(b)};e.resolve=p;e.reject=function(a){return new e(function(c,b){b(a)})};e.race=function(a){return new e(function(c,b){for(var d=$jscomp.makeIterator(a),k=d.next();!k.done;k=d.next())p(k.value).callWhenSettled_(c,
b)})};e.all=function(a){var c=$jscomp.makeIterator(a),b=c.next();return b.done?p([]):new e(function(a,d){function f(b){return function(c){k[b]=c;e--;0==e&&a(k)}}var k=[],e=0;do k.push(void 0),e++,p(b.value).callWhenSettled_(f(k.length-1),d),b=c.next();while(!b.done)})};return e},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var m={},l=Object.create(new $jscomp.global.Proxy(m,{get:function(p,q,e){return p==m&&"q"==q&&e==l}}));return!0===l.q}catch(p){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(m){function l(){if(!m||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),d=new m([[a,2],[c,3]]);if(2!=d.get(a)||3!=d.get(c))return!1;d.delete(a);d.set(c,4);return!d.has(a)&&4==d.get(c)}catch(h){return!1}}function p(){}function q(b){if(!$jscomp.owns(b,a)){var c=new p;$jscomp.defineProperty(b,a,{value:c})}}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof p)return a;q(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(m&&
$jscomp.ES6_CONFORMANCE)return m}else if(l())return m;var a="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var d=0,c=function(a){this.id_=(d+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(b,c){q(b);if(!$jscomp.owns(b,a))throw Error("WeakMap key fail: "+b);b[a][this.id_]=c;return this};c.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:void 0};c.prototype.has=
function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};c.prototype.delete=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)?delete b[a][this.id_]:!1};return c},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(m){function l(){if($jscomp.ASSUME_NO_NATIVE_MAP||!m||"function"!=typeof m||!m.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new m($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),h=d.next();if(h.done||h.value[0]!=a||"s"!=h.value[1])return!1;h=d.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!d.next().done?!1:!0}catch(w){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(m&&$jscomp.ES6_CONFORMANCE)return m}else if(l())return m;$jscomp.initSymbolIterator();var p=new WeakMap,q=function(a){this.data_={};this.head_=d();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};q.prototype.set=function(a,c){a=0===a?0:a;var b=e(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=c:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:c},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};q.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};q.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=d();this.size=0};q.prototype.has=function(a){return!!e(this,a).entry};
q.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};q.prototype.entries=function(){return a(this,function(a){return[a.key,a.value]})};q.prototype.keys=function(){return a(this,function(a){return a.key})};q.prototype.values=function(){return a(this,function(a){return a.value})};q.prototype.forEach=function(a,c){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(c,d[1],d[0],this)};q.prototype[Symbol.iterator]=q.prototype.entries;var e=function(a,d){var b=d&&typeof d;"object"==
b||"function"==b?p.has(d)?b=p.get(d):(b=""+ ++c,p.set(d,b)):b="p_"+d;var f=a.data_[b];if(f&&$jscomp.owns(a.data_,b))for(a=0;a<f.length;a++){var e=f[a];if(d!==d&&e.key!==e.key||d===e.key)return{id:b,list:f,index:a,entry:e}}return{id:b,list:f,index:-1,entry:void 0}},a=function(a,c){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}})},d=function(){var a={};return a.previous=
a.next=a.head=a},c=0;return q},"es6","es3");$jscomp.checkStringArgs=function(m,l,p){if(null==m)throw new TypeError("The 'this' value for String.prototype."+p+" must not be null or undefined");if(l instanceof RegExp)throw new TypeError("First argument to String.prototype."+p+" must not be a regular expression");return m+""};
$jscomp.polyfill("String.prototype.endsWith",function(m){return m?m:function(m,p){var l=$jscomp.checkStringArgs(this,m,"endsWith");m+="";void 0===p&&(p=l.length);p=Math.max(0,Math.min(p|0,l.length));for(var e=m.length;0<e&&0<p;)if(l[--p]!=m[--e])return!1;return 0>=e}},"es6","es3");
(function(m){"object"===typeof exports&&"undefined"!==typeof module?module.exports=m():"function"===typeof define&&define.amd?define([],m):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).adapter=m()})(function(){return function e(l,p,q){function a(b,c){if(!p[b]){if(!l[b]){var f="function"==typeof require&&require;if(!c&&f)return f(b,!0);if(d)return d(b,!0);c=Error("Cannot find module '"+b+"'");throw c.code="MODULE_NOT_FOUND",c;}c=p[b]={exports:{}};
l[b][0].call(c.exports,function(c){var d=l[b][1][c];return a(d?d:c)},c,c.exports,e,l,p,q)}return p[b].exports}for(var d="function"==typeof require&&require,c=0;c<q.length;c++)a(q[c]);return a}({1:[function(l,p,q){function e(a,b,c,d,f){b=k.writeRtpDescription(a.kind,b);b+=k.writeIceParameters(a.iceGatherer.getLocalParameters());b+=k.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":f||"active");b+="a=mid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?
b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(c=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=c,d="msid:"+(d?d.id:"-")+" "+c+"\r\n",b=b+("a="+d)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+d),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+d,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+
" cname:"+k.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+k.localCName+"\r\n");return b}function a(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var g="string"===typeof d;g&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport=udp")||
-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport=udp"):c=!0});delete a.url;a.urls=g?d[0]:d;return!!d.length}})}function d(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},f=function(a,b,c,u){a=d(a.parameters.apt,c);b=d(b.parameters.apt,u);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var g=
0;g<b.codecs.length;g++){var n=b.codecs[g];if(d.name.toLowerCase()===n.name.toLowerCase()&&d.clockRate===n.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!n.parameters.apt||f(d,n,a.codecs,b.codecs))){n=JSON.parse(JSON.stringify(n));n.numChannels=Math.min(d.numChannels,n.numChannels);c.codecs.push(n);n.rtcpFeedback=n.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});
a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var n=b.headerExtensions[d];if(a.uri===n.uri){c.headerExtensions.push(n);break}}});return c}function c(a,b,c){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)}function b(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===
a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});c||a.addRemoteCandidate(b);return!c}function f(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var k=l("sdp");p.exports=function(h,w){function t(a,b){b.addTrack(a);b.dispatchEvent(new h.MediaStreamTrackEvent("addtrack",{track:a}))}function g(a,b){b.removeTrack(a);b.dispatchEvent(new h.MediaStreamTrackEvent("removetrack",
{track:a}))}function x(a,b,c,d){var n=new Event("track");n.track=b;n.receiver=c;n.transceiver={receiver:c};n.streams=d;h.setTimeout(function(){a._dispatchEvent("track",n)})}var r=function(b){var c=this,d=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){c[a]=d[a].bind(d)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState=
"stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";b=JSON.parse(JSON.stringify(b||{}));this.usingBundle="max-bundle"===b.bundlePolicy;if("negotiate"===b.rtcpMuxPolicy)throw f("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");b.rtcpMuxPolicy||(b.rtcpMuxPolicy="require");switch(b.iceTransportPolicy){case "all":case "relay":break;default:b.iceTransportPolicy="all"}switch(b.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:b.bundlePolicy=
"balanced"}b.iceServers=a(b.iceServers||[],w);this._iceGatherers=[];if(b.iceCandidatePoolSize)for(var n=b.iceCandidatePoolSize;0<n;n--)this._iceGatherers.push(new h.RTCIceGatherer({iceServers:b.iceServers,gatherPolicy:b.iceTransportPolicy}));else b.iceCandidatePoolSize=0;this._config=b;this.transceivers=[];this._sdpSessionId=k.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(r.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});
Object.defineProperty(r.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});r.prototype.onicecandidate=null;r.prototype.onaddstream=null;r.prototype.ontrack=null;r.prototype.onremovestream=null;r.prototype.onsignalingstatechange=null;r.prototype.oniceconnectionstatechange=null;r.prototype.onconnectionstatechange=null;r.prototype.onicegatheringstatechange=null;r.prototype.onnegotiationneeded=null;r.prototype.ondatachannel=null;r.prototype._dispatchEvent=
function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};r.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)};r.prototype.getConfiguration=function(){return this._config};r.prototype.getLocalStreams=function(){return this.localStreams};r.prototype.getRemoteStreams=function(){return this.remoteStreams};r.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;
a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);
b||this.transceivers.push(a);return a};r.prototype.addTrack=function(a,b){if(this._isClosed)throw f("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===a}))throw f("InvalidAccessError","Track already exists.");for(var c,d=0;d<this.transceivers.length;d++)this.transceivers[d].track||this.transceivers[d].kind!==a.kind||(c=this.transceivers[d]);c||(c=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===
this.localStreams.indexOf(b)&&this.localStreams.push(b);c.track=a;c.stream=b;c.rtpSender=new h.RTCRtpSender(a,c.dtlsTransport);return c.rtpSender};r.prototype.addStream=function(a){var b=this;if(15025<=w)a.getTracks().forEach(function(c){b.addTrack(c,a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};r.prototype.removeTrack=function(a){if(this._isClosed)throw f("InvalidStateError",
"Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof h.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===a});if(!b)throw f("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(c)&&-1<
this.localStreams.indexOf(c)&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};r.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&b.removeTrack(c)})};r.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};r.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};
r.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new h.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(d,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var n=!b.candidate||0===Object.keys(b.candidate).length;d.state=n?
"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};d.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return d};r.prototype._gather=function(a,b){var c=this,d=this.transceivers[b].iceGatherer;if(!d.onlocalcandidate){var n=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;d.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);d.onlocalcandidate=
function(n){if(!(c.usingBundle&&0<b)){var u=new Event("icecandidate");u.candidate={sdpMid:a,sdpMLineIndex:b};var g=n.candidate;if(n=!g||0===Object.keys(g).length){if("new"===d.state||"gathering"===d.state)d.state="completed"}else"new"===d.state&&(d.state="gathering"),g.component=1,g.ufrag=d.getLocalParameters().usernameFragment,g=k.writeCandidate(g),u.candidate=Object.assign(u.candidate,k.parseCandidate(g)),u.candidate.candidate=g,u.candidate.toJSON=function(){return{candidate:u.candidate.candidate,
sdpMid:u.candidate.sdpMid,sdpMLineIndex:u.candidate.sdpMLineIndex,usernameFragment:u.candidate.usernameFragment}};g=k.getMediaSections(c._localDescription.sdp);g[u.candidate.sdpMLineIndex]=n?g[u.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":g[u.candidate.sdpMLineIndex]+("a="+u.candidate.candidate+"\r\n");c._localDescription.sdp=k.getDescription(c._localDescription.sdp)+g.join("");g=c.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&
(c.iceGatheringState="gathering",c._emitGatheringStateChange());n||c._dispatchEvent("icecandidate",u);g&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};h.setTimeout(function(){n.forEach(function(a){d.onlocalcandidate(a)})},0)}};r.prototype._createIceAndDtlsTransports=function(){var a=this,b=new h.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var c=new h.RTCDtlsTransport(b);
c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};r.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,
delete b.onerror,delete this.transceivers[a].dtlsTransport};r.prototype._transceive=function(a,b,c){var n=d(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(n.encodings=a.sendEncodingParameters,n.rtcp={cname:k.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(n.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(n));c&&a.rtpReceiver&&0<n.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>w&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),
n.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],n.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(n.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(n.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(n))};r.prototype.setLocalDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(f("TypeError",'Unsupported type "'+a.type+'"'));if(!c("setLocalDescription",a.type,b.signalingState)||
b._isClosed)return Promise.reject(f("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));if("offer"===a.type){var n=k.splitSections(a.sdp);var g=n.shift();n.forEach(function(a,c){a=k.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});b.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){n=k.splitSections(b._remoteDescription.sdp);g=n.shift();var e=0<k.matchPrefix(g,"a=ice-lite").length;n.forEach(function(a,c){var n=b.transceivers[c],
u=n.iceGatherer,f=n.iceTransport,t=n.dtlsTransport,h=n.localCapabilities,r=n.remoteCapabilities;if(!(k.isRejected(a)&&0===k.matchPrefix(a,"a=bundle-only").length||n.rejected)){var y=k.getIceParameters(a,g);a=k.getDtlsParameters(a,g);e&&(a.role="server");b.usingBundle&&0!==c||(b._gather(n.mid,c),"new"===f.state&&f.start(u,y,e?"controlling":"controlled"),"new"===t.state&&t.start(a));c=d(h,r);b._transceive(n,0<c.codecs.length,!1)}})}b._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-local-offer"):
b._updateSignalingState("stable");return Promise.resolve()};r.prototype.setRemoteDescription=function(a){var d=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(f("TypeError",'Unsupported type "'+a.type+'"'));if(!c("setRemoteDescription",a.type,d.signalingState)||d._isClosed)return Promise.reject(f("InvalidStateError","Can not set remote "+a.type+" in state "+d.signalingState));var n={};d.remoteStreams.forEach(function(a){n[a.id]=a});var e=[],r=k.splitSections(a.sdp),y=r.shift(),
l=0<k.matchPrefix(y,"a=ice-lite").length,p=0<k.matchPrefix(y,"a=group:BUNDLE ").length;d.usingBundle=p;var q=k.matchPrefix(y,"a=ice-options:")[0];d.canTrickleIceCandidates=q?0<=q.substr(14).split(" ").indexOf("trickle"):!1;r.forEach(function(c,f){var u=k.splitLines(c),r=k.getKind(c),x=k.isRejected(c)&&0===k.matchPrefix(c,"a=bundle-only").length,C=u[0].substr(2).split(" ")[2];u=k.getDirection(c,y);var z=k.parseMsid(c),E=k.getMid(c)||k.generateIdentifier();if(x||"application"===r&&("DTLS/SCTP"===C||
"UDP/DTLS/SCTP"===C))d.transceivers[f]={mid:E,kind:r,protocol:C,rejected:!0};else{!x&&d.transceivers[f]&&d.transceivers[f].rejected&&(d.transceivers[f]=d._createTransceiver(r,!0));var F=k.parseRtpParameters(c);if(!x){var q=k.getIceParameters(c,y);var G=k.getDtlsParameters(c,y);G.role="client"}C=k.parseRtpEncodingParameters(c);var H=k.parseRtcpParameters(c),I=0<k.matchPrefix(c,"a=end-of-candidates",y).length,D=k.matchPrefix(c,"a=candidate:").map(function(a){return k.parseCandidate(a)}).filter(function(a){return 1===
a.component});("offer"===a.type||"answer"===a.type)&&!x&&p&&0<f&&d.transceivers[f]&&(d._disposeIceAndDtlsTransports(f),d.transceivers[f].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[f].iceTransport=d.transceivers[0].iceTransport,d.transceivers[f].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[f].rtpSender&&d.transceivers[f].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[f].rtpReceiver&&d.transceivers[f].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport));
if("offer"!==a.type||x)"answer"!==a.type||x||(v=d.transceivers[f],B=v.iceGatherer,r=v.iceTransport,E=v.dtlsTransport,A=v.rtpReceiver,x=v.sendEncodingParameters,c=v.localCapabilities,d.transceivers[f].recvEncodingParameters=C,d.transceivers[f].remoteCapabilities=F,d.transceivers[f].rtcpParameters=H,D.length&&"new"===r.state&&(!l&&!I||p&&0!==f?D.forEach(function(a){b(v.iceTransport,a)}):r.setRemoteCandidates(D)),p&&0!==f||("new"===r.state&&r.start(B,q,"controlling"),"new"===E.state&&E.start(G)),d._transceive(v,
"sendrecv"===u||"recvonly"===u,"sendrecv"===u||"sendonly"===u),!A||"sendrecv"!==u&&"sendonly"!==u?delete v.rtpReceiver:(u=A.track,z?(n[z.stream]||(n[z.stream]=new h.MediaStream),t(u,n[z.stream]),e.push([u,A,n[z.stream]])):(n.default||(n.default=new h.MediaStream),t(u,n.default),e.push([u,A,n.default]))));else{var v=d.transceivers[f]||d._createTransceiver(r);v.mid=E;v.iceGatherer||(v.iceGatherer=d._createIceGatherer(f,p));D.length&&"new"===v.iceTransport.state&&(!I||p&&0!==f?D.forEach(function(a){b(v.iceTransport,
a)}):v.iceTransport.setRemoteCandidates(D));c=h.RTCRtpReceiver.getCapabilities(r);15019>w&&(c.codecs=c.codecs.filter(function(a){return"rtx"!==a.name}));x=v.sendEncodingParameters||[{ssrc:1001*(2*f+2)}];q=!1;if("sendrecv"===u||"sendonly"===u){q=!v.rtpReceiver;var A=v.rtpReceiver||new h.RTCRtpReceiver(v.dtlsTransport,r);if(q){u=A.track;if(!z||"-"!==z.stream)if(z){n[z.stream]||(n[z.stream]=new h.MediaStream,Object.defineProperty(n[z.stream],"id",{get:function(){return z.stream}}));Object.defineProperty(u,
"id",{get:function(){return z.track}});var B=n[z.stream]}else n.default||(n.default=new h.MediaStream),B=n.default;B&&(t(u,B),v.associatedRemoteMediaStreams.push(B));e.push([u,A,B])}}else v.rtpReceiver&&v.rtpReceiver.track&&(v.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===v.rtpReceiver.track.id});b&&g(b,a)}),v.associatedRemoteMediaStreams=[]);v.localCapabilities=c;v.remoteCapabilities=F;v.rtpReceiver=A;v.rtcpParameters=H;v.sendEncodingParameters=
x;v.recvEncodingParameters=C;d._transceive(d.transceivers[f],!1,q)}}});void 0===d._dtlsRole&&(d._dtlsRole="offer"===a.type?"active":"passive");d._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?d._updateSignalingState("have-remote-offer"):d._updateSignalingState("stable");Object.keys(n).forEach(function(a){var b=n[a];if(b.getTracks().length){if(-1===d.remoteStreams.indexOf(b)){d.remoteStreams.push(b);var c=new Event("addstream");c.stream=b;h.setTimeout(function(){d._dispatchEvent("addstream",
c)})}e.forEach(function(a){b.id===a[2].id&&x(d,a[0],a[1],[b])})}});e.forEach(function(a){a[2]||x(d,a[0],a[1],[])});h.setTimeout(function(){d&&d.transceivers&&d.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};r.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&
a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};r.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};r.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,h.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};r.prototype._updateIceConnectionState=function(){var a={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&(this.iceConnectionState=
b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};r.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){a[b.iceTransport.state]++;a[b.dtlsTransport.state]++});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&
(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};r.prototype.createOffer=function(a){var b=this;if(b._isClosed)return Promise.reject(f("InvalidStateError","Can not call createOffer after close"));var c=b.transceivers.filter(function(a){return"audio"===a.kind}).length,d=b.transceivers.filter(function(a){return"video"===a.kind}).length;if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==a.offerToReceiveAudio&&(c=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio);void 0!==a.offerToReceiveVideo&&(d=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(b.transceivers.forEach(function(a){"audio"===a.kind?(c--,0>c&&(a.wantReceive=!1)):"video"===a.kind&&(d--,0>d&&(a.wantReceive=!1))});0<c||0<d;)0<c&&(b._createTransceiver("audio"),c--),0<d&&(b._createTransceiver("video"),d--);var g=k.writeSessionBoilerplate(b._sdpSessionId,
b._sdpSessionVersion++);b.transceivers.forEach(function(a,c){var d=a.track,g=a.kind,f=a.mid||k.generateIdentifier();a.mid=f;a.iceGatherer||(a.iceGatherer=b._createIceGatherer(c,b.usingBundle));f=h.RTCRtpSender.getCapabilities(g);15019>w&&(f.codecs=f.codecs.filter(function(a){return"rtx"!==a.name}));f.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});f.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});c=a.sendEncodingParameters||[{ssrc:1001*(2*c+1)}];d&&15019<=w&&"video"===g&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new h.RTCRtpReceiver(a.dtlsTransport,g));a.localCapabilities=f;a.sendEncodingParameters=c});"max-compat"!==
b._config.bundlePolicy&&(g+="a=group:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");g+="a=ice-options:trickle\r\n";b.transceivers.forEach(function(a,c){g+=e(a,a.localCapabilities,"offer",a.stream,b._dtlsRole);g+="a=rtcp-rsize\r\n";!a.iceGatherer||"new"===b.iceGatheringState||0!==c&&b.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;g+="a="+k.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(g+="a=end-of-candidates\r\n"))});a=
new h.RTCSessionDescription({type:"offer",sdp:g});return Promise.resolve(a)};r.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(f("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==a.signalingState&&"have-local-pranswer"!==a.signalingState)return Promise.reject(f("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var b=k.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&
(b+="a=group:BUNDLE "+a.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var c=k.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(g,f){if(!(f+1>c))if(g.rejected)"application"===g.kind?b="DTLS/SCTP"===g.protocol?b+"m=application 0 DTLS/SCTP 5000\r\n":b+("m=application 0 "+g.protocol+" webrtc-datachannel\r\n"):"audio"===g.kind?b+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===g.kind&&(b+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),
b+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+g.mid+"\r\n";else{if(g.stream){var n;"audio"===g.kind?n=g.stream.getAudioTracks()[0]:"video"===g.kind&&(n=g.stream.getVideoTracks()[0]);n&&15019<=w&&"video"===g.kind&&!g.sendEncodingParameters[0].rtx&&(g.sendEncodingParameters[0].rtx={ssrc:g.sendEncodingParameters[0].ssrc+1})}f=d(g.localCapabilities,g.remoteCapabilities);!f.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&g.sendEncodingParameters[0].rtx&&delete g.sendEncodingParameters[0].rtx;
b+=e(g,f,"answer",g.stream,a._dtlsRole);g.rtcpParameters&&g.rtcpParameters.reducedSize&&(b+="a=rtcp-rsize\r\n")}});var g=new h.RTCSessionDescription({type:"answer",sdp:b});return Promise.resolve(g)};r.prototype.addIceCandidate=function(a){var c=this,d;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(g,n){if(c._remoteDescription)if(a&&""!==a.candidate){var e=a.sdpMLineIndex;if(a.sdpMid)for(var t=0;t<c.transceivers.length;t++)if(c.transceivers[t].mid===
a.sdpMid){e=t;break}var h=c.transceivers[e];if(h){if(h.rejected)return g();t=0<Object.keys(a.candidate).length?k.parseCandidate(a.candidate):{};if("tcp"===t.protocol&&(0===t.port||9===t.port)||t.component&&1!==t.component)return g();if((0===e||0<e&&h.iceTransport!==c.transceivers[0].iceTransport)&&!b(h.iceTransport,t))return n(f("OperationError","Can not add ICE candidate"));n=a.candidate.trim();0===n.indexOf("a=")&&(n=n.substr(2));d=k.getMediaSections(c._remoteDescription.sdp);d[e]+="a="+(t.type?
n:"end-of-candidates")+"\r\n";c._remoteDescription.sdp=k.getDescription(c._remoteDescription.sdp)+d.join("")}else return n(f("OperationError","Can not add ICE candidate"))}else for(e=0;e<c.transceivers.length&&(c.transceivers[e].rejected||(c.transceivers[e].iceTransport.addRemoteCandidate({}),d=k.getMediaSections(c._remoteDescription.sdp),d[e]+="a=end-of-candidates\r\n",c._remoteDescription.sdp=k.getDescription(c._remoteDescription.sdp)+d.join(""),!c.usingBundle));e++);else return n(f("InvalidStateError",
"Can not add ICE candidate without a remote description"));g()})};r.prototype.getStats=function(a){if(a&&a instanceof h.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw f("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&
c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=h[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",
outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var y=["createOffer","createAnswer"];y.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,
[b])}):b.apply(this,arguments)}});y=["setLocalDescription","setRemoteDescription","addIceCandidate"];y.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=
arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return r}},{sdp:2}],2:[function(l,p,q){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};e.localCName=e.generateIdentifier();e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};e.splitSections=function(a){return a.split("\nm=").map(function(a,c){return(0<c?"m="+a:a).trim()+"\r\n"})};
e.getDescription=function(a){return(a=e.splitSections(a))&&a[0]};e.getMediaSections=function(a){a=e.splitSections(a);a.shift();return a};e.matchPrefix=function(a,d){return e.splitLines(a).filter(function(a){return 0===a.indexOf(d)})};e.parseCandidate=function(a){a=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var d={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],port:parseInt(a[5],10),type:a[7]},
c=8;c<a.length;c+=2)switch(a[c]){case "raddr":d.relatedAddress=a[c+1];break;case "rport":d.relatedPort=parseInt(a[c+1],10);break;case "tcptype":d.tcpType=a[c+1];break;case "ufrag":d.ufrag=a[c+1];d.usernameFragment=a[c+1];break;default:d[a[c]]=a[c+1]}return d};e.writeCandidate=function(a){var d=[];d.push(a.foundation);d.push(a.component);d.push(a.protocol.toUpperCase());d.push(a.priority);d.push(a.ip);d.push(a.port);var c=a.type;d.push("typ");d.push(c);"host"!==c&&a.relatedAddress&&a.relatedPort&&
(d.push("raddr"),d.push(a.relatedAddress),d.push("rport"),d.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(d.push("tcptype"),d.push(a.tcpType));if(a.usernameFragment||a.ufrag)d.push("ufrag"),d.push(a.usernameFragment||a.ufrag);return"candidate:"+d.join(" ")};e.parseIceOptions=function(a){return a.substr(14).split(" ")};e.parseRtpMap=function(a){a=a.substr(9).split(" ");var d={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");d.name=a[0];d.clockRate=parseInt(a[1],10);d.channels=
3===a.length?parseInt(a[2],10):1;d.numChannels=d.channels;return d};e.writeRtpMap=function(a){var d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);var c=a.channels||a.numChannels||1;return"a=rtpmap:"+d+" "+a.name+"/"+a.clockRate+(1!==c?"/"+c:"")+"\r\n"};e.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&
"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};e.parseFmtp=function(a){for(var d={},c=a.substr(a.indexOf(" ")+1).split(";"),b=0;b<c.length;b++)a=c[b].trim().split("="),d[a[0].trim()]=a[1];return d};e.writeFmtp=function(a){var d="",c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var b=[];Object.keys(a.parameters).forEach(function(c){a.parameters[c]?b.push(c+"="+a.parameters[c]):b.push(c)});d+="a=fmtp:"+c+
" "+b.join(";")+"\r\n"}return d};e.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};e.writeRtcpFb=function(a){var d="",c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){d+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return d};e.parseSsrcMedia=function(a){var d=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,
d-7),10)},b=a.indexOf(":",d);-1<b?(c.attribute=a.substr(d+1,b-d-1),c.value=a.substr(b+1)):c.attribute=a.substr(d+1);return c};e.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};e.getMid=function(a){if(a=e.matchPrefix(a,"a=mid:")[0])return a.substr(6)};e.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};e.getDtlsParameters=function(a,d){return{role:"auto",fingerprints:e.matchPrefix(a+
d,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(a,d){var c="a=setup:"+d+"\r\n";a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return c};e.getIceParameters=function(a,d){a=e.splitLines(a);a=a.concat(e.splitLines(d));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)}};e.writeIceParameters=function(a){return"a=ice-ufrag:"+
a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"};e.parseRtpParameters=function(a){for(var d={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=e.splitLines(a)[0].split(" "),b=3;b<c.length;b++){var f=c[b],k=e.matchPrefix(a,"a=rtpmap:"+f+" ")[0];if(k){k=e.parseRtpMap(k);var h=e.matchPrefix(a,"a=fmtp:"+f+" ");k.parameters=h.length?e.parseFmtp(h[0]):{};k.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb);d.codecs.push(k);switch(k.name.toUpperCase()){case "RED":case "ULPFEC":d.fecMechanisms.push(k.name.toUpperCase())}}}e.matchPrefix(a,
"a=extmap:").forEach(function(a){d.headerExtensions.push(e.parseExtmap(a))});return d};e.writeRtpDescription=function(a,d){var c="";c+="m="+a+" ";c+=0<d.codecs.length?"9":"0";c+=" UDP/TLS/RTP/SAVPF ";c+=d.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";c+="c=IN IP4 0.0.0.0\r\n";c+="a=rtcp:9 IN IP4 0.0.0.0\r\n";d.codecs.forEach(function(a){c+=e.writeRtpMap(a);c+=e.writeFmtp(a);c+=e.writeRtcpFb(a)});var b=0;d.codecs.forEach(function(a){a.maxptime>
b&&(b=a.maxptime)});0<b&&(c+="a=maxptime:"+b+"\r\n");c+="a=rtcp-mux\r\n";d.headerExtensions&&d.headerExtensions.forEach(function(a){c+=e.writeExtmap(a)});return c};e.parseRtpEncodingParameters=function(a){var d=[],c=e.parseRtpParameters(a),b=-1!==c.fecMechanisms.indexOf("RED"),f=-1!==c.fecMechanisms.indexOf("ULPFEC"),k=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),h=0<k.length&&k[0].ssrc,w;k=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,
10)})});0<k.length&&1<k[0].length&&k[0][0]===h&&(w=k[0][1]);c.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:h,codecPayloadType:parseInt(a.parameters.apt,10)},h&&w&&(a.rtx={ssrc:w}),d.push(a),b&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:w,mechanism:f?"red+ulpfec":"red"},d.push(a)))});0===d.length&&h&&d.push({ssrc:h});var t=e.matchPrefix(a,"b=");t.length&&(t=0===t[0].indexOf("b=TIAS:")?parseInt(t[0].substr(7),10):0===t[0].indexOf("b=AS:")?950*parseInt(t[0].substr(5),
10)-16E3:void 0,d.forEach(function(a){a.maxBitrate=t}));return d};e.parseRtcpParameters=function(a){var d={},c=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];c&&(d.cname=c.value,d.ssrc=c.ssrc);c=e.matchPrefix(a,"a=rtcp-rsize");d.reducedSize=0<c.length;d.compound=0===c.length;a=e.matchPrefix(a,"a=rtcp-mux");d.mux=0<a.length;return d};e.parseMsid=function(a){var d=e.matchPrefix(a,"a=msid:");if(1===d.length)return a=d[0].substr(7).split(" "),
{stream:a[0],track:a[1]};a=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(a,d){d=void 0!==d?d:2;return"v=0\r\no=thisisadapterortc "+(a?a:e.generateSessionId())+" "+d+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(a,d,c,b){d=
e.writeRtpDescription(a.kind,d);d+=e.writeIceParameters(a.iceGatherer.getLocalParameters());d+=e.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":"active");d+="a=mid:"+a.mid+"\r\n";d=a.direction?d+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?d+"a=sendrecv\r\n":a.rtpSender?d+"a=sendonly\r\n":a.rtpReceiver?d+"a=recvonly\r\n":d+"a=inactive\r\n";a.rtpSender&&(c="msid:"+b.id+" "+a.rtpSender.track.id+"\r\n",d=d+("a="+c)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+
c),a.sendEncodingParameters[0].rtx&&(d+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+c,d+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));d+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(d+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n");return d};e.getDirection=function(a,d){a=e.splitLines(a);for(var c=0;c<a.length;c++)switch(a[c]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[c].substr(2)}return d?
e.getDirection(d):"sendrecv"};e.getKind=function(a){return e.splitLines(a)[0].split(" ")[0].substr(2)};e.isRejected=function(a){return"0"===a.split(" ",2)[1]};e.parseMLine=function(a){a=e.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};e.parseOLine=function(a){a=e.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};e.isValidSDP=
function(a){if("string"!==typeof a||0===a.length)return!1;a=e.splitLines(a);for(var d=0;d<a.length;d++)if(2>a[d].length||"="!==a[d].charAt(1))return!1;return!0};"object"===typeof p&&(p.exports=e)},{}],3:[function(l,p,q){q="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{};l=l("./adapter_factory.js");p.exports=l({window:q.window})},{"./adapter_factory.js":4}],4:[function(l,p,q){var e=l("./utils");p.exports=function(a,d){a=a&&a.window;var c={shimChrome:!0,
shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(b in d)hasOwnProperty.call(d,b)&&(c[b]=d[b]);d=e.log;var b=e.detectBrowser(a);var f=l("./chrome/chrome_shim")||null,k=l("./edge/edge_shim")||null,h=l("./firefox/firefox_shim")||null,w=l("./safari/safari_shim")||null,t=l("./common_shim")||null,g={browserDetails:b,commonShim:t,extractVersion:e.extractVersion,disableLog:e.disableLog,disableWarnings:e.disableWarnings};switch(b.browser){case "chrome":if(!f||!f.shimPeerConnection||!c.shimChrome){d("Chrome shim is not included in this adapter release.");
break}d("adapter.js shimming chrome.");g.browserShim=f;t.shimCreateObjectURL(a);f.shimGetUserMedia(a);f.shimMediaStream(a);f.shimSourceObject(a);f.shimPeerConnection(a);f.shimOnTrack(a);f.shimAddTrackRemoveTrack(a);f.shimGetSendersWithDtmf(a);f.shimSenderReceiverGetStats(a);f.fixNegotiationNeeded(a);t.shimRTCIceCandidate(a);t.shimMaxMessageSize(a);t.shimSendThrowTypeError(a);break;case "firefox":if(!h||!h.shimPeerConnection||!c.shimFirefox){d("Firefox shim is not included in this adapter release.");
break}d("adapter.js shimming firefox.");g.browserShim=h;t.shimCreateObjectURL(a);h.shimGetUserMedia(a);h.shimSourceObject(a);h.shimPeerConnection(a);h.shimOnTrack(a);h.shimRemoveStream(a);h.shimSenderGetStats(a);h.shimReceiverGetStats(a);h.shimRTCDataChannel(a);t.shimRTCIceCandidate(a);t.shimMaxMessageSize(a);t.shimSendThrowTypeError(a);break;case "edge":if(!k||!k.shimPeerConnection||!c.shimEdge){d("MS edge shim is not included in this adapter release.");break}d("adapter.js shimming edge.");g.browserShim=
k;t.shimCreateObjectURL(a);k.shimGetUserMedia(a);k.shimPeerConnection(a);k.shimReplaceTrack(a);t.shimMaxMessageSize(a);t.shimSendThrowTypeError(a);break;case "safari":if(!w||!c.shimSafari){d("Safari shim is not included in this adapter release.");break}d("adapter.js shimming safari.");g.browserShim=w;t.shimCreateObjectURL(a);w.shimRTCIceServerUrls(a);w.shimCreateOfferLegacy(a);w.shimCallbacksAPI(a);w.shimLocalStreamsAPI(a);w.shimRemoteStreamsAPI(a);w.shimTrackEventTransceiver(a);w.shimGetUserMedia(a);
t.shimRTCIceCandidate(a);t.shimMaxMessageSize(a);t.shimSendThrowTypeError(a);break;default:d("Unsupported browser!")}return g}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":11,"./safari/safari_shim":13,"./utils":14}],5:[function(l,p,q){function e(a,c,d){c&&!d.has(c.id)&&(d.set(c.id,c),Object.keys(c).forEach(function(b){b.endsWith("Id")?e(a,a.get(c[b]),d):b.endsWith("Ids")&&c[b].forEach(function(b){e(a,a.get(b),d)})}))}function a(a,c,d){var b=d?"outbound-rtp":
"inbound-rtp",f=new Map;if(null===c)return f;var t=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===c.id&&t.push(a)});t.forEach(function(c){a.forEach(function(d){d.type===b&&d.trackId===c.id&&e(a,d,f)})});return f}var d=l("../utils.js"),c=d.log;p.exports={shimGetUserMedia:l("./getusermedia"),shimMediaStream:function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream},shimOnTrack:function(a){if("object"!==typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)"RTCRtpTransceiver"in
a||d.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||(a.transceiver={receiver:a.receiver});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=
this;c._ontrackpoly||(c._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var f=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var g=new Event("track");g.track=d.track;g.receiver=f;g.transceiver={receiver:f};g.streams=[b.stream];c.dispatchEvent(g)});b.stream.getTracks().forEach(function(d){var f=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&
a.track.id===d.id}):{track:d};var g=new Event("track");g.track=d;g.receiver=f;g.transceiver={receiver:f};g.streams=[b.stream];c.dispatchEvent(g)})},c.addEventListener("addstream",c._ontrackpoly));return b.apply(c,arguments)}}},shimGetSendersWithDtmf:function(a){if("object"===typeof a&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?
a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var g=c.apply(this,arguments);g||(g=b(this,a),this._senders.push(g));return g};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,
arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;c._senders=c._senders||[];e.apply(c,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var t=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._senders=b._senders||[];t.apply(b,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===
a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===typeof a&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var g=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=g.apply(a,[]);b.forEach(function(b){b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===
this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}},shimSenderReceiverGetStats:function(b){if("object"===typeof b&&b.RTCPeerConnection&&b.RTCRtpSender&&b.RTCRtpReceiver){if(!("getStats"in b.RTCRtpSender.prototype)){var c=b.RTCPeerConnection.prototype.getSenders;c&&(b.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(a,[]);b.forEach(function(b){b._pc=a});return b});var e=b.RTCPeerConnection.prototype.addTrack;e&&
(b.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});b.RTCRtpSender.prototype.getStats=function(){var b=this;return this._pc.getStats().then(function(c){return a(c,b.track,!0)})}}if(!("getStats"in b.RTCRtpReceiver.prototype)){var h=b.RTCPeerConnection.prototype.getReceivers;h&&(b.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=h.apply(a,[]);b.forEach(function(b){b._pc=a});return b});d.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=
a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){var b=this;return this._pc.getStats().then(function(c){return a(c,b.track,!1)})}}if("getStats"in b.RTCRtpSender.prototype&&"getStats"in b.RTCRtpReceiver.prototype){var l=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof b.MediaStreamTrack){var a=arguments[0],c,d,f;this.getSenders().forEach(function(b){b.track===a&&(c?f=!0:c=b)});this.getReceivers().forEach(function(b){b.track===
a&&(d?f=!0:d=b);return b.track===a});return f||c&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():d?d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return l.apply(this,arguments)}}}},shimSourceObject:function(a){var b=a&&a.URL;"object"===typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,
"srcObject",{get:function(){return this._srcObject},set:function(a){var c=this;this._srcObject=a;this.src&&b.revokeObjectURL(this.src);a?(this.src=b.createObjectURL(a),a.addEventListener("addtrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)}),a.addEventListener("removetrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=
this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=b.apply(this,arguments);this._shimmedLocalStreams[c.id]?-1===this._shimmedLocalStreams[c.id].indexOf(d)&&this._shimmedLocalStreams[c.id].push(d):
this._shimmedLocalStreams[c.id]=[c,d];return d};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var d=b.getSenders();c.apply(this,arguments);var e=b.getSenders().filter(function(a){return-1===d.indexOf(a)});this._shimmedLocalStreams[a.id]=
[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var d=b._shimmedLocalStreams[c].indexOf(a);
-1!==d&&b._shimmedLocalStreams[c].splice(d,1);1===b._shimmedLocalStreams[c].length&&delete b._shimmedLocalStreams[c]});return e.apply(this,arguments)}},shimAddTrackRemoveTrack:function(a){function b(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(a._streams[b.id].id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:c})}function c(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];
c=c.replace(new RegExp(b.id,"g"),a._streams[b.id].id)});return new RTCSessionDescription({type:b.type,sdp:c})}var e=d.detectBrowser(a);if(a.RTCPeerConnection.prototype.addTrack&&65<=e.version)return this.shimAddTrackRemoveTrackWithNative(a);var l=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=l.apply(this);a._reverseStreams=a._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};var t=a.RTCPeerConnection.prototype.addStream;
a.RTCPeerConnection.prototype.addStream=function(b){var c=this;c._streams=c._streams||{};c._reverseStreams=c._reverseStreams||{};b.getTracks().forEach(function(a){if(c.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!c._reverseStreams[b.id]){var d=new a.MediaStream(b.getTracks());c._streams[b.id]=d;c._reverseStreams[d.id]=b;b=d}t.apply(c,[b])};var g=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=
function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};g.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};a.RTCPeerConnection.prototype.addTrack=function(b,c){var d=this;if("closed"===d.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,1);if(1!==e.length||!e[0].getTracks().find(function(a){return a===
b}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(d.getSenders().find(function(a){return a.track===b}))throw new DOMException("Track already exists.","InvalidAccessError");d._streams=d._streams||{};d._reverseStreams=d._reverseStreams||{};(e=d._streams[c.id])?(e.addTrack(b),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):(e=new a.MediaStream([b]),d._streams[c.id]=
e,d._reverseStreams[e.id]=c,d.addStream(e));return d.getSenders().find(function(a){return a.track===b})};["createOffer","createAnswer"].forEach(function(c){var d=a.RTCPeerConnection.prototype[c];a.RTCPeerConnection.prototype[c]=function(){var a=this,c=arguments;return arguments.length&&"function"===typeof arguments[0]?d.apply(a,[function(d){d=b(a,d);c[0].apply(null,[d])},function(a){c[1]&&c[1].apply(null,a)},arguments[2]]):d.apply(a,arguments).then(function(c){return b(a,c)})}});var p=a.RTCPeerConnection.prototype.setLocalDescription;
a.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return p.apply(this,arguments);arguments[0]=c(this,arguments[0]);return p.apply(this,arguments)};var r=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=r.get.apply(this);return""===a.type?a:b(this,a)}});a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===
b.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==b)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");b._streams=b._streams||{};var c;Object.keys(b._streams).forEach(function(d){b._streams[d].getTracks().find(function(b){return a.track===b})&&(c=b._streams[d])});
c&&(1===c.getTracks().length?b.removeStream(b._reverseStreams[c.id]):c.removeTrack(a.track),b.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(a){var b=d.detectBrowser(a);if(!a.RTCPeerConnection&&a.webkitRTCPeerConnection)a.RTCPeerConnection=function(b,d){c("PeerConnection");b&&b.iceTransportPolicy&&(b.iceTransports=b.iceTransportPolicy);return new a.webkitRTCPeerConnection(b,d)},a.RTCPeerConnection.prototype=a.webkitRTCPeerConnection.prototype,a.webkitRTCPeerConnection.generateCertificate&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.webkitRTCPeerConnection.generateCertificate}});else{var e=a.RTCPeerConnection;a.RTCPeerConnection=function(a,b){if(a&&a.iceServers){for(var c=[],g=0;g<a.iceServers.length;g++){var f=a.iceServers[g];!f.hasOwnProperty("urls")&&f.hasOwnProperty("url")?(d.deprecated("RTCIceServer.url","RTCIceServer.urls"),f=JSON.parse(JSON.stringify(f)),f.urls=f.url,c.push(f)):c.push(a.iceServers[g])}a.iceServers=c}return new e(a,
b)};a.RTCPeerConnection.prototype=e.prototype;Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})}var h=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,b,c){var d=this,e=arguments;if(0<arguments.length&&"function"===typeof a)return h.apply(this,arguments);if(0===h.length&&(0===arguments.length||"function"!==typeof arguments[0]))return h.apply(this,[]);var g=function(a){var b={};a.result().forEach(function(a){var c=
{id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},f=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?h.apply(this,[function(a){e[1](f(g(a)))},arguments[0]]):(new Promise(function(a,b){h.apply(d,[function(b){a(f(g(b)))},b])})).then(b,c)};51>b.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=
a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=arguments,b=this,d=new Promise(function(d,e){c.apply(b,[a[0],d,e])});return 2>a.length?d:d.then(function(){a[1].apply(null,[])},function(b){3<=a.length&&a[2].apply(null,[b])})}});52>b.version&&["createOffer","createAnswer"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=this;if(1>arguments.length||1===arguments.length&&"object"===typeof arguments[0]){var b=
1===arguments.length?arguments[0]:void 0;return new Promise(function(d,e){c.apply(a,[d,e,b])})}return c.apply(this,arguments)}});["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)}});var l=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=
function(){return arguments[0]?l.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},fixNegotiationNeeded:function(a){d.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})},shimGetDisplayMedia:function(a,c){"getDisplayMedia"in a.navigator||("function"!==typeof c?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):navigator.getDisplayMedia=function(a){return c(a).then(function(b){a.video=
{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b,maxFrameRate:a.video.frameRate||3}};return navigator.mediaDevices.getUserMedia(a)})})}}},{"../utils.js":14,"./getusermedia":6}],6:[function(l,p,q){var e=l("../utils.js"),a=e.log;p.exports=function(d){var c=e.detectBrowser(d),b=d&&d.navigator,f=function(a){if("object"!==typeof a||a.mandatory||a.optional)return a;var b={};Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d="object"===typeof a[c]?
a[c]:{ideal:a[c]};void 0!==d.exact&&"number"===typeof d.exact&&(d.min=d.max=d.exact);var e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];var f={};"number"===typeof d.ideal?(f[e("min",c)]=d.ideal,b.optional.push(f),f={},f[e("max",c)]=d.ideal):f[e("",c)]=d.ideal;b.optional.push(f)}void 0!==d.exact&&"number"!==typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(function(a){void 0!==
d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})}});a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced));return b},k=function(d,e){if(61<=c.version)return e(d);if((d=JSON.parse(JSON.stringify(d)))&&"object"===typeof d.audio){var g=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};d=JSON.parse(JSON.stringify(d));g(d.audio,"autoGainControl","googAutoGainControl");g(d.audio,"noiseSuppression","googNoiseSuppression");d.audio=f(d.audio)}if(d&&"object"===typeof d.video){var h=
d.video.facingMode;h=h&&("object"===typeof h?h:{ideal:h});g=66>c.version;if(!(!h||"user"!==h.exact&&"environment"!==h.exact&&"user"!==h.ideal&&"environment"!==h.ideal||b.mediaDevices.getSupportedConstraints&&b.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete d.video.facingMode;if("environment"===h.exact||"environment"===h.ideal)var n=["back","rear"];else if("user"===h.exact||"user"===h.ideal)n=["front"];if(n)return b.mediaDevices.enumerateDevices().then(function(b){b=b.filter(function(a){return"videoinput"===
a.kind});var c=b.find(function(a){return n.some(function(b){return-1!==a.label.toLowerCase().indexOf(b)})});!c&&b.length&&-1!==n.indexOf("back")&&(c=b[b.length-1]);c&&(d.video.deviceId=h.exact?{exact:c.deviceId}:{ideal:c.deviceId});d.video=f(d.video);a("chrome: "+JSON.stringify(d));return e(d)})}d.video=f(d.video)}a("chrome: "+JSON.stringify(d));return e(d)},h=function(a){return 64<=c.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",
DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};b.getUserMedia=function(a,c,d){k(a,function(a){b.webkitGetUserMedia(a,
c,function(a){d&&d(h(a))})})};var l=function(a){return new Promise(function(c,d){b.getUserMedia(a,c,d)})};b.mediaDevices||(b.mediaDevices={getUserMedia:l,enumerateDevices:function(){return new Promise(function(a){var b={audio:"audioinput",video:"videoinput"};return d.MediaStreamTrack.getSources(function(c){a(c.map(function(a){return{label:a.label,kind:b[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,
width:!0}}});if(b.mediaDevices.getUserMedia){var t=b.mediaDevices.getUserMedia.bind(b.mediaDevices);b.mediaDevices.getUserMedia=function(a){return k(a,function(a){return t(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(h(a))})})}}else b.mediaDevices.getUserMedia=function(a){return l(a)};"undefined"===typeof b.mediaDevices.addEventListener&&
(b.mediaDevices.addEventListener=function(){a("Dummy mediaDevices.addEventListener called.")});"undefined"===typeof b.mediaDevices.removeEventListener&&(b.mediaDevices.removeEventListener=function(){a("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":14}],7:[function(l,p,q){var e=l("sdp"),a=l("./utils");p.exports={shimRTCIceCandidate:function(d){if(d.RTCIceCandidate&&!(d.RTCIceCandidate&&"foundation"in d.RTCIceCandidate.prototype)){var c=d.RTCIceCandidate;d.RTCIceCandidate=function(a){"object"===
typeof a&&a.candidate&&0===a.candidate.indexOf("a=")&&(a=JSON.parse(JSON.stringify(a)),a.candidate=a.candidate.substr(2));if(a.candidate&&a.candidate.length){var b=new c(a);a=e.parseCandidate(a.candidate);var d=Object.assign(b,a);d.toJSON=function(){return{candidate:d.candidate,sdpMid:d.sdpMid,sdpMLineIndex:d.sdpMLineIndex,usernameFragment:d.usernameFragment}};return d}return new c(a)};d.RTCIceCandidate.prototype=c.prototype;a.wrapPeerConnectionEvent(d,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,
"candidate",{value:new d.RTCIceCandidate(a.candidate),writable:"false"});return a})}},shimCreateObjectURL:function(d){var c=d&&d.URL;if("object"===typeof d&&d.HTMLMediaElement&&"srcObject"in d.HTMLMediaElement.prototype&&c.createObjectURL&&c.revokeObjectURL){var b=c.createObjectURL.bind(c),e=c.revokeObjectURL.bind(c),k=new Map,h=0;c.createObjectURL=function(c){if("getTracks"in c){var d="polyblob:"+ ++h;k.set(d,c);a.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return d}return b(c)};
c.revokeObjectURL=function(a){e(a);k.delete(a)};var l=Object.getOwnPropertyDescriptor(d.HTMLMediaElement.prototype,"src");Object.defineProperty(d.HTMLMediaElement.prototype,"src",{get:function(){return l.get.apply(this)},set:function(a){this.srcObject=k.get(a)||null;return l.set.apply(this,[a])}});var t=d.HTMLMediaElement.prototype.setAttribute;d.HTMLMediaElement.prototype.setAttribute=function(){2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=k.get(arguments[1])||null);
return t.apply(this,arguments)}}},shimMaxMessageSize:function(d){if(!d.RTCSctpTransport&&d.RTCPeerConnection){var c=a.detectBrowser(d);"sctp"in d.RTCPeerConnection.prototype||Object.defineProperty(d.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var b=function(a){a=e.splitSections(a.sdp);a.shift();return a.some(function(a){return(a=e.parseMLine(a))&&"application"===a.kind&&-1!==a.protocol.indexOf("SCTP")})},f=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);
if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},k=function(a){var b=65536;"firefox"===c.browser&&(b=57>c.version?-1===a?16384:2147483637:60>c.version?57===c.version?65535:65536:2147483637);return b},h=function(a,b){var d=65536;"firefox"===c.browser&&57===c.version&&(d=65535);a=e.matchPrefix(a.sdp,"a=max-message-size:");0<a.length?d=parseInt(a[0].substr(19),10):"firefox"===c.browser&&-1!==b&&(d=2147483637);return d},l=d.RTCPeerConnection.prototype.setRemoteDescription;d.RTCPeerConnection.prototype.setRemoteDescription=
function(){this._sctp=null;if(b(arguments[0])){var a=f(arguments[0]),c=k(a);a=h(arguments[0],a);var d=0===c&&0===a?Number.POSITIVE_INFINITY:0===c||0===a?Math.max(c,a):Math.min(c,a);c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return d}});this._sctp=c}return l.apply(this,arguments)}}},shimSendThrowTypeError:function(d){function c(a,b){var c=a.send;a.send=function(){var d=arguments[0];d=d.length||d.size||d.byteLength;if("open"===a.readyState&&b.sctp&&d>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+
b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(d.RTCPeerConnection&&"createDataChannel"in d.RTCPeerConnection.prototype){var b=d.RTCPeerConnection.prototype.createDataChannel;d.RTCPeerConnection.prototype.createDataChannel=function(){var a=b.apply(this,arguments);c(a,this);return a};a.wrapPeerConnectionEvent(d,"datachannel",function(a){c(a.channel,a.target);return a})}}}},{"./utils":14,sdp:2}],8:[function(l,p,q){var e=l("../utils"),a=l("./filtericeservers"),d=l("rtcpeerconnection-shim");
p.exports={shimGetUserMedia:l("./getusermedia"),shimPeerConnection:function(c){var b=e.detectBrowser(c);if(c.RTCIceGatherer&&(c.RTCIceCandidate||(c.RTCIceCandidate=function(a){return a}),c.RTCSessionDescription||(c.RTCSessionDescription=function(a){return a}),15025>b.version)){var f=Object.getOwnPropertyDescriptor(c.MediaStreamTrack.prototype,"enabled");Object.defineProperty(c.MediaStreamTrack.prototype,"enabled",{set:function(a){f.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!c.RTCRtpSender||
"dtmf"in c.RTCRtpSender.prototype||Object.defineProperty(c.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new c.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});c.RTCDtmfSender&&!c.RTCDTMFSender&&(c.RTCDTMFSender=c.RTCDtmfSender);var k=d(c,b.version);c.RTCPeerConnection=function(b){b&&b.iceServers&&(b.iceServers=a(b.iceServers));return new k(b)};c.RTCPeerConnection.prototype=k.prototype},shimReplaceTrack:function(a){!a.RTCRtpSender||
"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)}}},{"../utils":14,"./filtericeservers":9,"./getusermedia":10,"rtcpeerconnection-shim":1}],9:[function(l,p,q){var e=l("../utils");p.exports=function(a,d){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var b=a.urls||a.url;a.url&&!a.urls&&e.deprecated("RTCIceServer.url","RTCIceServer.urls");var k="string"===typeof b;k&&(b=[b]);b=b.filter(function(a){return 0!==
a.indexOf("turn:")||-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=d&&-1===a.indexOf("?transport=udp"):c=!0});delete a.url;a.urls=k?b[0]:b;return!!b.length}})}},{"../utils":14}],10:[function(l,p,q){p.exports=function(e){e=e&&e.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},d=e.mediaDevices.getUserMedia.bind(e.mediaDevices);
e.mediaDevices.getUserMedia=function(c){return d(c).catch(function(b){return Promise.reject(a(b))})}}},{}],11:[function(l,p,q){var e=l("../utils");p.exports={shimGetUserMedia:l("./getusermedia"),shimOnTrack:function(a){"object"!==typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",
this._ontrackpoly));this.addEventListener("track",this._ontrack=a);this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=new Event("track");c.track=b;c.receiver={track:b};c.transceiver={receiver:c.receiver};c.streams=[a.stream];this.dispatchEvent(c)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0});"object"===typeof a&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,
"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(a){"object"===typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(a){var d=e.detectBrowser(a);if("object"===typeof a&&(a.RTCPeerConnection||a.mozRTCPeerConnection)){a.RTCPeerConnection||(a.RTCPeerConnection=function(b,
c){if(38>d.version&&b&&b.iceServers){for(var e=[],f=0;f<b.iceServers.length;f++){var h=b.iceServers[f];if(h.hasOwnProperty("urls"))for(var k=0;k<h.urls.length;k++){var l={url:h.urls[k]};0===h.urls[k].indexOf("turn")&&(l.username=h.username,l.credential=h.credential);e.push(l)}else e.push(b.iceServers[f])}b.iceServers=e}return new a.mozRTCPeerConnection(b,c)},a.RTCPeerConnection.prototype=a.mozRTCPeerConnection.prototype,a.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,
"generateCertificate",{get:function(){return a.mozRTCPeerConnection.generateCertificate}}),a.RTCSessionDescription=a.mozRTCSessionDescription,a.RTCIceCandidate=a.mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)}});var c=a.RTCPeerConnection.prototype.addIceCandidate;
a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var b=function(a){var b=new Map;Object.keys(a).forEach(function(c){b.set(c,a[c]);b[c]=a[c]});return b},f={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},k=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,
c,e){return k.apply(this,[a||null]).then(function(a){48>d.version&&(a=b(a));if(53>d.version&&!c)try{a.forEach(function(a){a.type=f[a.type]||a.type})}catch(x){if("TypeError"!==x.name)throw x;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:f[b.type]||b.type}))})}return a}).then(c,e)}}},shimSenderGetStats:function(a){if("object"===typeof a&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var d=a.RTCPeerConnection.prototype.getSenders;d&&(a.RTCPeerConnection.prototype.getSenders=
function(){var a=this,c=d.apply(a,[]);c.forEach(function(b){b._pc=a});return c});var c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(a){if("object"===typeof a&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var d=
a.RTCPeerConnection.prototype.getReceivers;d&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=d.apply(a,[]);b.forEach(function(b){b._pc=a});return b});e.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var c=
this;e.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(b){b.track&&-1!==a.getTracks().indexOf(b.track)&&c.removeTrack(b)})})},shimRTCDataChannel:function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)},shimGetDisplayMedia:function(a,d){"getDisplayMedia"in a.navigator||(navigator.getDisplayMedia=function(a){if(!a||!a.video)return a=new DOMException("getDisplayMedia without video constraints is undefined"),a.name="NotFoundError",a.code=8,Promise.reject(a);
!0===a.video?a.video={mediaSource:d}:a.video.mediaSource=d;return navigator.mediaDevices.getUserMedia(a)})}}},{"../utils":14,"./getusermedia":12}],12:[function(l,p,q){var e=l("../utils"),a=e.log;p.exports=function(d){var c=e.detectBrowser(d),b=d&&d.navigator;d=d&&d.MediaStreamTrack;var f=function(a){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||
a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},k=function(d,e,g){var n=function(a){if("object"!==typeof a||a.require)return a;var b=[];Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d=a[c]="object"===typeof a[c]?a[c]:{ideal:a[c]};void 0===d.min&&void 0===d.max&&void 0===d.exact||b.push(c);void 0!==d.exact&&("number"===typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact);if(void 0!==
d.ideal){a.advanced=a.advanced||[];var e={};e[c]="number"===typeof d.ideal?{min:d.ideal,max:d.ideal}:d.ideal;a.advanced.push(e);delete d.ideal;Object.keys(d).length||delete a[c]}}});b.length&&(a.require=b);return a};d=JSON.parse(JSON.stringify(d));38>c.version&&(a("spec: "+JSON.stringify(d)),d.audio&&(d.audio=n(d.audio)),d.video&&(d.video=n(d.video)),a("ff37: "+JSON.stringify(d)));return b.mozGetUserMedia(d,e,function(a){g(f(a))})},h=function(a){return new Promise(function(b,c){k(a,b,c)})};b.mediaDevices||
(b.mediaDevices={getUserMedia:h,addEventListener:function(){},removeEventListener:function(){}});b.mediaDevices.enumerateDevices=b.mediaDevices.enumerateDevices||function(){return new Promise(function(a){a([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})};if(41>c.version){var l=b.mediaDevices.enumerateDevices.bind(b.mediaDevices);b.mediaDevices.enumerateDevices=function(){return l().then(void 0,function(a){if("NotFoundError"===
a.name)return[];throw a;})}}if(49>c.version){var p=b.mediaDevices.getUserMedia.bind(b.mediaDevices);b.mediaDevices.getUserMedia=function(a){return p(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("The object can not be found here.","NotFoundError");return b},function(a){return Promise.reject(f(a))})}}if(!(55<c.version&&"autoGainControl"in b.mediaDevices.getSupportedConstraints())){var g=
function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},q=b.mediaDevices.getUserMedia.bind(b.mediaDevices);b.mediaDevices.getUserMedia=function(a){"object"===typeof a&&"object"===typeof a.audio&&(a=JSON.parse(JSON.stringify(a)),g(a.audio,"autoGainControl","mozAutoGainControl"),g(a.audio,"noiseSuppression","mozNoiseSuppression"));return q(a)};if(d&&d.prototype.getSettings){var r=d.prototype.getSettings;d.prototype.getSettings=function(){var a=r.apply(this,arguments);g(a,"mozAutoGainControl","autoGainControl");
g(a,"mozNoiseSuppression","noiseSuppression");return a}}if(d&&d.prototype.applyConstraints){var y=d.prototype.applyConstraints;d.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===typeof a&&(a=JSON.parse(JSON.stringify(a)),g(a,"autoGainControl","mozAutoGainControl"),g(a,"noiseSuppression","mozNoiseSuppression"));return y.apply(this,[a])}}}b.getUserMedia=function(a,d,f){if(44>c.version)return k(a,d,f);e.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");
b.mediaDevices.getUserMedia(a).then(d,f)}}},{"../utils":14}],13:[function(l,p,q){var e=l("../utils");p.exports={shimLocalStreamsAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=[]);return this._localStreams});"getStreamById"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getStreamById=function(a){var b=null;this._localStreams&&
this._localStreams.forEach(function(c){c.id===a&&(b=c)});this._remoteStreams&&this._remoteStreams.forEach(function(c){c.id===a&&(b=c)});return b});if(!("addStream"in a.RTCPeerConnection.prototype)){var d=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]);-1===this._localStreams.indexOf(a)&&this._localStreams.push(a);var b=this;a.getTracks().forEach(function(c){d.call(b,c,a)})};a.RTCPeerConnection.prototype.addTrack=
function(a,b){b&&(this._localStreams?-1===this._localStreams.indexOf(b)&&this._localStreams.push(b):this._localStreams=[b]);return d.call(this,a,b)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);var b=this._localStreams.indexOf(a);if(-1!==b){this._localStreams.splice(b,1);var c=this,d=a.getTracks();this.getSenders().forEach(function(a){-1!==d.indexOf(a.track)&&c.removeTrack(a)})}})}},shimRemoteStreamsAPI:function(a){if("object"===
typeof a&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){this._onaddstream&&this.removeEventListener("addstream",this._onaddstream);this.addEventListener("addstream",this._onaddstream=a)}});
var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)}})});return d.apply(a,arguments)}}},shimCallbacksAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection){a=
a.RTCPeerConnection.prototype;var d=a.createOffer,c=a.createAnswer,b=a.setLocalDescription,e=a.setRemoteDescription,k=a.addIceCandidate;a.createOffer=function(a,b){var c=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};a.createAnswer=function(a,b){var d=c.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};var h=function(a,c,d){a=b.apply(this,[a]);if(!d)return a;a.then(c,
d);return Promise.resolve()};a.setLocalDescription=h;h=function(a,b,c){a=e.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setRemoteDescription=h;h=function(a,b,c){a=k.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.addIceCandidate=h}},shimGetUserMedia:function(a){var d=a&&a.navigator;d.getUserMedia||(d.webkitGetUserMedia?d.getUserMedia=d.webkitGetUserMedia.bind(d):d.mediaDevices&&d.mediaDevices.getUserMedia&&(d.getUserMedia=function(a,b,e){d.mediaDevices.getUserMedia(a).then(b,
e)}.bind(d)))},shimRTCIceServerUrls:function(a){var d=a.RTCPeerConnection;a.RTCPeerConnection=function(a,b){if(a&&a.iceServers){for(var c=[],k=0;k<a.iceServers.length;k++){var h=a.iceServers[k];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),h.urls=h.url,delete h.url,c.push(h)):c.push(a.iceServers[k])}a.iceServers=c}return new d(a,b)};a.RTCPeerConnection.prototype=d.prototype;"generateCertificate"in a.RTCPeerConnection&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return d.generateCertificate}})},shimTrackEventTransceiver:function(a){"object"===typeof a&&a.RTCPeerConnection&&"receiver"in a.RTCTrackEvent.prototype&&!a.RTCTransceiver&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(a){var d=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==
typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var b=this.getTransceivers().find(function(a){return a.sender.track&&"audio"===a.sender.track.kind});!1===a.offerToReceiveAudio&&b?"sendrecv"===b.direction?b.setDirection?b.setDirection("sendonly"):b.direction="sendonly":"recvonly"===b.direction&&(b.setDirection?b.setDirection("inactive"):b.direction="inactive"):!0!==a.offerToReceiveAudio||b||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=
!!a.offerToReceiveVideo);b=this.getTransceivers().find(function(a){return a.sender.track&&"video"===a.sender.track.kind});!1===a.offerToReceiveVideo&&b?"sendrecv"===b.direction?b.setDirection("sendonly"):"recvonly"===b.direction&&b.setDirection("inactive"):!0!==a.offerToReceiveVideo||b||this.addTransceiver("video")}return d.apply(this,arguments)}}}},{"../utils":14}],14:[function(l,p,q){function e(a,b,d){return(a=a.match(b))&&a.length>=d&&parseInt(a[d],10)}var a=!0,d=!0;p.exports={extractVersion:e,
wrapPeerConnectionEvent:function(a,b,d){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var c=a.addEventListener;a.addEventListener=function(a,e){if(a!==b)return c.apply(this,arguments);var f=function(a){(a=d(a))&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=f;return c.apply(this,[a,f])};var e=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return e.apply(this,arguments);var d=this._eventMap[c];delete this._eventMap[c];return e.apply(this,
[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}},disableLog:function(c){return"boolean"!==typeof c?Error("Argument type: "+typeof c+". Please use a boolean."):(a=c)?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function(a){if("boolean"!==typeof a)return Error("Argument type: "+
typeof a+". Please use a boolean.");d=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")},log:function(){"object"!==typeof window||a||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)},deprecated:function(a,b){d&&console.warn(a+" is deprecated, please use "+b+" instead.")},detectBrowser:function(a){var b=a&&a.navigator,c={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return c.browser="Not a browser.",c;b.mozGetUserMedia?
(c.browser="firefox",c.version=e(b.userAgent,/Firefox\/(\d+)\./,1)):b.webkitGetUserMedia?(c.browser="chrome",c.version=e(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/)?(c.browser="edge",c.version=e(b.userAgent,/Edge\/(\d+).(\d+)$/,2)):a.RTCPeerConnection&&b.userAgent.match(/AppleWebKit\/(\d+)\./)?(c.browser="safari",c.version=e(b.userAgent,/AppleWebKit\/(\d+)\./,1)):c.browser="Not a supported browser.";return c}}},{}]},{},[3])(3)});
