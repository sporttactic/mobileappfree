var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},f=Object.create(new $jscomp.global.Proxy(a,{get:function(g,k,e){return g==a&&"q"==k&&e==f}}));return!0===f.q}catch(g){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var f=0;return function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,g){a!=Array.prototype&&a!=Object.prototype&&(a[f]=g.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,f){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(g){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(g||"")+"_"+f++,g)}var f=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return f?f.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,f){return Object.prototype.hasOwnProperty.call(a,f)};$jscomp.polyfill=function(a,f,g,k){if(f){g=$jscomp.global;a=a.split(".");for(k=0;k<a.length-1;k++){var e=a[k];e in g||(g[e]={});g=g[e]}a=a[a.length-1];k=g[a];f=f(k);f!=k&&null!=f&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("WeakMap",function(a){function f(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(h){return!1}}function g(){}function k(b){if(!$jscomp.owns(b,c)){var a=new g;$jscomp.defineProperty(b,c,{value:a})}}function e(b){var a=Object[b];a&&(Object[b]=function(b){if(b instanceof g)return b;k(b);return a(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(f())return a;var c="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var d=0,b=function(b){this.id_=(d+=Math.random()+1).toString();if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};b.prototype.set=function(b,a){k(b);if(!$jscomp.owns(b,c))throw Error("WeakMap key fail: "+b);b[c][this.id_]=a;return this};b.prototype.get=function(b){return $jscomp.owns(b,c)?b[c][this.id_]:void 0};b.prototype.has=
function(b){return $jscomp.owns(b,c)&&$jscomp.owns(b[c],this.id_)};b.prototype.delete=function(b){return $jscomp.owns(b,c)&&$jscomp.owns(b[c],this.id_)?delete b[c][this.id_]:!1};return b},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function f(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),h=d.next();if(h.done||h.value[0]!=b||"s"!=h.value[1])return!1;h=d.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!d.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(f())return a;$jscomp.initSymbolIterator();var g=new WeakMap,k=function(b){this.data_={};this.head_=d();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};k.prototype.set=function(b,a){b=0===b?0:b;var c=e(this,b);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=a:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,
value:a},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};k.prototype.delete=function(b){b=e(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};k.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=d();this.size=0};k.prototype.has=function(b){return!!e(this,b).entry};
k.prototype.get=function(b){return(b=e(this,b).entry)&&b.value};k.prototype.entries=function(){return c(this,function(b){return[b.key,b.value]})};k.prototype.keys=function(){return c(this,function(b){return b.key})};k.prototype.values=function(){return c(this,function(b){return b.value})};k.prototype.forEach=function(b,a){for(var c=this.entries(),h;!(h=c.next()).done;)h=h.value,b.call(a,h[1],h[0],this)};k.prototype[Symbol.iterator]=k.prototype.entries;var e=function(a,c){var d=c&&typeof c;"object"==
d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++b,g.set(c,d)):d="p_"+c;var h=a.data_[d];if(h&&$jscomp.owns(a.data_,d))for(a=0;a<h.length;a++){var e=h[a];if(c!==c&&e.key!==e.key||c===e.key)return{id:d,list:h,index:a,entry:e}}return{id:d,list:h,index:-1,entry:void 0}},c=function(b,a){var c=b.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=b.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:a(c)};c=null}return{done:!0,value:void 0}})},d=function(){var b={};return b.previous=
b.next=b.head=b},b=0;return k},"es6","es3");
$jscomp.polyfill("Set",function(a){function f(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var f=Object.seal({x:4}),e=new a($jscomp.makeIterator([f]));if(!e.has(f)||1!=e.size||e.add(f)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var c=e.entries(),d=c.next();if(d.done||d.value[0]!=f||d.value[1]!=f)return!1;d=c.next();return d.done||d.value[0]==f||4!=d.value[0].x||d.value[1]!=d.value[0]?!1:c.next().done}catch(b){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(f())return a;$jscomp.initSymbolIterator();var g=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)this.add(e.value)}this.size=this.map_.size};g.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};g.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};g.prototype.clear=function(){this.map_.clear();
this.size=0};g.prototype.has=function(a){return this.map_.has(a)};g.prototype.entries=function(){return this.map_.entries()};g.prototype.values=function(){return this.map_.values()};g.prototype.keys=g.prototype.values;g.prototype[Symbol.iterator]=g.prototype.values;g.prototype.forEach=function(a,e){var c=this;this.map_.forEach(function(d){return a.call(e,d,d,c)})};return g},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,g){return a===g?0!==a||1/a===1/g:a!==a&&g!==g}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,g){var f=this;f instanceof String&&(f=String(f));var e=f.length;g=g||0;for(0>g&&(g=Math.max(g+e,0));g<e;g++){var c=f[g];if(c===a||Object.is(c,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,f,g){if(null==a)throw new TypeError("The 'this' value for String.prototype."+g+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+g+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,g){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,g||0)}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function f(){this.batch_=null}function g(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;f.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var k=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(a){k(a,0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(n){this.asyncThrow_(n)}}}this.batch_=null};f.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(l){this.reject_(l);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)c.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var c=new f;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(n){c.reject(n)}};e.prototype.then=function(a,b){function c(b,a){return"function"==typeof b?function(a){try{d(b(a))}catch(u){f(u)}}:a}var d,f,h=new e(function(b,a){d=b;f=a});this.callWhenSettled_(c(a,d),c(b,f));return h};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function d(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?c.asyncExecute(d):this.onSettledCallbacks_.push(d)};e.resolve=g;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,c){for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())g(e.value).callWhenSettled_(b,
c)})};e.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?g([]):new e(function(a,d){function h(b){return function(h){e[b]=h;f--;0==f&&a(e)}}var e=[],f=0;do e.push(void 0),f++,g(c.value).callWhenSettled_(h(e.length-1),d),c=b.next();while(!c.done)})};return e},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,g,k){var e=this.length||0;0>g&&(g=Math.max(0,e+g));if(null==k||k>e)k=e;k=Number(k);0>k&&(k=Math.max(0,e+k));for(g=Number(g||0);g<k;g++)this[g]=a;return this}},"es6","es3");var cr={plugins_:{},behaviors:{}};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(a){return a.__proto__}:function(a){return a.constructor.prototype});
(function(){function a(b,a){this.x=b;this.y=a;cr.seal(this)}function f(b,a,h,c){this.set(b,a,h,c);cr.seal(this)}function g(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr.seal(this)}function k(b,a,h,c){b<a?h<c?(u=b<h?b:h,y=a>c?a:c):(u=b<c?b:c,y=a>h?a:h):h<c?(u=a<h?a:h,y=b>c?b:c):(u=a<c?a:c,y=b>h?b:h)}function e(){this.items=this.s=null;this.item_count=0;D&&(this.s=new Set);this.values_cache=[];this.cache_valid=!0;cr.seal(this)}function c(b){E[t++]=b}function d(){this.sum=
this.t=this.y=this.c=0;cr.seal(this)}function b(b){this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.set_pts(b);cr.seal(this)}function l(b,a){this.cellwidth=b;this.cellheight=a;this.cells={}}function n(b,a){this.cellwidth=b;this.cellheight=a;this.cells={}}function q(b,a,h){l.prototype.totalCellCount++;if(N.length){var c=N.pop();c.grid=b;c.x=a;c.y=h;return c}return new cr.GridCell(b,a,h)}function h(b,a,h){this.grid=b;this.x=a;this.y=h;this.objects=
new cr.ObjectSet}function m(b,a,h){n.prototype.totalCellCount++;if(P.length){var c=P.pop();c.grid=b;c.x=a;c.y=h;return c}return new cr.RenderCell(b,a,h)}function p(b,a,h){this.grid=b;this.x=a;this.y=h;this.objects=[];this.is_sorted=!0;this.pending_removal=new cr.ObjectSet;this.any_pending_removal=!1}function v(b,a){return b.zindex-a.zindex}cr.logexport=function(b){window.console&&window.console.log&&window.console.log(b)};cr.logerror=function(b){window.console&&window.console.error&&window.console.error(b)};
cr.seal=function(b){return b};cr.freeze=function(b){return b};cr.is_undefined=function(b){return"undefined"===typeof b};cr.is_number=function(b){return"number"===typeof b};cr.is_string=function(b){return"string"===typeof b};cr.isPOT=function(b){return 0<b&&0===(b-1&b)};cr.nextHighestPowerOfTwo=function(b){--b;for(var a=1;32>a;a<<=1)b|=b>>a;return b+1};cr.abs=function(b){return 0>b?-b:b};cr.max=function(b,a){return b>a?b:a};cr.min=function(b,a){return b<a?b:a};cr.PI=Math.PI;cr.round=function(b){return b+
.5|0};cr.floor=function(b){return 0<=b?b|0:(b|0)-1};cr.ceil=function(b){var a=b|0;return a===b?a:a+1};a.prototype.offset=function(b,a){this.x+=b;this.y+=a;return this};a.prototype.mul=function(b,a){this.x*=b;this.y*=a;return this};cr.vector2=a;cr.segments_intersect=function(b,a,h,c,d,e,f,m){if(b<h){var l=b;var k=h}else l=h,k=b;if(d<f){var g=d;var t=f}else g=f,t=d;if(k<g||l>t)return!1;a<c?(l=a,k=c):(l=c,k=a);e<m?(g=e,t=m):(g=m,t=e);if(k<g||l>t)return!1;k=d-b+f-h;l=e-a+m-c;b=h-b;a=c-a;d=f-d;e=m-e;m=
cr.abs(a*d-e*b);return cr.abs(d*l-e*k)>m?!1:cr.abs(b*l-a*k)<=m};f.prototype.set=function(b,a,h,c){this.left=b;this.top=a;this.right=h;this.bottom=c};f.prototype.copy=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};f.prototype.width=function(){return this.right-this.left};f.prototype.height=function(){return this.bottom-this.top};f.prototype.offset=function(b,a){this.left+=b;this.top+=a;this.right+=b;this.bottom+=a;return this};f.prototype.normalize=function(){if(this.left>
this.right){var b=this.left;this.left=this.right;this.right=b}this.top>this.bottom&&(b=this.top,this.top=this.bottom,this.bottom=b)};f.prototype.intersects_rect=function(b){return!(b.right<this.left||b.bottom<this.top||b.left>this.right||b.top>this.bottom)};f.prototype.intersects_rect_off=function(b,a,h){return!(b.right+a<this.left||b.bottom+h<this.top||b.left+a>this.right||b.top+h>this.bottom)};f.prototype.contains_pt=function(b,a){return b>=this.left&&b<=this.right&&a>=this.top&&a<=this.bottom};
f.prototype.equals=function(b){return this.left===b.left&&this.top===b.top&&this.right===b.right&&this.bottom===b.bottom};cr.rect=f;g.prototype.set_from_rect=function(b){this.tlx=b.left;this.tly=b.top;this.trx=b.right;this.try_=b.top;this.brx=b.right;this.bry=b.bottom;this.blx=b.left;this.bly=b.bottom};g.prototype.set_from_rotated_rect=function(b,a){if(0===a)this.set_from_rect(b);else{var h=Math.sin(a),c=Math.cos(a);a=b.left*h;var d=b.top*h,e=b.right*h;h*=b.bottom;var f=b.left*c,m=b.top*c,l=b.right*
c;b=b.bottom*c;this.tlx=f-d;this.tly=m+a;this.trx=l-d;this.try_=m+e;this.brx=l-h;this.bry=b+e;this.blx=f-h;this.bly=b+a}};g.prototype.offset=function(b,a){this.tlx+=b;this.tly+=a;this.trx+=b;this.try_+=a;this.brx+=b;this.bry+=a;this.blx+=b;this.bly+=a;return this};var u=0,y=0;g.prototype.bounding_box=function(b){k(this.tlx,this.trx,this.brx,this.blx);b.left=u;b.right=y;k(this.tly,this.try_,this.bry,this.bly);b.top=u;b.bottom=y};g.prototype.contains_pt=function(b,a){var h=this.tlx,c=this.tly,d=this.trx-
h,e=this.try_-c,f=this.brx-h,m=this.bry-c;b-=h;a-=c;var l=d*d+e*e,k=d*f+e*m;e=d*b+e*a;var g=f*f+m*m,t=f*b+m*a,r=1/(l*g-k*k);d=(g*e-k*t)*r;l=(l*t-k*e)*r;if(0<=d&&0<l&&1>d+l)return!0;d=this.blx-h;e=this.bly-c;l=d*d+e*e;k=d*f+e*m;e=d*b+e*a;r=1/(l*g-k*k);d=(g*e-k*t)*r;l=(l*t-k*e)*r;return 0<=d&&0<l&&1>d+l};g.prototype.at=function(b,a){if(a)switch(b){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(b){case 0:return this.tly;
case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};g.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};g.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4};g.prototype.intersects_segment=function(b,a,h,c){if(this.contains_pt(b,a)||this.contains_pt(h,c))return!0;var d;for(d=0;4>d;d++){var e=this.at(d,!0);var f=this.at(d,!1);var m=this.at(d+1,!0);var l=this.at(d+1,!1);if(cr.segments_intersect(b,
a,h,c,e,f,m,l))return!0}return!1};g.prototype.intersects_quad=function(b){var a=b.midX(),h=b.midY();if(this.contains_pt(a,h))return!0;a=this.midX();h=this.midY();if(b.contains_pt(a,h))return!0;var c,d;for(c=0;4>c;c++)for(d=0;4>d;d++){a=this.at(c,!0);h=this.at(c,!1);var e=this.at(c+1,!0);var f=this.at(c+1,!1);var m=b.at(d,!0);var l=b.at(d,!1);var k=b.at(d+1,!0);var g=b.at(d+1,!1);if(cr.segments_intersect(a,h,e,f,m,l,k,g))return!0}return!1};cr.quad=g;cr.RGB=function(b,a,h){return Math.max(Math.min(b,
255),0)|Math.max(Math.min(a,255),0)<<8|Math.max(Math.min(h,255),0)<<16};cr.GetRValue=function(b){return b&255};cr.GetGValue=function(b){return(b&65280)>>8};cr.GetBValue=function(b){return(b&16711680)>>16};cr.shallowCopy=function(b,a,h){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};cr.arrayRemove=function(b,a){var h;a=cr.floor(a);if(!(0>a||a>=b.length)){for(h=b.length-1;a<h;a++)b[a]=b[a+1];cr.truncateArray(b,h)}};cr.truncateArray=function(b,a){b.length=a};cr.clearArray=function(b){cr.truncateArray(b,
0)};cr.shallowAssignArray=function(b,a){cr.clearArray(b);var h;var c=0;for(h=a.length;c<h;++c)b[c]=a[c]};cr.appendArray=function(b,a){b.push.apply(b,a)};cr.fastIndexOf=function(b,a){var h;var c=0;for(h=b.length;c<h;++c)if(b[c]===a)return c;return-1};cr.arrayFindRemove=function(b,a){a=cr.fastIndexOf(b,a);-1!==a&&cr.arrayRemove(b,a)};cr.clamp=function(b,a,h){return b<a?a:b>h?h:b};cr.to_radians=function(b){return b/(180/cr.PI)};cr.to_degrees=function(b){return 180/cr.PI*b};cr.clamp_angle_degrees=function(b){b%=
360;0>b&&(b+=360);return b};cr.clamp_angle=function(b){b%=2*cr.PI;0>b&&(b+=2*cr.PI);return b};cr.to_clamped_degrees=function(b){return cr.clamp_angle_degrees(cr.to_degrees(b))};cr.to_clamped_radians=function(b){return cr.clamp_angle(cr.to_radians(b))};cr.angleTo=function(b,a,h,c){return Math.atan2(c-a,h-b)};cr.angleDiff=function(b,a){if(b===a)return 0;b=Math.sin(b)*Math.sin(a)+Math.cos(b)*Math.cos(a);return 1<=b?0:-1>=b?cr.PI:Math.acos(b)};cr.angleRotate=function(b,a,h){var c=Math.sin(b),d=Math.cos(b),
e=Math.sin(a),f=Math.cos(a);return Math.acos(c*e+d*f)>h?0<d*e-c*f?cr.clamp_angle(b+h):cr.clamp_angle(b-h):cr.clamp_angle(a)};cr.angleClockwise=function(b,a){return 0>=Math.cos(b)*Math.sin(a)-Math.sin(b)*Math.cos(a)};cr.rotatePtAround=function(b,a,h,c,d,e){if(0===h)return e?b:a;var f=Math.sin(h);h=Math.cos(h);b-=c;a-=d;var m=b*f;b=b*h-a*f;return e?b+c:a*h+m+d};cr.distanceTo=function(b,a,h,c){b=h-b;a=c-a;return Math.sqrt(b*b+a*a)};cr.xor=function(b,a){return!b!==!a};cr.lerp=function(b,a,h){return b+
(a-b)*h};cr.unlerp=function(b,a,h){return b===a?0:(h-b)/(a-b)};cr.anglelerp=function(b,a,h){var c=cr.angleDiff(b,a);return cr.angleClockwise(a,b)?b+c*h:b-c*h};cr.qarp=function(b,a,h,c){return cr.lerp(cr.lerp(b,a,c),cr.lerp(a,h,c),c)};cr.cubic=function(b,a,h,c,d){return cr.lerp(cr.qarp(b,a,h,d),cr.qarp(a,h,c,d),d)};cr.cosp=function(b,a,h){return(b+a+(b-a)*Math.cos(h*Math.PI))/2};cr.hasAnyOwnProperty=function(b){for(var a in b)if(b.hasOwnProperty(a))return!0;return!1};cr.wipe=function(b){for(var a in b)b.hasOwnProperty(a)&&
delete b[a]};var z=+new Date;cr.performance_now=function(){if("undefined"!==typeof window.performance){var b=window.performance;if("undefined"!==typeof b.now)return b.now();if("undefined"!==typeof b.webkitNow)return b.webkitNow();if("undefined"!==typeof b.mozNow)return b.mozNow();if("undefined"!==typeof b.msNow)return b.msNow()}return Date.now()-z};var x=!1,r=x=!1,A=!1;"undefined"!==typeof window&&(x=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),x=!x&&/safari/i.test(navigator.userAgent),
r=/(iphone|ipod|ipad)/i.test(navigator.userAgent),A=window.c2ejecta);var D=!x&&!A&&!r&&"undefined"!==typeof Set&&"undefined"!==typeof Set.prototype.forEach;e.prototype.contains=function(b){return this.isEmpty()?!1:D?this.s.has(b):this.items&&this.items.hasOwnProperty(b)};e.prototype.add=function(b){if(D)this.s.has(b)||(this.s.add(b),this.cache_valid=!1);else{var a=b.toString(),h=this.items;h?h.hasOwnProperty(a)||(h[a]=b,this.item_count++,this.cache_valid=!1):(this.items={},this.items[a]=b,this.item_count=
1,this.cache_valid=!1)}};e.prototype.remove=function(b){if(!this.isEmpty())if(D)this.s.has(b)&&(this.s["delete"](b),this.cache_valid=!1);else if(this.items){b=b.toString();var a=this.items;a.hasOwnProperty(b)&&(delete a[b],this.item_count--,this.cache_valid=!1)}};e.prototype.clear=function(){this.isEmpty()||(D?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),this.cache_valid=!0)};e.prototype.isEmpty=function(){return 0===this.count()};e.prototype.count=function(){return D?
this.s.size:this.item_count};var E=null,t=0;e.prototype.update_cache=function(){if(!this.cache_valid){if(D)cr.clearArray(this.values_cache),E=this.values_cache,t=0,this.s.forEach(c),E=null,t=0;else{var b=this.values_cache;cr.clearArray(b);var a,h=0,d=this.items;if(d)for(a in d)d.hasOwnProperty(a)&&(b[h++]=d[a])}this.cache_valid=!0}};e.prototype.valuesRef=function(){this.update_cache();return this.values_cache};cr.ObjectSet=e;var w=new cr.ObjectSet;cr.removeArrayDuplicates=function(b){var a;var h=
0;for(a=b.length;h<a;++h)w.add(b[h]);cr.shallowAssignArray(b,w.valuesRef());w.clear()};cr.arrayRemoveAllFromObjectSet=function(b,a){D?cr.arrayRemoveAll_set(b,a.s):cr.arrayRemoveAll_arr(b,a.valuesRef())};cr.arrayRemoveAll_set=function(b,a){var h,c;var d=h=0;for(c=b.length;h<c;++h){var e=b[h];a.has(e)||(b[d++]=e)}cr.truncateArray(b,d)};cr.arrayRemoveAll_arr=function(b,a){var h,c;var d=h=0;for(c=b.length;h<c;++h){var e=b[h];-1===cr.fastIndexOf(a,e)&&(b[d++]=e)}cr.truncateArray(b,d)};d.prototype.add=
function(b){this.y=b-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};d.prototype.reset=function(){this.sum=this.t=this.y=this.c=0};cr.KahanAdder=d;cr.regexp_escape=function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};b.prototype.set_pts=function(b){this.pts_array=b;this.pts_count=b.length/2;this.pts_cache.length=b.length;this.cache_height=this.cache_width=-1;this.cache_angle=0};b.prototype.is_empty=function(){return!this.pts_array.length};b.prototype.update_bbox=
function(){for(var b=this.pts_cache,a=b[0],h=a,c=b[1],d=c,e,f,m=1,l=this.pts_count;m<l;++m)f=2*m,e=b[f],f=b[f+1],e<a&&(a=e),e>h&&(h=e),f<c&&(c=f),f>d&&(d=f);this.bboxLeft=a;this.bboxRight=h;this.bboxTop=c;this.bboxBottom=d};b.prototype.set_from_rect=function(b,a,h){this.pts_cache.length=8;this.pts_count=4;var c=this.pts_cache;c[0]=b.left-a;c[1]=b.top-h;c[2]=b.right-a;c[3]=b.top-h;c[4]=b.right-a;c[5]=b.bottom-h;c[6]=b.left-a;c[7]=b.bottom-h;this.cache_width=b.right-b.left;this.cache_height=b.bottom-
b.top;this.update_bbox()};b.prototype.set_from_quad=function(b,a,h,c,d){this.pts_cache.length=8;this.pts_count=4;var e=this.pts_cache;e[0]=b.tlx-a;e[1]=b.tly-h;e[2]=b.trx-a;e[3]=b.try_-h;e[4]=b.brx-a;e[5]=b.bry-h;e[6]=b.blx-a;e[7]=b.bly-h;this.cache_width=c;this.cache_height=d;this.update_bbox()};b.prototype.set_from_poly=function(b){this.pts_count=b.pts_count;cr.shallowAssignArray(this.pts_cache,b.pts_cache);this.bboxLeft=b.bboxLeft;this.bboxTop=b.bboxTop;this.bboxRight=b.bboxRight;this.bboxBottom=
b.bboxBottom};b.prototype.cache_poly=function(b,a,h){if(this.cache_width!==b||this.cache_height!==a||this.cache_angle!==h){this.cache_width=b;this.cache_height=a;this.cache_angle=h;var c,d=0,e=1,f=this.pts_array,m=this.pts_cache;0!==h&&(d=Math.sin(h),e=Math.cos(h));h=0;for(c=this.pts_count;h<c;h++){var l=2*h;var k=l+1;var g=f[l]*b;var t=f[k]*a;m[l]=g*e-t*d;m[k]=t*e+g*d}this.update_bbox()}};b.prototype.contains_pt=function(b,a){var h=this.pts_cache;if(b===h[0]&&a===h[1])return!0;var c,d=this.pts_count,
e=this.bboxLeft-110,f=this.bboxTop-101,m=this.bboxRight+131,l=this.bboxBottom+120,k=0,g=0;for(c=0;c<d;c++){var t=2*c;var r=(c+1)%d*2;var w=h[t];t=h[t+1];var q=h[r];r=h[r+1];cr.segments_intersect(e,f,b,a,w,t,q,r)&&k++;cr.segments_intersect(m,l,b,a,w,t,q,r)&&g++}return 1===k%2||1===g%2};b.prototype.intersects_poly=function(b,a,h){var c=b.pts_cache,d=this.pts_cache;if(this.contains_pt(c[0]+a,c[1]+h)||b.contains_pt(d[0]-a,d[1]-h))return!0;var e,f;var m=0;for(e=this.pts_count;m<e;m++){var l=2*m;var k=
(m+1)%e*2;var g=d[l];l=d[l+1];var t=d[k];var r=d[k+1];k=0;for(f=b.pts_count;k<f;k++){var w=2*k;var q=(k+1)%f*2;var p=c[w]+a;w=c[w+1]+h;var x=c[q]+a;q=c[q+1]+h;if(cr.segments_intersect(g,l,t,r,p,w,x,q))return!0}}return!1};b.prototype.intersects_segment=function(b,a,h,c,d,e){var f=this.pts_cache;if(this.contains_pt(h-b,c-a))return!0;var m;var l=0;for(m=this.pts_count;l<m;l++){var k=2*l;var g=(l+1)%m*2;var t=f[k]+b;k=f[k+1]+a;var r=f[g]+b;g=f[g+1]+a;if(cr.segments_intersect(h,c,d,e,t,k,r,g))return!0}return!1};
b.prototype.mirror=function(b){var a;var h=0;for(a=this.pts_count;h<a;++h){var c=2*h;this.pts_cache[c]=2*b-this.pts_cache[c]}};b.prototype.flip=function(b){var a;var h=0;for(a=this.pts_count;h<a;++h){var c=2*h+1;this.pts_cache[c]=2*b-this.pts_cache[c]}};b.prototype.diag=function(){var b;var a=0;for(b=this.pts_count;a<b;++a){var h=2*a;var c=h+1;var d=this.pts_cache[h];this.pts_cache[h]=this.pts_cache[c];this.pts_cache[c]=d}};cr.CollisionPoly=b;l.prototype.totalCellCount=0;l.prototype.getCell=function(b,
a,h){var c=this.cells[b];return c?(c=c[a])?c:h?(c=q(this,b,a),this.cells[b][a]=c):null:h?(c=q(this,b,a),this.cells[b]={},this.cells[b][a]=c):null};l.prototype.XToCell=function(b){return cr.floor(b/this.cellwidth)};l.prototype.YToCell=function(b){return cr.floor(b/this.cellheight)};l.prototype.update=function(b,a,h){var c,d,e;if(a){var f=a.left;for(c=a.right;f<=c;++f){var m=a.top;for(d=a.bottom;m<=d;++m)if(!h||!h.contains_pt(f,m))if(e=this.getCell(f,m,!1))e.remove(b),e.isEmpty()&&(l.prototype.totalCellCount--,
e.objects.clear(),1E3>N.length&&N.push(e),this.cells[f][m]=null)}}if(h)for(f=h.left,c=h.right;f<=c;++f)for(m=h.top,d=h.bottom;m<=d;++m)a&&a.contains_pt(f,m)||this.getCell(f,m,!0).insert(b)};l.prototype.queryRange=function(b,a){var h,c;var d=this.XToCell(b.left);var e=this.YToCell(b.top);var f=this.XToCell(b.right);for(h=this.YToCell(b.bottom);d<=f;++d)for(b=e;b<=h;++b)(c=this.getCell(d,b,!1))&&c.dump(a)};cr.SparseGrid=l;n.prototype.totalCellCount=0;n.prototype.getCell=function(b,a,h){var c=this.cells[b];
return c?(c=c[a])?c:h?(c=m(this,b,a),this.cells[b][a]=c):null:h?(c=m(this,b,a),this.cells[b]={},this.cells[b][a]=c):null};n.prototype.XToCell=function(b){return cr.floor(b/this.cellwidth)};n.prototype.YToCell=function(b){return cr.floor(b/this.cellheight)};n.prototype.update=function(b,a,h){var c,d,e;if(a){var f=a.left;for(c=a.right;f<=c;++f){var m=a.top;for(d=a.bottom;m<=d;++m)if(!h||!h.contains_pt(f,m))if(e=this.getCell(f,m,!1))e.remove(b),e.isEmpty()&&(n.prototype.totalCellCount--,e.reset(),1E3>
P.length&&P.push(e),this.cells[f][m]=null)}}if(h)for(f=h.left,c=h.right;f<=c;++f)for(m=h.top,d=h.bottom;m<=d;++m)a&&a.contains_pt(f,m)||this.getCell(f,m,!0).insert(b)};n.prototype.queryRange=function(b,a,h,c,d){var e,f;b=this.XToCell(b);a=this.YToCell(a);h=this.XToCell(h);for(e=this.YToCell(c);b<=h;++b)for(c=a;c<=e;++c)(f=this.getCell(b,c,!1))&&f.dump(d)};n.prototype.markRangeChanged=function(b){var a,h;var c=b.left;var d=b.top;var e=b.right;for(a=b.bottom;c<=e;++c)for(b=d;b<=a;++b)if(h=this.getCell(c,
b,!1))h.is_sorted=!1};cr.RenderGrid=n;var N=[];h.prototype.isEmpty=function(){return this.objects.isEmpty()};h.prototype.insert=function(b){this.objects.add(b)};h.prototype.remove=function(b){this.objects.remove(b)};h.prototype.dump=function(b){cr.appendArray(b,this.objects.valuesRef())};cr.GridCell=h;var P=[];p.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;this.flush_pending();return!0};p.prototype.insert=function(b){this.pending_removal.contains(b)?
(this.pending_removal.remove(b),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>b.get_zindex()&&(this.is_sorted=!1),this.objects.push(b)):(this.objects.push(b),this.is_sorted=!0)};p.prototype.remove=function(b){this.pending_removal.add(b);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};p.prototype.flush_pending=function(){this.any_pending_removal&&(this.pending_removal.count()===
this.objects.length?this.reset():(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};p.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(v),this.is_sorted=!0)};p.prototype.reset=function(){cr.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};p.prototype.dump=function(b){this.flush_pending();this.ensure_sorted();this.objects.length&&b.push(this.objects)};
cr.RenderCell=p;var Q="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr.effectToCompositeOp=function(b){return 0>=b||11<=b?"source-over":Q[b-1]};cr.setGLBlend=function(b,a,h){if(h)switch(b.srcBlend=h.ONE,b.destBlend=h.ONE_MINUS_SRC_ALPHA,a){case 1:b.srcBlend=h.ONE;b.destBlend=h.ONE;break;case 3:b.srcBlend=h.ONE;b.destBlend=h.ZERO;break;case 4:b.srcBlend=h.ONE_MINUS_DST_ALPHA;b.destBlend=h.ONE;break;case 5:b.srcBlend=
h.DST_ALPHA;b.destBlend=h.ZERO;break;case 6:b.srcBlend=h.ZERO;b.destBlend=h.SRC_ALPHA;break;case 7:b.srcBlend=h.ONE_MINUS_DST_ALPHA;b.destBlend=h.ZERO;break;case 8:b.srcBlend=h.ZERO;b.destBlend=h.ONE_MINUS_SRC_ALPHA;break;case 9:b.srcBlend=h.DST_ALPHA;b.destBlend=h.ONE_MINUS_SRC_ALPHA;break;case 10:b.srcBlend=h.ONE_MINUS_DST_ALPHA,b.destBlend=h.SRC_ALPHA}};cr.round6dp=function(b){return Math.round(1E6*b)/1E6};cr.equals_nocase=function(b,a){return"string"!==typeof b||"string"!==typeof a||b.length!==
a.length?!1:b===a?!0:b.toLowerCase()===a.toLowerCase()};cr.isCanvasInputEvent=function(b){b=b.target;return!b||b===document||b===window||document&&document.body&&b===document.body||cr.equals_nocase(b.tagName,"canvas")?!0:!1}})();var MatrixArray="undefined"!==typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(a){var f=new MatrixArray(3);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2]);return f};
vec3.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];return f};vec3.add=function(a,f,g){if(!g||a===g)return a[0]+=f[0],a[1]+=f[1],a[2]+=f[2],a;g[0]=a[0]+f[0];g[1]=a[1]+f[1];g[2]=a[2]+f[2];return g};vec3.subtract=function(a,f,g){if(!g||a===g)return a[0]-=f[0],a[1]-=f[1],a[2]-=f[2],a;g[0]=a[0]-f[0];g[1]=a[1]-f[1];g[2]=a[2]-f[2];return g};vec3.negate=function(a,f){f||(f=a);f[0]=-a[0];f[1]=-a[1];f[2]=-a[2];return f};
vec3.scale=function(a,f,g){if(!g||a===g)return a[0]*=f,a[1]*=f,a[2]*=f,a;g[0]=a[0]*f;g[1]=a[1]*f;g[2]=a[2]*f;return g};vec3.normalize=function(a,f){f||(f=a);var g=a[0],k=a[1];a=a[2];var e=Math.sqrt(g*g+k*k+a*a);if(e){if(1===e)return f[0]=g,f[1]=k,f[2]=a,f}else return f[0]=0,f[1]=0,f[2]=0,f;e=1/e;f[0]=g*e;f[1]=k*e;f[2]=a*e;return f};vec3.cross=function(a,f,g){g||(g=a);var k=a[0],e=a[1];a=a[2];var c=f[0],d=f[1];f=f[2];g[0]=e*f-a*d;g[1]=a*c-k*f;g[2]=k*d-e*c;return g};
vec3.length=function(a){var f=a[0],g=a[1];a=a[2];return Math.sqrt(f*f+g*g+a*a)};vec3.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]};vec3.direction=function(a,f,g){g||(g=a);var k=a[0]-f[0],e=a[1]-f[1];a=a[2]-f[2];f=Math.sqrt(k*k+e*e+a*a);if(!f)return g[0]=0,g[1]=0,g[2]=0,g;f=1/f;g[0]=k*f;g[1]=e*f;g[2]=a*f;return g};vec3.lerp=function(a,f,g,k){k||(k=a);k[0]=a[0]+g*(f[0]-a[0]);k[1]=a[1]+g*(f[1]-a[1]);k[2]=a[2]+g*(f[2]-a[2]);return k};vec3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};
mat3.create=function(a){var f=new MatrixArray(9);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8]);return f};mat3.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];return f};mat3.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
mat3.transpose=function(a,f){if(!f||a===f){f=a[1];var g=a[2],k=a[5];a[1]=a[3];a[2]=a[6];a[3]=f;a[5]=a[7];a[6]=g;a[7]=k;return a}f[0]=a[0];f[1]=a[3];f[2]=a[6];f[3]=a[1];f[4]=a[4];f[5]=a[7];f[6]=a[2];f[7]=a[5];f[8]=a[8];return f};mat3.toMat4=function(a,f){f||(f=mat4.create());f[15]=1;f[14]=0;f[13]=0;f[12]=0;f[11]=0;f[10]=a[8];f[9]=a[7];f[8]=a[6];f[7]=0;f[6]=a[5];f[5]=a[4];f[4]=a[3];f[3]=0;f[2]=a[2];f[1]=a[1];f[0]=a[0];return f};
mat3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};mat4.create=function(a){var f=new MatrixArray(16);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8],f[9]=a[9],f[10]=a[10],f[11]=a[11],f[12]=a[12],f[13]=a[13],f[14]=a[14],f[15]=a[15]);return f};
mat4.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];f[9]=a[9];f[10]=a[10];f[11]=a[11];f[12]=a[12];f[13]=a[13];f[14]=a[14];f[15]=a[15];return f};mat4.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
mat4.transpose=function(a,f){if(!f||a===f){f=a[1];var g=a[2],k=a[3],e=a[6],c=a[7],d=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=f;a[6]=a[9];a[7]=a[13];a[8]=g;a[9]=e;a[11]=a[14];a[12]=k;a[13]=c;a[14]=d;return a}f[0]=a[0];f[1]=a[4];f[2]=a[8];f[3]=a[12];f[4]=a[1];f[5]=a[5];f[6]=a[9];f[7]=a[13];f[8]=a[2];f[9]=a[6];f[10]=a[10];f[11]=a[14];f[12]=a[3];f[13]=a[7];f[14]=a[11];f[15]=a[15];return f};
mat4.determinant=function(a){var f=a[0],g=a[1],k=a[2],e=a[3],c=a[4],d=a[5],b=a[6],l=a[7],n=a[8],q=a[9],h=a[10],m=a[11],p=a[12],v=a[13],u=a[14];a=a[15];return p*q*b*e-n*v*b*e-p*d*h*e+c*v*h*e+n*d*u*e-c*q*u*e-p*q*k*l+n*v*k*l+p*g*h*l-f*v*h*l-n*g*u*l+f*q*u*l+p*d*k*m-c*v*k*m-p*g*b*m+f*v*b*m+c*g*u*m-f*d*u*m-n*d*k*a+c*q*k*a+n*g*b*a-f*q*b*a-c*g*h*a+f*d*h*a};
mat4.inverse=function(a,f){f||(f=a);var g=a[0],k=a[1],e=a[2],c=a[3],d=a[4],b=a[5],l=a[6],n=a[7],q=a[8],h=a[9],m=a[10],p=a[11],v=a[12],u=a[13],y=a[14];a=a[15];var z=g*b-k*d,x=g*l-e*d,r=g*n-c*d,A=k*l-e*b,D=k*n-c*b,E=e*n-c*l,t=q*u-h*v,w=q*y-m*v,N=q*a-p*v,P=h*y-m*u,Q=h*a-p*u,B=m*a-p*y,I=1/(z*B-x*Q+r*P+A*N-D*w+E*t);f[0]=(b*B-l*Q+n*P)*I;f[1]=(-k*B+e*Q-c*P)*I;f[2]=(u*E-y*D+a*A)*I;f[3]=(-h*E+m*D-p*A)*I;f[4]=(-d*B+l*N-n*w)*I;f[5]=(g*B-e*N+c*w)*I;f[6]=(-v*E+y*r-a*x)*I;f[7]=(q*E-m*r+p*x)*I;f[8]=(d*Q-b*N+n*t)*
I;f[9]=(-g*Q+k*N-c*t)*I;f[10]=(v*D-u*r+a*z)*I;f[11]=(-q*D+h*r-p*z)*I;f[12]=(-d*P+b*w-l*t)*I;f[13]=(g*P-k*w+e*t)*I;f[14]=(-v*A+u*x-y*z)*I;f[15]=(q*A-h*x+m*z)*I;return f};mat4.toRotationMat=function(a,f){f||(f=mat4.create());f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];f[9]=a[9];f[10]=a[10];f[11]=a[11];f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};
mat4.toMat3=function(a,f){f||(f=mat3.create());f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[4];f[4]=a[5];f[5]=a[6];f[6]=a[8];f[7]=a[9];f[8]=a[10];return f};mat4.toInverseMat3=function(a,f){var g=a[0],k=a[1],e=a[2],c=a[4],d=a[5],b=a[6],l=a[8],n=a[9];a=a[10];var q=a*d-b*n,h=-a*c+b*l,m=n*c-d*l,p=g*q+k*h+e*m;if(!p)return null;p=1/p;f||(f=mat3.create());f[0]=q*p;f[1]=(-a*k+e*n)*p;f[2]=(b*k-e*d)*p;f[3]=h*p;f[4]=(a*g-e*l)*p;f[5]=(-b*g+e*c)*p;f[6]=m*p;f[7]=(-n*g+k*l)*p;f[8]=(d*g-k*c)*p;return f};
mat4.multiply=function(a,f,g){g||(g=a);var k=a[0],e=a[1],c=a[2],d=a[3],b=a[4],l=a[5],n=a[6],q=a[7],h=a[8],m=a[9],p=a[10],v=a[11],u=a[12],y=a[13],z=a[14];a=a[15];var x=f[0],r=f[1],A=f[2],D=f[3],E=f[4],t=f[5],w=f[6],N=f[7],P=f[8],Q=f[9],B=f[10],I=f[11],H=f[12],L=f[13],O=f[14];f=f[15];g[0]=x*k+r*b+A*h+D*u;g[1]=x*e+r*l+A*m+D*y;g[2]=x*c+r*n+A*p+D*z;g[3]=x*d+r*q+A*v+D*a;g[4]=E*k+t*b+w*h+N*u;g[5]=E*e+t*l+w*m+N*y;g[6]=E*c+t*n+w*p+N*z;g[7]=E*d+t*q+w*v+N*a;g[8]=P*k+Q*b+B*h+I*u;g[9]=P*e+Q*l+B*m+I*y;g[10]=P*
c+Q*n+B*p+I*z;g[11]=P*d+Q*q+B*v+I*a;g[12]=H*k+L*b+O*h+f*u;g[13]=H*e+L*l+O*m+f*y;g[14]=H*c+L*n+O*p+f*z;g[15]=H*d+L*q+O*v+f*a;return g};mat4.multiplyVec3=function(a,f,g){g||(g=f);var k=f[0],e=f[1];f=f[2];g[0]=a[0]*k+a[4]*e+a[8]*f+a[12];g[1]=a[1]*k+a[5]*e+a[9]*f+a[13];g[2]=a[2]*k+a[6]*e+a[10]*f+a[14];return g};
mat4.multiplyVec4=function(a,f,g){g||(g=f);var k=f[0],e=f[1],c=f[2];f=f[3];g[0]=a[0]*k+a[4]*e+a[8]*c+a[12]*f;g[1]=a[1]*k+a[5]*e+a[9]*c+a[13]*f;g[2]=a[2]*k+a[6]*e+a[10]*c+a[14]*f;g[3]=a[3]*k+a[7]*e+a[11]*c+a[15]*f;return g};
mat4.translate=function(a,f,g){var k=f[0],e=f[1];f=f[2];if(!g||a===g)return a[12]=a[0]*k+a[4]*e+a[8]*f+a[12],a[13]=a[1]*k+a[5]*e+a[9]*f+a[13],a[14]=a[2]*k+a[6]*e+a[10]*f+a[14],a[15]=a[3]*k+a[7]*e+a[11]*f+a[15],a;var c=a[0];var d=a[1];var b=a[2];var l=a[3];var n=a[4];var q=a[5];var h=a[6];var m=a[7];var p=a[8];var v=a[9];var u=a[10];var y=a[11];g[0]=c;g[1]=d;g[2]=b;g[3]=l;g[4]=n;g[5]=q;g[6]=h;g[7]=m;g[8]=p;g[9]=v;g[10]=u;g[11]=y;g[12]=c*k+n*e+p*f+a[12];g[13]=d*k+q*e+v*f+a[13];g[14]=b*k+h*e+u*f+a[14];
g[15]=l*k+m*e+y*f+a[15];return g};mat4.scale=function(a,f,g){var k=f[0],e=f[1];f=f[2];if(!g||a===g)return a[0]*=k,a[1]*=k,a[2]*=k,a[3]*=k,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=f,a[9]*=f,a[10]*=f,a[11]*=f,a;g[0]=a[0]*k;g[1]=a[1]*k;g[2]=a[2]*k;g[3]=a[3]*k;g[4]=a[4]*e;g[5]=a[5]*e;g[6]=a[6]*e;g[7]=a[7]*e;g[8]=a[8]*f;g[9]=a[9]*f;g[10]=a[10]*f;g[11]=a[11]*f;g[12]=a[12];g[13]=a[13];g[14]=a[14];g[15]=a[15];return g};
mat4.rotate=function(a,f,g,k){var e=g[0],c=g[1];g=g[2];var d=Math.sqrt(e*e+c*c+g*g);if(!d)return null;1!==d&&(d=1/d,e*=d,c*=d,g*=d);var b=Math.sin(f);var l=Math.cos(f);var n=1-l;f=a[0];d=a[1];var q=a[2];var h=a[3];var m=a[4];var p=a[5];var v=a[6];var u=a[7];var y=a[8];var z=a[9];var x=a[10];var r=a[11];var A=e*e*n+l;var D=c*e*n+g*b;var E=g*e*n-c*b;var t=e*c*n-g*b;var w=c*c*n+l;var N=g*c*n+e*b;var P=e*g*n+c*b;e=c*g*n-e*b;c=g*g*n+l;k?a!==k&&(k[12]=a[12],k[13]=a[13],k[14]=a[14],k[15]=a[15]):k=a;k[0]=
f*A+m*D+y*E;k[1]=d*A+p*D+z*E;k[2]=q*A+v*D+x*E;k[3]=h*A+u*D+r*E;k[4]=f*t+m*w+y*N;k[5]=d*t+p*w+z*N;k[6]=q*t+v*w+x*N;k[7]=h*t+u*w+r*N;k[8]=f*P+m*e+y*c;k[9]=d*P+p*e+z*c;k[10]=q*P+v*e+x*c;k[11]=h*P+u*e+r*c;return k};
mat4.rotateX=function(a,f,g){var k=Math.sin(f);f=Math.cos(f);var e=a[4],c=a[5],d=a[6],b=a[7],l=a[8],n=a[9],q=a[10],h=a[11];g?a!==g&&(g[0]=a[0],g[1]=a[1],g[2]=a[2],g[3]=a[3],g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]):g=a;g[4]=e*f+l*k;g[5]=c*f+n*k;g[6]=d*f+q*k;g[7]=b*f+h*k;g[8]=e*-k+l*f;g[9]=c*-k+n*f;g[10]=d*-k+q*f;g[11]=b*-k+h*f;return g};
mat4.rotateY=function(a,f,g){var k=Math.sin(f);f=Math.cos(f);var e=a[0],c=a[1],d=a[2],b=a[3],l=a[8],n=a[9],q=a[10],h=a[11];g?a!==g&&(g[4]=a[4],g[5]=a[5],g[6]=a[6],g[7]=a[7],g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]):g=a;g[0]=e*f+l*-k;g[1]=c*f+n*-k;g[2]=d*f+q*-k;g[3]=b*f+h*-k;g[8]=e*k+l*f;g[9]=c*k+n*f;g[10]=d*k+q*f;g[11]=b*k+h*f;return g};
mat4.rotateZ=function(a,f,g){var k=Math.sin(f);f=Math.cos(f);var e=a[0],c=a[1],d=a[2],b=a[3],l=a[4],n=a[5],q=a[6],h=a[7];g?a!==g&&(g[8]=a[8],g[9]=a[9],g[10]=a[10],g[11]=a[11],g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]):g=a;g[0]=e*f+l*k;g[1]=c*f+n*k;g[2]=d*f+q*k;g[3]=b*f+h*k;g[4]=e*-k+l*f;g[5]=c*-k+n*f;g[6]=d*-k+q*f;g[7]=b*-k+h*f;return g};
mat4.frustum=function(a,f,g,k,e,c,d){d||(d=mat4.create());var b=f-a,l=k-g,n=c-e;d[0]=2*e/b;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=2*e/l;d[6]=0;d[7]=0;d[8]=(f+a)/b;d[9]=(k+g)/l;d[10]=-(c+e)/n;d[11]=-1;d[12]=0;d[13]=0;d[14]=-(c*e*2)/n;d[15]=0;return d};mat4.perspective=function(a,f,g,k,e){a=g*Math.tan(a*Math.PI/360);f*=a;return mat4.frustum(-f,f,-a,a,g,k,e)};
mat4.ortho=function(a,f,g,k,e,c,d){d||(d=mat4.create());var b=f-a,l=k-g,n=c-e;d[0]=2/b;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=2/l;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=-2/n;d[11]=0;d[12]=-(a+f)/b;d[13]=-(k+g)/l;d[14]=-(c+e)/n;d[15]=1;return d};
mat4.lookAt=function(a,f,g,k){k||(k=mat4.create());var e=a[0],c=a[1];a=a[2];var d=g[0];var b=g[1];var l=g[2];g=f[1];var n=f[2];if(e===f[0]&&c===g&&a===n)return mat4.identity(k);g=e-f[0];n=c-f[1];var q=a-f[2];var h=1/Math.sqrt(g*g+n*n+q*q);g*=h;n*=h;q*=h;f=b*q-l*n;l=l*g-d*q;d=d*n-b*g;(h=Math.sqrt(f*f+l*l+d*d))?(h=1/h,f*=h,l*=h,d*=h):d=l=f=0;b=n*d-q*l;var m=q*f-g*d;var p=g*l-n*f;(h=Math.sqrt(b*b+m*m+p*p))?(h=1/h,b*=h,m*=h,p*=h):p=m=b=0;k[0]=f;k[1]=b;k[2]=g;k[3]=0;k[4]=l;k[5]=m;k[6]=n;k[7]=0;k[8]=d;
k[9]=p;k[10]=q;k[11]=0;k[12]=-(f*e+l*c+d*a);k[13]=-(b*e+m*c+p*a);k[14]=-(g*e+n*c+q*a);k[15]=1;return k};mat4.fromRotationTranslation=function(a,f,g){g||(g=mat4.create());var k=a[0],e=a[1],c=a[2],d=a[3],b=k+k,l=e+e,n=c+c;a=k*b;var q=k*l;k*=n;var h=e*l;e*=n;c*=n;b*=d;l*=d;d*=n;g[0]=1-(h+c);g[1]=q+d;g[2]=k-l;g[3]=0;g[4]=q-d;g[5]=1-(a+c);g[6]=e+b;g[7]=0;g[8]=k+l;g[9]=e-b;g[10]=1-(a+h);g[11]=0;g[12]=f[0];g[13]=f[1];g[14]=f[2];g[15]=1;return g};
mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};quat4.create=function(a){var f=new MatrixArray(4);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3]);return f};quat4.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];return f};
quat4.calculateW=function(a,f){var g=a[0],k=a[1],e=a[2];if(!f||a===f)return a[3]=-Math.sqrt(Math.abs(1-g*g-k*k-e*e)),a;f[0]=g;f[1]=k;f[2]=e;f[3]=-Math.sqrt(Math.abs(1-g*g-k*k-e*e));return f};quat4.inverse=function(a,f){if(!f||a===f)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;f[0]=-a[0];f[1]=-a[1];f[2]=-a[2];f[3]=a[3];return f};quat4.length=function(a){var f=a[0],g=a[1],k=a[2];a=a[3];return Math.sqrt(f*f+g*g+k*k+a*a)};
quat4.normalize=function(a,f){f||(f=a);var g=a[0],k=a[1],e=a[2];a=a[3];var c=Math.sqrt(g*g+k*k+e*e+a*a);if(0===c)return f[0]=0,f[1]=0,f[2]=0,f[3]=0,f;c=1/c;f[0]=g*c;f[1]=k*c;f[2]=e*c;f[3]=a*c;return f};quat4.multiply=function(a,f,g){g||(g=a);var k=a[0],e=a[1],c=a[2];a=a[3];var d=f[0],b=f[1],l=f[2];f=f[3];g[0]=k*f+a*d+e*l-c*b;g[1]=e*f+a*b+c*d-k*l;g[2]=c*f+a*l+k*b-e*d;g[3]=a*f-k*d-e*b-c*l;return g};
quat4.multiplyVec3=function(a,f,g){g||(g=f);var k=f[0],e=f[1],c=f[2];f=a[0];var d=a[1],b=a[2];a=a[3];var l=a*k+d*c-b*e,n=a*e+b*k-f*c,q=a*c+f*e-d*k;k=-f*k-d*e-b*c;g[0]=l*a+k*-f+n*-b-q*-d;g[1]=n*a+k*-d+q*-f-l*-b;g[2]=q*a+k*-b+l*-d-n*-f;return g};quat4.toMat3=function(a,f){f||(f=mat3.create());var g=a[0],k=a[1],e=a[2];a=a[3];var c=g+g,d=k+k,b=e+e,l=g*c,n=g*d;g*=b;var q=k*d;k*=b;e*=b;c*=a;d*=a;a*=b;f[0]=1-(q+e);f[1]=n+a;f[2]=g-d;f[3]=n-a;f[4]=1-(l+e);f[5]=k+c;f[6]=g+d;f[7]=k-c;f[8]=1-(l+q);return f};
quat4.toMat4=function(a,f){f||(f=mat4.create());var g=a[0],k=a[1],e=a[2];a=a[3];var c=g+g,d=k+k,b=e+e,l=g*c,n=g*d;g*=b;var q=k*d;k*=b;e*=b;c*=a;d*=a;a*=b;f[0]=1-(q+e);f[1]=n+a;f[2]=g-d;f[3]=0;f[4]=n-a;f[5]=1-(l+e);f[6]=k+c;f[7]=0;f[8]=g+d;f[9]=k-c;f[10]=1-(l+q);f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};
quat4.slerp=function(a,f,g,k){k||(k=a);var e=a[0]*f[0]+a[1]*f[1]+a[2]*f[2]+a[3]*f[3];if(1<=Math.abs(e))return k!==a&&(k[0]=a[0],k[1]=a[1],k[2]=a[2],k[3]=a[3]),k;var c=Math.acos(e);var d=Math.sqrt(1-e*e);if(.001>Math.abs(d))return k[0]=.5*a[0]+.5*f[0],k[1]=.5*a[1]+.5*f[1],k[2]=.5*a[2]+.5*f[2],k[3]=.5*a[3]+.5*f[3],k;e=Math.sin((1-g)*c)/d;g=Math.sin(g*c)/d;k[0]=a[0]*e+f[0]*g;k[1]=a[1]*e+f[1]*g;k[2]=a[2]*e+f[2]*g;k[3]=a[3]*e+f[3]*g;return k};
quat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};
(function(){function a(b,a,c){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent);this.height=this.width=0;this.enableFrontToBack=!!c;this.isBatchInEarlyZPass=this.isEarlyZPass=!1;this.currentZ=0;this.zNear=1;this.zFar=1E3;this.zIncrement=(this.zFar-this.zNear)/32768;this.zA=this.zFar/(this.zFar-this.zNear);this.zB=this.zFar*this.zNear/(this.zNear-this.zFar);this.kzA=65536*this.zA;this.kzB=65536*this.zB;this.cam=vec3.create([0,0,100]);this.look=vec3.create([0,0,0]);this.up=
vec3.create([0,1,0]);this.worldScale=vec3.create([1,1,1]);this.enable_mipmaps=!0;this.matP=mat4.create();this.matMV=mat4.create();this.lastMV=mat4.create();this.currentMV=mat4.create();this.gl=b;this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1;this.initState()}function f(b,a,c){this.gl=b;this.shaderProgram=a;this.name=c;this.locAPos=b.getAttribLocation(a,"aPos");this.locATex=b.getAttribLocation(a,"aTex");this.locMatP=b.getUniformLocation(a,"matP");this.locMatMV=b.getUniformLocation(a,
"matMV");this.locOpacity=b.getUniformLocation(a,"opacity");this.locColorFill=b.getUniformLocation(a,"colorFill");this.locSamplerFront=b.getUniformLocation(a,"samplerFront");this.locSamplerBack=b.getUniformLocation(a,"samplerBack");this.locDestStart=b.getUniformLocation(a,"destStart");this.locDestEnd=b.getUniformLocation(a,"destEnd");this.locSeconds=b.getUniformLocation(a,"seconds");this.locPixelWidth=b.getUniformLocation(a,"pixelWidth");this.locPixelHeight=b.getUniformLocation(a,"pixelHeight");this.locLayerScale=
b.getUniformLocation(a,"layerScale");this.locLayerAngle=b.getUniformLocation(a,"layerAngle");this.locViewOrigin=b.getUniformLocation(a,"viewOrigin");this.locScrollPos=b.getUniformLocation(a,"scrollPos");this.hasAnyOptionalUniforms=!!(this.locPixelWidth||this.locPixelHeight||this.locSeconds||this.locSamplerBack||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle||this.locViewOrigin||this.locScrollPos);this.lpPixelHeight=this.lpPixelWidth=-999;this.lpOpacity=1;this.lpDestStartY=
this.lpDestStartX=0;this.lpLayerScale=this.lpDestEndY=this.lpDestEndX=1;this.lpSeconds=this.lpScrollPosY=this.lpScrollPosX=this.lpViewOriginY=this.lpViewOriginX=this.lpLayerAngle=0;this.lastCustomParams=[];this.lpMatMV=mat4.create();this.locOpacity&&b.uniform1f(this.locOpacity,1);this.locColorFill&&b.uniform4f(this.locColorFill,1,1,1,1);this.locSamplerFront&&b.uniform1i(this.locSamplerFront,0);this.locSamplerBack&&b.uniform1i(this.locSamplerBack,1);this.locDestStart&&b.uniform2f(this.locDestStart,
0,0);this.locDestEnd&&b.uniform2f(this.locDestEnd,1,1);this.locLayerScale&&b.uniform1f(this.locLayerScale,1);this.locLayerAngle&&b.uniform1f(this.locLayerAngle,0);this.locViewOrigin&&b.uniform2f(this.locViewOrigin,0,0);this.locScrollPos&&b.uniform2f(this.locScrollPos,0,0);this.locSeconds&&b.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function g(b,a){return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===a[8]&&b[9]===a[9]&&b[10]===
a[10]&&b[11]===a[11]&&b[12]===a[12]&&b[13]===a[13]&&b[14]===a[14]&&b[15]===a[15]}function k(b,a){this.type=b;this.glwrap=a;this.gl=a.gl;this.indexCount=this.startIndex=this.opacityParam=0;this.mat4param=this.texParam=null;this.shaderParams=[];cr.seal(this)}var e=mat4.create();a.prototype.initState=function(){var b=this.gl,a;this.lastOpacity=1;this.lastTexture1=this.lastTexture0=null;this.currentOpacity=1;b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);b.enable(b.BLEND);b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);
b.disable(b.CULL_FACE);b.disable(b.STENCIL_TEST);b.disable(b.DITHER);this.enableFrontToBack?(b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL)):b.disable(b.DEPTH_TEST);this.maxTextureSize=b.getParameter(b.MAX_TEXTURE_SIZE);this.lastSrcBlend=b.ONE;this.lastDestBlend=b.ONE_MINUS_SRC_ALPHA;this.vertexData=new Float32Array(8E3*(this.enableFrontToBack?3:2));this.texcoordData=new Float32Array(16E3);this.pointData=new Float32Array(32E3);this.pointBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.pointBuffer);
b.bufferData(b.ARRAY_BUFFER,this.pointData.byteLength,b.DYNAMIC_DRAW);this.vertexBuffers=Array(4);this.texcoordBuffers=Array(4);for(a=0;4>a;a++)this.vertexBuffers[a]=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffers[a]),b.bufferData(b.ARRAY_BUFFER,this.vertexData.byteLength,b.DYNAMIC_DRAW),this.texcoordBuffers[a]=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this.texcoordBuffers[a]),b.bufferData(b.ARRAY_BUFFER,this.texcoordData.byteLength,b.DYNAMIC_DRAW);this.curBuffer=0;this.indexBuffer=
b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var c=new Uint16Array(12E3),d=a=0;12E3>a;)c[a++]=d,c[a++]=d+1,c[a++]=d+2,c[a++]=d,c[a++]=d+2,c[a++]=d+3,d+=4;b.bufferData(b.ELEMENT_ARRAY_BUFFER,c,b.STATIC_DRAW);this.pointPtr=this.texPtr=this.vertexPtr=0;this.shaderPrograms=[];a=this.enableFrontToBack?"attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}":
"attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";c=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}"},a,"<default>");this.shaderPrograms.push(c);
c=this.createShaderProgram({src:"uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}"},"attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}","<point>");this.shaderPrograms.push(c);c=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}"},
a,"<earlyz>");this.shaderPrograms.push(c);c=this.createShaderProgram({src:"uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}"},a,"<fill>");this.shaderPrograms.push(c);for(var h in cr.shaders)cr.shaders.hasOwnProperty(h)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[h],a,h));b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,null);this.batch=[];this.batchPtr=0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.currentProgram=this.lastProgram=-1;this.currentShader=
null;this.fbo=b.createFramebuffer();this.depthBuffer=this.renderToTex=null;this.attachedDepthBuffer=!1;this.enableFrontToBack&&(this.depthBuffer=b.createRenderbuffer());this.tmpVec3=vec3.create([0,0,0]);b=b.getParameter(b.ALIASED_POINT_SIZE_RANGE);this.minPointSize=b[0];this.maxPointSize=b[1];2048<this.maxPointSize&&(this.maxPointSize=2048);this.switchProgram(0);cr.seal(this)};f.prototype.updateMatMV=function(b){g(this.lpMatMV,b)||(mat4.set(b,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,
b))};a.prototype.createShaderProgram=function(b,a,c){var d=this.gl,h=d.createShader(d.FRAGMENT_SHADER);d.shaderSource(h,b.src);d.compileShader(h);if(!d.getShaderParameter(h,d.COMPILE_STATUS))throw b=d.getShaderInfoLog(h),d.deleteShader(h),Error("error compiling fragment shader: "+b);var e=d.createShader(d.VERTEX_SHADER);d.shaderSource(e,a);d.compileShader(e);if(!d.getShaderParameter(e,d.COMPILE_STATUS))throw b=d.getShaderInfoLog(e),d.deleteShader(h),d.deleteShader(e),Error("error compiling vertex shader: "+
b);a=d.createProgram();d.attachShader(a,h);d.attachShader(a,e);d.linkProgram(a);if(!d.getProgramParameter(a,d.LINK_STATUS))throw b=d.getProgramInfoLog(a),d.deleteShader(h),d.deleteShader(e),d.deleteProgram(a),Error("error linking shader program: "+b);d.useProgram(a);d.deleteShader(h);d.deleteShader(e);h=new f(d,a,c);h.extendBoxHorizontal=b.extendBoxHorizontal||0;h.extendBoxVertical=b.extendBoxVertical||0;h.crossSampling=!!b.crossSampling;h.preservesOpaqueness=!!b.preservesOpaqueness;h.animated=!!b.animated;
h.parameters=b.parameters||[];b=0;for(e=h.parameters.length;b<e;b++)h.parameters[b][1]=d.getUniformLocation(a,h.parameters[b][0]),h.lastCustomParams.push(0),d.uniform1f(h.parameters[b][1],0);cr.seal(h);return h};a.prototype.getShaderIndex=function(b){var a;var c=0;for(a=this.shaderPrograms.length;c<a;c++)if(this.shaderPrograms[c].name===b)return c;return-1};a.prototype.project=function(b,a,c){var d=this.matMV,h=this.matP,e=[0,0,0,0,0,0,0,0];e[0]=d[0]*b+d[4]*a+d[12];e[1]=d[1]*b+d[5]*a+d[13];e[2]=d[2]*
b+d[6]*a+d[14];e[3]=d[3]*b+d[7]*a+d[15];e[4]=h[0]*e[0]+h[4]*e[1]+h[8]*e[2]+h[12]*e[3];e[5]=h[1]*e[0]+h[5]*e[1]+h[9]*e[2]+h[13]*e[3];e[6]=h[2]*e[0]+h[6]*e[1]+h[10]*e[2]+h[14]*e[3];e[7]=-e[2];0!==e[7]&&(e[7]=1/e[7],e[4]*=e[7],e[5]*=e[7],e[6]*=e[7],c[0]=(.5*e[4]+.5)*this.width,c[1]=(.5*e[5]+.5)*this.height)};a.prototype.setSize=function(b,a,c){if(this.width!==b||this.height!==a||c){this.endBatch();c=this.gl;this.width=b;this.height=a;c.viewport(0,0,b,a);mat4.lookAt(this.cam,this.look,this.up,this.matMV);
this.enableFrontToBack?(mat4.ortho(-b/2,b/2,a/2,-a/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1):(mat4.perspective(45,b/a,this.zNear,this.zFar,this.matP),b=[0,0],a=[0,0],this.project(0,0,b),this.project(1,1,a),this.worldScale[0]=1/(a[0]-b[0]),this.worldScale[1]=-1/(a[1]-b[1]));b=0;for(a=this.shaderPrograms.length;b<a;b++){var d=this.shaderPrograms[b];d.hasCurrentMatMV=!1;d.locMatP&&(c.useProgram(d.shaderProgram),c.uniformMatrix4fv(d.locMatP,!1,this.matP))}c.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram);
c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE0);this.lastTexture1=this.lastTexture0=null;this.depthBuffer&&(c.bindFramebuffer(c.FRAMEBUFFER,this.fbo),c.bindRenderbuffer(c.RENDERBUFFER,this.depthBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=
!0),c.bindRenderbuffer(c.RENDERBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,null),this.renderToTex=null)}};a.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV);mat4.scale(this.matMV,this.worldScale)};a.prototype.translate=function(b,a){if(0!==b||0!==a)this.tmpVec3[0]=b,this.tmpVec3[1]=a,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3)};a.prototype.scale=function(b,a){if(1!==b||1!==a)this.tmpVec3[0]=b,this.tmpVec3[1]=a,this.tmpVec3[2]=1,mat4.scale(this.matMV,
this.tmpVec3)};a.prototype.rotateZ=function(b){0!==b&&mat4.rotateZ(this.matMV,b)};a.prototype.updateModelView=function(){if(!g(this.lastMV,this.matMV)){var b=this.pushBatch();b.type=5;b.mat4param?mat4.set(this.matMV,b.mat4param):b.mat4param=mat4.create(this.matMV);mat4.set(this.matMV,this.lastMV);this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setEarlyZIndex=function(b){this.enableFrontToBack&&(32760<b&&(b=32760),this.currentZ=this.cam[2]-this.zNear-b*this.zIncrement)};k.prototype.doSetEarlyZPass=
function(){var b=this.gl,a=this.glwrap;0!==this.startIndex?(b.depthMask(!0),b.colorMask(!1,!1,!1,!1),b.disable(b.BLEND),b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),b.clear(b.DEPTH_BUFFER_BIT),b.bindFramebuffer(b.FRAMEBUFFER,null),a.isBatchInEarlyZPass=!0):(b.depthMask(!1),b.colorMask(!0,!0,!0,!0),b.enable(b.BLEND),a.isBatchInEarlyZPass=!1)};k.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)};
k.prototype.doSetTexture1=function(){var b=this.gl;b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,this.texParam);b.activeTexture(b.TEXTURE0)};k.prototype.doSetOpacity=function(){var b=this.opacityParam,a=this.glwrap;a.currentOpacity=b;a=a.currentShader;a.locOpacity&&a.lpOpacity!==b&&(a.lpOpacity=b,this.gl.uniform1f(a.locOpacity,b))};k.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)};k.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,
this.indexCount)};k.prototype.doUpdateModelView=function(){var b,a=this.glwrap.shaderPrograms,c=this.glwrap.currentProgram;var d=0;for(b=a.length;d<b;d++){var h=a[d];d===c&&h.locMatMV?(h.updateMatMV(this.mat4param),h.hasCurrentMatMV=!0):h.hasCurrentMatMV=!1}mat4.set(this.mat4param,this.glwrap.currentMV)};k.prototype.doRenderToTexture=function(){var b=this.gl,a=this.glwrap;this.texParam?(a.lastTexture1===this.texParam&&(b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,null),a.lastTexture1=null,
b.activeTexture(b.TEXTURE0)),b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),a.isBatchInEarlyZPass||b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this.texParam,0)):(a.enableFrontToBack||b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),b.bindFramebuffer(b.FRAMEBUFFER,null))};k.prototype.doClear=function(){var b=this.gl,a=this.startIndex;0===a?(b.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),b.clear(b.COLOR_BUFFER_BIT)):
1===a?(b.enable(b.SCISSOR_TEST),b.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),b.disable(b.SCISSOR_TEST)):b.clear(b.DEPTH_BUFFER_BIT)};k.prototype.doSetDepthTestEnabled=function(){var b=this.gl;0!==this.startIndex?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST)};k.prototype.doPoints=function(){var b=this.gl,a=this.glwrap;a.enableFrontToBack&&b.disable(b.DEPTH_TEST);var c=a.shaderPrograms[1];b.useProgram(c.shaderProgram);
!c.hasCurrentMatMV&&c.locMatMV&&(c.updateMatMV(a.currentMV),c.hasCurrentMatMV=!0);b.enableVertexAttribArray(c.locAPos);b.bindBuffer(b.ARRAY_BUFFER,a.pointBuffer);b.vertexAttribPointer(c.locAPos,4,b.FLOAT,!1,0,0);b.drawArrays(b.POINTS,this.startIndex/4,this.indexCount);c=a.currentShader;b.useProgram(c.shaderProgram);0<=c.locAPos&&(b.enableVertexAttribArray(c.locAPos),b.bindBuffer(b.ARRAY_BUFFER,a.vertexBuffers[a.curBuffer]),b.vertexAttribPointer(c.locAPos,a.enableFrontToBack?3:2,b.FLOAT,!1,0,0));0<=
c.locATex&&(b.enableVertexAttribArray(c.locATex),b.bindBuffer(b.ARRAY_BUFFER,a.texcoordBuffers[a.curBuffer]),b.vertexAttribPointer(c.locATex,2,b.FLOAT,!1,0,0));a.enableFrontToBack&&b.enable(b.DEPTH_TEST)};k.prototype.doSetProgram=function(){var b=this.gl,a=this.glwrap,c=a.shaderPrograms[this.startIndex];a.currentProgram=this.startIndex;a.currentShader=c;b.useProgram(c.shaderProgram);!c.hasCurrentMatMV&&c.locMatMV&&(c.updateMatMV(a.currentMV),c.hasCurrentMatMV=!0);c.locOpacity&&c.lpOpacity!==a.currentOpacity&&
(c.lpOpacity=a.currentOpacity,b.uniform1f(c.locOpacity,a.currentOpacity));0<=c.locAPos&&(b.enableVertexAttribArray(c.locAPos),b.bindBuffer(b.ARRAY_BUFFER,a.vertexBuffers[a.curBuffer]),b.vertexAttribPointer(c.locAPos,a.enableFrontToBack?3:2,b.FLOAT,!1,0,0));0<=c.locATex&&(b.enableVertexAttribArray(c.locATex),b.bindBuffer(b.ARRAY_BUFFER,a.texcoordBuffers[a.curBuffer]),b.vertexAttribPointer(c.locATex,2,b.FLOAT,!1,0,0))};k.prototype.doSetColor=function(){var b=this.mat4param;this.gl.uniform4f(this.glwrap.currentShader.locColorFill,
b[0],b[1],b[2],b[3])};k.prototype.doSetProgramParameters=function(){var b=this.glwrap.currentShader,a=this.gl;var c=this.mat4param;b.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,a.activeTexture(a.TEXTURE0));var d=c[0];b.locPixelWidth&&d!==b.lpPixelWidth&&(b.lpPixelWidth=d,a.uniform1f(b.locPixelWidth,d));d=c[1];b.locPixelHeight&&d!==b.lpPixelHeight&&(b.lpPixelHeight=d,a.uniform1f(b.locPixelHeight,
d));d=c[2];var h=c[3];!b.locDestStart||d===b.lpDestStartX&&h===b.lpDestStartY||(b.lpDestStartX=d,b.lpDestStartY=h,a.uniform2f(b.locDestStart,d,h));d=c[4];h=c[5];!b.locDestEnd||d===b.lpDestEndX&&h===b.lpDestEndY||(b.lpDestEndX=d,b.lpDestEndY=h,a.uniform2f(b.locDestEnd,d,h));d=c[6];b.locLayerScale&&d!==b.lpLayerScale&&(b.lpLayerScale=d,a.uniform1f(b.locLayerScale,d));d=c[7];b.locLayerAngle&&d!==b.lpLayerAngle&&(b.lpLayerAngle=d,a.uniform1f(b.locLayerAngle,d));d=c[8];h=c[9];!b.locViewOrigin||d===b.lpViewOriginX&&
h===b.lpViewOriginY||(b.lpViewOriginX=d,b.lpViewOriginY=h,a.uniform2f(b.locViewOrigin,d,h));d=c[10];h=c[11];!b.locScrollPos||d===b.lpScrollPosX&&h===b.lpScrollPosY||(b.lpScrollPosX=d,b.lpScrollPosY=h,a.uniform2f(b.locScrollPos,d,h));d=c[12];b.locSeconds&&d!==b.lpSeconds&&(b.lpSeconds=d,a.uniform1f(b.locSeconds,d));if(b.parameters.length)for(c=0,h=b.parameters.length;c<h;c++)d=this.shaderParams[c],d!==b.lastCustomParams[c]&&(b.lastCustomParams[c]=d,a.uniform1f(b.parameters[c][1],d))};a.prototype.pushBatch=
function(){this.batchPtr===this.batch.length&&this.batch.push(new k(0,this));return this.batch[this.batchPtr++]};a.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){var b=this.gl;0<this.pointPtr&&(b.bindBuffer(b.ARRAY_BUFFER,this.pointBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),a&&0<=a.locAPos&&"<point>"===a.name&&b.vertexAttribPointer(a.locAPos,4,b.FLOAT,!1,0,0));if(0<this.vertexPtr){var a=this.currentShader;b.bindBuffer(b.ARRAY_BUFFER,
this.vertexBuffers[this.curBuffer]);b.bufferSubData(b.ARRAY_BUFFER,0,this.vertexData.subarray(0,this.vertexPtr));a&&0<=a.locAPos&&"<point>"!==a.name&&b.vertexAttribPointer(a.locAPos,this.enableFrontToBack?3:2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]);b.bufferSubData(b.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr));a&&0<=a.locATex&&"<point>"!==a.name&&b.vertexAttribPointer(a.locATex,2,b.FLOAT,!1,0,0)}b=0;for(a=this.batchPtr;b<a;b++){var c=this.batch[b];
switch(c.type){case 1:c.doQuad();break;case 2:c.doSetTexture();break;case 3:c.doSetOpacity();break;case 4:c.doSetBlend();break;case 5:c.doUpdateModelView();break;case 6:c.doRenderToTexture();break;case 7:c.doClear();break;case 8:c.doPoints();break;case 9:c.doSetProgram();break;case 10:c.doSetProgramParameters();break;case 11:c.doSetTexture1();break;case 12:c.doSetColor();break;case 13:c.doSetDepthTestEnabled();break;case 14:c.doSetEarlyZPass()}}this.pointPtr=this.texPtr=this.vertexPtr=this.batchPtr=
0;this.isBatchInEarlyZPass=this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.curBuffer++;4<=this.curBuffer&&(this.curBuffer=0)}};a.prototype.setOpacity=function(b){if(b!==this.lastOpacity&&!this.isEarlyZPass){var a=this.pushBatch();a.type=3;this.lastOpacity=a.opacityParam=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setTexture=function(b){if(b!==this.lastTexture0){var a=this.pushBatch();a.type=2;this.lastTexture0=a.texParam=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setBlend=
function(b,a){if((b!==this.lastSrcBlend||a!==this.lastDestBlend)&&!this.isEarlyZPass){var c=this.pushBatch();c.type=4;c.startIndex=b;c.indexCount=a;this.lastSrcBlend=b;this.lastDestBlend=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA};a.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)};a.prototype.setNoPremultiplyAlphaBlend=
function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};a.prototype.quad=function(b,a,c,d,h,e,f,k){15992<=this.vertexPtr&&this.endBatch();var m=this.vertexPtr,g=this.texPtr,l=this.vertexData,p=this.texcoordData,r=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var q=this.pushBatch();q.type=1;q.startIndex=this.enableFrontToBack?m:m/2*3;q.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(l[m++]=b,l[m++]=a,l[m++]=
r,l[m++]=c,l[m++]=d,l[m++]=r,l[m++]=h,l[m++]=e,l[m++]=r,l[m++]=f,l[m++]=k,l[m++]=r):(l[m++]=b,l[m++]=a,l[m++]=c,l[m++]=d,l[m++]=h,l[m++]=e,l[m++]=f,l[m++]=k);p[g++]=0;p[g++]=0;p[g++]=1;p[g++]=0;p[g++]=1;p[g++]=1;p[g++]=0;p[g++]=1;this.vertexPtr=m;this.texPtr=g};a.prototype.quadTex=function(b,a,c,d,h,e,f,k,g){15992<=this.vertexPtr&&this.endBatch();var m=this.vertexPtr,l=this.texPtr,p=this.vertexData,r=this.texcoordData,q=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=
6;else{var n=this.pushBatch();n.type=1;n.startIndex=this.enableFrontToBack?m:m/2*3;n.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}n=g.left;var v=g.top,t=g.right;g=g.bottom;this.enableFrontToBack?(p[m++]=b,p[m++]=a,p[m++]=q,p[m++]=c,p[m++]=d,p[m++]=q,p[m++]=h,p[m++]=e,p[m++]=q,p[m++]=f,p[m++]=k,p[m++]=q):(p[m++]=b,p[m++]=a,p[m++]=c,p[m++]=d,p[m++]=h,p[m++]=e,p[m++]=f,p[m++]=k);r[l++]=n;r[l++]=v;r[l++]=t;r[l++]=v;r[l++]=t;r[l++]=g;r[l++]=n;r[l++]=g;this.vertexPtr=m;this.texPtr=l};a.prototype.quadTexUV=
function(b,a,c,d,h,e,f,k,g,y,z,x,r,A,D,E){15992<=this.vertexPtr&&this.endBatch();var m=this.vertexPtr,l=this.texPtr,p=this.vertexData,q=this.texcoordData,n=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var v=this.pushBatch();v.type=1;v.startIndex=this.enableFrontToBack?m:m/2*3;v.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(p[m++]=b,p[m++]=a,p[m++]=n,p[m++]=c,p[m++]=d,p[m++]=n,p[m++]=h,p[m++]=e,p[m++]=n,p[m++]=f,p[m++]=
k,p[m++]=n):(p[m++]=b,p[m++]=a,p[m++]=c,p[m++]=d,p[m++]=h,p[m++]=e,p[m++]=f,p[m++]=k);q[l++]=g;q[l++]=y;q[l++]=z;q[l++]=x;q[l++]=r;q[l++]=A;q[l++]=D;q[l++]=E;this.vertexPtr=m;this.texPtr=l};a.prototype.convexPoly=function(b){var a=b.length/2-2,c=a-1,d=b[0],h=b[1],e;for(e=0;e<a;e+=2){var f=2*e;var k=b[f+2];var g=b[f+3];var y=b[f+4];var z=b[f+5];if(e===c)this.quad(d,h,k,g,y,z,y,z);else{var x=b[f+6];f=b[f+7];this.quad(d,h,k,g,y,z,x,f)}}};a.prototype.point=function(b,a,c,d){7996<=this.pointPtr&&this.endBatch();
var h=this.pointPtr,e=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var f=this.pushBatch();f.type=8;f.startIndex=h;f.indexCount=1;this.hasPointBatchTop=!0;this.hasQuadBatchTop=!1}e[h++]=b;e[h++]=a;e[h++]=c;e[h++]=d;this.pointPtr=h};a.prototype.switchProgram=function(b){if(this.lastProgram!==b){if(!this.shaderPrograms[b]){if(0===this.lastProgram)return;b=0}var a=this.pushBatch();a.type=9;this.lastProgram=a.startIndex=b;this.hasPointBatchTop=this.hasQuadBatchTop=
!1}};a.prototype.programUsesDest=function(b){b=this.shaderPrograms[b];return!(!b.locDestStart&&!b.locDestEnd)};a.prototype.programUsesCrossSampling=function(b){b=this.shaderPrograms[b];return!!(b.locDestStart||b.locDestEnd||b.crossSampling)};a.prototype.programPreservesOpaqueness=function(b){return this.shaderPrograms[b].preservesOpaqueness};a.prototype.programExtendsBox=function(b){b=this.shaderPrograms[b];return 0!==b.extendBoxHorizontal||0!==b.extendBoxVertical};a.prototype.getProgramBoxExtendHorizontal=
function(b){return this.shaderPrograms[b].extendBoxHorizontal};a.prototype.getProgramBoxExtendVertical=function(b){return this.shaderPrograms[b].extendBoxVertical};a.prototype.getProgramParameterType=function(b,a){return this.shaderPrograms[b].parameters[a][2]};a.prototype.programIsAnimated=function(b){return this.shaderPrograms[b].animated};a.prototype.setProgramParameters=function(b,a,c,d,h,e,f,k,g,y,z,x,r,A,D){var m=this.shaderPrograms[this.lastProgram];if(m.hasAnyOptionalUniforms||D.length){var l=
this.pushBatch();l.type=10;l.mat4param?mat4.set(this.matMV,l.mat4param):l.mat4param=mat4.create();var w=l.mat4param;w[0]=a;w[1]=c;w[2]=d;w[3]=h;w[4]=e;w[5]=f;w[6]=k;w[7]=g;w[8]=y;w[9]=z;w[10]=x;w[11]=r;w[12]=A;l.texParam=m.locSamplerBack?b:null;if(D.length)for(c=l.shaderParams,c.length=D.length,b=0,a=D.length;b<a;b++)c[b]=D[b];this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.clear=function(b,a,c,d){var h=this.pushBatch();h.type=7;h.startIndex=0;h.mat4param||(h.mat4param=mat4.create());
h.mat4param[0]=b;h.mat4param[1]=a;h.mat4param[2]=c;h.mat4param[3]=d;this.hasPointBatchTop=this.hasQuadBatchTop=!1};a.prototype.clearRect=function(b,a,c,d){if(!(0>c||0>d)){var h=this.pushBatch();h.type=7;h.startIndex=1;h.mat4param||(h.mat4param=mat4.create());h.mat4param[0]=b;h.mat4param[1]=a;h.mat4param[2]=c;h.mat4param[3]=d;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.clearDepth=function(){var b=this.pushBatch();b.type=7;b.startIndex=2;this.hasPointBatchTop=this.hasQuadBatchTop=!1};
a.prototype.setEarlyZPass=function(b){if(this.enableFrontToBack&&(b=!!b,this.isEarlyZPass!==b)){var a=this.pushBatch();a.type=14;a.startIndex=b?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.isEarlyZPass=b;this.renderToTex=null;this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}};a.prototype.setDepthTestEnabled=function(b){if(this.enableFrontToBack){var a=this.pushBatch();a.type=13;a.startIndex=b?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,
e);this.resetModelView();this.updateModelView();var b=this.width/2,a=this.height/2;this.quad(-b,a,b,a,b,-a,-b,-a);mat4.set(e,this.matMV);this.updateModelView()};a.prototype.setColorFillMode=function(b,a,c,d){this.switchProgram(3);var h=this.pushBatch();h.type=12;h.mat4param||(h.mat4param=mat4.create());h.mat4param[0]=b;h.mat4param[1]=a;h.mat4param[2]=c;h.mat4param[3]=d;this.hasPointBatchTop=this.hasQuadBatchTop=!1};a.prototype.setTextureFillMode=function(){this.switchProgram(0)};a.prototype.restoreEarlyZMode=
function(){this.switchProgram(2)};a.prototype.present=function(){this.endBatch();this.gl.flush()};var c=[],d={};a.prototype.contextLost=function(){cr.clearArray(c);d={}};a.prototype.loadTexture=function(b,a,e,f,h,m){a=!!a;e=!!e;var k=b.src+","+a+","+e+(a?","+h:"");if("undefined"!==typeof b.src&&d.hasOwnProperty(k)){var g=d[k];g.c2refcount++;return g}this.endBatch();var l=this.gl,q=cr.isPOT(b.width)&&cr.isPOT(b.height);g=l.createTexture();l.bindTexture(l.TEXTURE_2D,g);l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);var n=l.RGBA,x=l.RGBA,r=l.UNSIGNED_BYTE;if(f&&!this.isIE)switch(f){case 1:x=n=l.RGB;break;case 2:r=l.UNSIGNED_SHORT_4_4_4_4;break;case 3:r=l.UNSIGNED_SHORT_5_5_5_1;break;case 4:x=n=l.RGB,r=l.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!q&&a){f=document.createElement("canvas");f.width=cr.nextHighestPowerOfTwo(b.width);f.height=cr.nextHighestPowerOfTwo(b.height);var A=f.getContext("2d");"undefined"!==typeof A.imageSmoothingEnabled?A.imageSmoothingEnabled=e:(A.webkitImageSmoothingEnabled=e,A.mozImageSmoothingEnabled=
e,A.msImageSmoothingEnabled=e);A.drawImage(b,0,0,b.width,b.height,0,0,f.width,f.height);l.texImage2D(l.TEXTURE_2D,0,n,x,r,f)}else l.texImage2D(l.TEXTURE_2D,0,n,x,r,b);a?"repeat-x"===h?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)):("repeat-y"===h?l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE):l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT)):(l.texParameteri(l.TEXTURE_2D,
l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE));e?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),(q||2<=this.version)&&this.enable_mipmaps&&!m?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_LINEAR),l.generateMipmap(l.TEXTURE_2D)):l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST));l.bindTexture(l.TEXTURE_2D,
null);this.lastTexture0=null;g.c2width=b.width;g.c2height=b.height;g.c2refcount=1;g.c2texkey=k;c.push(g);return d[k]=g};a.prototype.createEmptyTexture=function(b,a,d,e,h){this.endBatch();var f=this.gl;this.isIE&&(e=!1);var k=f.createTexture();f.bindTexture(f.TEXTURE_2D,k);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b,a,0,f.RGBA,e?f.UNSIGNED_SHORT_4_4_4_4:f.UNSIGNED_BYTE,null);h?(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT)):(f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE));f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,d?f.LINEAR:f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,d?f.LINEAR:f.NEAREST);f.bindTexture(f.TEXTURE_2D,null);this.lastTexture0=null;k.c2width=b;k.c2height=a;c.push(k);return k};a.prototype.videoToTexture=function(b,a,c){this.endBatch();var d=this.gl;this.isIE&&(c=!1);d.bindTexture(d.TEXTURE_2D,a);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);try{d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,c?d.UNSIGNED_SHORT_4_4_4_4:d.UNSIGNED_BYTE,b)}catch(h){console&&console.error&&console.error("Error updating WebGL texture: ",h)}d.bindTexture(d.TEXTURE_2D,null);this.lastTexture0=null};a.prototype.deleteTexture=function(b){b&&("undefined"!==typeof b.c2refcount&&1<b.c2refcount?b.c2refcount--:(this.endBatch(),b===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),b===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(c,b),"undefined"!==typeof b.c2texkey&&delete d[b.c2texkey],this.gl.deleteTexture(b)))};a.prototype.estimateVRAM=function(){var b=this.width*this.height*8,a;var d=0;for(a=c.length;d<a;d++){var e=c[d];b+=e.c2width*e.c2height*4}return b};a.prototype.textureCount=function(){return c.length};a.prototype.setRenderingToTexture=function(b){if(b!==this.renderToTex){var a=this.pushBatch();
a.type=6;this.renderToTex=a.texParam=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};cr.GLWrap=a})();
(function(){function a(b){if(b&&(b.getContext||b.dc)&&!b.c2runtime){b.c2runtime=this;var a=this;this.isPhoneGap=this.isCordova=(this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk))||"undefined"!==typeof window.device&&("undefined"!==typeof window.device.cordova||"undefined"!==typeof window.device.phonegap)||"undefined"!==typeof window.c2iscordova&&window.c2iscordova;this.isDirectCanvas=!!b.dc;
this.isAppMobi="undefined"!==typeof window.AppMobi||this.isDirectCanvas;this.isCocoonJs=!!window.c2cocoonjs;this.isEjecta=!!window.c2ejecta;this.isCocoonJs&&(CocoonJS.App.onSuspended.addEventListener(function(){a.setSuspended(!0)}),CocoonJS.App.onActivated.addEventListener(function(){a.setSuspended(!1)}));this.isEjecta&&(document.addEventListener("pagehide",function(){a.setSuspended(!0)}),document.addEventListener("pageshow",function(){a.setSuspended(!1)}),document.addEventListener("resize",function(){a.setSize(window.innerWidth,
window.innerHeight)}));this.isDomFree=this.isDirectCanvas||this.isCocoonJs||this.isEjecta;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&
!this.isIE&&!this.isMicrosoftEdge;this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad||this.isEjecta;this.isiPhoneiOS6=this.isiPhone&&/os\s6/i.test(navigator.userAgent);this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&
!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=this.isNWjs="undefined"!==typeof window.c2nodewebkit||"undefined"!==typeof window.c2nwjs||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="undefined"!==typeof window.is_scirra_arcade;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindows8Capable=!("undefined"===typeof window.c2isWindows8Capable||!window.c2isWindows8Capable);
this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10=!!window.cr_windows10;this.isWinJS=this.isWindows8App||this.isWindows8Capable||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&
!this.isFirefox&&!this.isAmazonWebApp&&!this.isDomFree;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAppMobi||this.isCocoonJs||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen||this.isEjecta;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));this.isWKWebView=!!(this.isiOS&&this.isCordova&&window.webkit);"undefined"===
typeof cr_is_preview||this.isNWjs||"?nw"!==window.location.search&&!/nodewebkit/i.test(navigator.userAgent)&&!/nwjs/i.test(navigator.userAgent)||(this.isNWjs=!0);this.isDebug="undefined"!==typeof cr_is_preview&&-1<window.location.search.indexOf("debug");this.canvas=b;this.canvasdiv=document.getElementById("c2canvasdiv");this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=
0;this.canvas.oncontextmenu=function(b){b.preventDefault&&b.preventDefault();return!1};this.canvas.onselectstart=function(b){b.preventDefault&&b.preventDefault();return!1};this.canvas.ontouchstart=function(b){b.preventDefault&&b.preventDefault();return!1};this.isDirectCanvas&&(window.c2runtime=this);this.isNWjs&&(window.ondragover=function(b){b.preventDefault();return!1},window.ondrop=function(b){b.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
this.isAndroidStockBrowser&&"undefined"!==typeof jQuery&&jQuery("canvas").parents("*").css("overflow","visible");this.width=b.width;this.height=b.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_by_index=[];
this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets={};this.eventsheets_by_index=[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=
null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=!1;this.fireOnCreateAfterLoad=[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr.KahanAdder;this.wallTime=new cr.KahanAdder;this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=[];this.event_stack_index=-1;
this.localvar_stack=[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.loadingprogress=0;this.isNodeFullscreen=!1;this.stackLocalCount=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr.ObjectSet;this.objects_to_tick=new cr.ObjectSet;
this.objects_to_tick2=new cr.ObjectSet;this.registered_collisions=[];this.temp_poly=new cr.CollisionPoly([]);this.temp_poly2=new cr.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder=
"";this.objectsByUid={};this.snapshotCanvas=this.loaderlogos=null;this.snapshotData="";this.objectRefTable=[];this.requestProjectData()}}function f(b,a){return 128>=a?b[3]:256>=a?b[2]:512>=a?b[1]:b[0]}function g(){try{return!!window.indexedDB}catch(F){return!1}}function k(b){b.target.result.createObjectStore("saves",{keyPath:"slot"})}function e(b,a,c,h){try{var d=indexedDB.open("_C2SaveStates");d.onupgradeneeded=k;d.onerror=h;d.onsuccess=function(d){d=d.target.result;d.onerror=h;d.transaction(["saves"],
"readwrite").objectStore("saves").put({slot:b,data:a}).onsuccess=c}}catch(U){h(U)}}function c(b,a,c){try{var h=indexedDB.open("_C2SaveStates");h.onupgradeneeded=k;h.onerror=c;h.onsuccess=function(h){h=h.target.result;h.onerror=c;var d=h.transaction(["saves"]).objectStore("saves").get(b);d.onsuccess=function(b){d.result?a(d.result.data):a(null)}}}catch(M){c(M)}}function d(){cr.logexport("Reloading for continuous preview");window.c2cocoonjs?CocoonJS.App.reload():-1<window.location.search.indexOf("continuous")?
window.location.reload(!0):window.location+="?continuous"}function b(b){var a,c={};for(a in b)!b.hasOwnProperty(a)||b[a]instanceof cr.ObjectSet||b[a]&&"undefined"!==typeof b[a].c2userdata||"spriteCreatedDestroyCallback"!==a&&(c[a]=b[a]);return c}var l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;a.prototype.requestProjectData=function(){var b=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",
function(a){b.loadProject(JSON.parse(a))},function(b){alert("Error fetching data.js")});else{var a=this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var c="data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)c="data.json";a.open("GET",c,!0);var h=!1;if(!this.isDomFree&&"response"in a&&"responseType"in a)try{a.responseType="json",h="json"===a.responseType}catch(M){h=!1}if(!h&&"responseType"in a)try{a.responseType="text"}catch(M){}if("overrideMimeType"in
a)try{a.overrideMimeType("application/json; charset=utf-8")}catch(M){}this.isWindowsPhone8?a.onreadystatechange=function(){4===a.readyState&&b.loadProject(JSON.parse(a.responseText))}:(a.onload=function(){if(h)b.loadProject(a.response);else if(b.isEjecta){var c=a.responseText;c=c.substr(c.indexOf("{"));b.loadProject(JSON.parse(c))}else b.loadProject(JSON.parse(a.responseText))},a.onerror=function(b){cr.logerror("Error requesting "+c+":");cr.logerror(b)});a.send()}};a.prototype.initRendererAndLoader=
function(){var b=this,a,c;this.isRetina=(!this.isDomFree||this.isEjecta||this.isCordova)&&this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);this.devicePixelRatio=this.isRetina?window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio||1:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,window.innerHeight,!0);
this.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();b.onContextLost();cr.logexport("[Construct 2] WebGL context lost");window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(a){b.glwrap.initState();b.glwrap.setSize(b.glwrap.width,b.glwrap.height,!0);b.layer_tex=null;b.layout_tex=null;b.fx_tex[0]=null;b.fx_tex[1]=null;b.onContextRestored();b.redraw=!0;cr.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);
try{if(this.enableWebGL&&(this.isCocoonJs||this.isEjecta||!this.isDomFree)){var h={alpha:!0,depth:!1,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",h));this.gl||(this.gl=this.canvas.getContext("webgl",h)||this.canvas.getContext("experimental-webgl",h))}}catch(W){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(h=this.gl.getExtension("WEBGL_debug_renderer_info")){var d=this.gl.getParameter(h.UNMASKED_VENDOR_WEBGL);
this.glUnmaskedRenderer=this.gl.getParameter(h.UNMASKED_RENDERER_WEBGL)+" ["+d+"]"}this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.isDomFree||(this.overlay_canvas=document.createElement("canvas"),jQuery(this.overlay_canvas).appendTo(this.canvas.parentNode),this.overlay_canvas.oncontextmenu=function(b){return!1},this.overlay_canvas.onselectstart=function(b){return!1},this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio),this.overlay_canvas.height=
Math.round(this.cssHeight*this.devicePixelRatio),jQuery(this.overlay_canvas).css({width:this.cssWidth+"px",height:this.cssHeight+"px"}),this.positionOverlayCanvas(),this.overlay_ctx=this.overlay_canvas.getContext("2d"));this.glwrap=new cr.GLWrap(this.gl,this.isMobile,this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;h=0;for(d=this.types_by_index.length;h<d;h++){var e=this.types_by_index[h];var f=0;
for(a=e.effect_types.length;f<a;f++){var m=e.effect_types[f];m.shaderindex=this.glwrap.getShaderIndex(m.id);m.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(m.shaderindex);this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(m.shaderindex)}}h=0;for(d=this.layouts_by_index.length;h<d;h++){var k=this.layouts_by_index[h];f=0;for(a=k.effect_types.length;f<a;f++)m=k.effect_types[f],m.shaderindex=this.glwrap.getShaderIndex(m.id),m.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(m.shaderindex);
k.updateActiveEffects();f=0;for(a=k.layers.length;f<a;f++){var g=k.layers[f];e=0;for(c=g.effect_types.length;e<c;e++)m=g.effect_types[e],m.shaderindex=this.glwrap.getShaderIndex(m.id),m.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(m.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(m.shaderindex);g.updateActiveEffects()}}}else{if(0<this.fullscreen_mode&&this.isDirectCanvas){this.canvas=null;document.oncontextmenu=function(b){return!1};
document.onselectstart=function(b){return!1};this.ctx=AppMobi.canvas.getContext("2d");try{this.ctx.samplingMode=this.linearSampling?"smooth":"sharp",this.ctx.globalScale=1,this.ctx.HTML5CompatibilityMode=!0,this.ctx.imageSmoothingEnabled=this.linearSampling}catch(W){}0!==this.width&&0!==this.height&&(this.ctx.width=this.width,this.ctx.height=this.height)}this.ctx||(h=this.isCocoonJs?{antialias:!!this.linearSampling,alpha:!0}:{alpha:!0},this.ctx=this.canvas.getContext("2d",h),this.setCtxImageSmoothingEnabled(this.ctx,
this.linearSampling));this.overlay_ctx=this.overlay_canvas=null}this.tickFunc=function(a){b.tick(!1,a)};window==window.top||this.isDomFree||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));"undefined"!==typeof cr_is_preview&&(this.isCocoonJs&&console.log("[Construct 2] In preview-over-wifi via CocoonJS mode"),-1<window.location.search.indexOf("continuous")&&(cr.logexport("Reloading for continuous preview"),
this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(jQuery(window).focus(function(){b.setSuspended(!1)}),jQuery(window).blur(function(){var a=window.parent;a&&a.document.hasFocus()||b.setSuspended(!0)})));window.addEventListener("blur",function(){b.onWindowBlur()});this.isDomFree||(h=function(b){if(cr.isCanvasInputEvent(b)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(ba){}},
"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",h):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",h):document.addEventListener("touchstart",h),document.addEventListener("mousedown",h));0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio&&this.setSize(this.original_width,this.original_height,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr.seal(this)};a.prototype.setSize=function(b,a,c){var h=0,d=0,e;if(this.lastWindowWidth!==
b||this.lastWindowHeight!==a||c){this.lastWindowWidth=b;this.lastWindowHeight=a;var f=this.fullscreen_mode;if((e=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen)&&!this.isCordova)||0!==this.fullscreen_mode||c){e&&(f=this.fullscreen_scaling);c=this.devicePixelRatio;if(4<=f)if(5===f&&1!==c&&(b+=1,a+=1),e=this.original_width/this.original_height,b/a>e)if(e*=a,5===f){h=e*c/this.original_width;1<h?h=Math.floor(h):1>h&&(h=
1/Math.ceil(1/h));e=this.original_width*h/c;var m=this.original_height*h/c;h=(b-e)/2;d=(a-m)/2;b=e;a=m}else h=(b-e)/2,b=e;else m=b/e,5===f?(h=m*c/this.original_height,1<h?h=Math.floor(h):1>h&&(h=1/Math.ceil(1/h)),e=this.original_width*h/c,m=this.original_height*h/c,h=(b-e)/2,d=(a-m)/2,b=e):d=(a-m)/2,a=m;else e&&0===f&&(h=Math.floor((b-this.original_width)/2),d=Math.floor((a-this.original_height)/2),b=this.original_width,a=this.original_height);2>f&&(this.aspect_scale=c);this.cssWidth=Math.round(b);
this.cssHeight=Math.round(a);this.width=Math.round(b*c);this.height=Math.round(a*c);this.redraw=!0;this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===f?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===f?
(e=this.original_width/this.original_height,f=this.lastWindowWidth/this.lastWindowHeight,f<e?this.draw_width=this.draw_height*f:f>e&&(this.draw_height=this.draw_width/f)):3===f&&(e=this.original_width/this.original_height,f=this.lastWindowWidth/this.lastWindowHeight,f>e?this.draw_width=this.draw_height*f:f<e&&(this.draw_height=this.draw_width/f)));this.canvasdiv&&!this.isDomFree&&(jQuery(this.canvasdiv).css({width:Math.round(b)+"px",height:Math.round(a)+"px","margin-left":Math.floor(h)+"px","margin-top":Math.floor(d)+
"px"}),"undefined"!==typeof cr_is_preview&&jQuery("#borderwrap").css({width:Math.round(b)+"px",height:Math.round(a)+"px"}));this.canvas&&(this.canvas.width=Math.round(b*c),this.canvas.height=Math.round(a*c),this.isEjecta?(this.canvas.style.left=Math.floor(h)+"px",this.canvas.style.top=Math.floor(d)+"px",this.canvas.style.width=Math.round(b)+"px",this.canvas.style.height=Math.round(a)+"px"):this.isRetina&&!this.isDomFree&&(this.canvas.style.width=Math.round(b)+"px",this.canvas.style.height=Math.round(a)+
"px"));this.overlay_canvas&&(this.overlay_canvas.width=Math.round(b*c),this.overlay_canvas.height=Math.round(a*c),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px");this.glwrap&&this.glwrap.setSize(Math.round(b*c),Math.round(a*c));this.isDirectCanvas&&this.ctx&&(this.ctx.width=Math.round(b),this.ctx.height=Math.round(a));this.ctx&&this.setCtxImageSmoothingEnabled(this.ctx,this.linearSampling);this.tryLockOrientation();this.isiPhone&&!this.isCordova&&
window.scrollTo(0,0)}}};a.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var b="portrait";2===this.orientations&&(b="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(b).catch(function(){}):screen.lockOrientation?screen.lockOrientation(b):screen.webkitLockOrientation?screen.webkitLockOrientation(b):screen.mozLockOrientation?screen.mozLockOrientation(b):screen.msLockOrientation&&screen.msLockOrientation(b)}catch(C){console&&
console.warn&&console.warn("Failed to lock orientation: ",C)}}};a.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var b;var a=0;for(b=this.types_by_index.length;a<b;a++){var c=this.types_by_index[a];if(c.onLostWebGLContext)c.onLostWebGLContext()}};a.prototype.onContextRestored=function(){this.is_WebGL_context_lost=!1;var b;var a=0;for(b=this.types_by_index.length;a<b;a++){var c=this.types_by_index[a];if(c.onRestoreWebGLContext)c.onRestoreWebGLContext()}};
a.prototype.positionOverlayCanvas=function(){if(!this.isDomFree){var b=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova?jQuery(this.canvas).offset():jQuery(this.canvas).position();b.position="absolute";jQuery(this.overlay_canvas).css(b)}};var n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;a.prototype.setSuspended=
function(b){var a;if(b&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&n&&n(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),b=0,a=this.suspend_events.length;b<a;b++)this.suspend_events[b](!0);else if(!b&&this.isSuspended){cr.logexport("[Construct 2] Resuming");this.isSuspended=!1;this.last_tick_time=cr.performance_now();this.last_fps_time=cr.performance_now();b=this.logictime=this.framecount=0;for(a=this.suspend_events.length;b<
a;b++)this.suspend_events[b](!1);this.tick(!1)}};a.prototype.addSuspendCallback=function(b){this.suspend_events.push(b)};a.prototype.GetObjectReference=function(b){return this.objectRefTable[b]};a.prototype.loadProject=function(b){b&&b.project||cr.logerror("Project model unavailable");b=b.project;this.name=b[0];this.first_layout=b[1];this.fullscreen_mode=b[12];this.fullscreen_mode_set=b[12];this.original_width=b[10];this.original_height=b[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=
this.original_height/2;this.isDomFree&&!this.isEjecta&&(4<=b[12]||0===b[12])&&(cr.logexport("[Construct 2] Letterbox scale fullscreen modes are not supported on this platform - falling back to 'Scale outer'"),this.fullscreen_mode_set=this.fullscreen_mode=3);this.uses_loader_layout=b[18];this.loaderstyle=b[19];if(0===this.loaderstyle){var a=new Image;a.crossOrigin="anonymous";this.setImageSrc(a,"loading-logo.png");this.loaderlogos={logo:a}}else if(4===this.loaderstyle){a=new Image;a.src="";var c=new Image;
c.src="";var h=new Image;h.src="";var d=new Image;d.src="";var e=new Image;e.src="";var f=new Image;f.src="";var m=new Image;m.src="";var k=new Image;k.src="";var g=new Image;g.src="";var l=new Image;l.src="";var r=new Image;r.src="";var t=new Image;t.src="";this.loaderlogos={logo:[a,c,h,d],powered:[e,f,m,k],website:[g,l,r,t]}}this.next_uid=b[21];this.objectRefTable=cr.getObjectRefTable();this.system=new cr.system_object(this);a=0;for(c=b[2].length;a<c;a++){m=b[2][a];h=this.GetObjectReference(m[0]);
cr.add_common_aces(m,h.prototype);k=new h(this);k.singleglobal=m[1];k.is_world=m[2];k.is_rotatable=m[5];k.must_predraw=m[9];if(k.onCreate)k.onCreate();cr.seal(k);this.plugins.push(k)}this.objectRefTable=cr.getObjectRefTable();a=0;for(c=b[3].length;a<c;a++){m=b[3][a];e=this.GetObjectReference(m[1]);k=null;h=0;for(d=this.plugins.length;h<d;h++)if(this.plugins[h]instanceof e){k=this.plugins[h];break}g=new k.Type(k);g.name=m[0];g.is_family=m[2];g.instvar_sids=m[3].slice(0);g.vars_count=m[3].length;g.behs_count=
m[4];g.fx_count=m[5];g.sid=m[11];g.is_family?(g.members=[],g.family_index=this.family_count++,g.families=null):(g.members=null,g.family_index=-1,g.families=[]);g.family_var_map=null;g.family_beh_map=null;g.family_fx_map=null;g.is_contained=!1;g.container=null;m[6]?(g.texture_file=m[6][0],g.texture_filesize=m[6][1],g.texture_pixelformat=m[6][2]):(g.texture_file=null,g.texture_filesize=0,g.texture_pixelformat=0);g.animations=m[7]?m[7]:null;g.index=a;g.instances=[];g.deadCache=[];g.solstack=[new cr.selection(g)];
g.cur_sol=0;g.default_instance=null;g.default_layerindex=0;g.stale_iids=!0;g.updateIIDs=cr.type_updateIIDs;g.getFirstPicked=cr.type_getFirstPicked;g.getPairedInstance=cr.type_getPairedInstance;g.getCurrentSol=cr.type_getCurrentSol;g.pushCleanSol=cr.type_pushCleanSol;g.pushCopySol=cr.type_pushCopySol;g.popSol=cr.type_popSol;g.getBehaviorByName=cr.type_getBehaviorByName;g.getBehaviorIndexByName=cr.type_getBehaviorIndexByName;g.getEffectIndexByName=cr.type_getEffectIndexByName;g.applySolToContainer=
cr.type_applySolToContainer;g.getInstanceByIID=cr.type_getInstanceByIID;g.collision_grid=new cr.SparseGrid(this.original_width,this.original_height);g.any_cell_changed=!0;g.any_instance_parallaxed=!1;g.extra={};g.toString=cr.type_toString;g.behaviors=[];h=0;for(d=m[8].length;h<d;h++){l=m[8][h];r=this.GetObjectReference(l[1]);t=null;e=0;for(f=this.behaviors.length;e<f;e++)if(this.behaviors[e]instanceof r){t=this.behaviors[e];break}if(!t){t=new r(this);t.my_types=[];t.my_instances=new cr.ObjectSet;
if(t.onCreate)t.onCreate();cr.seal(t);this.behaviors.push(t);cr.behaviors.solid&&t instanceof cr.behaviors.solid&&(this.solidBehavior=t);cr.behaviors.jumpthru&&t instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=t);cr.behaviors.shadowcaster&&t instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=t)}-1===t.my_types.indexOf(g)&&t.my_types.push(g);e=new t.Type(t,g);e.name=l[0];e.sid=l[2];e.onCreate();cr.seal(e);g.behaviors.push(e)}g.global=m[9];g.isOnLoaderLayout=m[10];g.effect_types=
[];h=0;for(d=m[12].length;h<d;h++)g.effect_types.push({id:m[12][h][0],name:m[12][h][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:h});g.tile_poly_data=m[13];if(!this.uses_loader_layout||g.is_family||g.isOnLoaderLayout||!k.is_world)g.onCreate(),cr.seal(g);g.name&&(this.types[g.name]=g);this.types_by_index.push(g);k.singleglobal&&(h=new k.Instance(g),h.uid=this.next_uid++,h.puid=this.next_puid++,h.iid=0,h.get_iid=cr.inst_get_iid,h.toString=cr.inst_toString,h.properties=m[14],h.onCreate(),
cr.seal(h),g.instances.push(h),this.objectsByUid[h.uid.toString()]=h)}a=0;for(c=b[4].length;a<c;a++)for(e=b[4][a],f=this.types_by_index[e[0]],h=1,d=e.length;h<d;h++)m=this.types_by_index[e[h]],m.families.push(f),f.members.push(m);a=0;for(c=b[28].length;a<c;a++){e=b[28][a];f=[];h=0;for(d=e.length;h<d;h++)f.push(this.types_by_index[e[h]]);h=0;for(d=f.length;h<d;h++)f[h].is_contained=!0,f[h].container=f}if(0<this.family_count)for(a=0,c=this.types_by_index.length;a<c;a++)if(m=this.types_by_index[a],!m.is_family&&
m.families.length){m.family_var_map=Array(this.family_count);m.family_beh_map=Array(this.family_count);m.family_fx_map=Array(this.family_count);g=[];h=t=r=l=0;for(d=m.families.length;h<d;h++)for(k=m.families[h],m.family_var_map[k.family_index]=l,l+=k.vars_count,m.family_beh_map[k.family_index]=r,r+=k.behs_count,m.family_fx_map[k.family_index]=t,t+=k.fx_count,e=0,f=k.effect_types.length;e<f;e++)g.push(cr.shallowCopy({},k.effect_types[e]));m.effect_types=g.concat(m.effect_types);h=0;for(d=m.effect_types.length;h<
d;h++)m.effect_types[h].index=h}a=0;for(c=b[5].length;a<c;a++)m=b[5][a],h=new cr.layout(this,m),cr.seal(h),this.layouts[h.name]=h,this.layouts_by_index.push(h);a=0;for(c=b[6].length;a<c;a++)m=b[6][a],h=new cr.eventsheet(this,m),cr.seal(h),this.eventsheets[h.name]=h,this.eventsheets_by_index.push(h);a=0;for(c=this.eventsheets_by_index.length;a<c;a++)this.eventsheets_by_index[a].postInit();a=0;for(c=this.eventsheets_by_index.length;a<c;a++)this.eventsheets_by_index[a].updateDeepIncludes();a=0;for(c=
this.triggers_to_postinit.length;a<c;a++)this.triggers_to_postinit[a].postInit();cr.clearArray(this.triggers_to_postinit);this.audio_to_preload=b[7];this.files_subfolder=b[8];this.pixel_rounding=b[9];this.aspect_scale=1;this.enableWebGL=b[13];this.linearSampling=b[14];this.clearBackground=b[15];this.versionstr=b[16];this.useHighDpi=b[17];this.orientations=b[20];this.autoLockOrientation=0<this.orientations;this.pauseOnBlur=b[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=b[23];
this.downscalingQuality=b[24];this.preloadSounds=b[25];this.projectName=b[26];this.enableFrontToBack=b[27]&&!this.isIE;this.start_time=Date.now();cr.clearArray(this.objectRefTable);this.initRendererAndLoader()};var q=!1,h=0,m=[];a.prototype.queueImageLoad=function(b,a){var c=this,d=function(){h--;c.maybeLoadNextImages()};b.addEventListener("load",d);b.addEventListener("error",d);m.push([b,a]);this.maybeLoadNextImages()};a.prototype.maybeLoadNextImages=function(){for(var b;m.length&&100>h;)h++,b=m.shift(),
this.setImageSrc(b[0],b[1])};a.prototype.waitForImageLoad=function(b,a){b.cocoonLazyLoad=!0;b.onerror=function(a){q=b.c2error=!0;console&&console.error&&console.error("Error loading image '"+b.src+"': ",a)};this.isEjecta?b.src=a:b.src||("undefined"!==typeof XAPKReader?XAPKReader.get(a,function(a){b.src=a},function(c){q=b.c2error=!0;console&&console.error&&console.error("Error extracting image '"+a+"' from expansion file: ",c)}):(b.crossOrigin="anonymous",this.queueImageLoad(b,a)));this.wait_for_textures.push(b)};
a.prototype.findWaitingTexture=function(b){var a;var c=0;for(a=this.wait_for_textures.length;c<a;c++)if(this.wait_for_textures[c].cr_src===b)return this.wait_for_textures[c];return null};var p=0,v=!1;a.prototype.getready=function(){this.audioInstance&&(p=this.audioInstance.setPreloadList(this.audio_to_preload))};a.prototype.areAllTexturesAndSoundsLoaded=function(){var b=p,a=0,c=!0,h;var d=0;for(h=this.wait_for_textures.length;d<h;d++){var e=this.wait_for_textures[d];var f=e.cr_filesize;if(!f||0>=
f)f=5E4;b+=f;e.src&&(e.complete||e.loaded)&&!e.c2error?a+=f:c=!1}c&&this.preloadSounds&&this.audioInstance&&(v||(this.audioInstance.startPreloads(),v=!0),d=this.audioInstance.getPreloadedSize(),a+=d,d<p&&(c=!1));this.progress=0==b?1:a/b;return c};var u=!1;a.prototype.go=function(){if(this.ctx||this.glwrap){var b=this.ctx||this.overlay_ctx;this.overlay_canvas&&this.positionOverlayCanvas();var a=window.innerWidth,c=window.innerHeight;this.lastWindowWidth===a&&this.lastWindowHeight===c||this.setSize(a,
c);this.progress=0;this.last_progress=-1;var h=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||u))this.go_loading_finished();else{c=Date.now()-this.start_time;if(b){var d=this.width,e=this.height;a=this.devicePixelRatio;if(3>this.loaderstyle&&(this.isCocoonJs||500<=c&&this.last_progress!=this.progress)){b.clearRect(0,0,d,e);c=d/2;e/=2;d=0===this.loaderstyle&&this.loaderlogos.logo.complete;var f=40*a,m=0,g=80*a;if(d){var k=this.loaderlogos.logo;g=k.width*a;var r=k.height*a;f=g/
2;m=r/2;b.drawImage(k,cr.floor(c-f),cr.floor(e-m),g,r)}1>=this.loaderstyle?(e+=m+(d?12*a:0),c=cr.floor(c-f)+.5,e=cr.floor(e)+.5,b.fillStyle=q?"red":"DodgerBlue",b.fillRect(c,e,Math.floor(g*this.progress),6*a),b.strokeStyle="black",b.strokeRect(c,e,g,6*a),b.strokeStyle="white",b.strokeRect(c-1*a,e-1*a,g+2*a,8*a)):2===this.loaderstyle&&(b.font=this.isEjecta?"12pt ArialMT":"12pt Arial",b.fillStyle=q?"#f00":"#999",b.textBaseLine="middle",a=Math.round(100*this.progress)+"%",d=b.measureText?b.measureText(a):
null,b.fillText(a,c-(d?d.width:0)/2,e));this.last_progress=this.progress}else if(4===this.loaderstyle){this.draw_c2_splash_loader(b);l?l(function(){h.go()}):setTimeout(function(){h.go()},16);return}}setTimeout(function(){h.go()},this.isCocoonJs?10:100)}}};var y=-1,z="undefined"===typeof cr_is_preview?200:0,x=!0,r=!1,A=0,D=0,E="undefined"===typeof cr_is_preview?3E3:0,t=null,w=null,N=0;a.prototype.draw_c2_splash_loader=function(b){if(!u){for(var a=Math.ceil(this.width),c=Math.ceil(this.height),h=this.loaderlogos.logo,
d=this.loaderlogos.powered,e=this.loaderlogos.website,m=0;4>m;++m)if(!h[m].complete||!d[m].complete||!e[m].complete)return;0===N&&(y=Date.now());m=Date.now();var g=!1,k=b;x||r?(b.clearRect(0,0,a,c),t&&t.width===a&&t.height===c||(t=document.createElement("canvas"),t.width=a,t.height=c,w=t.getContext("2d")),k=w,g=!0,x&&1===N&&(y=Date.now())):b.globalAlpha=1;k.fillStyle="#333333";k.fillRect(0,0,a,c);if(256<this.cssHeight){var l=cr.clamp(.22*c,105,.6*a);var p=.25*l;k.drawImage(f(d,l),.5*a-l/2,.2*c-p/
2,l,p);p=l=Math.min(.395*c,.95*a);k.drawImage(f(h,l),.5*a-l/2,.485*c-p/2,l,p);l=cr.clamp(.22*c,105,.6*a);p=.25*l;k.drawImage(f(e,l),.5*a-l/2,.868*c-p/2,l,p);k.fillStyle="#3C3C3C";p=Math.max(.005*c,2);k.fillRect(0,.8*c-p/2,a,p);k.fillStyle=q?"red":"#E0FF65";l=a*this.progress;k.fillRect(.5*a-l/2,.8*c-p/2,l,p)}else p=l=.55*c,k.drawImage(f(h,l),.5*a-l/2,.45*c-p/2,l,p),k.fillStyle="#3C3C3C",p=Math.max(.005*c,2),k.fillRect(0,.85*c-p/2,a,p),k.fillStyle=q?"red":"#E0FF65",l=a*this.progress,k.fillRect(.5*a-
l/2,.85*c-p/2,l,p);g&&(x?b.globalAlpha=0===N?0:Math.min((m-y)/300,1):r&&(b.globalAlpha=Math.max(1-(m-D)/300,0)),b.drawImage(t,0,0,a,c));x&&300<=m-y&&2<=N&&(x=!1,A=m);!x&&m-A>=E&&!r&&1<=this.progress&&(r=!0,D=m);if(r&&m-D>=300+z||"undefined"!==typeof cr_is_preview&&1<=this.progress&&500>Date.now()-y)u=!0,r=x=!1,this.loaderlogos=w=t=null;++N}};a.prototype.go_loading_finished=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=this.overlay_ctx=
null);this.start_time=Date.now();this.last_fps_time=cr.performance_now();var b;if(this.uses_loader_layout){var a=0;for(b=this.types_by_index.length;a<b;a++){var c=this.types_by_index[a];c.is_family||c.isOnLoaderLayout||!c.plugin.is_world||(c.onCreate(),cr.seal(c))}}else this.isloading=!1;a=0;for(b=this.layouts_by_index.length;a<b;a++)this.layouts_by_index[a].createGlobalNonWorlds();2<=this.fullscreen_mode&&(a=this.original_width/this.original_height,b=this.width/this.height,this.aspect_scale=2!==
this.fullscreen_mode&&b>a||2===this.fullscreen_mode&&b<a?this.height/this.original_height:this.width/this.original_width);this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW());navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide();a=0;for(b=this.types_by_index.length;a<
b;a++)if(c=this.types_by_index[a],c.onAppBegin)c.onAppBegin();document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1);this.isDirectCanvas&&AppMobi.webview.execute("onGameReady();")};a.prototype.tick=function(b,a,c){if(this.running_layout){var h=cr.performance_now();if(c||!this.isSuspended||b){b||(l?this.raf_id=l(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));a=a||h;var d=this.fullscreen_mode;((c=(document.mozFullScreen||
document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)||this.isNodeFullscreen)&&0<this.fullscreen_scaling&&(d=this.fullscreen_scaling);if(0<d){d=window.innerWidth;var e=window.innerHeight;this.lastWindowWidth===d&&this.lastWindowHeight===e||this.setSize(d,e)}this.isDomFree||(c?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),
Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height));this.isloading&&(c=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,c&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW()));this.logic(a);!this.redraw&&!this.isCocoonJs||this.is_WebGL_context_lost||this.suspendDrawing||b||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),
this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr.performance_now()-h}}};a.prototype.logic=function(b){var a;1E3<=b-this.last_fps_time&&
(this.last_fps_time+=1E3,1E3<=b-this.last_fps_time&&(this.last_fps_time=b),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=this.logictime,this.logictime=0);var c=0;0!==this.last_tick_time&&(c=b-this.last_tick_time,0>c&&(c=0),this.dt1=c/=1E3,.5<this.dt1?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate));this.last_tick_time=b;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(c);b=(document.mozFullScreen||document.webkitIsFullScreen||
document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova;if(2<=this.fullscreen_mode||b&&0<this.fullscreen_scaling){c=this.original_width/this.original_height;var h=this.width/this.height;var d=this.fullscreen_mode;b&&0<this.fullscreen_scaling&&(d=this.fullscreen_scaling);this.aspect_scale=2!==d&&h>c||2===d&&h<c?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=
this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;h=this.objects_to_pretick.valuesRef();b=0;for(c=h.length;b<c;b++)h[b].pretick();b=0;for(c=this.types_by_index.length;b<c;b++){var e=this.types_by_index[b];if(!e.is_family&&(e.behaviors.length||e.families.length))for(h=0,d=e.instances.length;h<d;h++){var f=e.instances[h];var m=0;for(a=f.behavior_insts.length;m<a;m++)f.behavior_insts[m].tick()}}b=
0;for(c=this.types_by_index.length;b<c;b++)if(e=this.types_by_index[b],!e.is_family&&(e.behaviors.length||e.families.length))for(h=0,d=e.instances.length;h<d;h++)for(f=e.instances[h],m=0,a=f.behavior_insts.length;m<a;m++){var g=f.behavior_insts[m];g.posttick&&g.posttick()}h=this.objects_to_tick.valuesRef();b=0;for(c=h.length;b<c;b++)h[b].tick();this.isInOnDestroy--;this.handleSaveLoad();for(b=0;this.changelayout&&10>b++;)this.doChangeLayout(this.changelayout);b=0;for(c=this.eventsheets_by_index.length;b<
c;b++)this.eventsheets_by_index[b].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;b=0;for(c=this.types_by_index.length;b<c;b++)if(e=this.types_by_index[b],!e.is_family&&(e.behaviors.length||e.families.length))for(h=0,d=e.instances.length;h<d;h++)for(f=e.instances[h],m=0,a=f.behavior_insts.length;m<a;m++)g=f.behavior_insts[m],g.tick2&&g.tick2();h=this.objects_to_tick2.valuesRef();
b=0;for(c=h.length;b<c;b++)h[b].tick2();this.isInOnDestroy--};a.prototype.onWindowBlur=function(){var b,a,c;var h=0;for(b=this.types_by_index.length;h<b;h++){var d=this.types_by_index[h];if(!d.is_family){var e=0;for(a=d.instances.length;e<a;e++){var f=d.instances[e];if(f.onWindowBlur)f.onWindowBlur();if(f.behavior_insts){var m=0;for(c=f.behavior_insts.length;m<c;m++){var g=f.behavior_insts[m];if(g.onWindowBlur)g.onWindowBlur()}}}}}};a.prototype.doChangeLayout=function(b){var a=this.running_layout;
this.running_layout.stopRunning();var c;if(this.glwrap){var h=0;for(c=this.types_by_index.length;h<c;h++){var d=this.types_by_index[h];d.is_family||!d.unloadTextures||d.global&&0!==d.instances.length||-1!==b.initial_types.indexOf(d)||d.unloadTextures()}}a==b&&cr.clearArray(this.system.waits);cr.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);b.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=this.redraw=!0;this.ClearDeathRow()};a.prototype.runLayoutChangeMethods=
function(b){var a,c,h;var d=0;for(a=this.behaviors.length;d<a;d++){var e=this.behaviors[d];if(b){if(e.onBeforeLayoutChange)e.onBeforeLayoutChange()}else if(e.onLayoutChange)e.onLayoutChange()}d=0;for(a=this.types_by_index.length;d<a;d++)if(e=this.types_by_index[d],e.global||e.plugin.singleglobal){var f=0;for(c=e.instances.length;f<c;f++){var m=e.instances[f];if(b){if(m.onBeforeLayoutChange)m.onBeforeLayoutChange()}else if(m.onLayoutChange)m.onLayoutChange();if(m.behavior_insts){var g=0;for(h=m.behavior_insts.length;g<
h;g++){var k=m.behavior_insts[g];if(b){if(k.onBeforeLayoutChange)k.onBeforeLayoutChange()}else if(k.onLayoutChange)k.onLayoutChange()}}}}};a.prototype.pretickMe=function(b){this.objects_to_pretick.add(b)};a.prototype.unpretickMe=function(b){this.objects_to_pretick.remove(b)};a.prototype.tickMe=function(b){this.objects_to_tick.add(b)};a.prototype.untickMe=function(b){this.objects_to_tick.remove(b)};a.prototype.tick2Me=function(b){this.objects_to_tick2.add(b)};a.prototype.untick2Me=function(b){this.objects_to_tick2.remove(b)};
a.prototype.getDt=function(b){return b&&-1!==b.my_timescale?this.dt1*b.my_timescale:this.dt};a.prototype.draw=function(){this.running_layout.draw(this.ctx);this.isDirectCanvas&&this.ctx.present()};a.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));this.running_layout.drawGL(this.glwrap);this.glwrap.present()};a.prototype.addDestroyCallback=function(b){b&&this.destroycallbacks.push(b)};a.prototype.removeDestroyCallback=function(b){cr.arrayFindRemove(this.destroycallbacks,
b)};a.prototype.getObjectByUID=function(b){b=b.toString();return this.objectsByUid.hasOwnProperty(b)?this.objectsByUid[b]:null};var P=[];a.prototype.DestroyInstance=function(b){var a;var c=b.type.name;if(this.deathRow.hasOwnProperty(c)){var h=this.deathRow[c];if(h.contains(b))return}else h=P.length?P.pop():new cr.ObjectSet,this.deathRow[c]=h;h.add(b);this.hasPendingInstances=!0;if(b.is_contained)for(c=0,a=b.siblings.length;c<a;c++)this.DestroyInstance(b.siblings[c]);this.isInClearDeathRow&&h.values_cache.push(b);
this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(b.type.plugin).cnds.OnDestroyed,b),this.isInOnDestroy--)};a.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var b,a;this.isInClearDeathRow=!0;var c=0;for(b=this.createRow.length;c<b;++c){var h=this.createRow[c];var d=h.type;d.instances.push(h);var e=0;for(a=d.families.length;e<a;++e)d.families[e].instances.push(h),d.families[e].stale_iids=!0}cr.clearArray(this.createRow);this.IterateDeathRow();cr.wipe(this.deathRow);
this.hasPendingInstances=this.isInClearDeathRow=!1}};a.prototype.IterateDeathRow=function(){for(var b in this.deathRow)this.deathRow.hasOwnProperty(b)&&this.ClearDeathRowForType(this.deathRow[b])};a.prototype.ClearDeathRowForType=function(b){var a=b.valuesRef(),c=a[0].type,h,d;cr.arrayRemoveAllFromObjectSet(c.instances,b);c.stale_iids=!0;0===c.instances.length&&(c.any_instance_parallaxed=!1);var e=0;for(h=c.families.length;e<h;++e){var f=c.families[e];cr.arrayRemoveAllFromObjectSet(f.instances,b);
f.stale_iids=!0}e=0;for(h=this.system.waits.length;e<h;++e){var m=this.system.waits[e];m.sols.hasOwnProperty(c.index)&&cr.arrayRemoveAllFromObjectSet(m.sols[c.index].insts,b);if(!c.is_family){var g=0;for(d=c.families.length;g<d;++g)f=c.families[g],m.sols.hasOwnProperty(f.index)&&cr.arrayRemoveAllFromObjectSet(m.sols[f.index].insts,b)}}if(m=a[0].layer){if(m.useRenderCells)for(g=m.instances,e=0,h=g.length;e<h;++e)d=g[e],b.contains(d)&&(d.update_bbox(),m.render_grid.update(d,d.rendercells,null),d.rendercells.set(0,
0,-1,-1));cr.arrayRemoveAllFromObjectSet(m.instances,b);m.setZIndicesStaleFrom(0)}for(e=0;e<a.length;++e)this.ClearDeathRowForSingleInstance(a[e],c);b.clear();P.push(b);this.redraw=!0};a.prototype.ClearDeathRowForSingleInstance=function(b,a){var c;var h=0;for(c=this.destroycallbacks.length;h<c;++h)this.destroycallbacks[h](b);b.collcells&&a.collision_grid.update(b,b.collcells,null);(h=b.layer)&&h.removeFromInstanceList(b,!0);if(b.behavior_insts)for(h=0,c=b.behavior_insts.length;h<c;++h){var d=b.behavior_insts[h];
if(d.onDestroy)d.onDestroy();d.behavior.my_instances.remove(b)}this.objects_to_pretick.remove(b);this.objects_to_tick.remove(b);this.objects_to_tick2.remove(b);if(b.onDestroy)b.onDestroy();this.objectsByUid.hasOwnProperty(b.uid.toString())&&delete this.objectsByUid[b.uid.toString()];this.objectcount--;100>a.deadCache.length&&a.deadCache.push(b)};a.prototype.createInstance=function(b,a,c,h){if(b.is_family){var d=cr.floor(Math.random()*b.members.length);return this.createInstance(b.members[d],a,c,h)}return b.default_instance?
this.createInstanceFromInit(b.default_instance,a,!1,c,h,!1):null};var Q=[];a.prototype.createInstanceFromInit=function(b,a,c,h,d,e){var f,m;if(!b)return null;var g=this.types_by_index[b[1]],k=g.plugin.is_world;if(this.isloading&&k&&!g.isOnLoaderLayout||k&&!this.glwrap&&11===b[0][11])return null;var l=a;k||(a=null);if(g.deadCache.length){var r=g.deadCache.pop();r.recycled=!0;g.plugin.Instance.call(r,g)}else r=new g.plugin.Instance(g),r.recycled=!1;!c||e||this.objectsByUid.hasOwnProperty(b[2].toString())?
r.uid=this.next_uid++:r.uid=b[2];this.objectsByUid[r.uid.toString()]=r;r.puid=this.next_puid++;r.iid=g.instances.length;var t=0;for(f=this.createRow.length;t<f;++t)this.createRow[t].type===g&&r.iid++;r.get_iid=cr.inst_get_iid;r.toString=cr.inst_toString;var w=b[3];if(r.recycled)cr.wipe(r.extra);else{r.extra={};if("undefined"!==typeof cr_is_preview)for(r.instance_var_names=[],r.instance_var_names.length=w.length,t=0,f=w.length;t<f;t++)r.instance_var_names[t]=w[t][1];r.instance_vars=[];r.instance_vars.length=
w.length}t=0;for(f=w.length;t<f;t++)r.instance_vars[t]=w[t][0];if(k){var p=b[0];r.x=cr.is_undefined(h)?p[0]:h;r.y=cr.is_undefined(d)?p[1]:d;r.z=p[2];r.width=p[3];r.height=p[4];r.depth=p[5];r.angle=p[6];r.opacity=p[7];r.hotspotX=p[8];r.hotspotY=p[9];r.blend_mode=p[10];t=p[11];!this.glwrap&&g.effect_types.length&&(r.blend_mode=t);r.compositeOp=cr.effectToCompositeOp(r.blend_mode);this.gl&&cr.setGLBlend(r,r.blend_mode,this.gl);if(r.recycled){t=0;for(f=p[12].length;t<f;t++)for(w=0,m=p[12][t].length;w<
m;w++)r.effect_params[t][w]=p[12][t][w];r.bbox.set(0,0,0,0);r.collcells.set(0,0,-1,-1);r.rendercells.set(0,0,-1,-1);r.bquad.set_from_rect(r.bbox);cr.clearArray(r.bbox_changed_callbacks)}else{r.effect_params=p[12].slice(0);t=0;for(f=r.effect_params.length;t<f;t++)r.effect_params[t]=p[12][t].slice(0);r.active_effect_types=[];r.active_effect_flags=[];r.active_effect_flags.length=g.effect_types.length;r.bbox=new cr.rect(0,0,0,0);r.collcells=new cr.rect(0,0,-1,-1);r.rendercells=new cr.rect(0,0,-1,-1);
r.bquad=new cr.quad;r.bbox_changed_callbacks=[];r.set_bbox_changed=cr.set_bbox_changed;r.add_bbox_changed_callback=cr.add_bbox_changed_callback;r.contains_pt=cr.inst_contains_pt;r.update_bbox=cr.update_bbox;r.update_render_cell=cr.update_render_cell;r.update_collision_cell=cr.update_collision_cell;r.get_zindex=cr.inst_get_zindex}r.tilemap_exists=!1;r.tilemap_width=0;r.tilemap_height=0;r.tilemap_data=null;14===p.length&&(r.tilemap_exists=!0,r.tilemap_width=p[13][0],r.tilemap_height=p[13][1],r.tilemap_data=
p[13][2]);t=0;for(f=g.effect_types.length;t<f;t++)r.active_effect_flags[t]=!0;r.shaders_preserve_opaqueness=!0;r.updateActiveEffects=cr.inst_updateActiveEffects;r.updateActiveEffects();r.uses_shaders=!!r.active_effect_types.length;r.bbox_changed=!0;r.cell_changed=!0;g.any_cell_changed=!0;r.visible=!0;r.my_timescale=-1;r.layer=a;r.zindex=a.instances.length;r.earlyz_index=0;"undefined"===typeof r.collision_poly&&(r.collision_poly=null);this.redraw=r.collisionsEnabled=!0}cr.clearArray(Q);t=0;for(f=g.families.length;t<
f;t++)Q.push.apply(Q,g.families[t].behaviors);Q.push.apply(Q,g.behaviors);if(r.recycled)for(t=0,f=Q.length;t<f;t++){var q=Q[t];var x=r.behavior_insts[t];x.recycled=!0;q.behavior.Instance.call(x,q,r);p=b[4][t];w=0;for(m=p.length;w<m;w++)x.properties[w]=p[w];x.onCreate();q.behavior.my_instances.add(r)}else for(r.behavior_insts=[],t=0,f=Q.length;t<f;t++)q=Q[t],x=new q.behavior.Instance(q,r),x.recycled=!1,x.properties=b[4][t].slice(0),x.onCreate(),cr.seal(x),r.behavior_insts.push(x),q.behavior.my_instances.add(r);
p=b[5];if(r.recycled)for(t=0,f=p.length;t<f;t++)r.properties[t]=p[t];else r.properties=p.slice(0);this.createRow.push(r);this.hasPendingInstances=!0;a&&(a.appendToInstanceList(r,!0),1!==a.parallaxX||1!==a.parallaxY)&&(g.any_instance_parallaxed=!0);this.objectcount++;if(g.is_contained){if(r.is_contained=!0,r.recycled?cr.clearArray(r.siblings):r.siblings=[],!c&&!e){t=0;for(f=g.container.length;t<f;t++)if(g.container[t]!==g){if(!g.container[t].default_instance)return null;r.siblings.push(this.createInstanceFromInit(g.container[t].default_instance,
l,!1,k?r.x:h,k?r.y:d,!0))}t=0;for(f=r.siblings.length;t<f;t++)for(r.siblings[t].siblings.push(r),w=0;w<f;w++)t!==w&&r.siblings[t].siblings.push(r.siblings[w])}}else r.is_contained=!1,r.siblings=null;r.onCreate();r.recycled||cr.seal(r);t=0;for(f=r.behavior_insts.length;t<f;t++)r.behavior_insts[t].postCreate&&r.behavior_insts[t].postCreate();return r};a.prototype.getLayerByName=function(b){var a;var c=0;for(a=this.running_layout.layers.length;c<a;c++){var h=this.running_layout.layers[c];if(cr.equals_nocase(h.name,
b))return h}return null};a.prototype.getLayerByNumber=function(b){b=cr.floor(b);0>b&&(b=0);b>=this.running_layout.layers.length&&(b=this.running_layout.layers.length-1);return this.running_layout.layers[b]};a.prototype.getLayer=function(b){return cr.is_number(b)?this.getLayerByNumber(b):this.getLayerByName(b.toString())};a.prototype.clearSol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].getCurrentSol().select_all=!0};a.prototype.pushCleanSol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].pushCleanSol()};
a.prototype.pushCopySol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].pushCopySol()};a.prototype.popSol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].popSol()};a.prototype.updateAllCells=function(b){if(b.any_cell_changed){var a,c=b.instances;var h=0;for(a=c.length;h<a;++h)c[h].update_collision_cell();c=this.createRow;h=0;for(a=c.length;h<a;++h)c[h].type===b&&c[h].update_collision_cell();b.any_cell_changed=!1}};a.prototype.getCollisionCandidates=function(b,a,c,h){var d,e=b?1!==b.parallaxX||
1!==b.parallaxY:!1;if(a.is_family)for(b=0,d=a.members.length;b<d;++b){var f=a.members[b];e||f.any_instance_parallaxed?cr.appendArray(h,f.instances):(this.updateAllCells(f),f.collision_grid.queryRange(c,h))}else e||a.any_instance_parallaxed?cr.appendArray(h,a.instances):(this.updateAllCells(a),a.collision_grid.queryRange(c,h))};a.prototype.getTypesCollisionCandidates=function(b,a,c,h){var d;var e=0;for(d=a.length;e<d;++e)this.getCollisionCandidates(b,a[e],c,h)};a.prototype.getSolidCollisionCandidates=
function(b,a,c){var h=this.getSolidBehavior();if(!h)return null;this.getTypesCollisionCandidates(b,h.my_types,a,c)};a.prototype.getJumpthruCollisionCandidates=function(b,a,c){var h=this.getJumpthruBehavior();if(!h)return null;this.getTypesCollisionCandidates(b,h.my_types,a,c)};a.prototype.testAndSelectCanvasPointOverlap=function(b,a,c,h){var d=b.getCurrentSol(),e,f=this.getCurrentEventStack().current_event.orblock;if(d.select_all){h||(d.select_all=!1,cr.clearArray(d.instances));var m=0;for(e=b.instances.length;m<
e;m++){var g=b.instances[m];g.update_bbox();var k=g.layer.canvasToLayer(a,c,!0);var l=g.layer.canvasToLayer(a,c,!1);if(g.contains_pt(k,l)){if(h)return!1;d.instances.push(g)}else f&&d.else_instances.push(g)}}else{var r=0;var t=f?d.else_instances:d.instances;m=0;for(e=t.length;m<e;m++)if(g=t[m],g.update_bbox(),k=g.layer.canvasToLayer(a,c,!0),l=g.layer.canvasToLayer(a,c,!1),g.contains_pt(k,l)){if(h)return!1;f?d.instances.push(g):(d.instances[r]=d.instances[m],r++)}h||(t.length=r)}b.applySolToContainer();
return h?!0:d.hasObjects()};a.prototype.testOverlap=function(b,a){if(!(b&&a&&b!==a&&b.collisionsEnabled&&a.collisionsEnabled))return!1;b.update_bbox();a.update_bbox();var c=b.layer,h=a.layer,d;if(c===h||c.parallaxX===h.parallaxX&&h.parallaxY===h.parallaxY&&c.scale===h.scale&&c.angle===h.angle&&c.zoomRate===h.zoomRate){if(!b.bbox.intersects_rect(a.bbox)||!b.bquad.intersects_quad(a.bquad)||b.tilemap_exists&&a.tilemap_exists)return!1;if(b.tilemap_exists)return this.testTilemapOverlap(b,a);if(a.tilemap_exists)return this.testTilemapOverlap(a,
b);var e=b.collision_poly&&!b.collision_poly.is_empty();var f=a.collision_poly&&!a.collision_poly.is_empty();if(!e&&!f)return!0;e?(b.collision_poly.cache_poly(b.width,b.height,b.angle),e=b.collision_poly):(this.temp_poly.set_from_quad(b.bquad,b.x,b.y,b.width,b.height),e=this.temp_poly);if(f){a.collision_poly.cache_poly(a.width,a.height,a.angle);var m=a.collision_poly}else this.temp_poly.set_from_quad(a.bquad,a.x,a.y,a.width,a.height),m=this.temp_poly;return e.intersects_poly(m,a.x-b.x,a.y-b.y)}e=
b.collision_poly&&!b.collision_poly.is_empty();f=a.collision_poly&&!a.collision_poly.is_empty();e?(b.collision_poly.cache_poly(b.width,b.height,b.angle),this.temp_poly.set_from_poly(b.collision_poly)):this.temp_poly.set_from_quad(b.bquad,b.x,b.y,b.width,b.height);e=this.temp_poly;f?(a.collision_poly.cache_poly(a.width,a.height,a.angle),this.temp_poly2.set_from_poly(a.collision_poly)):this.temp_poly2.set_from_quad(a.bquad,a.x,a.y,a.width,a.height);m=this.temp_poly2;f=0;for(d=e.pts_count;f<d;f++){var g=
2*f;var k=g+1;var l=e.pts_cache[g];var r=e.pts_cache[k];e.pts_cache[g]=c.layerToCanvas(l+b.x,r+b.y,!0);e.pts_cache[k]=c.layerToCanvas(l+b.x,r+b.y,!1)}e.update_bbox();f=0;for(d=m.pts_count;f<d;f++)g=2*f,k=g+1,l=m.pts_cache[g],r=m.pts_cache[k],m.pts_cache[g]=h.layerToCanvas(l+a.x,r+a.y,!0),m.pts_cache[k]=h.layerToCanvas(l+a.x,r+a.y,!1);m.update_bbox();return e.intersects_poly(m,0,0)};var B=new cr.quad,I=new cr.rect(0,0,0,0),H=[];a.prototype.testTilemapOverlap=function(b,a){var c,h=a.bbox,d=b.x,e=b.y;
b.getCollisionRectCandidates(h,H);var f=a.collision_poly&&!a.collision_poly.is_empty();b=0;for(c=H.length;b<c;++b){var m=H[b];var g=m.rc;if(h.intersects_rect_off(g,d,e)&&(B.set_from_rect(g),B.offset(d,e),B.intersects_quad(a.bquad)))if(f)if(a.collision_poly.cache_poly(a.width,a.height,a.angle),m.poly){if(m.poly.intersects_poly(a.collision_poly,a.x-(d+g.left),a.y-(e+g.top)))return cr.clearArray(H),!0}else{if(this.temp_poly.set_from_quad(B,0,0,g.right-g.left,g.bottom-g.top),this.temp_poly.intersects_poly(a.collision_poly,
a.x,a.y))return cr.clearArray(H),!0}else if(m.poly){if(this.temp_poly.set_from_quad(a.bquad,0,0,a.width,a.height),m.poly.intersects_poly(this.temp_poly,-(d+g.left),-(e+g.top)))return cr.clearArray(H),!0}else return cr.clearArray(H),!0}cr.clearArray(H);return!1};a.prototype.testRectOverlap=function(b,a){if(!a||!a.collisionsEnabled)return!1;a.update_bbox();if(!a.bbox.intersects_rect(b))return!1;if(a.tilemap_exists){a.getCollisionRectCandidates(b,H);var c,h=a.x,d=a.y;a=0;for(c=H.length;a<c;++a){var e=
H[a];var f=e.rc;if(b.intersects_rect_off(f,h,d))if(e.poly){if(this.temp_poly.set_from_rect(b,0,0),e.poly.intersects_poly(this.temp_poly,-(h+f.left),-(d+f.top)))return cr.clearArray(H),!0}else return cr.clearArray(H),!0}cr.clearArray(H);return!1}B.set_from_rect(b);if(!a.bquad.intersects_quad(B))return!1;if(!a.collision_poly||a.collision_poly.is_empty())return!0;a.collision_poly.cache_poly(a.width,a.height,a.angle);B.offset(-b.left,-b.top);this.temp_poly.set_from_quad(B,0,0,1,1);return a.collision_poly.intersects_poly(this.temp_poly,
b.left-a.x,b.top-a.y)};a.prototype.testSegmentOverlap=function(b,a,c,h,d){if(!d||!d.collisionsEnabled)return!1;d.update_bbox();I.set(cr.min(b,c),cr.min(a,h),cr.max(b,c),cr.max(a,h));if(!d.bbox.intersects_rect(I))return!1;if(d.tilemap_exists){d.getCollisionRectCandidates(I,H);var e,f=d.x,m=d.y;d=0;for(e=H.length;d<e;++d){var g=H[d];var k=g.rc;if(I.intersects_rect_off(k,f,m)&&(B.set_from_rect(k),B.offset(f,m),B.intersects_segment(b,a,c,h)))if(g.poly){if(g.poly.intersects_segment(f+k.left,m+k.top,b,
a,c,h))return cr.clearArray(H),!0}else return cr.clearArray(H),!0}cr.clearArray(H);return!1}if(!d.bquad.intersects_segment(b,a,c,h))return!1;if(!d.collision_poly||d.collision_poly.is_empty())return!0;d.collision_poly.cache_poly(d.width,d.height,d.angle);return d.collision_poly.intersects_segment(d.x,d.y,b,a,c,h)};a.prototype.typeHasBehavior=function(b,a){if(!a)return!1;var c,h;var d=0;for(c=b.behaviors.length;d<c;d++)if(b.behaviors[d].behavior instanceof a)return!0;if(!b.is_family)for(d=0,c=b.families.length;d<
c;d++){var e=b.families[d];var f=0;for(h=e.behaviors.length;f<h;f++)if(e.behaviors[f].behavior instanceof a)return!0}return!1};a.prototype.typeHasNoSaveBehavior=function(b){return this.typeHasBehavior(b,cr.behaviors.NoSave)};a.prototype.typeHasPersistBehavior=function(b){return this.typeHasBehavior(b,cr.behaviors.Persist)};a.prototype.getSolidBehavior=function(){return this.solidBehavior};a.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var L=[];a.prototype.testOverlapSolid=
function(b){var a;b.update_bbox();this.getSolidCollisionCandidates(b.layer,b.bbox,L);var c=0;for(a=L.length;c<a;++c){var h=L[c];if(h.extra.solidEnabled&&this.testOverlap(b,h))return cr.clearArray(L),h}cr.clearArray(L);return null};a.prototype.testRectOverlapSolid=function(b){var a;this.getSolidCollisionCandidates(null,b,L);var c=0;for(a=L.length;c<a;++c){var h=L[c];if(h.extra.solidEnabled&&this.testRectOverlap(b,h))return cr.clearArray(L),h}cr.clearArray(L);return null};var O=[];a.prototype.testOverlapJumpThru=
function(b,a){var c=null;a&&(c=O,cr.clearArray(c));b.update_bbox();this.getJumpthruCollisionCandidates(b.layer,b.bbox,L);var h;var d=0;for(h=L.length;d<h;++d){var e=L[d];if(e.extra.jumpthruEnabled&&this.testOverlap(b,e))if(a)c.push(e);else return cr.clearArray(L),e}cr.clearArray(L);return c};a.prototype.pushOutSolid=function(b,a,c,h,d,e){h=h||50;var f=b.x,m=b.y,g,k=null,l=null;for(g=0;g<h;g++)if(b.x=f+a*g,b.y=m+c*g,b.set_bbox_changed(),!this.testOverlap(b,k)&&((k=this.testOverlapSolid(b))&&(l=k),
!k&&(d&&(k=e?this.testOverlap(b,e)?e:null:this.testOverlapJumpThru(b))&&(l=k),!k)))return l&&this.pushInFractional(b,a,c,l,16),!0;b.x=f;b.y=m;b.set_bbox_changed();return!1};a.prototype.pushOutSolidAxis=function(b,a,c,h){h=h||50;var d=b.x,e=b.y,f=null,m=null,g,k;for(g=0;g<h;++g)for(k=0;2>k;++k){var l=2*k-1;b.x=d+a*g*l;b.y=e+c*g*l;b.set_bbox_changed();if(!this.testOverlap(b,f))if(f=this.testOverlapSolid(b))m=f;else return m&&this.pushInFractional(b,a*l,c*l,m,16),!0}b.x=d;b.y=e;b.set_bbox_changed();
return!1};a.prototype.pushOut=function(b,a,c,h,d){h=h||50;var e=b.x,f=b.y,m;for(m=0;m<h;m++)if(b.x=e+a*m,b.y=f+c*m,b.set_bbox_changed(),!this.testOverlap(b,d))return!0;b.x=e;b.y=f;b.set_bbox_changed();return!1};a.prototype.pushInFractional=function(b,a,c,h,d){var e=2,f=!1;var m=!1;for(var g=b.x,k=b.y;e<=d;)m=1/e,e*=2,b.x+=a*m*(f?1:-1),b.y+=c*m*(f?1:-1),b.set_bbox_changed(),this.testOverlap(b,h)?m=f=!0:(m=f=!1,g=b.x,k=b.y);m&&(b.x=g,b.y=k,b.set_bbox_changed())};a.prototype.pushOutSolidNearest=function(b,
a){a=cr.is_undefined(a)?100:a;var c=0,h=b.x,d=b.y,e=0,f=0,m=0,g=this.testOverlapSolid(b);if(!g)return!0;for(;c<=a;){switch(e){case 0:f=0;m=-1;c++;break;case 1:f=1;m=-1;break;case 2:f=1;m=0;break;case 3:m=f=1;break;case 4:f=0;m=1;break;case 5:f=-1;m=1;break;case 6:f=-1;m=0;break;case 7:m=f=-1}e=(e+1)%8;b.x=cr.floor(h+f*c);b.y=cr.floor(d+m*c);b.set_bbox_changed();if(!this.testOverlap(b,g)&&(g=this.testOverlapSolid(b),!g))return!0}b.x=h;b.y=d;b.set_bbox_changed();return!1};a.prototype.registerCollision=
function(b,a){b.collisionsEnabled&&a.collisionsEnabled&&this.registered_collisions.push([b,a])};a.prototype.addRegisteredCollisionCandidates=function(b,a,c){var h;var d=0;for(h=this.registered_collisions.length;d<h;++d){var e=this.registered_collisions[d];if(e[0]===b)e=e[1];else if(e[1]===b)e=e[0];else continue;if(a.is_family){if(-1===a.members.indexOf(a))continue}else if(e.type!==a)continue;-1===c.indexOf(e)&&c.push(e)}};a.prototype.checkRegisteredCollision=function(b,a){var c;var h=0;for(c=this.registered_collisions.length;h<
c;h++){var d=this.registered_collisions[h];if(d[0]===b&&d[1]===a||d[0]===a&&d[1]===b)return!0}return!1};a.prototype.calculateSolidBounceAngle=function(b,a,c,h){var d=b.x,e=b.y,f=cr.max(10,cr.distanceTo(a,c,d,e)),m=cr.angleTo(a,c,d,e),g=h||this.testOverlapSolid(b);if(!g)return cr.clamp_angle(m+cr.PI);var k=g,l,r=cr.to_radians(5);for(l=1;36>l;l++){var t=m-l*r;b.x=a+Math.cos(t)*f;b.y=c+Math.sin(t)*f;b.set_bbox_changed();if(!this.testOverlap(b,k)&&(k=h?null:this.testOverlapSolid(b),!k)){var w=t;break}}36===
l&&(w=cr.clamp_angle(m+cr.PI));k=g;for(l=1;36>l;l++)if(t=m+l*r,b.x=a+Math.cos(t)*f,b.y=c+Math.sin(t)*f,b.set_bbox_changed(),!this.testOverlap(b,k)&&(k=h?null:this.testOverlapSolid(b),!k)){var p=t;break}36===l&&(p=cr.clamp_angle(m+cr.PI));b.x=d;b.y=e;b.set_bbox_changed();if(p===w)return p;b=cr.angleDiff(p,w)/2;b=cr.angleClockwise(p,w)?cr.clamp_angle(w+b+cr.PI):cr.clamp_angle(p+b);w=Math.cos(m);m=Math.sin(m);p=Math.cos(b);b=Math.sin(b);a=w*p+m*b;return cr.angleTo(0,0,w-2*a*p,m-2*a*b)};var S=-1;a.prototype.trigger=
function(b,a,c){if(!this.running_layout)return!1;var h=this.running_layout.event_sheet;if(!h)return!1;var d=!1,e;S++;var f=h.deep_includes;var m=0;for(e=f.length;m<e;++m){var g=this.triggerOnSheet(b,a,f[m],c);d=d||g}g=this.triggerOnSheet(b,a,h,c);S--;return d||g};a.prototype.triggerOnSheet=function(b,a,c,h){var d=!1,e;if(a){var f=this.triggerOnSheetForTypeName(b,a,a.type.name,c,h);d=d||f;var m=a.type.families;var g=0;for(e=m.length;g<e;++g)f=this.triggerOnSheetForTypeName(b,a,m[g].name,c,h),d=d||
f}else f=this.triggerOnSheetForTypeName(b,a,"system",c,h),d=d||f;return d};a.prototype.triggerOnSheetForTypeName=function(b,a,c,h,d){var e,f=!1;var m="undefined"!==typeof d;var g=(m?h.fasttriggers:h.triggers)[c];if(!g)return f;var k=null;h=0;for(e=g.length;h<e;++h)if(g[h].method==b){k=g[h].evs;break}if(!k)return f;b=m?k[d]:k;if(!b)return null;h=0;for(e=b.length;h<e;h++)d=b[h][0],m=b[h][1],d=this.executeSingleTrigger(a,c,d,m),f=f||d;return f};a.prototype.executeSingleTrigger=function(b,a,c,h){var d,
e=!1;this.trigger_depth++;var f=this.getCurrentEventStack().current_event;f&&this.pushCleanSol(f.solModifiersIncludingParents);var m=1<this.trigger_depth;this.pushCleanSol(c.solModifiersIncludingParents);m&&this.pushLocalVarStack();var g=this.pushEventStack(c);g.current_event=c;if(b){var k=this.types[a].getCurrentSol();k.select_all=!1;cr.clearArray(k.instances);k.instances[0]=b;this.types[a].applySolToContainer()}b=!0;if(c.parent){a=g.temp_parents_arr;for(k=c.parent;k;)a.push(k),k=k.parent;a.reverse();
k=0;for(d=a.length;k<d;k++)if(!a[k].run_pretrigger()){b=!1;break}}b&&(this.execcount++,c.orblock?c.run_orblocktrigger(h):c.run(),e=e||g.last_event_true);this.popEventStack();m&&this.popLocalVarStack();this.popSol(c.solModifiersIncludingParents);f&&this.popSol(f.solModifiersIncludingParents);this.hasPendingInstances&&0===this.isInOnDestroy&&0===S&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return e};a.prototype.getCurrentCondition=function(){var b=this.getCurrentEventStack();
return b.current_event.conditions[b.cndindex]};a.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};a.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};a.prototype.getCurrentAction=function(){var b=this.getCurrentEventStack();return b.current_event.actions[b.actindex]};a.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};
a.prototype.popLocalVarStack=function(){this.localvar_stack_index--};a.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};a.prototype.pushEventStack=function(b){this.event_stack_index++;this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var a=this.getCurrentEventStack();a.reset(b);return a};a.prototype.popEventStack=function(){this.event_stack_index--};a.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};
a.prototype.pushLoopStack=function(b){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:b,index:0,stopped:!1}));var a=this.getCurrentLoop();a.name=b;a.index=0;a.stopped=!1;return a};a.prototype.popLoopStack=function(){this.loop_stack_index--};a.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]};a.prototype.getEventVariableByName=function(b,a){for(var c,h,d,e,f;a;){c=0;for(h=a.subevents.length;c<h;c++)if(f=a.subevents[c],
f instanceof cr.eventvariable&&cr.equals_nocase(b,f.name))return f;a=a.parent}c=0;for(h=this.eventsheets_by_index.length;c<h;c++)for(e=this.eventsheets_by_index[c],a=0,d=e.events.length;a<d;a++)if(f=e.events[a],f instanceof cr.eventvariable&&cr.equals_nocase(b,f.name))return f;return null};a.prototype.getLayoutBySid=function(b){var a;var c=0;for(a=this.layouts_by_index.length;c<a;c++)if(this.layouts_by_index[c].sid===b)return this.layouts_by_index[c];return null};a.prototype.getObjectTypeBySid=function(b){var a;
var c=0;for(a=this.types_by_index.length;c<a;c++)if(this.types_by_index[c].sid===b)return this.types_by_index[c];return null};a.prototype.getGroupBySid=function(b){var a;var c=0;for(a=this.allGroups.length;c<a;c++)if(this.allGroups[c].sid===b)return this.allGroups[c];return null};a.prototype.doCanvasSnapshot=function(b,a){this.snapshotCanvas=[b,a];this.redraw=!0};a.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};a.prototype.handleSaveLoad=function(){var b=this,a=this.saveToSlot,
h=this.lastSaveJson,f=this.loadFromSlot,m=!1;this.signalledContinuousPreview&&(m=!0,a="__c2_continuouspreview",this.signalledContinuousPreview=!1);if(a.length){this.ClearDeathRow();h=this.saveToJSONString();if(g()&&!this.isCocoonJs)e(a,h,function(){cr.logexport("Saved state to IndexedDB storage ("+h.length+" bytes)");b.lastSaveJson=h;b.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null);h=b.lastSaveJson="";m&&d()},function(c){try{localStorage.setItem("__c2save_"+a,h),cr.logexport("Saved state to WebStorage ("+
h.length+" bytes)"),b.lastSaveJson=h,b.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),h=b.lastSaveJson="",m&&d()}catch(R){cr.logexport("Failed to save game state: "+c+"; "+R),b.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+a,h),cr.logexport("Saved state to WebStorage ("+h.length+" bytes)"),b.lastSaveJson=h,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),h=b.lastSaveJson="",m&&d()}catch(U){cr.logexport("Error saving to WebStorage: "+
U),b.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(f.length){if(g()&&!this.isCocoonJs)c(f,function(a){a?(b.loadFromJson=a,cr.logexport("Loaded state from IndexedDB storage ("+b.loadFromJson.length+" bytes)")):(b.loadFromJson=localStorage.getItem("__c2save_"+f)||"",cr.logexport("Loaded state from WebStorage ("+b.loadFromJson.length+" bytes)"));b.suspendDrawing=!1;b.loadFromJson||(b.loadFromJson=null,b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,
null))},function(a){b.loadFromJson=localStorage.getItem("__c2save_"+f)||"";cr.logexport("Loaded state from WebStorage ("+b.loadFromJson.length+" bytes)");b.suspendDrawing=!1;b.loadFromJson||(b.loadFromJson=null,b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});else{try{this.loadFromJson=localStorage.getItem("__c2save_"+f)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(U){this.loadFromJson=null}this.suspendDrawing=!1;b.loadFromJson||(b.loadFromJson=
null,b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,null),this.lastSaveJson=""):b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)};a.prototype.saveToJSONString=function(){var a,c,h,d={c2save:!0,version:1,rt:{time:this.kahanTime.sum,
walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var e=0;for(a=this.types_by_index.length;e<a;e++){var f=this.types_by_index[e];if(!f.is_family&&!this.typeHasNoSaveBehavior(f)){var m={instances:[]};cr.hasAnyOwnProperty(f.extra)&&(m.ex=b(f.extra));var g=0;for(c=f.instances.length;g<
c;g++)m.instances.push(this.saveInstanceToJSON(f.instances[g]));d.types[f.sid.toString()]=m}}e=0;for(a=this.layouts_by_index.length;e<a;e++)g=this.layouts_by_index[e],d.layouts[g.sid.toString()]=g.saveToJSON();c=d.events.groups;e=0;for(a=this.allGroups.length;e<a;e++)g=this.allGroups[e],c[g.sid.toString()]=this.groups_by_name[g.group_name].group_active;a=d.events.cnds;for(h in this.cndsBySid)this.cndsBySid.hasOwnProperty(h)&&(e=this.cndsBySid[h],cr.hasAnyOwnProperty(e.extra)&&(a[h]={ex:b(e.extra)}));
a=d.events.acts;for(h in this.actsBySid)this.actsBySid.hasOwnProperty(h)&&(e=this.actsBySid[h],cr.hasAnyOwnProperty(e.extra)&&(a[h]={ex:b(e.extra)}));a=d.events.vars;for(h in this.varsBySid)this.varsBySid.hasOwnProperty(h)&&(e=this.varsBySid[h],e.is_constant||e.parent&&!e.is_static||(a[h]=e.data));d.system=this.system.saveToJSON();return JSON.stringify(d)};a.prototype.refreshUidMap=function(){var b,a;this.objectsByUid={};var c=0;for(b=this.types_by_index.length;c<b;c++){var h=this.types_by_index[c];
if(!h.is_family){var d=0;for(a=h.instances.length;d<a;d++){var e=h.instances[d];this.objectsByUid[e.uid.toString()]=e}}}};a.prototype.loadFromJSONString=function(b){try{var a=JSON.parse(b)}catch(W){return!1}if(!a.c2save||1<a.version)return!1;this.isLoadingState=!0;b=a.rt;this.kahanTime.reset();this.kahanTime.sum=b.time;this.wallTime.reset();this.wallTime.sum=b.walltime||0;this.timescale=b.timescale;this.tickcount=b.tickcount;this.execcount=b.execcount;this.start_time=Date.now()-b.start_time_offset;
var c=b.running_layout;if(c!==this.running_layout.sid)if(c=this.getLayoutBySid(c))this.doChangeLayout(c);else return;var h,d,e;var f=a.types;for(d in f)if(f.hasOwnProperty(d)&&(e=this.getObjectTypeBySid(parseInt(d,10)))&&!e.is_family&&!this.typeHasNoSaveBehavior(e)){f[d].ex?e.extra=f[d].ex:cr.wipe(e.extra);var m=e.instances;var g=f[d].instances;c=0;for(h=cr.min(m.length,g.length);c<h;c++)this.loadInstanceFromJSON(m[c],g[c]);c=g.length;for(h=m.length;c<h;c++)this.DestroyInstance(m[c]);c=m.length;for(h=
g.length;c<h;c++){m=null;if(e.plugin.is_world&&(m=this.running_layout.getLayerBySid(g[c].w.l),!m))continue;m=this.createInstanceFromInit(e.default_instance,m,!1,0,0,!0);this.loadInstanceFromJSON(m,g[c])}e.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();h=a.layouts;for(d in h)h.hasOwnProperty(d)&&(c=this.getLayoutBySid(parseInt(d,10)))&&c.loadFromJSON(h[d]);h=a.events.groups;for(d in h)h.hasOwnProperty(d)&&(c=this.getGroupBySid(parseInt(d,10)))&&this.groups_by_name[c.group_name]&&this.groups_by_name[c.group_name].setGroupActive(h[d]);
c=a.events.cnds;for(d in this.cndsBySid)this.cndsBySid.hasOwnProperty(d)&&(c.hasOwnProperty(d)?this.cndsBySid[d].extra=c[d].ex:this.cndsBySid[d].extra={});c=a.events.acts;for(d in this.actsBySid)this.actsBySid.hasOwnProperty(d)&&(c.hasOwnProperty(d)?this.actsBySid[d].extra=c[d].ex:this.actsBySid[d].extra={});c=a.events.vars;for(d in c)c.hasOwnProperty(d)&&this.varsBySid.hasOwnProperty(d)&&(this.varsBySid[d].data=c[d]);this.next_uid=b.next_uid;this.isLoadingState=!1;c=0;for(h=this.fireOnCreateAfterLoad.length;c<
h;++c)m=this.fireOnCreateAfterLoad[c],this.trigger(Object.getPrototypeOf(m.type.plugin).cnds.OnCreated,m);cr.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(a.system);c=0;for(h=this.types_by_index.length;c<h;c++)if(e=this.types_by_index[c],!e.is_family&&!this.typeHasNoSaveBehavior(e))for(a=0,d=e.instances.length;a<d;a++){m=e.instances[a];if(e.is_contained)for(f=m.get_iid(),cr.clearArray(m.siblings),b=0,g=e.container.length;b<g;b++){var k=e.container[b];e!==k&&m.siblings.push(k.instances[f])}m.afterLoad&&
m.afterLoad();if(m.behavior_insts)for(b=0,g=m.behavior_insts.length;b<g;b++)f=m.behavior_insts[b],f.afterLoad&&f.afterLoad()}return this.redraw=!0};a.prototype.saveInstanceToJSON=function(a,c){var h;var d=a.type;var e=d.plugin;var f={};c?f.c2=!0:f.uid=a.uid;cr.hasAnyOwnProperty(a.extra)&&(f.ex=b(a.extra));if(a.instance_vars&&a.instance_vars.length)for(f.ivs={},c=0,h=a.instance_vars.length;c<h;c++)f.ivs[a.type.instvar_sids[c].toString()]=a.instance_vars[c];if(e.is_world){e={x:a.x,y:a.y,w:a.width,h:a.height,
l:a.layer.sid,zi:a.get_zindex()};0!==a.angle&&(e.a=a.angle);1!==a.opacity&&(e.o=a.opacity);.5!==a.hotspotX&&(e.hX=a.hotspotX);.5!==a.hotspotY&&(e.hY=a.hotspotY);0!==a.blend_mode&&(e.bm=a.blend_mode);a.visible||(e.v=a.visible);a.collisionsEnabled||(e.ce=a.collisionsEnabled);-1!==a.my_timescale&&(e.mts=a.my_timescale);if(d.effect_types.length)for(e.fx=[],c=0,h=d.effect_types.length;c<h;c++){var m=d.effect_types[c];e.fx.push({name:m.name,active:a.active_effect_flags[m.index],params:a.effect_params[m.index]})}f.w=
e}if(a.behavior_insts&&a.behavior_insts.length)for(f.behs={},c=0,h=a.behavior_insts.length;c<h;c++)d=a.behavior_insts[c],d.saveToJSON&&(f.behs[d.type.sid.toString()]=d.saveToJSON());a.saveToJSON&&(f.data=a.saveToJSON());return f};a.prototype.getInstanceVarIndexBySid=function(b,a){var c;var h=0;for(c=b.instvar_sids.length;h<c;h++)if(b.instvar_sids[h]===a)return h;return-1};a.prototype.getBehaviorIndexBySid=function(b,a){var c;var h=0;for(c=b.behavior_insts.length;h<c;h++)if(b.behavior_insts[h].type.sid===
a)return h;return-1};a.prototype.loadInstanceFromJSON=function(b,a,c){var h,d;var e=b.type;var f=e.plugin;if(c){if(!a.c2)return}else b.uid=a.uid;a.ex?b.extra=a.ex:cr.wipe(b.extra);if(d=a.ivs)for(h in d)if(d.hasOwnProperty(h)){var m=this.getInstanceVarIndexBySid(e,parseInt(h,10));if(!(0>m||m>=b.instance_vars.length)){var g=d[h];null===g&&(g=NaN);b.instance_vars[m]=g}}if(f.is_world){m=a.w;b.layer.sid!==m.l&&(d=b.layer,b.layer=this.running_layout.getLayerBySid(m.l),b.layer?(d.removeFromInstanceList(b,
!0),b.layer.appendToInstanceList(b,!0),b.set_bbox_changed(),b.layer.setZIndicesStaleFrom(0)):(b.layer=d,c||this.DestroyInstance(b)));b.x=m.x;b.y=m.y;b.width=m.w;b.height=m.h;b.zindex=m.zi;b.angle=m.hasOwnProperty("a")?m.a:0;b.opacity=m.hasOwnProperty("o")?m.o:1;b.hotspotX=m.hasOwnProperty("hX")?m.hX:.5;b.hotspotY=m.hasOwnProperty("hY")?m.hY:.5;b.visible=m.hasOwnProperty("v")?m.v:!0;b.collisionsEnabled=m.hasOwnProperty("ce")?m.ce:!0;b.my_timescale=m.hasOwnProperty("mts")?m.mts:-1;b.blend_mode=m.hasOwnProperty("bm")?
m.bm:0;b.compositeOp=cr.effectToCompositeOp(b.blend_mode);this.gl&&cr.setGLBlend(b,b.blend_mode,this.gl);b.set_bbox_changed();if(m.hasOwnProperty("fx"))for(c=0,d=m.fx.length;c<d;c++)g=e.getEffectIndexByName(m.fx[c].name),0>g||(b.active_effect_flags[g]=m.fx[c].active,b.effect_params[g]=m.fx[c].params);b.updateActiveEffects()}if(e=a.behs)for(h in e)e.hasOwnProperty(h)&&(c=this.getBehaviorIndexBySid(b,parseInt(h,10)),0>c||b.behavior_insts[c].loadFromJSON(e[h]));a.data&&b.loadFromJSON(a.data)};a.prototype.fetchLocalFileViaCordova=
function(b,a,c){window.resolveLocalFileSystemURL(cordova.file.applicationDirectory+"www/"+b,function(b){b.file(a,c)},c)};a.prototype.fetchLocalFileViaCordovaAsText=function(b,a,c){this.fetchLocalFileViaCordova(b,function(b){var h=new FileReader;h.onload=function(b){a(b.target.result)};h.onerror=c;h.readAsText(b)},c)};var J=[],G=0;a.prototype.maybeStartNextArrayBufferRead=function(){if(J.length&&!(8<=G)){G++;var b=J.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(b.filename,b.successCallback,
b.errorCallback)}};a.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(b,a,c){var h=this;J.push({filename:b,successCallback:function(b){G--;h.maybeStartNextArrayBufferRead();a(b)},errorCallback:function(b){G--;h.maybeStartNextArrayBufferRead();c(b)}});this.maybeStartNextArrayBufferRead()};a.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(b,a,c){this.fetchLocalFileViaCordova(b,function(b){var c=new FileReader;c.onload=function(b){a(b.target.result)};c.readAsArrayBuffer(b)},c)};a.prototype.fetchLocalFileViaCordovaAsURL=
function(b,a,c){var h="",d=b.toLowerCase(),e=d.substr(d.length-4);d=d.substr(d.length-5);".mp4"===e?h="video/mp4":".webm"===d?h="video/webm":".m4a"===e?h="audio/mp4":".mp3"===e&&(h="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(b,function(b){b=new Blob([b],{type:h});b=URL.createObjectURL(b);a(b)},c)};a.prototype.isAbsoluteUrl=function(b){return/^(?:[a-z]+:)?\/\//.test(b)||"data:"===b.substr(0,5)||"blob:"===b.substr(0,5)};a.prototype.setImageSrc=function(b,a){this.isWKWebView&&!this.isAbsoluteUrl(a)?
this.fetchLocalFileViaCordovaAsURL(a,function(a){b.src=a},function(b){alert("Failed to load image: "+b)}):b.src=a};a.prototype.setCtxImageSmoothingEnabled=function(b,a){"undefined"!==typeof b.imageSmoothingEnabled?b.imageSmoothingEnabled=a:(b.webkitImageSmoothingEnabled=a,b.mozImageSmoothingEnabled=a,b.msImageSmoothingEnabled=a)};cr.runtime=a;cr.createRuntime=function(b){return new a(document.getElementById(b))};cr.createDCRuntime=function(b,c){return new a({dc:!0,width:b,height:c})};window.cr_createRuntime=
cr.createRuntime;window.cr_createDCRuntime=cr.createDCRuntime;window.createCocoonJSRuntime=function(){window.c2cocoonjs=!0;var b=document.createElement("screencanvas")||document.createElement("canvas");b.screencanvas=!0;document.body.appendChild(b);b=new a(b);window.c2runtime=b;window.addEventListener("orientationchange",function(){window.c2runtime.setSize(window.innerWidth,window.innerHeight)});window.c2runtime.setSize(window.innerWidth,window.innerHeight);return b};window.createEjectaRuntime=function(){var b=
document.getElementById("canvas");b=new a(b);window.c2runtime=b;window.c2runtime.setSize(window.innerWidth,window.innerHeight);return b}})();window.cr_getC2Runtime=function(){var a=document.getElementById("c2canvas");return a?a.c2runtime:window.c2runtime?window.c2runtime:null};window.cr_getSnapshot=function(a,f){var g=window.cr_getC2Runtime();g&&g.doCanvasSnapshot(a,f)};window.cr_sizeCanvas=function(a,f){if(0!==a&&0!==f){var g=window.cr_getC2Runtime();g&&g.setSize(a,f)}};
window.cr_setSuspended=function(a){var f=window.cr_getC2Runtime();f&&f.setSuspended(a)};
(function(){function a(b,a){this.runtime=b;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=a[0];this.originalWidth=a[1];this.originalHeight=a[2];this.width=a[1];this.height=a[2];this.unbounded_scrolling=a[3];this.sheetname=a[4];this.sid=a[5];var c=a[6],h;this.layers=[];this.initial_types=[];b=0;for(h=c.length;b<h;b++){var d=new cr.layer(this,c[b]);d.number=b;cr.seal(d);this.layers.push(d)}c=
a[7];this.initial_nonworld=[];b=0;for(h=c.length;b<h;b++){d=c[b];var e=this.runtime.types_by_index[d[1]];e.default_instance||(e.default_instance=d);this.initial_nonworld.push(d);-1===this.initial_types.indexOf(e)&&this.initial_types.push(e)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];b=0;for(h=a[8].length;b<h;b++)this.effect_types.push({id:a[8][b][0],name:a[8][b][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:b}),this.effect_params.push(a[8][b][2].slice(0));
this.updateActiveEffects();this.rcTex=new cr.rect(0,0,1,1);this.rcTex2=new cr.rect(0,0,1,1);this.persist_data={}}function f(b,a){return b.zindex-a.zindex}function g(b,a){this.layout=b;this.runtime=b.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr.rect(0,0,0,0);this.tmpquad=new cr.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=a[0];this.index=a[1];this.sid=
a[2];this.visible=a[3];this.background_color=a[4];this.transparent=a[5];this.parallaxX=a[6];this.parallaxY=a[7];this.opacity=a[8];this.forceOwnTexture=a[9];this.useRenderCells=a[10];this.zoomRate=a[11];this.blend_mode=a[12];this.effect_fallback=a[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=k();this.render_list_stale=!0;this.last_render_cells=new cr.rect(0,0,-1,-1);this.cur_render_cells=new cr.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=
new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=!1;b=a[14];var c;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var h=0;for(c=b.length;h<c;h++){var d=b[h],e=this.runtime.types_by_index[d[1]];e.default_instance||(e.default_instance=d,e.default_layerindex=this.index);this.initial_instances.push(d);-1===this.layout.initial_types.indexOf(e)&&this.layout.initial_types.push(e)}cr.shallowAssignArray(this.startup_initial_instances,
this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];h=0;for(c=a[15].length;h<c;h++)this.effect_types.push({id:a[15][h][0],name:a[15][h][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:h}),this.effect_params.push(a[15][h][2].slice(0));this.updateActiveEffects();this.rcTex=new cr.rect(0,0,1,1);this.rcTex2=new cr.rect(0,0,1,1)}function k(){return l.length?l.pop():[]}function e(b){cr.clearArray(b);l.push(b)}a.prototype.saveObjectToPersist=
function(b){var a=b.type.sid.toString();this.persist_data.hasOwnProperty(a)||(this.persist_data[a]=[]);this.persist_data[a].push(this.runtime.saveInstanceToJSON(b))};a.prototype.hasOpaqueBottomLayer=function(){var b=this.layers[0];return!b.transparent&&1===b.opacity&&!b.forceOwnTexture&&b.visible};a.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var b;var a=0;for(b=this.effect_types.length;a<b;a++){var c=this.effect_types[a];c.active&&
(this.active_effect_types.push(c),c.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};a.prototype.getEffectByName=function(b){var a;var c=0;for(a=this.effect_types.length;c<a;c++){var h=this.effect_types[c];if(h.name===b)return h}return null};var c=[],d=!0;a.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;
this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;var b,a;var e=0;for(b=this.runtime.types_by_index.length;e<b;e++){var g=this.runtime.types_by_index[e];if(!g.is_family){var k=g.instances;g=0;for(a=k.length;g<a;g++){var l=k[g];if(l.layer){var q=l.layer.number;q>=this.layers.length&&(q=this.layers.length-1);l.layer=this.layers[q];-1===l.layer.instances.indexOf(l)&&l.layer.instances.push(l);l.layer.zindices_stale=!0}}}}if(!d)for(e=0,b=this.layers.length;e<b;++e)this.layers[e].instances.sort(f);
cr.clearArray(c);this.boundScrolling();e=0;for(b=this.layers.length;e<b;e++)l=this.layers[e],l.createInitialInstances(),l.updateViewport(null);k=!1;if(!this.first_visit){for(x in this.persist_data)if(this.persist_data.hasOwnProperty(x)&&(g=this.runtime.getObjectTypeBySid(parseInt(x,10)))&&!g.is_family&&this.runtime.typeHasPersistBehavior(g)){a=this.persist_data[x];e=0;for(b=a.length;e<b;e++){l=null;if(g.plugin.is_world&&(l=this.getLayerBySid(a[e].w.l),!l))continue;l=this.runtime.createInstanceFromInit(g.default_instance,
l,!1,0,0,!0);this.runtime.loadInstanceFromJSON(l,a[e]);k=!0;c.push(l)}cr.clearArray(a)}e=0;for(b=this.layers.length;e<b;e++)this.layers[e].instances.sort(f),this.layers[e].zindices_stale=!0}k&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());for(e=0;e<c.length;e++)if(l=c[e],l.type.is_contained)for(b=l.get_iid(),g=0,a=l.type.container.length;g<a;g++){var x=l.type.container[g];l.type!==x&&(x.instances.length>b?l.siblings.push(x.instances[b]):x.default_instance&&(k=this.runtime.createInstanceFromInit(x.default_instance,
l.layer,!0,l.x,l.y,!0),this.runtime.ClearDeathRow(),x.updateIIDs(),l.siblings.push(k),c.push(k)))}e=0;for(b=this.initial_nonworld.length;e<b;e++)l=this.initial_nonworld[e],g=this.runtime.types_by_index[l[1]],g.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[e],null,!0);this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx&&!this.runtime.isDomFree)for(e=0,b=this.runtime.types_by_index.length;e<b;e++)x=this.runtime.types_by_index[e],!x.is_family&&x.instances.length&&
x.preloadCanvas2D&&x.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,c);else for(e=0,b=c.length;e<b;e++)l=c[e],this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated,l);cr.clearArray(c);this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};a.prototype.createGlobalNonWorlds=function(){var b,a;var c=b=0;for(a=this.initial_nonworld.length;b<
a;b++){var d=this.initial_nonworld[b];var e=this.runtime.types_by_index[d[1]];e.global?e.is_contained||this.runtime.createInstanceFromInit(d,null,!0):(this.initial_nonworld[c]=d,c++)}cr.truncateArray(this.initial_nonworld,c)};a.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=!0;cr.clearArray(this.runtime.system.waits);var b,a;if(!this.first_visit){var c=0;for(b=this.layers.length;c<b;c++){this.layers[c].updateZIndices();
var e=this.layers[c].instances;var f=0;for(a=e.length;f<a;f++){var g=e[f];g.type.global||this.runtime.typeHasPersistBehavior(g.type)&&this.saveObjectToPersist(g)}}}c=0;for(b=this.layers.length;c<b;c++){e=this.layers[c].instances;f=0;for(a=e.length;f<a;f++)g=e[f],g.type.global||this.runtime.DestroyInstance(g);this.runtime.ClearDeathRow();cr.clearArray(e);this.layers[c].zindices_stale=!0}c=0;for(b=this.runtime.types_by_index.length;c<b;c++)if(e=this.runtime.types_by_index[c],!(e.global||e.plugin.is_world||
e.plugin.singleglobal||e.is_family)){f=0;for(a=e.instances.length;f<a;f++)this.runtime.DestroyInstance(e.instances[f]);this.runtime.ClearDeathRow()}d=!1;this.runtime.isEndingLayout=!1};var b=new cr.rect(0,0,0,0);a.prototype.recreateInitialObjects=function(a,c,d,e,f){b.set(c,d,e,f);c=0;for(d=this.layers.length;c<d;c++)this.layers[c].recreateInitialObjects(a,b)};a.prototype.draw=function(b){var a=b,c=!1,h=!this.runtime.fullscreenScalingQuality;if(h){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=
document.createElement("canvas");var d=this.runtime.layout_canvas;d.width=this.runtime.draw_width;d.height=this.runtime.draw_height;this.runtime.layout_ctx=d.getContext("2d");c=!0}d=this.runtime.layout_canvas;a=this.runtime.layout_ctx;d.width!==this.runtime.draw_width&&(d.width=this.runtime.draw_width,c=!0);d.height!==this.runtime.draw_height&&(d.height=this.runtime.draw_height,c=!0);c&&this.runtime.setCtxImageSmoothingEnabled(a,this.runtime.linearSampling)}a.globalAlpha=1;a.globalCompositeOperation=
"source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&a.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);var e;c=0;for(e=this.layers.length;c<e;c++){var f=this.layers[c];f.visible&&0<f.opacity&&11!==f.blend_mode&&(f.instances.length||!f.transparent)?f.draw(a):f.updateViewport(null)}h&&b.drawImage(d,0,0,this.runtime.width,this.runtime.height)};a.prototype.drawGL_earlyZPass=function(b){b.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,
this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||b.setSize(this.runtime.draw_width,this.runtime.draw_height);var a;for(a=
this.layers.length-1;0<=a;--a){var c=this.layers[a];c.visible&&1===c.opacity&&c.shaders_preserve_opaqueness&&0===c.blend_mode&&(c.instances.length||!c.transparent)?c.drawGL_earlyZPass(b):c.updateViewport(null)}b.setEarlyZPass(!1)};a.prototype.drawGL=function(b){var a=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;if(a){this.runtime.layout_tex||(this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,
this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||b.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&
(b.setRenderingToTexture(null),b.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&b.clear(0,0,0,0);var c;var h=0;for(c=this.layers.length;h<c;h++){var d=this.layers[h];d.visible&&0<d.opacity&&(d.instances.length||!d.transparent)?d.drawGL(b):d.updateViewport(null)}a&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(a=this.active_effect_types[0].index,
b.switchProgram(this.active_effect_types[0].shaderindex),b.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,this.scale,this.angle,0,0,this.runtime.draw_width/2,this.runtime.draw_height/2,this.runtime.kahanTime.sum,this.effect_params[a]),b.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):b.switchProgram(0),this.runtime.fullscreenScalingQuality||b.setSize(this.runtime.width,this.runtime.height),b.setRenderingToTexture(null),
b.setDepthTestEnabled(!1),b.setOpacity(1),b.setTexture(this.runtime.layout_tex),b.setAlphaBlend(),b.resetModelView(),b.updateModelView(),a=this.runtime.width/2,h=this.runtime.height/2,b.quad(-a,h,a,h,a,-h,-a,-h),b.setTexture(null),b.setDepthTestEnabled(!0)):this.renderEffectChain(b,null,null,null))};a.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:
null};a.prototype.getMinLayerScale=function(){var b=this.layers[0].getScale(),a;var c=1;for(a=this.layers.length;c<a;c++){var d=this.layers[c];(0!==d.parallaxX||0!==d.parallaxY)&&d.getScale()<b&&(b=d.getScale())}return b};a.prototype.scrollToX=function(b){if(!this.unbounded_scrolling){var a=this.runtime.draw_width*(1/this.getMinLayerScale())/2;b>this.width-a&&(b=this.width-a);b<a&&(b=a)}this.scrollX!==b&&(this.scrollX=b,this.runtime.redraw=!0)};a.prototype.scrollToY=function(b){if(!this.unbounded_scrolling){var a=
this.runtime.draw_height*(1/this.getMinLayerScale())/2;b>this.height-a&&(b=this.height-a);b<a&&(b=a)}this.scrollY!==b&&(this.scrollY=b,this.runtime.redraw=!0)};a.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};a.prototype.renderEffectChain=function(b,a,c,d){var h=c?c.active_effect_types:a?a.active_effect_types:this.active_effect_types,e=1,f=0,g=0,m=0,k=this.runtime.draw_width,l=this.runtime.draw_height;c?(e=c.layer.getScale(),f=c.layer.getAngle(),g=c.layer.viewLeft,
m=c.layer.viewTop,k=c.layer.viewRight,l=c.layer.viewBottom):a&&(e=a.getScale(),f=a.getAngle(),g=a.viewLeft,m=a.viewTop,k=a.viewRight,l=a.viewBottom);var p=this.runtime.fx_tex,t,w,q=0,n=1,v=this.runtime.draw_width,B=this.runtime.draw_height,I=v/2,H=B/2,L=a?a.rcTex:this.rcTex,O=a?a.rcTex2:this.rcTex2,S=0,J=0,G=0,F=0,C=v,T=v,K=B,M=B,U=w=0;var R=c?c.layer.getAngle():0;if(c){var V=0;for(t=h.length;V<t;V++)w+=b.getProgramBoxExtendHorizontal(h[V].shaderindex),U+=b.getProgramBoxExtendVertical(h[V].shaderindex);
F=c.bbox;S=a.layerToCanvas(F.left,F.top,!0,!0);G=a.layerToCanvas(F.left,F.top,!1,!0);C=a.layerToCanvas(F.right,F.bottom,!0,!0);K=a.layerToCanvas(F.right,F.bottom,!1,!0);0!==R&&(V=a.layerToCanvas(F.right,F.top,!0,!0),t=a.layerToCanvas(F.right,F.top,!1,!0),J=a.layerToCanvas(F.left,F.bottom,!0,!0),F=a.layerToCanvas(F.left,F.bottom,!1,!0),R=Math.min(S,C,V,J),C=Math.max(S,C,V,J),S=R,R=Math.min(G,K,t,F),K=Math.max(G,K,t,F),G=R);S-=w;G-=U;C+=w;K+=U;O.left=S/v;O.top=1-G/B;O.right=C/v;O.bottom=1-K/B;J=S=cr.floor(S);
F=G=cr.floor(G);T=C=cr.ceil(C);M=K=cr.ceil(K);J-=w;F-=U;T+=w;M+=U;0>S&&(S=0);0>G&&(G=0);C>v&&(C=v);K>B&&(K=B);0>J&&(J=0);0>F&&(F=0);T>v&&(T=v);M>B&&(M=B);L.left=S/v;L.top=1-G/B;L.right=C/v;L.bottom=1-K/B}else L.left=O.left=0,L.top=O.top=0,L.right=O.right=1,L.bottom=O.bottom=1;U=c&&(b.programUsesDest(h[0].shaderindex)||0!==w||0!==U||1!==c.opacity||c.type.plugin.must_predraw)||a&&!c&&1!==a.opacity;b.setAlphaBlend();if(U){p[q]||(p[q]=b.createEmptyTexture(v,B,this.runtime.linearSampling));if(p[q].c2width!==
v||p[q].c2height!==B)b.deleteTexture(p[q]),p[q]=b.createEmptyTexture(v,B,this.runtime.linearSampling);b.switchProgram(0);b.setRenderingToTexture(p[q]);var X=M-F;b.clearRect(J,B-F-X,T-J,X);c?c.drawGL(b):(b.setTexture(this.runtime.layer_tex),b.setOpacity(a.opacity),b.resetModelView(),b.translate(-I,-H),b.updateModelView(),b.quadTex(S,K,C,K,C,G,S,G,L));O.left=O.top=0;O.right=O.bottom=1;c&&(R=L.top,L.top=L.bottom,L.bottom=R);q=1;n=0}b.setOpacity(1);w=h.length-1;var Z=b.programUsesCrossSampling(h[w].shaderindex)||
!a&&!c&&!this.runtime.fullscreenScalingQuality;V=0;for(t=h.length;V<t;V++){p[q]||(p[q]=b.createEmptyTexture(v,B,this.runtime.linearSampling));if(p[q].c2width!==v||p[q].c2height!==B)b.deleteTexture(p[q]),p[q]=b.createEmptyTexture(v,B,this.runtime.linearSampling);b.switchProgram(h[V].shaderindex);R=h[V].index;b.programIsAnimated(h[V].shaderindex)&&(this.runtime.redraw=!0);if(0!=V||U){b.setProgramParameters(d,1/v,1/B,O.left,O.top,O.right,O.bottom,e,f,g,m,(g+k)/2,(m+l)/2,this.runtime.kahanTime.sum,c?
c.effect_params[R]:a?a.effect_params[R]:this.effect_params[R]);b.setTexture(null);if(V!==w||Z){b.setRenderingToTexture(p[q]);X=M-F;var W=B-F-X;b.clearRect(J,W,T-J,X)}else c?b.setBlend(c.srcBlend,c.destBlend):a&&b.setBlend(a.srcBlend,a.destBlend),b.setRenderingToTexture(d);b.setTexture(p[n]);b.resetModelView();b.translate(-I,-H);b.updateModelView();b.quadTex(S,K,C,K,C,G,S,G,L);V!==w||Z||b.setTexture(null)}else b.setRenderingToTexture(p[q]),X=M-F,W=B-F-X,b.clearRect(J,W,T-J,X),c?(c.curFrame&&c.curFrame.texture_img?
(W=c.curFrame.texture_img,n=1/W.width,W=1/W.height):(n=1/c.width,W=1/c.height),b.setProgramParameters(d,n,W,O.left,O.top,O.right,O.bottom,e,f,g,m,(g+k)/2,(m+l)/2,this.runtime.kahanTime.sum,c.effect_params[R]),c.drawGL(b)):(b.setProgramParameters(d,1/v,1/B,0,0,1,1,e,f,g,m,(g+k)/2,(m+l)/2,this.runtime.kahanTime.sum,a?a.effect_params[R]:this.effect_params[R]),b.setTexture(a?this.runtime.layer_tex:this.runtime.layout_tex),b.resetModelView(),b.translate(-I,-H),b.updateModelView(),b.quadTex(S,K,C,K,C,G,
S,G,L)),O.left=O.top=0,O.right=O.bottom=1,c&&!Z&&(R=K,K=G,G=R);q=0===q?1:0;n=0===q?1:0}Z&&(b.switchProgram(0),c?b.setBlend(c.srcBlend,c.destBlend):a?b.setBlend(a.srcBlend,a.destBlend):this.runtime.fullscreenScalingQuality||(b.setSize(this.runtime.width,this.runtime.height),I=this.runtime.width/2,H=this.runtime.height/2,G=S=0,C=this.runtime.width,K=this.runtime.height),b.setRenderingToTexture(d),b.setTexture(p[n]),b.resetModelView(),b.translate(-I,-H),b.updateModelView(),c&&1===h.length&&!U?b.quadTex(S,
G,C,G,C,K,S,K,L):b.quadTex(S,K,C,K,C,G,S,G,L),b.setTexture(null))};a.prototype.getLayerBySid=function(b){var a;var c=0;for(a=this.layers.length;c<a;c++)if(this.layers[c].sid===b)return this.layers[c];return null};a.prototype.saveToJSON=function(){var b,a={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var c=0;for(b=this.effect_types.length;c<b;c++){var d=this.effect_types[c];a.fx.push({name:d.name,
active:d.active,params:this.effect_params[d.index]})}c=0;for(b=this.layers.length;c<b;c++)d=this.layers[c],a.layers[d.sid.toString()]=d.saveToJSON();return a};a.prototype.loadFromJSON=function(b){var a,c,d;this.scrollX=b.sx;this.scrollY=b.sy;this.scale=b.s;this.angle=b.a;this.width=b.w;this.height=b.h;this.persist_data=b.persist;"undefined"!==typeof b.fv&&(this.first_visit=b.fv);var h=b.fx;var e=0;for(a=h.length;e<a;e++)if(c=this.getEffectByName(h[e].name))c.active=h[e].active,this.effect_params[c.index]=
h[e].params;this.updateActiveEffects();e=b.layers;for(d in e)e.hasOwnProperty(d)&&(b=this.getLayerBySid(parseInt(d,10)))&&b.loadFromJSON(e[d])};cr.layout=a;g.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var b;var a=0;for(b=this.effect_types.length;a<b;a++){var c=this.effect_types[a];c.active&&(this.active_effect_types.push(c),c.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};g.prototype.getEffectByName=function(b){var a;
var c=0;for(a=this.effect_types.length;c<a;c++){var d=this.effect_types[c];if(d.name===b)return d}return null};g.prototype.createInitialInstances=function(){var b,a;var d=b=0;for(a=this.initial_instances.length;b<a;b++){var e=this.initial_instances[b];var f=this.runtime.types_by_index[e[1]];var g=this.runtime.typeHasPersistBehavior(f);f=!0;if(!g||this.layout.first_visit){e=this.runtime.createInstanceFromInit(e,this,!0);if(!e)continue;c.push(e);e.type.global&&(f=!1,this.created_globals.push(e.uid))}f&&
(this.initial_instances[d]=this.initial_instances[b],d++)}this.initial_instances.length=d;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr.effectToCompositeOp(this.blend_mode);this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};g.prototype.recreateInitialObjects=function(b,a){var c,d=this.runtime.types_by_index,h=b.is_family,e=b.members;var f=0;for(c=this.initial_instances.length;f<
c;++f){var g=this.initial_instances[f];var m=g[0];var k=m[0];m=m[1];if(a.contains_pt(k,m)){k=d[g[1]];if(k!==b)if(h){if(0>e.indexOf(k))continue}else continue;g=this.runtime.createInstanceFromInit(g,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(k.plugin).cnds.OnCreated,g);if(g.is_contained)for(k=0,m=g.siblings.length;k<m;k++){var l=g.siblings[f];this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated,l)}this.runtime.isInOnDestroy--}}};g.prototype.removeFromInstanceList=
function(b,a){var c=cr.fastIndexOf(this.instances,b);0>c||(a&&this.useRenderCells&&b.rendercells&&b.rendercells.right>=b.rendercells.left&&(b.update_bbox(),this.render_grid.update(b,b.rendercells,null),b.rendercells.set(0,0,-1,-1)),c===this.instances.length-1?this.instances.pop():(cr.arrayRemove(this.instances,c),this.setZIndicesStaleFrom(c)),this.render_list_stale=!0)};g.prototype.appendToInstanceList=function(b,a){b.zindex=this.instances.length;this.instances.push(b);a&&this.useRenderCells&&b.rendercells&&
b.set_bbox_changed();this.render_list_stale=!0};g.prototype.prependToInstanceList=function(b,a){this.instances.unshift(b);this.setZIndicesStaleFrom(0);a&&this.useRenderCells&&b.rendercells&&b.set_bbox_changed()};g.prototype.moveInstanceAdjacent=function(b,a,c){var d=b.get_zindex();a=a.get_zindex();cr.arrayRemove(this.instances,d);d<a&&a--;c&&a++;a===this.instances.length?this.instances.push(b):this.instances.splice(a,0,b);this.setZIndicesStaleFrom(d<a?d:a)};g.prototype.setZIndicesStaleFrom=function(b){-1===
this.zindices_stale_from?this.zindices_stale_from=b:b<this.zindices_stale_from&&(this.zindices_stale_from=b);this.render_list_stale=this.zindices_stale=!0};g.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=0);var b;if(this.useRenderCells){var a=this.zindices_stale_from;for(b=this.instances.length;a<b;++a){var c=this.instances[a];c.zindex=a;this.render_grid.markRangeChanged(c.rendercells)}}else for(a=this.zindices_stale_from,b=this.instances.length;a<
b;++a)this.instances[a].zindex=a;this.zindices_stale=!1;this.zindices_stale_from=-1}};g.prototype.getScale=function(b){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||b?this.runtime.aspect_scale:1)};g.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1};g.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var l=[],n=[],q=[];g.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();
this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,q);if(!q.length)return k();if(1===q.length){var b=k();cr.shallowAssignArray(b,q[0]);cr.clearArray(q);return b}for(var a=!0;1<q.length;){var c;b=q;var d=a;var f=0;for(c=b.length;f<c-1;f+=2){var g=b[f];var l=b[f+1];a=k();var x=g,r=l,A=a,D=0,E=0,t=0,w=x.length,N=r.length;for(A.length=w+N;D<w&&E<N;++t){var P=x[D];var Q=r[E];P.zindex<Q.zindex?(A[t]=P,++D):(A[t]=Q,++E)}for(;D<w;++D,++t)A[t]=x[D];for(;E<N;++E,++t)A[t]=
r[E];d||(e(g),e(l));n.push(a)}1===c%2&&(d?(g=k(),cr.shallowAssignArray(g,b[c-1]),n.push(g)):n.push(b[c-1]));cr.shallowAssignArray(b,n);cr.clearArray(n);a=!1}b=q[0];cr.clearArray(q);return b};g.prototype.draw=function(b){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==this.blend_mode;var a=this.runtime.canvas,c=b,d=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),a=this.runtime.layer_canvas,a.width=this.runtime.draw_width,
a.height=this.runtime.draw_height,this.runtime.layer_ctx=a.getContext("2d"),d=!0),a=this.runtime.layer_canvas,c=this.runtime.layer_ctx,a.width!==this.runtime.draw_width&&(a.width=this.runtime.draw_width,d=!0),a.height!==this.runtime.draw_height&&(a.height=this.runtime.draw_height,d=!0),d&&this.runtime.setCtxImageSmoothingEnabled(c,this.runtime.linearSampling),this.transparent&&c.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));c.globalAlpha=1;c.globalCompositeOperation="source-over";
this.transparent||(c.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",c.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));c.save();this.disableAngle=!0;d=this.canvasToLayer(0,0,!0,!0);var h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),h=Math.round(h));this.rotateViewport(d,h,c);var f=this.getScale();c.scale(f,f);c.translate(-d,-h);this.useRenderCells?(this.cur_render_cells.left=
this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(e(this.last_render_list),d=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):d=this.last_render_list):d=this.instances;
var g=null;h=0;for(f=d.length;h<f;++h){var k=d[h];k!==g&&(this.drawInstance(k,c),g=k)}this.useRenderCells&&(this.last_render_list=d);c.restore();this.render_offscreen&&(b.globalCompositeOperation=this.compositeOp,b.globalAlpha=this.opacity,b.drawImage(a,0,0))};g.prototype.drawInstance=function(b,a){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var c=b.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(a.globalCompositeOperation=b.compositeOp,
b.draw(a))}};g.prototype.updateViewport=function(b){this.disableAngle=!0;var a=this.canvasToLayer(0,0,!0,!0),c=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(a=Math.round(a),c=Math.round(c));this.rotateViewport(a,c,b)};g.prototype.rotateViewport=function(b,a,c){var d=this.getScale();this.viewLeft=b;this.viewTop=a;this.viewRight=b+1/d*this.runtime.draw_width;this.viewBottom=a+1/d*this.runtime.draw_height;this.viewLeft>this.viewRight&&(b=this.viewLeft,this.viewLeft=
this.viewRight,this.viewRight=b);this.viewTop>this.viewBottom&&(b=this.viewTop,this.viewTop=this.viewBottom,this.viewBottom=b);b=this.getAngle();0!==b&&(c&&(c.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),c.rotate(-b),c.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
b),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};g.prototype.drawGL_earlyZPass=function(b){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var a=this.canvasToLayer(0,0,!0,!0),c=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(a=Math.round(a),c=Math.round(c));
this.rotateViewport(a,c,null);a=this.getScale();b.resetModelView();b.scale(a,a);b.rotateZ(-this.getAngle());b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);b.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(e(this.last_render_list),a=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):a=this.last_render_list):a=this.instances;var d=null;for(c=a.length-1;0<=c;--c){var h=a[c];h!==d&&(this.drawInstanceGL_earlyZPass(a[c],b),d=h)}this.useRenderCells&&(this.last_render_list=a);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,b.setEarlyZIndex(this.clear_earlyz_index),
b.setColorFillMode(1,1,1,1),b.fullscreenQuad(),b.restoreEarlyZMode())};g.prototype.drawGL=function(b){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&b.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(b.setEarlyZIndex(this.clear_earlyz_index),b.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),b.fullscreenQuad(),b.setTextureFillMode()):b.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var a=this.canvasToLayer(0,0,!0,!0);var c=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(a=Math.round(a),c=Math.round(c));this.rotateViewport(a,c,null);a=this.getScale();b.resetModelView();b.scale(a,a);b.rotateZ(-this.getAngle());b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);b.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(e(this.last_render_list),c=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):c=this.last_render_list):c=this.instances;var d,h=null;var f=0;for(d=c.length;f<
d;++f){var g=c[f];g!==h&&(this.drawInstanceGL(c[f],b),h=g)}this.useRenderCells&&(this.last_render_list=c);this.render_offscreen&&(c=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,f=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!b.programUsesCrossSampling(c)&&1===this.opacity?(1===this.active_effect_types.length?(b.switchProgram(c),b.setProgramParameters(this.layout.getRenderTarget(),
1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,a,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,this.effect_params[f]),b.programIsAnimated(c)&&(this.runtime.redraw=!0)):b.switchProgram(0),b.setRenderingToTexture(this.layout.getRenderTarget()),b.setOpacity(this.opacity),b.setTexture(this.runtime.layer_tex),b.setBlend(this.srcBlend,this.destBlend),b.resetModelView(),b.updateModelView(),a=this.runtime.draw_width/
2,c=this.runtime.draw_height/2,b.quad(-a,c,a,c,a,-c,-a,-c),b.setTexture(null)):this.layout.renderEffectChain(b,this,null,this.layout.getRenderTarget()))};g.prototype.drawInstanceGL=function(b,a){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var c=b.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(a.setEarlyZIndex(b.earlyz_index),b.uses_shaders?this.drawInstanceWithShadersGL(b,a):(a.switchProgram(0),a.setBlend(b.srcBlend,b.destBlend),b.drawGL(a)))}};
g.prototype.drawInstanceGL_earlyZPass=function(b,a){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var c=b.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(b.earlyz_index=this.runtime.earlyz_index++,0===b.blend_mode&&1===b.opacity&&b.shaders_preserve_opaqueness&&b.drawGL_earlyZPass&&(a.setEarlyZIndex(b.earlyz_index),b.drawGL_earlyZPass(a)))}};g.prototype.drawInstanceWithShadersGL=function(b,a){var c=b.active_effect_types[0].shaderindex,d=
b.active_effect_types[0].index,h=this.getScale();if(1!==b.active_effect_types.length||a.programUsesCrossSampling(c)||a.programExtendsBox(c)||(b.angle||b.layer.getAngle())&&a.programUsesDest(c)||1!==b.opacity||b.type.plugin.must_predraw)this.layout.renderEffectChain(a,this,b,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),a.resetModelView(),a.scale(h,h),a.rotateZ(-this.getAngle()),a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),a.updateModelView();
else{a.switchProgram(c);a.setBlend(b.srcBlend,b.destBlend);a.programIsAnimated(c)&&(this.runtime.redraw=!0);var e=0,f=0,g=0,k=0;a.programUsesDest(c)&&(k=b.bbox,e=this.layerToCanvas(k.left,k.top,!0,!0),f=this.layerToCanvas(k.left,k.top,!1,!0),g=this.layerToCanvas(k.right,k.bottom,!0,!0),k=this.layerToCanvas(k.right,k.bottom,!1,!0),e/=windowWidth,f=1-f/windowHeight,g/=windowWidth,k=1-k/windowHeight);if(b.curFrame&&b.curFrame.texture_img){var m=b.curFrame.texture_img;c=1/m.width;m=1/m.height}else c=
1/b.width,m=1/b.height;a.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),c,m,e,f,g,k,h,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,b.effect_params[d]);b.drawGL(a)}};g.prototype.canvasToLayer=function(b,a,c,d){var h=this.runtime.devicePixelRatio;this.runtime.isRetina&&(b*=h,a*=h);h=this.runtime.parallax_x_origin;var e=this.runtime.parallax_y_origin;h=(this.layout.scrollX-
h)*this.parallaxX+h;e=(this.layout.scrollY-e)*this.parallaxY+e;var f=h,g=e,k=1/this.getScale(!d);d?(f-=this.runtime.draw_width*k/2,g-=this.runtime.draw_height*k/2):(f-=this.runtime.width*k/2,g-=this.runtime.height*k/2);f+=b*k;g+=a*k;a=this.getAngle();0!==a&&(f-=h,g-=e,b=Math.cos(a),a=Math.sin(a),d=f*b-g*a,g=g*b+f*a,f=d+h,g+=e);return c?f:g};g.prototype.layerToCanvas=function(b,a,c,d){var h=this.runtime.parallax_x_origin,e=this.runtime.parallax_y_origin,f=(this.layout.scrollX-h)*this.parallaxX+h,g=
(this.layout.scrollY-e)*this.parallaxY+e;e=f;h=g;var k=this.getAngle();if(0!==k){b-=f;a-=g;var m=Math.cos(-k);k=Math.sin(-k);var l=b*m-a*k;a=a*m+b*k;b=l+f;a+=g}f=1/this.getScale(!d);d?(e-=this.runtime.draw_width*f/2,h-=this.runtime.draw_height*f/2):(e-=this.runtime.width*f/2,h-=this.runtime.height*f/2);e=(b-e)/f;h=(a-h)/f;b=this.runtime.devicePixelRatio;this.runtime.isRetina&&!d&&(e/=b,h/=b);return c?e:h};g.prototype.rotatePt=function(b,a,c){if(0===this.getAngle())return c?b:a;var d=this.layerToCanvas(b,
a,!0);a=this.layerToCanvas(b,a,!1);this.disableAngle=!0;b=this.canvasToLayer(d,a,!0);d=this.canvasToLayer(d,a,!0);this.disableAngle=!1;return c?b:d};g.prototype.saveToJSON=function(){var b,a={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var c=0;for(b=this.effect_types.length;c<b;c++){var d=
this.effect_types[c];a.fx.push({name:d.name,active:d.active,params:this.effect_params[d.index]})}return a};g.prototype.loadFromJSON=function(b){var a;this.scale=b.s;this.angle=b.a;this.viewLeft=b.vl;this.viewTop=b.vt;this.viewRight=b.vr;this.viewBottom=b.vb;this.visible=b.v;this.background_color=b.bc;this.transparent=b.t;this.parallaxX=b.px;this.parallaxY=b.py;this.opacity=b.o;this.zoomRate=b.zr;this.created_globals=b.cg||[];cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);
var c=new cr.ObjectSet;var d=0;for(a=this.created_globals.length;d<a;++d)c.add(this.created_globals[d]);var e=d=0;for(a=this.initial_instances.length;d<a;++d)c.contains(this.initial_instances[d][2])||(this.initial_instances[e]=this.initial_instances[d],++e);cr.truncateArray(this.initial_instances,e);e=b.fx;d=0;for(a=e.length;d<a;d++)if(b=this.getEffectByName(e[d].name))b.active=e[d].active,this.effect_params[b.index]=e[d].params;this.updateActiveEffects();this.instances.sort(f);this.zindices_stale=
!0};cr.layer=g})();
(function(){function a(b,a){var c,d=b.length;switch(d){case 0:return!0;case 1:return b[0]===a[0];case 2:return b[0]===a[0]&&b[1]===a[1];default:for(c=0;c<d;c++)if(b[c]!==a[c])return!1;return!0}}function f(b,a){return b.index-a.index}function g(b){var c;if(2===b.length){if(b[0].index>b[1].index){var d=b[0];b[0]=b[1];b[1]=d}}else 2<b.length&&b.sort(f);b.length>=v.length&&(v.length=b.length+1);v[b.length]||(v[b.length]=[]);var e=v[b.length];d=0;for(c=e.length;d<c;d++){var h=e[d];if(a(b,h))return h}e.push(b);
return b}function k(b,a){this.runtime=b;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=a[0];b=a[1];this.events=[];var c;a=0;for(c=b.length;a<c;a++)this.init_event(b[a],null,this.events)}function e(b){this.type=b;this.instances=[];this.else_instances=[];this.select_all=!0}function c(b,a,c){this.sheet=b;this.parent=a;this.runtime=b.runtime;this.solModifiers=[];this.solModifiersIncludingParents=[];this.has_else_block=
this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;c[1]&&(this.group_name=c[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!c[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=c[2];this.sid=c[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var d=c[5];b=0;for(a=d.length;b<a;b++){var e=new cr.condition(this,d[b]);e.index=b;cr.seal(e);this.conditions.push(e);this.addSolModifier(e.type)}d=c[6];b=0;for(a=d.length;b<a;b++)e=new cr.action(this,d[b]),e.index=b,cr.seal(e),this.actions.push(e);if(8===c.length)for(c=c[7],b=0,a=c.length;b<a;b++)this.sheet.init_event(c[b],this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=
null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function d(b,a){var c;if(b&&(-1===a.indexOf(b)&&a.push(b),b.is_contained)){var d=0;for(c=b.container.length;d<c;d++){var e=b.container[d];b!==e&&-1===a.indexOf(e)&&a.push(e)}}}function b(b,a){this.block=b;this.sheet=b.sheet;this.runtime=b.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(a[1]);this.trigger=0<
a[3];this.fasttrigger=2===a[3];this.looping=a[4];this.inverted=a[5];this.isstatic=a[6];this.sid=a[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===a[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[a[0]],this.run=this.isstatic?this.run_static:this.run_object,a[2]?(this.behaviortype=this.type.getBehaviorByName(a[2]),this.beh_index=this.type.getBehaviorIndexByName(a[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&
this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===a.length){var c=a[9];b=0;for(a=c.length;b<a;b++){var d=new cr.parameter(this,c[b]);cr.seal(d);this.parameters.push(d)}this.results.length=c.length}}function l(b,a){this.block=b;this.sheet=b.sheet;this.runtime=b.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(a[1]);-1===a[0]?(this.type=null,this.run=this.run_system,
this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[a[0]],this.run=this.run_object,a[2]?(this.behaviortype=this.type.getBehaviorByName(a[2]),this.beh_index=this.type.getBehaviorIndexByName(a[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=a[3];this.runtime.actsBySid[this.sid.toString()]=this;if(6===a.length){var c=a[5];b=0;for(a=c.length;b<a;b++){var d=new cr.parameter(this,c[b]);cr.seal(d);this.parameters.push(d)}this.results.length=c.length}}function n(){y++;
u.length===y&&u.push(new cr.expvalue);return u[y]}function q(b,a){this.owner=b;this.block=b.block;this.sheet=b.sheet;this.runtime=b.runtime;this.type=a[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var c;switch(a[0]){case 0:case 7:this.expression=new cr.expNode(this,a[1]);this.solindex=0;this.get=this.get_exp;break;
case 1:this.expression=new cr.expNode(this,a[1]);this.solindex=0;this.get=this.get_exp_str;break;case 5:this.expression=new cr.expNode(this,a[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=a[1];this.get=this.get_combosel;break;case 6:this.layout=this.runtime.layouts[a[1]];this.get=this.get_layout;break;case 9:this.key=a[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[a[1]];this.get=this.get_object;this.block.addSolModifier(this.object);
this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=a[1];b.type&&b.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=a[1];this.eventvar=null;this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=a[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],b=1,c=a.length;b<
c;b++){var d=new cr.parameter(this.owner,a[b]);cr.seal(d);this.subparams.push(d);this.variadicret.push(0)}}}function h(b,a,c){this.sheet=b;this.parent=a;this.runtime=b.runtime;this.solModifiers=[];this.name=c[1];this.vartype=c[2];this.initial=c[3];this.is_static=!!c[4];this.is_constant=!!c[5];this.sid=c[6];this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):
(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function m(b,a,c){this.sheet=b;this.parent=a;this.runtime=b.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=c[1];this.active=!0}function p(){this.temp_parents_arr=[];this.reset(null);cr.seal(this)}var v=[];k.prototype.toString=function(){return this.name};k.prototype.init_event=function(b,a,c){switch(b[0]){case 0:b=new cr.eventblock(this,a,b);cr.seal(b);if(b.orblock)for(c.push(b),c=0,a=b.conditions.length;c<
a;c++)b.conditions[c].trigger&&this.init_trigger(b,c);else b.is_trigger()?this.init_trigger(b,0):c.push(b);break;case 1:b=new cr.eventvariable(this,a,b);cr.seal(b);c.push(b);break;case 2:b=new cr.eventinclude(this,a,b),cr.seal(b),c.push(b)}};k.prototype.postInit=function(){var b;var a=0;for(b=this.events.length;a<b;a++)this.events[a].postInit(a<b-1&&this.events[a+1].is_else_block)};k.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes);cr.clearArray(this.already_included_sheets);
this.addDeepIncludes(this);cr.clearArray(this.already_included_sheets)};k.prototype.addDeepIncludes=function(b){var a,c=b.deep_includes,d=b.already_included_sheets,e=this.includes.valuesRef();var h=0;for(a=e.length;h<a;++h){var f=e[h];var g=f.include_sheet;!f.isActive()||b===g||-1<d.indexOf(g)||(d.push(g),g.addDeepIncludes(b),c.push(g))}};k.prototype.run=function(b){this.runtime.resuming_breakpoint||(this.hasRun=!0,b||(this.runtime.isRunningEvents=!0));var a;var c=0;for(a=this.events.length;c<a;c++){var d=
this.events[c];d.run();this.runtime.clearSol(d.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}b||(this.runtime.isRunningEvents=!1)};k.prototype.init_trigger=function(b,a){b.orblock||this.runtime.triggers_to_postinit.push(b);var c,d,e=b.conditions[a];var h=e.type?e.type.name:"system";var f=(c=e.fasttrigger)?this.fasttriggers:this.triggers;f[h]||(f[h]=[]);h=f[h];f=e.func;if(c){if(e.parameters.length&&(e=e.parameters[0],1===e.type&&2===e.expression.type)){e=e.expression.value.toLowerCase();
c=0;for(d=h.length;c<d;c++)if(h[c].method==f){c=h[c].evs;c[e]?c[e].push([b,a]):c[e]=[[b,a]];return}c={};c[e]=[[b,a]];h.push({method:f,evs:c})}}else{c=0;for(d=h.length;c<d;c++)if(h[c].method==f){h[c].evs.push([b,a]);return}e=cr.plugins_.Sprite&&f===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?!0:!1;e?h.unshift({method:f,evs:[[b,a]]}):h.push({method:f,evs:[[b,a]]})}};cr.eventsheet=k;e.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};e.prototype.getObjects=
function(){return this.select_all?this.type.instances:this.instances};e.prototype.pick_one=function(b){b&&(b.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,b.type.instances),this.select_all=!1),b=this.else_instances.indexOf(b),-1!==b&&(this.instances.push(this.else_instances[b]),this.else_instances.splice(b,1))):(this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=b))};cr.selection=e;window._c2hh_=
"CF4BD01569DCA121D76845B4FE35F9DC1B4B6115";c.prototype.postInit=function(b){var a,c=this.parent;if(this.group)for(this.toplevelgroup=!0;c;){if(!c.group){this.toplevelgroup=!1;break}c=c.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!b;this.solModifiersIncludingParents=this.solModifiers.slice(0);for(c=this.parent;c;){b=0;for(a=c.solModifiers.length;b<a;b++)this.addParentSolModifier(c.solModifiers[b]);c=c.parent}this.solModifiers=
g(this.solModifiers);this.solModifiersIncludingParents=g(this.solModifiersIncludingParents);b=0;for(a=this.conditions.length;b<a;b++)this.conditions[b].postInit();b=0;for(a=this.actions.length;b<a;b++)this.actions[b].postInit();b=0;for(a=this.subevents.length;b<a;b++)this.subevents[b].postInit(b<a-1&&this.subevents[b+1].is_else_block)};c.prototype.setGroupActive=function(b){if(this.group_active!==!!b){this.group_active=!!b;var a;b=0;for(a=this.contained_includes.length;b<a;++b)this.contained_includes[b].updateActive();
0<a&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};c.prototype.addSolModifier=function(b){d(b,this.solModifiers)};c.prototype.addParentSolModifier=function(b){d(b,this.solModifiersIncludingParents)};c.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};c.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};c.prototype.run=function(){var b,
a=!1,c=this.runtime,d=this.runtime.getCurrentEventStack();d.current_event=this;var e=this.conditions;this.is_else_block||(d.else_branch_ran=!1);if(this.orblock){0===e.length&&(a=!0);d.cndindex=0;for(b=e.length;d.cndindex<b;d.cndindex++){var h=e[d.cndindex];h.trigger||(h=h.run())&&(a=!0)}(d.last_event_true=a)&&this.run_actions_and_subevents()}else{d.cndindex=0;for(b=e.length;d.cndindex<b;d.cndindex++)if(h=e[d.cndindex].run(),!h){d.last_event_true=!1;this.toplevelevent&&c.hasPendingInstances&&c.ClearDeathRow();
return}d.last_event_true=!0;this.run_actions_and_subevents()}this.end_run(d)};c.prototype.end_run=function(b){b.last_event_true&&this.has_else_block&&(b.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};c.prototype.run_orblocktrigger=function(b){this.runtime.getCurrentEventStack().current_event=this;this.conditions[b].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};c.prototype.run_actions_and_subevents=
function(){var b=this.runtime.getCurrentEventStack(),a;b.actindex=0;for(a=this.actions.length;b.actindex<a;b.actindex++)if(this.actions[b.actindex].run())return;this.run_subevents()};c.prototype.resume_actions_and_subevents=function(){var b=this.runtime.getCurrentEventStack(),a;for(a=this.actions.length;b.actindex<a;b.actindex++)if(this.actions[b.actindex].run())return;this.run_subevents()};c.prototype.run_subevents=function(){if(this.subevents.length){var b,a,c=this.subevents.length-1;this.runtime.pushEventStack(this);
if(this.solWriterAfterCnds){var d=0;for(b=this.subevents.length;d<b;d++){var e=this.subevents[d];(a=!this.toplevelgroup||!this.group&&d<c)&&this.runtime.pushCopySol(e.solModifiers);e.run();a?this.runtime.popSol(e.solModifiers):this.runtime.clearSol(e.solModifiers)}}else for(d=0,b=this.subevents.length;d<b;d++)this.subevents[d].run();this.runtime.popEventStack()}};c.prototype.run_pretrigger=function(){var b=this.runtime.getCurrentEventStack();b.current_event=this;var a=!1,c;b.cndindex=0;for(c=this.conditions.length;b.cndindex<
c;b.cndindex++)if(this.conditions[b.cndindex].run())a=!0;else if(!this.orblock)return!1;return this.orblock?a:!0};c.prototype.retrigger=function(){this.runtime.execcount++;var b=this.runtime.getCurrentEventStack().cndindex,a=this.runtime.pushEventStack(this);if(!this.orblock)for(a.cndindex=b+1,b=this.conditions.length;a.cndindex<b;a.cndindex++)if(!this.conditions[a.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};c.prototype.isFirstConditionOfType=
function(b){var a=b.index;if(0===a)return!0;for(--a;0<=a;--a)if(this.conditions[a].type===b.type)return!1;return!0};cr.eventblock=c;b.prototype.postInit=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++){var c=this.parameters[a];c.postInit();c.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};b.prototype.run_true=function(){return!0};b.prototype.run_system=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++)this.results[a]=this.parameters[a].get();return cr.xor(this.func.apply(this.runtime.system,
this.results),this.inverted)};b.prototype.run_static=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++)this.results[a]=this.parameters[a].get();a=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return a};b.prototype.run_object=function(){var b,a,c,d=this.type,e=d.getCurrentSol(),h=this.block.orblock&&!this.trigger,f=d.is_contained,g=d.is_family,k=d.family_index,m=this.beh_index,l=-1<m,q=this.anyParamVariesPerInstance,p=this.parameters,
n=this.results,y=this.inverted,v=this.func;if(q){var u=0;for(a=p.length;u<a;++u){var J=p[u];J.variesPerInstance||(n[u]=J.get(0))}}else for(u=0,a=p.length;u<a;++u)n[u]=p[u].get(0);if(e.select_all){cr.clearArray(e.instances);cr.clearArray(e.else_instances);var G=d.instances;var F=0;for(b=G.length;F<b;++F){var C=G[F];if(q)for(u=0,a=p.length;u<a;++u)J=p[u],J.variesPerInstance&&(n[u]=J.get(F));l?(u=0,g&&(u=C.type.family_beh_map[k]),u=v.apply(C.behavior_insts[m+u],n)):u=v.apply(C,n);(c=cr.xor(u,y))?e.instances.push(C):
h&&e.else_instances.push(C)}d.finish&&d.finish(!0);e.select_all=!1;d.applySolToContainer();return e.hasObjects()}var T=0;G=(c=h&&!this.block.isFirstConditionOfType(this))?e.else_instances:e.instances;var K=!1;F=0;for(b=G.length;F<b;++F){C=G[F];if(q)for(u=0,a=p.length;u<a;++u)J=p[u],J.variesPerInstance&&(n[u]=J.get(F));l?(u=0,g&&(u=C.type.family_beh_map[k]),u=v.apply(C.behavior_insts[m+u],n)):u=v.apply(C,n);if(cr.xor(u,y))if(K=!0,c){if(e.instances.push(C),f)for(u=0,a=C.siblings.length;u<a;u++)J=C.siblings[u],
J.type.getCurrentSol().instances.push(J)}else{G[T]=C;if(f)for(u=0,a=C.siblings.length;u<a;u++)J=C.siblings[u],J.type.getCurrentSol().instances[T]=J;T++}else if(c){G[T]=C;if(f)for(u=0,a=C.siblings.length;u<a;u++)J=C.siblings[u],J.type.getCurrentSol().else_instances[T]=J;T++}else if(h&&(e.else_instances.push(C),f))for(u=0,a=C.siblings.length;u<a;u++)J=C.siblings[u],J.type.getCurrentSol().else_instances.push(J)}cr.truncateArray(G,T);if(f)for(g=d.container,F=0,b=g.length;F<b;F++)C=g[F].getCurrentSol(),
c?cr.truncateArray(C.else_instances,T):cr.truncateArray(C.instances,T);T=K;if(c&&!K)for(F=0,b=e.instances.length;F<b;F++){C=e.instances[F];if(q)for(u=0,a=p.length;u<a;u++)J=p[u],J.variesPerInstance&&(n[u]=J.get(F));u=l?v.apply(C.behavior_insts[m],n):v.apply(C,n);if(cr.xor(u,y)){K=!0;break}}d.finish&&d.finish(T||h);return h?K:e.hasObjects()};cr.condition=b;l.prototype.postInit=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++){var c=this.parameters[a];c.postInit();c.variesPerInstance&&
(this.anyParamVariesPerInstance=!0)}};l.prototype.run_system=function(){var b=this.runtime,a,c=this.parameters,d=this.results;var e=0;for(a=c.length;e<a;++e)d[e]=c[e].get();return this.func.apply(b.system,d)};l.prototype.run_object=function(){var b=this.type,a=this.beh_index,c=b.family_index,d=this.anyParamVariesPerInstance,e=this.parameters,h=this.results,f=this.func,g=b.getCurrentSol().getObjects();b=b.is_family;var k=-1<a,m,l;if(d){var q=0;for(l=e.length;q<l;++q){var p=e[q];p.variesPerInstance||
(h[q]=p.get(0))}}else for(q=0,l=e.length;q<l;++q)h[q]=e[q].get(0);var n=0;for(m=g.length;n<m;++n){var y=g[n];if(d)for(q=0,l=e.length;q<l;++q)p=e[q],p.variesPerInstance&&(h[q]=p.get(n));k?(q=0,b&&(q=y.type.family_beh_map[c]),f.apply(y.behavior_insts[a+q],h)):f.apply(y,h)}return!1};cr.action=l;var u=[],y=-1;q.prototype.postInit=function(){var b;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var a=0;for(b=this.subparams.length;a<
b;a++)this.subparams[a].postInit()}this.expression&&this.expression.postInit()};q.prototype.maybeVaryForType=function(b){this.variesPerInstance||!b||b.plugin.singleglobal||(this.variesPerInstance=!0)};q.prototype.setVaries=function(){this.variesPerInstance=!0};q.prototype.get_exp=function(b){this.solindex=b||0;b=n();this.expression.get(b);y--;return b.data};q.prototype.get_exp_str=function(b){this.solindex=b||0;b=n();this.expression.get(b);y--;return cr.is_string(b.data)?b.data:""};q.prototype.get_object=
function(){return this.object};q.prototype.get_combosel=function(){return this.combosel};q.prototype.get_layer=function(b){this.solindex=b||0;b=n();this.expression.get(b);y--;return b.is_number()?this.runtime.getLayerByNumber(b.data):this.runtime.getLayerByName(b.data)};q.prototype.get_layout=function(){return this.layout};q.prototype.get_key=function(){return this.key};q.prototype.get_instvar=function(){return this.index};q.prototype.get_familyvar=function(b){var a=b||0;b=this.owner.type;var c=b.getCurrentSol(),
d=c.getObjects();if(d.length)a=d[a%d.length].type;else if(c.else_instances.length)a=c.else_instances[a%c.else_instances.length].type;else if(b.instances.length)a=b.instances[a%b.instances.length].type;else return 0;return this.index+a.family_var_map[b.family_index]};q.prototype.get_eventvar=function(){return this.eventvar};q.prototype.get_audiofile=function(){return this.fileinfo};q.prototype.get_variadic=function(){var b;var a=0;for(b=this.subparams.length;a<b;a++)this.variadicret[a]=this.subparams[a].get();
return this.variadicret};cr.parameter=q;h.prototype.postInit=function(){this.solModifiers=g(this.solModifiers)};h.prototype.setValue=function(b){var a=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&a?(this.localIndex>=a.length&&(a.length=this.localIndex+1),a[this.localIndex]=b):this.data=b};h.prototype.getValue=function(){var b=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!b||this.is_constant?this.data:this.localIndex>=b.length||"undefined"===typeof b[this.localIndex]?
this.initial:b[this.localIndex]};h.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)};cr.eventvariable=h;m.prototype.toString=function(){return"include:"+this.include_sheet.toString()};m.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=g(this.solModifiers);for(var b=this.parent;b;)b.group&&b.contained_includes.push(this),b=b.parent;this.updateActive()};
m.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};m.prototype.updateActive=function(){for(var b=this.parent;b;){if(b.group&&!b.group_active){this.active=!1;return}b=b.parent}this.active=!0};m.prototype.isActive=function(){return this.active};cr.eventinclude=m;p.prototype.reset=function(b){this.current_event=b;this.actindex=this.cndindex=
0;cr.clearArray(this.temp_parents_arr);this.any_true_state=this.else_branch_ran=this.last_event_true=!1};p.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr.eventStackFrame=p})();
(function(){function a(a,b){this.owner=a;this.runtime=a.runtime;this.type=b[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var c=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=b[1];break;case 3:this.first=new cr.expNode(a,b[1]);break;case 18:this.first=new cr.expNode(a,b[1]);this.second=new cr.expNode(a,b[2]);this.third=new cr.expNode(a,b[3]);
break;case 19:this.func=this.runtime.GetObjectReference(b[1]);this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===b.length?(c=b[2],this.results.length=c.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[b[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(b[2]);this.return_string=b[3];cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&
this.owner.setVaries();this.instance_expr=b[4]?new cr.expNode(a,b[4]):null;this.results=[];this.parameters=[];6===b.length?(c=b[5],this.results.length=c.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[b[1]];this.return_string=b[2];this.instance_expr=b[3]?new cr.expNode(a,b[3]):null;this.varindex=b[4];break;case 22:this.object_type=this.runtime.types_by_index[b[1]];this.behavior_type=this.object_type.getBehaviorByName(b[2]);this.beh_index=this.object_type.getBehaviorIndexByName(b[2]);
this.func=this.runtime.GetObjectReference(b[3]);this.return_string=b[4];this.instance_expr=b[5]?new cr.expNode(a,b[5]):null;this.results=[];this.parameters=[];7===b.length?(c=b[6],this.results.length=c.length+1):this.results.length=1;break;case 23:this.varname=b[1],this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr.expNode(a,b[1]),this.second=new cr.expNode(a,b[2]));if(c){var d;b=0;for(d=c.length;b<d;b++)this.parameters.push(new cr.expNode(a,
c[b]))}cr.seal(this)}function f(){++c;e.length===c&&e.push(new cr.expvalue);return e[c]}function g(a,b,c){var d;var e=0;for(d=a.length;e<d;++e)a[e].get(c),b[e+1]=c.data}function k(a,b){this.type=a||cr.exptype.Integer;this.data=b||0;this.object_class=null;this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data));cr.seal(this)}a.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();
this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&this.instance_expr.postInit();if(this.parameters){var a;var b=0;for(a=this.parameters.length;b<a;b++)this.parameters[b].postInit()}};var e=[],c=-1;a.prototype.eval_system_exp=function(a){var b=this.parameters,d=this.results;d[0]=a;a=f();g(b,d,a);--c;this.func.apply(this.runtime.system,d)};a.prototype.eval_object_exp=function(a){var b=this.object_type,d=this.results,e=this.parameters,k=this.instance_expr,h=this.func,
m=this.owner.solindex,p=b.getCurrentSol(),v=p.getObjects();if(!v.length)if(p.else_instances.length)v=p.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}d[0]=a;a.object_class=b;a=f();g(e,d,a);k&&(k.get(a),a.is_number()&&(m=a.data,v=b.instances));--c;b=v.length;if(m>=b||m<=-b)m%=b;0>m&&(m+=b);h.apply(v[m],d)};a.prototype.eval_behavior_exp=function(a){var b=this.object_type,d=this.results,e=this.parameters,k=this.instance_expr,h=this.beh_index,m=this.func,p=this.owner.solindex,
v=b.getCurrentSol(),u=v.getObjects();if(!u.length)if(v.else_instances.length)u=v.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}d[0]=a;a.object_class=b;a=f();g(e,d,a);k&&(k.get(a),a.is_number()&&(p=a.data,u=b.instances));--c;e=u.length;if(p>=e||p<=-e)p%=e;0>p&&(p+=e);p=u[p];u=0;b.is_family&&(u=p.type.family_beh_map[b.family_index]);m.apply(p.behavior_insts[h+u],d)};a.prototype.eval_instvar_exp=function(a){var b=this.instance_expr,d=this.object_type,e=this.varindex,g=this.owner.solindex,
h=d.getCurrentSol(),k=h.getObjects();if(!k.length)if(h.else_instances.length)k=h.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}if(b){h=f();b.get(h);if(h.is_number()){g=h.data;k=d.instances;0!==k.length&&(g%=k.length,0>g&&(g+=k.length));g=d.getInstanceByIID(g);d=g.instance_vars[e];cr.is_string(d)?a.set_string(d):a.set_float(d);--c;return}--c}b=k.length;if(g>=b||g<=-b)g%=b;0>g&&(g+=b);g=k[g];k=0;d.is_family&&(k=g.type.family_var_map[d.family_index]);d=g.instance_vars[e+
k];cr.is_string(d)?a.set_string(d):a.set_float(d)};a.prototype.eval_int=function(a){a.type=cr.exptype.Integer;a.data=this.value};a.prototype.eval_float=function(a){a.type=cr.exptype.Float;a.data=this.value};a.prototype.eval_string=function(a){a.type=cr.exptype.String;a.data=this.value};a.prototype.eval_unaryminus=function(a){this.first.get(a);a.is_number()&&(a.data=-a.data)};a.prototype.eval_add=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data+=b.data,
b.is_float()&&a.make_float());--c};a.prototype.eval_subtract=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data-=b.data,b.is_float()&&a.make_float());--c};a.prototype.eval_multiply=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data*=b.data,b.is_float()&&a.make_float());--c};a.prototype.eval_divide=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data/=b.data,a.make_float());
--c};a.prototype.eval_mod=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data%=b.data,b.is_float()&&a.make_float());--c};a.prototype.eval_power=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data=Math.pow(a.data,b.data),b.is_float()&&a.make_float());--c};a.prototype.eval_and=function(a){this.first.get(a);var b=f();this.second.get(b);b.is_string()||a.is_string()?this.eval_and_stringconcat(a,b):this.eval_and_logical(a,
b);--c};a.prototype.eval_and_stringconcat=function(a,b){a.is_string()&&b.is_string()?this.eval_and_stringconcat_str_str(a,b):this.eval_and_stringconcat_num(a,b)};a.prototype.eval_and_stringconcat_str_str=function(a,b){a.data+=b.data};a.prototype.eval_and_stringconcat_num=function(a,b){a.is_string()?a.data+=(Math.round(1E10*b.data)/1E10).toString():a.set_string(a.data.toString()+b.data)};a.prototype.eval_and_logical=function(a,b){a.set_int(a.data&&b.data?1:0)};a.prototype.eval_or=function(a){this.first.get(a);
var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data||b.data?a.set_int(1):a.set_int(0));--c};a.prototype.eval_conditional=function(a){this.first.get(a);a.data?this.second.get(a):this.third.get(a)};a.prototype.eval_equal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data===b.data?1:0);--c};a.prototype.eval_notequal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data!==b.data?1:0);--c};a.prototype.eval_less=function(a){this.first.get(a);
var b=f();this.second.get(b);a.set_int(a.data<b.data?1:0);--c};a.prototype.eval_lessequal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data<=b.data?1:0);--c};a.prototype.eval_greater=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data>b.data?1:0);--c};a.prototype.eval_greaterequal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data>=b.data?1:0);--c};a.prototype.eval_eventvar_exp=function(a){var b=this.eventvar.getValue();cr.is_number(b)?
a.set_float(b):a.set_string(b)};cr.expNode=a;k.prototype.is_int=function(){return this.type===cr.exptype.Integer};k.prototype.is_float=function(){return this.type===cr.exptype.Float};k.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float};k.prototype.is_string=function(){return this.type===cr.exptype.String};k.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&(this.data=parseInt(this.data,10)),
this.type=cr.exptype.Integer)};k.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)};k.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)};k.prototype.set_int=function(a){this.type=cr.exptype.Integer;this.data=Math.floor(a)};k.prototype.set_float=function(a){this.type=cr.exptype.Float;this.data=a};k.prototype.set_string=function(a){this.type=cr.exptype.String;
this.data=a};k.prototype.set_any=function(a){cr.is_number(a)?(this.type=cr.exptype.Float,this.data=a):cr.is_string(a)?(this.type=cr.exptype.String,this.data=a.toString()):(this.type=cr.exptype.Integer,this.data=0)};cr.expvalue=k;cr.exptype={Integer:0,Float:1,String:2}})();cr.system_object=function(a){this.runtime=a;this.waits=[]};
cr.system_object.prototype.saveToJSON=function(){var a={},f,g,k;a.waits=[];var e=a.waits;var c=0;for(f=this.waits.length;c<f;c++){var d=this.waits[c];var b={t:d.time,st:d.signaltag,s:d.signalled,ev:d.ev.sid,sm:[],sols:{}};d.ev.actions[d.actindex]&&(b.act=d.ev.actions[d.actindex].sid);var l=0;for(g=d.solModifiers.length;l<g;l++)b.sm.push(d.solModifiers[l].sid);for(k in d.sols)if(d.sols.hasOwnProperty(k)){var n=this.runtime.types_by_index[parseInt(k,10)];var q={sa:d.sols[k].sa,insts:[]};l=0;for(g=d.sols[k].insts.length;l<
g;l++)q.insts.push(d.sols[k].insts[l].uid);b.sols[n.sid.toString()]=q}e.push(b)}return a};
cr.system_object.prototype.loadFromJSON=function(a){a=a.waits;var f,g,k,e,c;cr.clearArray(this.waits);var d=0;for(f=a.length;d<f;d++){var b=a[d];if(e=this.runtime.blocksBySid[b.ev.toString()]){var l=-1;var n=0;for(g=e.actions.length;n<g;n++)if(e.actions[n].sid===b.act){l=n;break}if(-1!==l){var q={sols:{},solModifiers:[],deleteme:!1};q.time=b.t;q.signaltag=b.st||"";q.signalled=!!b.s;q.ev=e;q.actindex=l;n=0;for(g=b.sm.length;n<g;n++)(e=this.runtime.getObjectTypeBySid(b.sm[n]))&&q.solModifiers.push(e);
for(k in b.sols)if(b.sols.hasOwnProperty(k)&&(e=this.runtime.getObjectTypeBySid(parseInt(k,10)))){l=b.sols[k];var h={sa:l.sa,insts:[]};n=0;for(g=l.insts.length;n<g;n++)(c=this.runtime.getObjectByUID(l.insts[n]))&&h.insts.push(c);q.sols[e.index.toString()]=h}this.waits.push(q)}}}};
(function(){function a(){}function f(b,a){b=b.extra.c2_feo_val;a=a.extra.c2_feo_val;if(cr.is_number(b)&&cr.is_number(a))return b-a;b=""+b;a=""+a;return b<a?-1:b>a?1:0}function g(b,a){p&&b===v&&a===u||(p=new RegExp(b,a),v=b,u=a);p.lastIndex=0;return p}function k(){}function e(){var b=z.length?z.pop():{sols:{},solModifiers:[]};b.deleteme=!1;return b}function c(){var b=x.length?x.pop():{insts:[]};b.sa=!1;return b}function d(b,a){var c=b[0]-a[0];return 0!==c?c:b[1]-a[1]}function b(b,a){return b[1]-a[1]}
function l(){}function n(b,a,c){if(b!==A||a!==D||c!==E){var d=g(a,c);r=b.match(d);A=b;D=a;E=c}}var q=cr.system_object.prototype;a.prototype.EveryTick=function(){return!0};a.prototype.OnLayoutStart=function(){return!0};a.prototype.OnLayoutEnd=function(){return!0};a.prototype.Compare=function(b,a,c){return cr.do_cmp(b,a,c)};a.prototype.CompareTime=function(b,a){var c=this.runtime.kahanTime.sum;return 0===b?(b=this.runtime.getCurrentCondition(),!b.extra.CompareTime_executed&&c>=a?b.extra.CompareTime_executed=
!0:!1):cr.do_cmp(c,b,a)};a.prototype.LayerVisible=function(b){return b?b.visible:!1};a.prototype.LayerEmpty=function(b){return b?!b.instances.length:!1};a.prototype.LayerCmpOpacity=function(b,a,c){return b?cr.do_cmp(100*b.opacity,a,c):!1};a.prototype.Repeat=function(b){var a=this.runtime.getCurrentEventStack(),c=a.current_event,d=a.isModifierAfterCnds();a=this.runtime.pushLoopStack();if(d)for(d=0;d<b&&!a.stopped;d++)this.runtime.pushCopySol(c.solModifiers),a.index=d,c.retrigger(),this.runtime.popSol(c.solModifiers);
else for(d=0;d<b&&!a.stopped;d++)a.index=d,c.retrigger();this.runtime.popLoopStack();return!1};a.prototype.While=function(b){var a=this.runtime.getCurrentEventStack();b=a.current_event;var c=a.isModifierAfterCnds();a=this.runtime.pushLoopStack();if(c)for(c=0;!a.stopped;c++)this.runtime.pushCopySol(b.solModifiers),a.index=c,b.retrigger()||(a.stopped=!0),this.runtime.popSol(b.solModifiers);else for(c=0;!a.stopped;c++)a.index=c,b.retrigger()||(a.stopped=!0);this.runtime.popLoopStack();return!1};a.prototype.For=
function(b,a,c){var d=this.runtime.getCurrentEventStack(),e=d.current_event;d=d.isModifierAfterCnds();b=this.runtime.pushLoopStack(b);if(c<a)if(d)for(;a>=c&&!b.stopped;--a)this.runtime.pushCopySol(e.solModifiers),b.index=a,e.retrigger(),this.runtime.popSol(e.solModifiers);else for(;a>=c&&!b.stopped;--a)b.index=a,e.retrigger();else if(d)for(;a<=c&&!b.stopped;++a)this.runtime.pushCopySol(e.solModifiers),b.index=a,e.retrigger(),this.runtime.popSol(e.solModifiers);else for(;a<=c&&!b.stopped;++a)b.index=
a,e.retrigger();this.runtime.popLoopStack();return!1};var h=[],m=-1;a.prototype.ForEach=function(b){var a=b.getCurrentSol();m++;h.length===m&&h.push([]);var c=h[m];cr.shallowAssignArray(c,a.getObjects());var d=this.runtime.getCurrentEventStack(),e=d.current_event,f=d.isModifierAfterCnds();d=this.runtime.pushLoopStack();var g,k,l=b.is_contained;if(f)for(f=0,g=c.length;f<g&&!d.stopped;f++){this.runtime.pushCopySol(e.solModifiers);var t=c[f];a=b.getCurrentSol();a.select_all=!1;cr.clearArray(a.instances);
a.instances[0]=t;if(l){var r=0;for(k=t.siblings.length;r<k;r++){var q=t.siblings[r];var p=q.type.getCurrentSol();p.select_all=!1;cr.clearArray(p.instances);p.instances[0]=q}}d.index=f;e.retrigger();this.runtime.popSol(e.solModifiers)}else for(a.select_all=!1,cr.clearArray(a.instances),f=0,g=c.length;f<g&&!d.stopped;f++){t=c[f];a.instances[0]=t;if(l)for(r=0,k=t.siblings.length;r<k;r++)q=t.siblings[r],p=q.type.getCurrentSol(),p.select_all=!1,cr.clearArray(p.instances),p.instances[0]=q;d.index=f;e.retrigger()}cr.clearArray(c);
this.runtime.popLoopStack();m--;return!1};a.prototype.ForEachOrdered=function(b,a,c){a=b.getCurrentSol();m++;h.length===m&&h.push([]);var d=h[m];cr.shallowAssignArray(d,a.getObjects());var e=this.runtime.getCurrentEventStack(),g=e.current_event,k=this.runtime.getCurrentCondition(),l=e.isModifierAfterCnds();e=this.runtime.pushLoopStack();var t;var r=0;for(t=d.length;r<t;r++)d[r].extra.c2_feo_val=k.parameters[1].get(r);d.sort(f);1===c&&d.reverse();c=b.is_contained;if(l)for(r=0,t=d.length;r<t&&!e.stopped;r++){this.runtime.pushCopySol(g.solModifiers);
var w=d[r];a=b.getCurrentSol();a.select_all=!1;cr.clearArray(a.instances);a.instances[0]=w;if(c)for(k=0,l=w.siblings.length;k<l;k++){var q=w.siblings[k];var p=q.type.getCurrentSol();p.select_all=!1;cr.clearArray(p.instances);p.instances[0]=q}e.index=r;g.retrigger();this.runtime.popSol(g.solModifiers)}else for(a.select_all=!1,cr.clearArray(a.instances),r=0,t=d.length;r<t&&!e.stopped;r++){w=d[r];a.instances[0]=w;if(c)for(k=0,l=w.siblings.length;k<l;k++)q=w.siblings[k],p=q.type.getCurrentSol(),p.select_all=
!1,cr.clearArray(p.instances),p.instances[0]=q;e.index=r;g.retrigger()}cr.clearArray(d);this.runtime.popLoopStack();m--;return!1};a.prototype.PickByComparison=function(b,a,c,d){var e,f;if(b){m++;h.length===m&&h.push([]);var g=h[m],k=b.getCurrentSol();cr.shallowAssignArray(g,k.getObjects());k.select_all&&cr.clearArray(k.else_instances);var l=this.runtime.getCurrentCondition();var t=e=0;for(f=g.length;e<f;e++){var r=g[e];g[t]=r;a=l.parameters[1].get(e);d=l.parameters[3].get(e);cr.do_cmp(a,c,d)?t++:
k.else_instances.push(r)}cr.truncateArray(g,t);k.select_all=!1;cr.shallowAssignArray(k.instances,g);cr.clearArray(g);m--;b.applySolToContainer();return!!k.instances.length}};a.prototype.PickByEvaluate=function(b,a){var c,d;if(b){m++;h.length===m&&h.push([]);var e=h[m],f=b.getCurrentSol();cr.shallowAssignArray(e,f.getObjects());f.select_all&&cr.clearArray(f.else_instances);var g=this.runtime.getCurrentCondition();var k=c=0;for(d=e.length;c<d;c++){var l=e[c];e[k]=l;(a=g.parameters[1].get(c))?k++:f.else_instances.push(l)}cr.truncateArray(e,
k);f.select_all=!1;cr.shallowAssignArray(f.instances,e);cr.clearArray(e);m--;b.applySolToContainer();return!!f.instances.length}};a.prototype.TriggerOnce=function(){var b=this.runtime.getCurrentCondition().extra;"undefined"===typeof b.TriggerOnce_lastTick&&(b.TriggerOnce_lastTick=-1);var a=b.TriggerOnce_lastTick,c=this.runtime.tickcount;b.TriggerOnce_lastTick=c;return this.runtime.layout_first_tick||a!==c-1};a.prototype.Every=function(b){var a=this.runtime.getCurrentCondition(),c=a.extra.Every_lastTime||
0,d=this.runtime.kahanTime.sum;"undefined"===typeof a.extra.Every_seconds&&(a.extra.Every_seconds=b);var e=a.extra.Every_seconds;if(d>=c+e)return a.extra.Every_lastTime=c+e,d>=a.extra.Every_lastTime+.04&&(a.extra.Every_lastTime=d),a.extra.Every_seconds=b,!0;d<c-.1&&(a.extra.Every_lastTime=d);return!1};a.prototype.PickNth=function(b,a){if(!b)return!1;var c=b.getCurrentSol(),d=c.getObjects();a=cr.floor(a);if(0>a||a>=d.length)return!1;c.pick_one(d[a]);b.applySolToContainer();return!0};a.prototype.PickRandom=
function(b){if(!b)return!1;var a=b.getCurrentSol(),c=a.getObjects(),d=cr.floor(Math.random()*c.length);if(d>=c.length)return!1;a.pick_one(c[d]);b.applySolToContainer();return!0};a.prototype.CompareVar=function(b,a,c){return cr.do_cmp(b.getValue(),a,c)};a.prototype.IsGroupActive=function(b){return(b=this.runtime.groups_by_name[b.toLowerCase()])&&b.group_active};a.prototype.IsPreview=function(){return"undefined"!==typeof cr_is_preview};a.prototype.PickAll=function(b){if(!b||!b.instances.length)return!1;
b.getCurrentSol().select_all=!0;b.applySolToContainer();return!0};a.prototype.IsMobile=function(){return this.runtime.isMobile};a.prototype.CompareBetween=function(b,a,c){return b>=a&&b<=c};a.prototype.Else=function(){var b=this.runtime.getCurrentEventStack();return b.else_branch_ran?!1:!b.last_event_true};a.prototype.OnLoadFinished=function(){return!0};a.prototype.OnCanvasSnapshot=function(){return!0};a.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};a.prototype.OnSaveComplete=
function(){return!0};a.prototype.OnSaveFailed=function(){return!0};a.prototype.OnLoadComplete=function(){return!0};a.prototype.OnLoadFailed=function(){return!0};a.prototype.ObjectUIDExists=function(b){return!!this.runtime.getObjectByUID(b)};a.prototype.IsOnPlatform=function(b){var a=this.runtime;switch(b){case 0:return!a.isDomFree&&!a.isNodeWebkit&&!a.isCordova&&!a.isWinJS&&!a.isWindowsPhone8&&!a.isBlackberry10&&!a.isAmazonWebApp;case 1:return a.isiOS;case 2:return a.isAndroid;case 3:return a.isWindows8App;
case 4:return a.isWindowsPhone8;case 5:return a.isBlackberry10;case 6:return a.isTizen;case 7:return a.isCocoonJs;case 8:return a.isCordova;case 9:return a.isArcade;case 10:return a.isNodeWebkit;case 11:return a.isCrosswalk;case 12:return a.isAmazonWebApp;case 13:return a.isWindows10;default:return!1}};var p=null,v="",u="";a.prototype.RegexTest=function(b,a,c){return g(a,c).test(b)};var y=[];a.prototype.PickOverlappingPoint=function(b,a,c){if(!b)return!1;var d=b.getCurrentSol(),e=d.getObjects(),h=
this.runtime.getCurrentEventStack().current_event.orblock,f=this.runtime.getCurrentCondition(),g;d.select_all?(cr.shallowAssignArray(y,e),cr.clearArray(d.else_instances),d.select_all=!1,cr.clearArray(d.instances)):h?(cr.shallowAssignArray(y,d.else_instances),cr.clearArray(d.else_instances)):(cr.shallowAssignArray(y,e),cr.clearArray(d.instances));e=0;for(h=y.length;e<h;++e){var k=y[e];k.update_bbox();(g=cr.xor(k.contains_pt(a,c),f.inverted))?d.instances.push(k):d.else_instances.push(k)}b.applySolToContainer();
return cr.xor(!!d.instances.length,f.inverted)};a.prototype.IsNaN=function(b){return!!isNaN(b)};a.prototype.AngleWithin=function(b,a,c){return cr.angleDiff(cr.to_radians(b),cr.to_radians(c))<=cr.to_radians(a)};a.prototype.IsClockwiseFrom=function(b,a){return cr.angleClockwise(cr.to_radians(b),cr.to_radians(a))};a.prototype.IsBetweenAngles=function(b,a,c){b=cr.to_clamped_radians(b);a=cr.to_clamped_radians(a);c=cr.to_clamped_radians(c);return cr.angleClockwise(c,a)?cr.angleClockwise(b,a)&&!cr.angleClockwise(b,
c):!(!cr.angleClockwise(b,a)&&cr.angleClockwise(b,c))};a.prototype.IsValueType=function(b,a){return"number"===typeof b?0===a:1===a};q.cnds=new a;k.prototype.GoToLayout=function(b){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=b)};k.prototype.NextPrevLayout=function(b){if(!this.runtime.isloading&&!this.runtime.changelayout){var a=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if(!b||0!==a)if(b||a!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=
this.runtime.layouts_by_index[a+(b?-1:1)]}};k.prototype.CreateObject=function(b,a,c,d){if(a&&b&&(a=this.runtime.createInstance(b,a,c,d))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(b.plugin).cnds.OnCreated,a);if(a.is_contained)for(c=0,d=a.siblings.length;c<d;c++){var e=a.siblings[c];this.runtime.trigger(Object.getPrototypeOf(e.type.plugin).cnds.OnCreated,e)}this.runtime.isInOnDestroy--;b=b.getCurrentSol();b.select_all=!1;cr.clearArray(b.instances);b.instances[0]=a;if(a.is_contained)for(c=
0,d=a.siblings.length;c<d;c++)e=a.siblings[c],b=e.type.getCurrentSol(),b.select_all=!1,cr.clearArray(b.instances),b.instances[0]=e}};k.prototype.SetLayerVisible=function(b,a){b&&b.visible!==a&&(b.visible=a,this.runtime.redraw=!0)};k.prototype.SetLayerOpacity=function(b,a){b&&(a=cr.clamp(a/100,0,1),b.opacity!==a&&(b.opacity=a,this.runtime.redraw=!0))};k.prototype.SetLayerScaleRate=function(b,a){b&&b.zoomRate!==a&&(b.zoomRate=a,this.runtime.redraw=!0)};k.prototype.SetLayerForceOwnTexture=function(b,
a){b&&(a=!!a,b.forceOwnTexture!==a&&(b.forceOwnTexture=a,this.runtime.redraw=!0))};k.prototype.SetLayoutScale=function(b){this.runtime.running_layout&&this.runtime.running_layout.scale!==b&&(this.runtime.running_layout.scale=b,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)};k.prototype.ScrollX=function(b){this.runtime.running_layout.scrollToX(b)};k.prototype.ScrollY=function(b){this.runtime.running_layout.scrollToY(b)};k.prototype.Scroll=function(b,a){this.runtime.running_layout.scrollToX(b);
this.runtime.running_layout.scrollToY(a)};k.prototype.ScrollToObject=function(b){if(b=b.getFirstPicked())this.runtime.running_layout.scrollToX(b.x),this.runtime.running_layout.scrollToY(b.y)};k.prototype.SetVar=function(b,a){0===b.vartype?cr.is_number(a)?b.setValue(a):b.setValue(parseFloat(a)):1===b.vartype&&b.setValue(a.toString())};k.prototype.AddVar=function(b,a){0===b.vartype?cr.is_number(a)?b.setValue(b.getValue()+a):b.setValue(b.getValue()+parseFloat(a)):1===b.vartype&&b.setValue(b.getValue()+
a.toString())};k.prototype.SubVar=function(b,a){0===b.vartype&&(cr.is_number(a)?b.setValue(b.getValue()-a):b.setValue(b.getValue()-parseFloat(a)))};k.prototype.SetGroupActive=function(b,a){if(b=this.runtime.groups_by_name[b.toLowerCase()])switch(a){case 0:b.setGroupActive(!1);break;case 1:b.setGroupActive(!0);break;case 2:b.setGroupActive(!b.group_active)}};k.prototype.SetTimescale=function(b){0>b&&(b=0);this.runtime.timescale=b};k.prototype.SetObjectTimescale=function(b,a){0>a&&(a=0);if(b){b=b.getCurrentSol().getObjects();
var c;var d=0;for(c=b.length;d<c;d++)b[d].my_timescale=a}};k.prototype.RestoreObjectTimescale=function(b){if(!b)return!1;b=b.getCurrentSol().getObjects();var a;var c=0;for(a=b.length;c<a;c++)b[c].my_timescale=-1};var z=[],x=[];k.prototype.Wait=function(b){if(!(0>b)){var a,d=this.runtime.getCurrentEventStack(),h=e();h.time=this.runtime.kahanTime.sum+b;h.signaltag="";h.signalled=!1;h.ev=d.current_event;h.actindex=d.actindex+1;b=0;for(a=this.runtime.types_by_index.length;b<a;b++){var f=this.runtime.types_by_index[b];
var g=f.getCurrentSol();g.select_all&&-1===d.current_event.solModifiers.indexOf(f)||(h.solModifiers.push(f),f=c(),f.sa=g.select_all,cr.shallowAssignArray(f.insts,g.instances),h.sols[b.toString()]=f)}this.waits.push(h);return!0}};k.prototype.WaitForSignal=function(b){var a,d=this.runtime.getCurrentEventStack(),h=e();h.time=-1;h.signaltag=b.toLowerCase();h.signalled=!1;h.ev=d.current_event;h.actindex=d.actindex+1;b=0;for(a=this.runtime.types_by_index.length;b<a;b++){var f=this.runtime.types_by_index[b];
var g=f.getCurrentSol();g.select_all&&-1===d.current_event.solModifiers.indexOf(f)||(h.solModifiers.push(f),f=c(),f.sa=g.select_all,cr.shallowAssignArray(f.insts,g.instances),h.sols[b.toString()]=f)}this.waits.push(h);return!0};k.prototype.Signal=function(b){b=b.toLowerCase();var a;var c=0;for(a=this.waits.length;c<a;++c){var d=this.waits[c];-1===d.time&&d.signaltag===b&&(d.signalled=!0)}};k.prototype.SetLayerScale=function(b,a){b&&b.scale!==a&&(b.scale=a,this.runtime.redraw=!0)};k.prototype.ResetGlobals=
function(){var b;var a=0;for(b=this.runtime.all_global_vars.length;a<b;a++){var c=this.runtime.all_global_vars[a];c.data=c.initial}};k.prototype.SetLayoutAngle=function(b){b=cr.to_radians(b);b=cr.clamp_angle(b);this.runtime.running_layout&&this.runtime.running_layout.angle!==b&&(this.runtime.running_layout.angle=b,this.runtime.redraw=!0)};k.prototype.SetLayerAngle=function(b,a){b&&(a=cr.to_radians(a),a=cr.clamp_angle(a),b.angle!==a&&(b.angle=a,this.runtime.redraw=!0))};k.prototype.SetLayerParallax=
function(b,a,c){if(b&&(b.parallaxX!==a/100||b.parallaxY!==c/100)){b.parallaxX=a/100;b.parallaxY=c/100;if(1!==b.parallaxX||1!==b.parallaxY)for(c=b.instances,b=0,a=c.length;b<a;++b)c[b].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};k.prototype.SetLayerBackground=function(b,a){if(b){var c=cr.GetRValue(a),d=cr.GetGValue(a);a=cr.GetBValue(a);if(b.background_color[0]!==c||b.background_color[1]!==d||b.background_color[2]!==a)b.background_color[0]=c,b.background_color[1]=d,b.background_color[2]=
a,this.runtime.redraw=!0}};k.prototype.SetLayerTransparent=function(b,a){b&&!!a!==!!b.transparent&&(b.transparent=!!a,this.runtime.redraw=!0)};k.prototype.SetLayerBlendMode=function(b,a){b&&b.blend_mode!==a&&(b.blend_mode=a,b.compositeOp=cr.effectToCompositeOp(b.blend_mode),this.runtime.gl&&cr.setGLBlend(b,b.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};k.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||(this.runtime.getCurrentLoop().stopped=!0)};k.prototype.GoToLayoutByName=
function(b){if(!this.runtime.isloading&&!this.runtime.changelayout)for(var a in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(a)&&cr.equals_nocase(a,b)){this.runtime.changelayout=this.runtime.layouts[a];break}};k.prototype.RestartLayout=function(b){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var a;b=0;for(a=this.runtime.allGroups.length;b<a;b++){var c=this.runtime.allGroups[b];c.setGroupActive(c.initially_activated)}}};
k.prototype.SnapshotCanvas=function(b,a){this.runtime.doCanvasSnapshot(0===b?"image/png":"image/jpeg",a/100)};k.prototype.SetCanvasSize=function(b,a){if(!(0>=b||0>=a)){var c=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||this.runtime.isNodeFullscreen)&&0<this.runtime.fullscreen_scaling&&(c=this.runtime.fullscreen_scaling);0===c?this.runtime.setSize(b,a,!0):(this.runtime.original_width=b,this.runtime.original_height=
a,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}};k.prototype.SetLayoutEffectEnabled=function(b,a){this.runtime.running_layout&&this.runtime.glwrap&&(a=this.runtime.running_layout.getEffectByName(a))&&(b=1===b,a.active!=b&&(a.active=b,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};k.prototype.SetLayerEffectEnabled=function(b,a,c){b&&this.runtime.glwrap&&(c=b.getEffectByName(c))&&(a=1===a,c.active!=a&&(c.active=a,b.updateActiveEffects(),
this.runtime.redraw=!0))};k.prototype.SetLayoutEffectParam=function(b,a,c){if(this.runtime.running_layout&&this.runtime.glwrap&&(b=this.runtime.running_layout.getEffectByName(b))){var d=this.runtime.running_layout.effect_params[b.index];a=Math.floor(a);0>a||a>=d.length||(1===this.runtime.glwrap.getProgramParameterType(b.shaderindex,a)&&(c/=100),d[a]!==c&&(d[a]=c,b.active&&(this.runtime.redraw=!0)))}};k.prototype.SetLayerEffectParam=function(b,a,c,d){b&&this.runtime.glwrap&&(a=b.getEffectByName(a))&&
(b=b.effect_params[a.index],c=Math.floor(c),0>c||c>=b.length||(1===this.runtime.glwrap.getProgramParameterType(a.shaderindex,c)&&(d/=100),b[c]!==d&&(b[c]=d,a.active&&(this.runtime.redraw=!0))))};k.prototype.SaveState=function(b){this.runtime.saveToSlot=b};k.prototype.LoadState=function(b){this.runtime.loadFromSlot=b};k.prototype.LoadStateJSON=function(b){this.runtime.loadFromJson=b};k.prototype.SetHalfFramerateMode=function(b){this.runtime.halfFramerateMode=0!==b};k.prototype.SetFullscreenQuality=
function(b){if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==b,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};k.prototype.ResetPersisted=function(){var b;var a=0;for(b=this.runtime.layouts_by_index.length;a<b;++a)this.runtime.layouts_by_index[a].persist_data={},this.runtime.layouts_by_index[a].first_visit=
!0};k.prototype.RecreateInitialObjects=function(b,a,c,d,e){b&&this.runtime.running_layout.recreateInitialObjects(b,a,c,d,e)};k.prototype.SetPixelRounding=function(b){this.runtime.pixel_rounding=0!==b;this.runtime.redraw=!0};k.prototype.SetMinimumFramerate=function(b){1>b&&(b=1);120<b&&(b=120);this.runtime.minimumFramerate=b};k.prototype.SortZOrderByInstVar=function(a,c){if(a){var e;var h=a.getCurrentSol().getObjects();var f=[],g=[],k=this.runtime.running_layout,m=a.is_family,l=a.family_index;a=0;
for(e=h.length;a<e;++a){var r=h[a];if(r.layer){var q=m?r.instance_vars[c+r.type.family_var_map[l]]:r.instance_vars[c];f.push([r.layer.index,r.get_zindex()]);g.push([r,q])}}if(f.length)for(f.sort(d),g.sort(b),a=0,e=f.length;a<e;++a)r=g[a][0],c=k.layers[f[a][0]],h=f[a][1],c.instances[h]!==r&&(c.instances[h]=r,r.layer=c,c.setZIndicesStaleFrom(h))}};q.acts=new k;l.prototype["int"]=function(b,a){cr.is_string(a)?(b.set_int(parseInt(a,10)),isNaN(b.data)&&(b.data=0)):b.set_int(a)};l.prototype["float"]=function(b,
a){cr.is_string(a)?(b.set_float(parseFloat(a)),isNaN(b.data)&&(b.data=0)):b.set_float(a)};l.prototype.str=function(b,a){cr.is_string(a)?b.set_string(a):b.set_string(a.toString())};l.prototype.len=function(b,a){b.set_int(a.length||0)};l.prototype.random=function(b,a,c){void 0===c?b.set_float(Math.random()*a):b.set_float(Math.random()*(c-a)+a)};l.prototype.sqrt=function(b,a){b.set_float(Math.sqrt(a))};l.prototype.abs=function(b,a){b.set_float(Math.abs(a))};l.prototype.round=function(b,a){b.set_int(Math.round(a))};
l.prototype.floor=function(b,a){b.set_int(Math.floor(a))};l.prototype.ceil=function(b,a){b.set_int(Math.ceil(a))};l.prototype.sin=function(b,a){b.set_float(Math.sin(cr.to_radians(a)))};l.prototype.cos=function(b,a){b.set_float(Math.cos(cr.to_radians(a)))};l.prototype.tan=function(b,a){b.set_float(Math.tan(cr.to_radians(a)))};l.prototype.asin=function(b,a){b.set_float(cr.to_degrees(Math.asin(a)))};l.prototype.acos=function(b,a){b.set_float(cr.to_degrees(Math.acos(a)))};l.prototype.atan=function(b,
a){b.set_float(cr.to_degrees(Math.atan(a)))};l.prototype.exp=function(b,a){b.set_float(Math.exp(a))};l.prototype.ln=function(b,a){b.set_float(Math.log(a))};l.prototype.log10=function(b,a){b.set_float(Math.log(a)/Math.LN10)};l.prototype.max=function(b){var a=arguments[1];"number"!==typeof a&&(a=0);var c;var d=2;for(c=arguments.length;d<c;d++){var e=arguments[d];"number"===typeof e&&a<e&&(a=e)}b.set_float(a)};l.prototype.min=function(b){var a=arguments[1];"number"!==typeof a&&(a=0);var c;var d=2;for(c=
arguments.length;d<c;d++){var e=arguments[d];"number"===typeof e&&a>e&&(a=e)}b.set_float(a)};l.prototype.dt=function(b){b.set_float(this.runtime.dt)};l.prototype.timescale=function(b){b.set_float(this.runtime.timescale)};l.prototype.wallclocktime=function(b){b.set_float((Date.now()-this.runtime.start_time)/1E3)};l.prototype.time=function(b){b.set_float(this.runtime.kahanTime.sum)};l.prototype.tickcount=function(b){b.set_int(this.runtime.tickcount)};l.prototype.objectcount=function(b){b.set_int(this.runtime.objectcount)};
l.prototype.fps=function(b){b.set_int(this.runtime.fps)};l.prototype.loopindex=function(b,a){var c;if(this.runtime.loop_stack.length)if(a){for(c=this.runtime.loop_stack_index;0<=c;--c){var d=this.runtime.loop_stack[c];if(d.name===a){b.set_int(d.index);return}}b.set_int(0)}else d=this.runtime.getCurrentLoop(),b.set_int(d?d.index:-1);else b.set_int(0)};l.prototype.distance=function(b,a,c,d,e){b.set_float(cr.distanceTo(a,c,d,e))};l.prototype.angle=function(b,a,c,d,e){b.set_float(cr.to_degrees(cr.angleTo(a,
c,d,e)))};l.prototype.scrollx=function(b){b.set_float(this.runtime.running_layout.scrollX)};l.prototype.scrolly=function(b){b.set_float(this.runtime.running_layout.scrollY)};l.prototype.newline=function(b){b.set_string("\n")};l.prototype.lerp=function(b,a,c,d){b.set_float(cr.lerp(a,c,d))};l.prototype.qarp=function(b,a,c,d,e){b.set_float(cr.qarp(a,c,d,e))};l.prototype.cubic=function(b,a,c,d,e,h){b.set_float(cr.cubic(a,c,d,e,h))};l.prototype.cosp=function(b,a,c,d){b.set_float(cr.cosp(a,c,d))};l.prototype.windowwidth=
function(b){b.set_int(this.runtime.width)};l.prototype.windowheight=function(b){b.set_int(this.runtime.height)};l.prototype.uppercase=function(b,a){b.set_string(cr.is_string(a)?a.toUpperCase():"")};l.prototype.lowercase=function(b,a){b.set_string(cr.is_string(a)?a.toLowerCase():"")};l.prototype.clamp=function(b,a,c,d){a<c?b.set_float(c):a>d?b.set_float(d):b.set_float(a)};l.prototype.layerscale=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(a.scale):b.set_float(0)};l.prototype.layeropacity=
function(b,a){(a=this.runtime.getLayer(a))?b.set_float(100*a.opacity):b.set_float(0)};l.prototype.layerscalerate=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(a.zoomRate):b.set_float(0)};l.prototype.layerparallaxx=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(100*a.parallaxX):b.set_float(0)};l.prototype.layerparallaxy=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(100*a.parallaxY):b.set_float(0)};l.prototype.layerindex=function(b,a){(a=this.runtime.getLayer(a))?b.set_int(a.index):
b.set_int(-1)};l.prototype.layoutscale=function(b){this.runtime.running_layout?b.set_float(this.runtime.running_layout.scale):b.set_float(0)};l.prototype.layoutangle=function(b){b.set_float(cr.to_degrees(this.runtime.running_layout.angle))};l.prototype.layerangle=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(cr.to_degrees(a.angle)):b.set_float(0)};l.prototype.layoutwidth=function(b){b.set_int(this.runtime.running_layout.width)};l.prototype.layoutheight=function(b){b.set_int(this.runtime.running_layout.height)};
l.prototype.find=function(b,a,c){cr.is_string(a)&&cr.is_string(c)?b.set_int(a.search(new RegExp(cr.regexp_escape(c),"i"))):b.set_int(-1)};l.prototype.findcase=function(b,a,c){cr.is_string(a)&&cr.is_string(c)?b.set_int(a.search(new RegExp(cr.regexp_escape(c),""))):b.set_int(-1)};l.prototype.left=function(b,a,c){b.set_string(cr.is_string(a)?a.substr(0,c):"")};l.prototype.right=function(b,a,c){b.set_string(cr.is_string(a)?a.substr(a.length-c):"")};l.prototype.mid=function(b,a,c,d){b.set_string(cr.is_string(a)?
a.substr(c,d):"")};l.prototype.tokenat=function(b,a,c,d){cr.is_string(a)&&cr.is_string(d)?(a=a.split(d),c=cr.floor(c),0>c||c>=a.length?b.set_string(""):b.set_string(a[c])):b.set_string("")};l.prototype.tokencount=function(b,a,c){cr.is_string(a)&&a.length?b.set_int(a.split(c).length):b.set_int(0)};l.prototype.replace=function(b,a,c,d){cr.is_string(a)&&cr.is_string(c)&&cr.is_string(d)?b.set_string(a.replace(new RegExp(cr.regexp_escape(c),"gi"),d)):b.set_string(cr.is_string(a)?a:"")};l.prototype.trim=
function(b,a){b.set_string(cr.is_string(a)?a.trim():"")};l.prototype.pi=function(b){b.set_float(cr.PI)};l.prototype.layoutname=function(b){this.runtime.running_layout?b.set_string(this.runtime.running_layout.name):b.set_string("")};l.prototype.renderer=function(b){b.set_string(this.runtime.gl?"webgl":"canvas2d")};l.prototype.rendererdetail=function(b){b.set_string(this.runtime.glUnmaskedRenderer)};l.prototype.anglediff=function(b,a,c){b.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(a),cr.to_radians(c))))};
l.prototype.choose=function(b){var a=cr.floor(Math.random()*(arguments.length-1));b.set_any(arguments[a+1])};l.prototype.rgb=function(b,a,c,d){b.set_int(cr.RGB(a,c,d))};l.prototype.projectversion=function(b){b.set_string(this.runtime.versionstr)};l.prototype.projectname=function(b){b.set_string(this.runtime.projectName)};l.prototype.anglelerp=function(b,a,c,d){a=cr.to_radians(a);c=cr.to_radians(c);var e=cr.angleDiff(a,c);cr.angleClockwise(c,a)?b.set_float(cr.to_clamped_degrees(a+e*d)):b.set_float(cr.to_clamped_degrees(a-
e*d))};l.prototype.anglerotate=function(b,a,c,d){a=cr.to_radians(a);c=cr.to_radians(c);d=cr.to_radians(d);b.set_float(cr.to_clamped_degrees(cr.angleRotate(a,c,d)))};l.prototype.zeropad=function(b,a,c){var d=0>a?"-":"";0>a&&(a=-a);c-=a.toString().length;for(var e=0;e<c;e++)d+="0";b.set_string(d+a.toString())};l.prototype.cpuutilisation=function(b){b.set_float(this.runtime.cpuutilisation/1E3)};l.prototype.viewportleft=function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewLeft:0)};l.prototype.viewporttop=
function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewTop:0)};l.prototype.viewportright=function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewRight:0)};l.prototype.viewportbottom=function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewBottom:0)};l.prototype.loadingprogress=function(b){b.set_float(this.runtime.loadingprogress)};l.prototype.unlerp=function(b,a,c,d){b.set_float(cr.unlerp(a,c,d))};l.prototype.canvassnapshot=function(b){b.set_string(this.runtime.snapshotData)};l.prototype.urlencode=
function(b,a){b.set_string(encodeURIComponent(a))};l.prototype.urldecode=function(b,a){b.set_string(decodeURIComponent(a))};l.prototype.canvastolayerx=function(b,a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.canvasToLayer(c,d,!0):0)};l.prototype.canvastolayery=function(b,a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.canvasToLayer(c,d,!1):0)};l.prototype.layertocanvasx=function(b,a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.layerToCanvas(c,d,!0):0)};l.prototype.layertocanvasy=function(b,
a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.layerToCanvas(c,d,!1):0)};l.prototype.savestatejson=function(b){b.set_string(this.runtime.lastSaveJson)};l.prototype.imagememoryusage=function(b){this.runtime.glwrap?b.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):b.set_float(0)};l.prototype.regexsearch=function(b,a,c,d){c=g(c,d);b.set_int(a?a.search(c):-1)};l.prototype.regexreplace=function(b,a,c,d,e){c=g(c,d);b.set_string(a?a.replace(c,e):"")};var r=[],A="",D="",E="";
l.prototype.regexmatchcount=function(b,a,c,d){g(c,d);n(a.toString(),c,d);b.set_int(r?r.length:0)};l.prototype.regexmatchat=function(b,a,c,d,e){e=Math.floor(e);g(c,d);n(a.toString(),c,d);!r||0>e||e>=r.length?b.set_string(""):b.set_string(r[e])};l.prototype.infinity=function(b){b.set_float(Infinity)};l.prototype.setbit=function(b,a,c,d){c|=0;b.set_int((a|0)&~(1<<c)|(0!==d?1:0)<<c)};l.prototype.togglebit=function(b,a,c){b.set_int((a|0)^1<<(c|0))};l.prototype.getbit=function(b,a,c){b.set_int((a|0)&1<<
(c|0)?1:0)};l.prototype.originalwindowwidth=function(b){b.set_int(this.runtime.original_width)};l.prototype.originalwindowheight=function(b){b.set_int(this.runtime.original_height)};q.exps=new l;q.runWaits=function(){var b,a=this.runtime.getCurrentEventStack();var c=0;for(b=this.waits.length;c<b;c++){var d=this.waits[c];if(-1===d.time){if(!d.signalled)continue}else if(d.time>this.runtime.kahanTime.sum)continue;a.current_event=d.ev;a.actindex=d.actindex;a.cndindex=0;for(f in d.sols)if(d.sols.hasOwnProperty(f)){var e=
this.runtime.types_by_index[parseInt(f,10)].getCurrentSol();var h=d.sols[f];e.select_all=h.sa;cr.shallowAssignArray(e.instances,h.insts);e=h;cr.clearArray(e.insts);x.push(e)}d.ev.resume_actions_and_subevents();this.runtime.clearSol(d.solModifiers);d.deleteme=!0}var f=c=0;for(b=this.waits.length;c<b;c++)d=this.waits[c],this.waits[f]=d,d.deleteme?(cr.wipe(d.sols),cr.clearArray(d.solModifiers),z.push(d)):f++;cr.truncateArray(this.waits,f)}})();
(function(){cr.add_common_aces=function(a,g){var f=a[1],e=a[3],c=a[4],d=a[5],b=a[6],l=a[7];a=a[8];g.cnds||(g.cnds={});g.acts||(g.acts={});g.exps||(g.exps={});var n=g.cnds,q=g.acts;g=g.exps;e&&(n.CompareX=function(b,a){return cr.do_cmp(this.x,b,a)},n.CompareY=function(b,a){return cr.do_cmp(this.y,b,a)},n.IsOnScreen=function(){var b=this.layer;this.update_bbox();var a=this.bbox;return!(a.right<b.viewLeft||a.bottom<b.viewTop||a.left>b.viewRight||a.top>b.viewBottom)},n.IsOutsideLayout=function(){this.update_bbox();
var b=this.bbox,a=this.runtime.running_layout;return 0>b.right||0>b.bottom||b.left>a.width||b.top>a.height},n.PickDistance=function(b,a,c){var d=this.getCurrentSol(),e=d.getObjects();if(!e.length)return!1;var h=e[0],f=h,g=cr.distanceTo(h.x,h.y,a,c),k;var m=1;for(k=e.length;m<k;m++){h=e[m];var l=cr.distanceTo(h.x,h.y,a,c);if(0===b&&l<g||1===b&&l>g)g=l,f=h}d.pick_one(f);return!0},q.SetX=function(b){this.x!==b&&(this.x=b,this.set_bbox_changed())},q.SetY=function(b){this.y!==b&&(this.y=b,this.set_bbox_changed())},
q.SetPos=function(b,a){if(this.x!==b||this.y!==a)this.x=b,this.y=a,this.set_bbox_changed()},q.SetPosToObject=function(b,a){var c=b.getPairedInstance(this);c&&(c.getImagePoint?(b=c.getImagePoint(a,!0),a=c.getImagePoint(a,!1)):(b=c.x,a=c.y),this.x!==b||this.y!==a)&&(this.x=b,this.y=a,this.set_bbox_changed())},q.MoveForward=function(b){0!==b&&(this.x+=Math.cos(this.angle)*b,this.y+=Math.sin(this.angle)*b,this.set_bbox_changed())},q.MoveAtAngle=function(b,a){0!==a&&(this.x+=Math.cos(cr.to_radians(b))*
a,this.y+=Math.sin(cr.to_radians(b))*a,this.set_bbox_changed())},g.X=function(b){b.set_float(this.x)},g.Y=function(b){b.set_float(this.y)},g.dt=function(b){b.set_float(this.runtime.getDt(this))});c&&(n.CompareWidth=function(b,a){return cr.do_cmp(this.width,b,a)},n.CompareHeight=function(b,a){return cr.do_cmp(this.height,b,a)},q.SetWidth=function(b){this.width!==b&&(this.width=b,this.set_bbox_changed())},q.SetHeight=function(b){this.height!==b&&(this.height=b,this.set_bbox_changed())},q.SetSize=function(b,
a){if(this.width!==b||this.height!==a)this.width=b,this.height=a,this.set_bbox_changed()},g.Width=function(b){b.set_float(this.width)},g.Height=function(b){b.set_float(this.height)},g.BBoxLeft=function(b){this.update_bbox();b.set_float(this.bbox.left)},g.BBoxTop=function(b){this.update_bbox();b.set_float(this.bbox.top)},g.BBoxRight=function(b){this.update_bbox();b.set_float(this.bbox.right)},g.BBoxBottom=function(b){this.update_bbox();b.set_float(this.bbox.bottom)});d&&(n.AngleWithin=function(b,a){return cr.angleDiff(this.angle,
cr.to_radians(a))<=cr.to_radians(b)},n.IsClockwiseFrom=function(b){return cr.angleClockwise(this.angle,cr.to_radians(b))},n.IsBetweenAngles=function(b,a){b=cr.to_clamped_radians(b);a=cr.to_clamped_radians(a);var c=cr.clamp_angle(this.angle);return cr.angleClockwise(a,b)?cr.angleClockwise(c,b)&&!cr.angleClockwise(c,a):!(!cr.angleClockwise(c,b)&&cr.angleClockwise(c,a))},q.SetAngle=function(b){b=cr.to_radians(cr.clamp_angle_degrees(b));isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},
q.RotateClockwise=function(b){0===b||isNaN(b)||(this.angle+=cr.to_radians(b),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},q.RotateCounterclockwise=function(b){0===b||isNaN(b)||(this.angle-=cr.to_radians(b),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},q.RotateTowardAngle=function(b,a){b=cr.angleRotate(this.angle,cr.to_radians(a),cr.to_radians(b));isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},q.RotateTowardPosition=function(b,a,c){b=cr.angleRotate(this.angle,
Math.atan2(c-this.y,a-this.x),cr.to_radians(b));isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},q.SetTowardPosition=function(b,a){b=Math.atan2(a-this.y,b-this.x);isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},g.Angle=function(b){b.set_float(cr.to_clamped_degrees(this.angle))});f||(n.CompareInstanceVar=function(b,a,c){return cr.do_cmp(this.instance_vars[b],a,c)},n.IsBoolInstanceVarSet=function(b){return this.instance_vars[b]},n.PickInstVarHiLow=function(b,a){var c=
this.getCurrentSol(),d=c.getObjects();if(!d.length)return!1;var e=d[0],h=e,f=e.instance_vars[a],g;var k=1;for(g=d.length;k<g;k++){e=d[k];var l=e.instance_vars[a];if(0===b&&l<f||1===b&&l>f)f=l,h=e}c.pick_one(h);return!0},n.PickByUID=function(b){var a;if(this.runtime.getCurrentCondition().inverted){var c=this.getCurrentSol();if(c.select_all){c.select_all=!1;cr.clearArray(c.instances);cr.clearArray(c.else_instances);var d=this.instances;var e=0;for(a=d.length;e<a;e++){var h=d[e];h.uid===b?c.else_instances.push(h):
c.instances.push(h)}}else{d=e=0;for(a=c.instances.length;e<a;e++)h=c.instances[e],c.instances[d]=h,h.uid===b?c.else_instances.push(h):d++;cr.truncateArray(c.instances,d)}this.applySolToContainer();return!!c.instances.length}h=this.runtime.getObjectByUID(b);if(!h)return!1;c=this.getCurrentSol();if(!c.select_all&&-1===c.instances.indexOf(h))return!1;if(this.is_family)for(b=h.type.families,e=0,a=b.length;e<a;e++){if(b[e]===this)return c.pick_one(h),this.applySolToContainer(),!0}else if(h.type===this)return c.pick_one(h),
this.applySolToContainer(),!0;return!1},n.OnCreated=function(){return!0},n.OnDestroyed=function(){return!0},q.SetInstanceVar=function(b,a){var c=this.instance_vars;cr.is_number(c[b])?cr.is_number(a)?c[b]=a:c[b]=parseFloat(a):cr.is_string(c[b])&&(cr.is_string(a)?c[b]=a:c[b]=a.toString())},q.AddInstanceVar=function(b,a){var c=this.instance_vars;cr.is_number(c[b])?cr.is_number(a)?c[b]+=a:c[b]+=parseFloat(a):cr.is_string(c[b])&&(cr.is_string(a)?c[b]+=a:c[b]+=a.toString())},q.SubInstanceVar=function(b,
a){var c=this.instance_vars;cr.is_number(c[b])&&(cr.is_number(a)?c[b]-=a:c[b]-=parseFloat(a))},q.SetBoolInstanceVar=function(b,a){this.instance_vars[b]=a?1:0},q.ToggleBoolInstanceVar=function(b){this.instance_vars[b]=1-this.instance_vars[b]},q.Destroy=function(){this.runtime.DestroyInstance(this)},q.LoadFromJsonString||(q.LoadFromJsonString=function(b){try{var a=JSON.parse(b)}catch(v){return}this.runtime.loadInstanceFromJSON(this,a,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(b=
0,a=this.behavior_insts.length;b<a;++b){var c=this.behavior_insts[b];c.afterLoad&&c.afterLoad()}}),g.Count=function(b){var a=b.object_class.instances.length,c;var d=0;for(c=this.runtime.createRow.length;d<c;d++){var e=this.runtime.createRow[d];b.object_class.is_family?0<=e.type.families.indexOf(b.object_class)&&a++:e.type===b.object_class&&a++}b.set_int(a)},g.PickedCount=function(b){b.set_int(b.object_class.getCurrentSol().getObjects().length)},g.UID=function(b){b.set_int(this.uid)},g.IID=function(b){b.set_int(this.get_iid())},
g.AsJSON||(g.AsJSON=function(b){b.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));b&&(n.IsVisible=function(){return this.visible},q.SetVisible=function(b){!b!==!this.visible&&(this.visible=!!b,this.runtime.redraw=!0)},n.CompareOpacity=function(b,a){return cr.do_cmp(cr.round6dp(100*this.opacity),b,a)},q.SetOpacity=function(b){b/=100;0>b?b=0:1<b&&(b=1);b!==this.opacity&&(this.opacity=b,this.runtime.redraw=!0)},g.Opacity=function(b){b.set_float(cr.round6dp(100*this.opacity))});
l&&(n.IsOnLayer=function(b){return b?this.layer===b:!1},n.PickTopBottom=function(b){var a=this.getCurrentSol(),c=a.getObjects();if(!c.length)return!1;var d=c[0],e=d,f;var h=1;for(f=c.length;h<f;h++)if(d=c[h],0===b){if(d.layer.index>e.layer.index||d.layer.index===e.layer.index&&d.get_zindex()>e.get_zindex())e=d}else if(d.layer.index<e.layer.index||d.layer.index===e.layer.index&&d.get_zindex()<e.get_zindex())e=d;a.pick_one(e);return!0},q.MoveToTop=function(){var b=this.layer,a=b.instances;a.length&&
a[a.length-1]===this||(b.removeFromInstanceList(this,!1),b.appendToInstanceList(this,!1),this.runtime.redraw=!0)},q.MoveToBottom=function(){var b=this.layer,a=b.instances;a.length&&a[0]===this||(b.removeFromInstanceList(this,!1),b.prependToInstanceList(this,!1),this.runtime.redraw=!0)},q.MoveToLayer=function(b){b&&b!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=b,b.appendToInstanceList(this,!0),this.runtime.redraw=!0)},q.ZMoveToObject=function(b,a){b=0===b;a&&(a=a.getFirstPicked(this))&&
a.uid!==this.uid&&(this.layer.index!==a.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=a.layer,a.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,a,b),this.runtime.redraw=!0)},g.LayerNumber=function(b){b.set_int(this.layer.number)},g.LayerName=function(b){b.set_string(this.layer.name)},g.ZIndex=function(b){b.set_int(this.get_zindex())});a&&(q.SetEffectEnabled=function(b,a){this.runtime.glwrap&&(a=this.type.getEffectIndexByName(a),0>a||(b=1===b,this.active_effect_flags[a]!==
b&&(this.active_effect_flags[a]=b,this.updateActiveEffects(),this.runtime.redraw=!0)))},q.SetEffectParam=function(b,a,c){if(this.runtime.glwrap){var d=this.type.getEffectIndexByName(b);0>d||(b=this.type.effect_types[d],d=this.effect_params[d],a=Math.floor(a),0>a||a>=d.length||(1===this.runtime.glwrap.getProgramParameterType(b.shaderindex,a)&&(c/=100),d[a]!==c&&(d[a]=c,b.active&&(this.runtime.redraw=!0))))}})};cr.set_bbox_changed=function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=
!0;this.runtime.redraw=!0;var a,g=this.bbox_changed_callbacks;var k=0;for(a=g.length;k<a;++k)g[k](this);this.layer.useRenderCells&&this.update_bbox()};cr.add_bbox_changed_callback=function(a){a&&this.bbox_changed_callbacks.push(a)};cr.update_bbox=function(){if(this.bbox_changed){var a=this.bbox,g=this.bquad;a.set(this.x,this.y,this.x+this.width,this.y+this.height);a.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);this.angle?(a.offset(-this.x,-this.y),g.set_from_rotated_rect(a,this.angle),
g.offset(this.x,this.y),g.bounding_box(a)):g.set_from_rect(a);a.normalize();this.bbox_changed=!1;this.update_render_cell()}};var a=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var f=this.layer.render_grid,g=this.bbox;a.set(f.XToCell(g.left),f.YToCell(g.top),f.XToCell(g.right),f.YToCell(g.bottom));this.rendercells.equals(a)||(this.rendercells.right<this.rendercells.left?f.update(this,null,a):f.update(this,this.rendercells,a),this.rendercells.copy(a),this.layer.render_list_stale=
!0)}};cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var f=this.type.collision_grid,g=this.bbox;a.set(f.XToCell(g.left),f.YToCell(g.top),f.XToCell(g.right),f.YToCell(g.bottom));this.collcells.equals(a)||(this.collcells.right<this.collcells.left?f.update(this,null,a):f.update(this,this.collcells,a),this.collcells.copy(a),this.cell_changed=!1)}};cr.inst_contains_pt=function(a,g){return this.bbox.contains_pt(a,g)&&this.bquad.contains_pt(a,g)?this.tilemap_exists?
this.testPointOverlapTile(a,g):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(a-this.x,g-this.y)):!0:!1};cr.inst_get_iid=function(){this.type.updateIIDs();return this.iid};cr.inst_get_zindex=function(){this.layer.updateZIndices();return this.zindex};cr.inst_updateActiveEffects=function(){cr.clearArray(this.active_effect_types);var a,g=!0;var k=0;for(a=this.active_effect_flags.length;k<a;k++)if(this.active_effect_flags[k]){var e=
this.type.effect_types[k];this.active_effect_types.push(e);e.preservesOpaqueness||(g=!1)}this.uses_shaders=!!this.active_effect_types.length;this.shaders_preserve_opaqueness=g};cr.inst_toString=function(){return"Inst"+this.puid};cr.type_getFirstPicked=function(a){if(a&&a.is_contained&&a.type!=this){var f;var k=0;for(f=a.siblings.length;k<f;k++){var e=a.siblings[k];if(e.type==this)return e}}a=this.getCurrentSol().getObjects();return a.length?a[0]:null};cr.type_getPairedInstance=function(a){var f=this.getCurrentSol().getObjects();
return f.length?f[a.get_iid()%f.length]:null};cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var a;var g=0;for(a=this.instances.length;g<a;g++)this.instances[g].iid=g;var k=g,e=this.runtime.createRow;g=0;for(a=e.length;g<a;++g)e[g].type===this&&(e[g].iid=k++);this.stale_iids=!1}};cr.type_getInstanceByIID=function(a){if(a<this.instances.length)return this.instances[a];a-=this.instances.length;var f=this.runtime.createRow,k;var e=0;for(k=f.length;e<k;++e)if(f[e].type===this){if(0===
a)return f[e];--a}return null};cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))};cr.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&this.solstack.push(new cr.selection(this));var a=this.solstack[this.cur_sol],g=this.solstack[this.cur_sol-
1];g.select_all?a.select_all=!0:(a.select_all=!1,cr.shallowAssignArray(a.instances,g.instances));cr.clearArray(a.else_instances)};cr.type_popSol=function(){this.cur_sol--};cr.type_getBehaviorByName=function(a){var f,k,e=0;if(!this.is_family){var c=0;for(f=this.families.length;c<f;c++){var d=this.families[c];var b=0;for(k=d.behaviors.length;b<k;b++){if(a===d.behaviors[b].name)return this.extra.lastBehIndex=e,d.behaviors[b];e++}}}c=0;for(f=this.behaviors.length;c<f;c++){if(a===this.behaviors[c].name)return this.extra.lastBehIndex=
e,this.behaviors[c];e++}return null};cr.type_getBehaviorIndexByName=function(a){return this.getBehaviorByName(a)?this.extra.lastBehIndex:-1};cr.type_getEffectIndexByName=function(a){var f;var k=0;for(f=this.effect_types.length;k<f;k++)if(this.effect_types[k].name===a)return k;return-1};cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var a,g,k;this.updateIIDs();var e=this.getCurrentSol();var c=e.select_all,d=(a=this.runtime.getCurrentEventStack())&&a.current_event&&a.current_event.orblock;
a=0;for(g=this.container.length;a<g;a++){var b=this.container[a];if(b!==this){b.updateIIDs();var l=b.getCurrentSol();l.select_all=c;if(!c){cr.clearArray(l.instances);var n=0;for(k=e.instances.length;n<k;++n)l.instances[n]=b.getInstanceByIID(e.instances[n].iid);if(d)for(cr.clearArray(l.else_instances),n=0,k=e.else_instances.length;n<k;++n)l.else_instances[n]=b.getInstanceByIID(e.else_instances[n].iid)}}}}};cr.type_toString=function(){return"Type"+this.sid};cr.do_cmp=function(a,g,k){if("undefined"===
typeof a||"undefined"===typeof k)return!1;switch(g){case 0:return a===k;case 1:return a!==k;case 2:return a<k;case 3:return a<=k;case 4:return a>k;case 5:return a>=k;default:return!1}}})();cr.shaders={};cr.plugins_.AJAX=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=!1,e=null,c=null,d="",b=cr.plugins_.AJAX.prototype;b.Type=function(b){this.plugin=b;this.runtime=b.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(b){this.type=b;this.runtime=b.runtime;this.curTag=this.lastData="";this.progress=0;this.timeout=-1;if(k=this.runtime.isNWjs)e=require("path"),c=require("fs"),d=e.dirname((window.process||nw.process).execPath)+"\\"};var l=b.Instance.prototype,n=null;window.C2_AJAX_DCSide=function(b,
a,c){n&&("success"===b?(n.curTag=a,n.lastData=c,n.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,n),n.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,n)):"error"===b?(n.curTag=a,n.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,n),n.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,n)):"progress"===b&&(n.progress=c,n.curTag=a,n.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,n)))};l.onCreate=function(){n=this};l.saveToJSON=function(){return{lastData:this.lastData}};
l.loadFromJSON=function(b){this.lastData=b.lastData;this.curTag="";this.progress=0};var q={},h="";l.doRequest=function(b,a,e,f){if(this.runtime.isDirectCanvas)AppMobi.webview.execute('C2_AJAX_WebSide("'+b+'", "'+a+'", "'+e+'", '+(f?'"'+f+'"':"null")+");");else{var g=this,l=null,m=function(){g.curTag=b;g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,g);g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,g)},r=function(){if(k){var e=d+a;c.existsSync(e)?c.readFile(e,{encoding:"utf8"},
function(a,c){a?m():(g.curTag=b,g.lastData=c.replace(/\r\n/g,"\n"),g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,g),g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,g))}):m()}else m()},p=function(a){a.lengthComputable&&(g.progress=a.loaded/a.total,g.curTag=b,g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,g))};try{l=this.runtime.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;l.onreadystatechange=function(){4===l.readyState&&(g.curTag=
b,g.lastData=l.responseText?l.responseText.replace(/\r\n/g,"\n"):"",400<=l.status?(g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,g),g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,g)):k&&!g.lastData.length||!k&&0===l.status&&!g.lastData.length||(g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,g),g.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,g)))};this.runtime.isWindowsPhone8||(l.onerror=r,l.ontimeout=r,l.onabort=r,l.onprogress=p);l.open(e,a);
!this.runtime.isWindowsPhone8&&0<=this.timeout&&"undefined"!==typeof l.timeout&&(l.timeout=this.timeout);try{l.responseType="text"}catch(E){}f&&l.setRequestHeader&&!q.hasOwnProperty("Content-Type")&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(l.setRequestHeader){for(var n in q)if(q.hasOwnProperty(n))try{l.setRequestHeader(n,q[n])}catch(E){}q={}}if(h&&l.overrideMimeType){try{l.overrideMimeType(h)}catch(E){}h=""}f?l.send(f):l.send()}catch(E){r()}}};a.prototype.OnComplete=
function(b){return cr.equals_nocase(b,this.curTag)};a.prototype.OnAnyComplete=function(b){return!0};a.prototype.OnError=function(b){return cr.equals_nocase(b,this.curTag)};a.prototype.OnAnyError=function(b){return!0};a.prototype.OnProgress=function(b){return cr.equals_nocase(b,this.curTag)};b.cnds=new a;f.prototype.Request=function(b,a){var c=this;this.runtime.isWKWebView&&!this.runtime.isAbsoluteUrl(a)?this.runtime.fetchLocalFileViaCordovaAsText(a,function(a){c.curTag=b;c.lastData=a.replace(/\r\n/g,
"\n");c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,c)},function(a){c.curTag=b;c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,c)}):this.doRequest(b,a,"GET")};f.prototype.RequestFile=function(b,a){var c=this;this.runtime.isWKWebView?this.runtime.fetchLocalFileViaCordovaAsText(a,function(a){c.curTag=b;c.lastData=a.replace(/\r\n/g,"\n");c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,
c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,c)},function(a){c.curTag=b;c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,c)}):this.doRequest(b,a,"GET")};f.prototype.Post=function(b,a,c,d){this.doRequest(b,a,d,c)};f.prototype.SetTimeout=function(b){this.timeout=1E3*b};f.prototype.SetHeader=function(b,a){q[b]=a};f.prototype.OverrideMIMEType=function(b){h=b};b.acts=new f;g.prototype.LastData=function(b){b.set_string(this.lastData)};
g.prototype.Progress=function(b){b.set_float(this.progress)};g.prototype.Tag=function(b){b.set_string(this.curTag)};b.exps=new g})();cr.plugins_.Browser=function(a){this.runtime=a};
(function(){function a(){l&&n&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(b){q.onSWMessage(b)})}function f(){if(!m&&navigator.getBattery){var b=navigator.getBattery();m=!0;b&&b.then(function(b){h=b})}}function g(){}function k(){}function e(b){console&&console.warn&&console.warn("Fullscreen request failed: ",b);v.setSize(window.innerWidth,window.innerHeight)}function c(){}var d=cr.plugins_.Browser.prototype;d.Type=function(b){this.plugin=b;this.runtime=b.runtime};
var b=d.Type.prototype;b.onCreate=function(){};var l=!1,n=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C2_RegisterSW&&navigator.serviceWorker){var b=document.createElement("script");b.onload=function(){l=!0;a()};b.src="offlineClient.js";document.head.appendChild(b)}});var q=null;b.onAppBegin=function(){n=!0;a()};d.Instance=function(b){this.type=b;this.runtime=b.runtime};b=d.Instance.prototype;b.onCreate=function(){var b=this;window.addEventListener("resize",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,
b)});q=this;"undefined"!==typeof navigator.onLine&&(window.addEventListener("online",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,b)}),window.addEventListener("offline",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,b)}));this.runtime.isDirectCanvas||(document.addEventListener("appMobi.device.update.available",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,b)}),document.addEventListener("backbutton",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,
b)}),document.addEventListener("menubutton",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,b)}),document.addEventListener("searchbutton",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,b)}),document.addEventListener("tizenhwkey",function(a){switch(a.keyName){case "back":var c=b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,b);!c&&window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case "menu":(c=
b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,b))||a.preventDefault()}}));this.runtime.isWindows10&&"undefined"!==typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(a){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,b)&&(a.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(a){return!!b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,b)});
this.runtime.addSuspendCallback(function(a){a?b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,b):b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,b)});this.is_arcade="undefined"!==typeof window.is_scirra_arcade};b.onSWMessage=function(b){b=b.data.type;"downloading-update"===b?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===b||"update-pending"===b?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,this):
"offline-ready"===b&&this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var h=null,m=!1;g.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:!1};g.prototype.IsOnline=function(){return navigator?navigator.onLine:!1};g.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1};g.prototype.OnOnline=function(){return!0};g.prototype.OnOffline=function(){return!0};g.prototype.IsDownloadingUpdate=function(){return!1};g.prototype.OnUpdateReady=
function(){return!0};g.prototype.PageVisible=function(){return!this.runtime.isSuspended};g.prototype.OnPageVisible=function(){return!0};g.prototype.OnPageHidden=function(){return!0};g.prototype.OnResize=function(){return!0};g.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen)};g.prototype.OnBackButton=function(){return!0};g.prototype.OnMenuButton=function(){return!0};g.prototype.OnSearchButton=function(){return!0};
g.prototype.IsMetered=function(){var b=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return b?!!b.metered:!1};g.prototype.IsCharging=function(){var b=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(b)return!!b.charging;f();return h?!!h.charging:!0};g.prototype.IsPortraitLandscape=function(b){return(window.innerWidth<=window.innerHeight?0:1)===b};g.prototype.SupportsFullscreen=function(){if(this.runtime.isNodeWebkit)return!0;var b=this.runtime.canvasdiv||
this.runtime.canvas;return!!(b.requestFullscreen||b.mozRequestFullScreen||b.msRequestFullscreen||b.webkitRequestFullScreen)};g.prototype.OnUpdateFound=function(){return!0};g.prototype.OnUpdateReady=function(){return!0};g.prototype.OnOfflineReady=function(){return!0};d.cnds=new g;k.prototype.Alert=function(b){this.runtime.isDomFree||alert(b.toString())};k.prototype.Close=function(){this.runtime.isCocoonJs?CocoonJS.App.forceToFinish():window.tizen?window.tizen.application.getCurrentApplication().exit():
navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||this.runtime.isDomFree||window.close()};k.prototype.Focus=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().focus():this.is_arcade||this.runtime.isDomFree||window.focus()};k.prototype.Blur=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().blur():this.is_arcade||this.runtime.isDomFree||window.blur()};k.prototype.GoBack=function(){navigator.app&&
navigator.app.backHistory?navigator.app.backHistory():this.is_arcade||this.runtime.isDomFree||!window.back||window.back()};k.prototype.GoForward=function(){this.is_arcade||this.runtime.isDomFree||!window.forward||window.forward()};k.prototype.GoHome=function(){this.is_arcade||this.runtime.isDomFree||!window.home||window.home()};k.prototype.GoToURL=function(b,a){this.runtime.isCocoonJs?CocoonJS.App.openURL(b):this.runtime.isEjecta?ejecta.openURL(b):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(b)):
navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(b,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(b,"_system"):this.is_arcade||this.runtime.isDomFree||(2!==a||this.is_arcade?1!==a||this.is_arcade?window.location=b:window.parent.location=b:window.top.location=b)};k.prototype.GoToURLWindow=function(b,a){this.runtime.isCocoonJs?CocoonJS.App.openURL(b):this.runtime.isEjecta?ejecta.openURL(b):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(b)):
navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(b,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(b,"_system"):this.is_arcade||this.runtime.isDomFree||window.open(b,a)};k.prototype.Reload=function(){this.is_arcade||this.runtime.isDomFree||window.location.reload()};var p=!0,v=null;k.prototype.RequestFullScreen=function(b){this.runtime.isDomFree?cr.logexport("[Construct 2] Requesting fullscreen is not supported on this platform - the request has been ignored"):
(2<=b&&(b+=1),6===b&&(b=2),this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!0):!this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().enterFullscreen(),this.runtime.isNodeFullscreen=!0,this.runtime.fullscreen_scaling=2<=b?b:0):document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement||(this.runtime.fullscreen_scaling=2<=b?b:0,b=document.documentElement,p&&(p=!1,v=this.runtime,b.addEventListener("mozfullscreenerror",
e),b.addEventListener("webkitfullscreenerror",e),b.addEventListener("MSFullscreenError",e),b.addEventListener("fullscreenerror",e)),b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen?b.msRequestFullscreen():b.webkitRequestFullScreen&&("undefined"!==typeof Element&&"undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?b.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):b.webkitRequestFullScreen())))};k.prototype.CancelFullScreen=function(){this.runtime.isDomFree?
cr.logexport("[Construct 2] Exiting fullscreen is not supported on this platform - the request has been ignored"):this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!1):this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().leaveFullscreen(),this.runtime.isNodeFullscreen=!1):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&
document.webkitCancelFullScreen()};k.prototype.Vibrate=function(b){try{var a=b.split(","),c;var d=0;for(c=a.length;d<c;d++)a[d]=parseInt(a[d],10);navigator.vibrate?navigator.vibrate(a):navigator.mozVibrate?navigator.mozVibrate(a):navigator.webkitVibrate?navigator.webkitVibrate(a):navigator.msVibrate&&navigator.msVibrate(a)}catch(A){}};k.prototype.InvokeDownload=function(b,a){var c=document.createElement("a");if("undefined"===typeof c.download)window.open(b);else{var d=document.getElementsByTagName("body")[0];
c.textContent=a;c.href=b;c.download=a;d.appendChild(c);b=new MouseEvent("click");c.dispatchEvent(b);d.removeChild(c)}};k.prototype.InvokeDownloadString=function(b,a,c){var d="data:"+a+","+encodeURIComponent(b);b=document.createElement("a");"undefined"===typeof b.download?window.open(d):(a=document.getElementsByTagName("body")[0],b.textContent=c,b.href=d,b.download=c,a.appendChild(b),c=new MouseEvent("click"),b.dispatchEvent(c),a.removeChild(b))};k.prototype.ConsoleLog=function(b,a){"undefined"!==
typeof console&&(0===b&&console.log&&console.log(a.toString()),1===b&&console.warn&&console.warn(a.toString()),2===b&&console.error&&console.error(a.toString()))};k.prototype.ConsoleGroup=function(b){console&&console.group&&console.group(b)};k.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()};k.prototype.ExecJs=function(b){try{eval&&eval(b)}catch(z){console&&console.error&&console.error("Error executing Javascript: ",z)}};var u="portrait landscape portrait-primary portrait-secondary landscape-primary landscape-secondary".split(" ");
k.prototype.LockOrientation=function(b){b=Math.floor(b);0>b||b>=u.length||(this.runtime.autoLockOrientation=!1,b=u[b],screen.orientation&&screen.orientation.lock?screen.orientation.lock(b):screen.lockOrientation?screen.lockOrientation(b):screen.webkitLockOrientation?screen.webkitLockOrientation(b):screen.mozLockOrientation?screen.mozLockOrientation(b):screen.msLockOrientation&&screen.msLockOrientation(b))};k.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1;screen.orientation&&
screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()};d.acts=new k;c.prototype.URL=function(b){b.set_string(this.runtime.isDomFree?"":window.location.toString())};c.prototype.Protocol=function(b){b.set_string(this.runtime.isDomFree?"":window.location.protocol)};c.prototype.Domain=
function(b){b.set_string(this.runtime.isDomFree?"":window.location.hostname)};c.prototype.PathName=function(b){b.set_string(this.runtime.isDomFree?"":window.location.pathname)};c.prototype.Hash=function(b){b.set_string(this.runtime.isDomFree?"":window.location.hash)};c.prototype.Referrer=function(b){b.set_string(this.runtime.isDomFree?"":document.referrer)};c.prototype.Title=function(b){b.set_string(this.runtime.isDomFree?"":document.title)};c.prototype.Name=function(b){b.set_string(this.runtime.isDomFree?
"":navigator.appName)};c.prototype.Version=function(b){b.set_string(this.runtime.isDomFree?"":navigator.appVersion)};c.prototype.Language=function(b){navigator&&navigator.language?b.set_string(navigator.language):b.set_string("")};c.prototype.Platform=function(b){b.set_string(this.runtime.isDomFree?"":navigator.platform)};c.prototype.Product=function(b){navigator&&navigator.product?b.set_string(navigator.product):b.set_string("")};c.prototype.Vendor=function(b){navigator&&navigator.vendor?b.set_string(navigator.vendor):
b.set_string("")};c.prototype.UserAgent=function(b){b.set_string(this.runtime.isDomFree?"":navigator.userAgent)};c.prototype.QueryString=function(b){b.set_string(this.runtime.isDomFree?"":window.location.search)};c.prototype.QueryParam=function(b,a){this.runtime.isDomFree?b.set_string(""):(a=RegExp("[?&]"+a+"=([^&]*)").exec(window.location.search))?b.set_string(decodeURIComponent(a[1].replace(/\+/g," "))):b.set_string("")};c.prototype.Bandwidth=function(b){var a=navigator.connection||navigator.mozConnection||
navigator.webkitConnection;a?"undefined"!==typeof a.bandwidth?b.set_float(a.bandwidth):"undefined"!==typeof a.downlinkMax?b.set_float(a.downlinkMax):b.set_float(Number.POSITIVE_INFINITY):b.set_float(Number.POSITIVE_INFINITY)};c.prototype.ConnectionType=function(b){var a=navigator.connection||navigator.mozConnection||navigator.webkitConnection;a?b.set_string(a.type||"unknown"):b.set_string("unknown")};c.prototype.BatteryLevel=function(b){var a=navigator.battery||navigator.mozBattery||navigator.webkitBattery;
a?b.set_float(a.level):(f(),h?b.set_float(h.level):b.set_float(1))};c.prototype.BatteryTimeLeft=function(b){var a=navigator.battery||navigator.mozBattery||navigator.webkitBattery;a?b.set_float(a.dischargingTime):(f(),h?b.set_float(h.dischargingTime):b.set_float(Number.POSITIVE_INFINITY))};c.prototype.ExecJS=function(b,a){if(eval){var c=0;try{c=eval(a)}catch(r){console&&console.error&&console.error("Error executing Javascript: ",r)}"number"===typeof c?b.set_any(c):"string"===typeof c?b.set_any(c):
"boolean"===typeof c?b.set_any(c?1:0):b.set_any(0)}else b.set_any(0)};c.prototype.ScreenWidth=function(b){b.set_int(screen.width)};c.prototype.ScreenHeight=function(b){b.set_int(screen.height)};c.prototype.DevicePixelRatio=function(b){b.set_float(this.runtime.devicePixelRatio)};c.prototype.WindowInnerWidth=function(b){b.set_int(window.innerWidth)};c.prototype.WindowInnerHeight=function(b){b.set_int(window.innerHeight)};c.prototype.WindowOuterWidth=function(b){b.set_int(window.outerWidth)};c.prototype.WindowOuterHeight=
function(b){b.set_int(window.outerHeight)};d.exps=new c})();cr.plugins_.Button=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.plugins_.Button.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Button plugin not supported on this platform - the object will not be created"):(this.isCheckbox=1===this.properties[0],this.inputElem=document.createElement("input"),this.elem=
this.isCheckbox?document.createElement("label"):this.inputElem,this.labelText=null,this.inputElem.type=this.isCheckbox?"checkbox":"button",this.inputElem.id=this.properties[6],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.isCheckbox?(jQuery(this.inputElem).appendTo(this.elem),this.labelText=document.createTextNode(this.properties[1]),jQuery(this.elem).append(this.labelText),this.inputElem.checked=0!==this.properties[7],jQuery(this.elem).css("font-family","sans-serif"),
jQuery(this.elem).css("display","inline-block"),jQuery(this.elem).css("color","black")):this.inputElem.value=this.properties[1],this.elem.title=this.properties[2],this.inputElem.disabled=0===this.properties[4],this.autoFontSize=0!==this.properties[5],this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.inputElem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.Button.prototype.cnds.OnClicked,
a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchend",function(a){a.stopPropagation()},!1),jQuery(this.elem).mousedown(function(a){a.stopPropagation()}),jQuery(this.elem).mouseup(function(a){a.stopPropagation()}),jQuery(this.elem).keydown(function(a){a.stopPropagation()}),jQuery(this.elem).keyup(function(a){a.stopPropagation()}),
this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0,this.updatePosition(!0),this.runtime.tickMe(this))};k.saveToJSON=function(){var a={tooltip:this.elem.title,disabled:!!this.inputElem.disabled};this.isCheckbox?(a.checked=!!this.inputElem.checked,a.text=this.labelText.nodeValue):a.text=this.elem.value;return a};k.loadFromJSON=function(a){this.elem.title=a.tooltip;this.inputElem.disabled=a.disabled;this.isCheckbox?(this.inputElem.checked=a.checked,this.labelText.nodeValue=
a.text):this.elem.value=a.text};k.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};k.tick=function(){this.updatePosition()};k.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),d=this.layer.layerToCanvas(this.x,this.y,!1),b=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,
g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=b||0>=e||c>=f||d>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>c&&(c=1),1>d&&(d=1),b>=f&&(b=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==d||this.lastRight!==b||this.lastBottom!==e||this.lastWinWidth!==f||this.lastWinHeight!==g?(this.lastLeft=c,this.lastTop=d,this.lastRight=b,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=
g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,f=Math.round(d)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(b-c)),jQuery(this.elem).height(Math.round(e-d)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(jQuery(this.elem).show(),
this.element_hidden=!1))}};k.draw=function(a){};k.drawGL=function(a){};a.prototype.OnClicked=function(){return!0};a.prototype.IsChecked=function(){return this.isCheckbox&&this.inputElem.checked};g.cnds=new a;f.prototype.SetText=function(a){this.runtime.isDomFree||(this.isCheckbox?this.labelText.nodeValue=a:this.elem.value=a)};f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetEnabled=
function(a){this.runtime.isDomFree||(this.inputElem.disabled=0===a)};f.prototype.SetFocus=function(){this.runtime.isDomFree||this.inputElem.focus()};f.prototype.SetBlur=function(){this.runtime.isDomFree||this.inputElem.blur()};f.prototype.SetCSSStyle=function(a,c){this.runtime.isDomFree||jQuery(this.elem).css(a,c)};f.prototype.SetChecked=function(a){!this.runtime.isDomFree&&this.isCheckbox&&(this.inputElem.checked=1===a)};f.prototype.ToggleChecked=function(){!this.runtime.isDomFree&&this.isCheckbox&&
(this.inputElem.checked=!this.inputElem.checked)};g.acts=new f;g.exps=new function(){}})();var lastCSS="",importList=[];function importcssfile(a){if(-1==importList.indexOf(a)){var f=document.createElement("link");f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");f.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(f);importList.push(a)}}
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,f){f=f||0;for(var g=this.length;f<g;){if(this[f]===a)return f;++f}return-1});function removecssfile(a){for(var f=document.getElementsByTagName("link"),g=f.length;0<=g;g--)f[g]&&null!=f[g].getAttribute("href")&&-1!=f[g].getAttribute("href").indexOf(a)&&f[g].parentNode.removeChild(f[g]);importList.splice(importList.indexOf(a),1)}cr.plugins_.CSS_import=function(a){this.runtime=a};
(function(){var a=cr.plugins_.CSS_import.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a){this.type=a;this.runtime=a.runtime};var f=a.Instance.prototype;f.onCreate=function(){""!=this.properties[0]&&(importcssfile(this.properties[0]),lastCSS=this.properties[0])};f.onDestroy=function(){};f.draw=function(a){};f.drawGL=function(a){};a.cnds={};a.cnds.CompareCSS=function(a,f){return this.properties[0]===a};a.acts={};f=a.acts;
f.SetCSS=function(a){importcssfile(a);lastCSS=a};f.RemCSS=function(a){removecssfile(a)};a.exps={};a.exps.GetCSS=function(a){""!=lastCSS?a.set_string(lastCSS):""!=this.properties[0]?a.set_string(this.properties[0]):a.set_string("")}})();cr.plugins_.Dictionary=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.Dictionary.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.dictionary={};this.cur_key="";this.key_count=0};e.saveToJSON=function(){return this.dictionary};e.loadFromJSON=function(a){this.dictionary=a;this.key_count=0;for(var c in this.dictionary)this.dictionary.hasOwnProperty(c)&&
this.key_count++};a.prototype.CompareValue=function(a,d,b){return cr.do_cmp(this.dictionary[a],d,b)};a.prototype.ForEachKey=function(){var a=this.runtime.getCurrentEventStack().current_event,d;for(d in this.dictionary)this.dictionary.hasOwnProperty(d)&&(this.cur_key=d,this.runtime.pushCopySol(a.solModifiers),a.retrigger(),this.runtime.popSol(a.solModifiers));this.cur_key="";return!1};a.prototype.CompareCurrentValue=function(a,d){return cr.do_cmp(this.dictionary[this.cur_key],a,d)};a.prototype.HasKey=
function(a){return this.dictionary.hasOwnProperty(a)};a.prototype.IsEmpty=function(){return 0===this.key_count};k.cnds=new a;f.prototype.AddKey=function(a,d){this.dictionary.hasOwnProperty(a)||this.key_count++;this.dictionary[a]=d};f.prototype.SetKey=function(a,d){this.dictionary.hasOwnProperty(a)&&(this.dictionary[a]=d)};f.prototype.DeleteKey=function(a){this.dictionary.hasOwnProperty(a)&&(delete this.dictionary[a],this.key_count--)};f.prototype.Clear=function(){cr.wipe(this.dictionary);this.key_count=
0};f.prototype.JSONLoad=function(a){try{var c=JSON.parse(a)}catch(l){return}if(c.c2dictionary){this.dictionary=c.data;this.key_count=0;for(var b in this.dictionary)this.dictionary.hasOwnProperty(b)&&this.key_count++}};f.prototype.JSONDownload=function(a){var c=document.createElement("a");if("undefined"===typeof c.download)c="data:text/html,"+encodeURIComponent("<p><a download='data.json' href=\"data:application/json,"+encodeURIComponent(JSON.stringify({c2dictionary:!0,data:this.dictionary}))+'">Download link</a></p>'),
window.open(c);else{var b=document.getElementsByTagName("body")[0];c.textContent=a;c.href="data:application/json,"+encodeURIComponent(JSON.stringify({c2dictionary:!0,data:this.dictionary}));c.download=a;b.appendChild(c);a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);c.dispatchEvent(a);b.removeChild(c)}};k.acts=new f;g.prototype.Get=function(a,d){this.dictionary.hasOwnProperty(d)?a.set_any(this.dictionary[d]):a.set_int(0)};g.prototype.KeyCount=
function(a){a.set_int(this.key_count)};g.prototype.CurrentKey=function(a){a.set_string(this.cur_key)};g.prototype.CurrentValue=function(a){this.dictionary.hasOwnProperty(this.cur_key)?a.set_any(this.dictionary[this.cur_key]):a.set_int(0)};g.prototype.AsJSON=function(a){a.set_string(JSON.stringify({c2dictionary:!0,data:this.dictionary}))};k.exps=new g})();cr.plugins_.Function=function(a){this.runtime=a};
(function(){function a(){this.name="";this.retVal=0;this.params=[]}function f(){l++;l===b.length&&b.push(new a);return b[l]}function g(){return 0>l?null:b[l]}function k(){}function e(){}function c(){}var d=cr.plugins_.Function.prototype;d.Type=function(b){this.plugin=b;this.runtime=b.runtime};d.Type.prototype.onCreate=function(){};d.Instance=function(b){this.type=b;this.runtime=b.runtime};var b=[],l=-1;d.Instance.prototype.onCreate=function(){var b=this;window.c2_callFunction=function(a,c){var d,
e=f();e.name=a.toLowerCase();e.retVal=0;if(c)for(e.params.length=c.length,a=0,d=c.length;a<d;++a){var h=c[a];e.params[a]="number"===typeof h||"string"===typeof h?h:"boolean"===typeof h?h?1:0:0}else cr.clearArray(e.params);b.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,b,e.name);l--;return e.retVal}};k.prototype.OnFunction=function(b){var a=g();return a?cr.equals_nocase(b,a.name):!1};k.prototype.CompareParam=function(b,a,c){var d=g();if(!d)return!1;b=cr.floor(b);return 0>b||b>=d.params.length?
!1:cr.do_cmp(d.params[b],a,c)};d.cnds=new k;e.prototype.CallFunction=function(b,a){var c=f();c.name=b.toLowerCase();c.retVal=0;cr.shallowAssignArray(c.params,a);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,c.name);l--};e.prototype.SetReturnValue=function(b){var a=g();a&&(a.retVal=b)};e.prototype.CallExpression=function(b){};d.acts=new e;c.prototype.ReturnValue=function(a){if(b.length){var c=l+1;c>=b.length&&(c=b.length-1);c=b[c]}else c=null;c?a.set_any(c.retVal):a.set_int(0)};
c.prototype.ParamCount=function(b){var a=g();a?b.set_int(a.params.length):b.set_int(0)};c.prototype.Param=function(b,a){a=cr.floor(a);var c=g();c?0<=a&&a<c.params.length?b.set_any(c.params[a]):b.set_int(0):b.set_int(0)};c.prototype.Call=function(b,a){var c=f();c.name=a.toLowerCase();c.retVal=0;cr.clearArray(c.params);var d;var e=2;for(d=arguments.length;e<d;e++)c.params.push(arguments[e]);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,c.name);l--;b.set_any(c.retVal)};d.exps=
new c})();cr.plugins_.Keyboard=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(a){a=Math.floor(a);switch(a){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"\u2190";case 38:return"\u2191";case 39:return"\u2192";case 40:return"\u2193";case 45:return"insert";case 46:return"del";
case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";
case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(a)}}
var k=cr.plugins_.Keyboard.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime;this.keyMap=Array(256);this.usedKeys=Array(256);this.triggerKey=0};var e=k.Instance.prototype;e.onCreate=function(){var a=this;this.runtime.isDomFree||(jQuery(document).keydown(function(b){a.onKeyDown(b)}),jQuery(document).keyup(function(b){a.onKeyUp(b)}))};var c=[32,33,34,35,36,37,38,39,40,44];e.onKeyDown=function(a){var b=
!1;window!=window.top&&-1<c.indexOf(a.which)&&(a.preventDefault(),b=!0,a.stopPropagation());if(this.keyMap[a.which])this.usedKeys[a.which]&&!b&&a.preventDefault();else{this.keyMap[a.which]=!0;this.triggerKey=a.which;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var d=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKey,this),e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,this);this.runtime.isInUserInputEvent=
!1;if(d||e)this.usedKeys[a.which]=!0,b||a.preventDefault()}};e.onKeyUp=function(a){this.keyMap[a.which]=!1;this.triggerKey=a.which;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var b=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),c=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);this.runtime.isInUserInputEvent=!1;if(b||c||this.usedKeys[a.which])this.usedKeys[a.which]=
!0,a.preventDefault()};e.onWindowBlur=function(){var a;for(a=0;256>a;++a)if(this.keyMap[a]){this.keyMap[a]=!1;this.triggerKey=a;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var b=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),c=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(b||c)this.usedKeys[a]=!0}};e.saveToJSON=function(){return{triggerKey:this.triggerKey}};e.loadFromJSON=function(a){this.triggerKey=
a.triggerKey};a.prototype.IsKeyDown=function(a){return this.keyMap[a]};a.prototype.OnKey=function(a){return a===this.triggerKey};a.prototype.OnAnyKey=function(a){return!0};a.prototype.OnAnyKeyReleased=function(a){return!0};a.prototype.OnKeyReleased=function(a){return a===this.triggerKey};a.prototype.IsKeyCodeDown=function(a){a=Math.floor(a);return 0>a||a>=this.keyMap.length?!1:this.keyMap[a]};a.prototype.OnKeyCode=function(a){return a===this.triggerKey};a.prototype.OnKeyCodeReleased=function(a){return a===
this.triggerKey};k.cnds=new a;k.acts=new function(){};f.prototype.LastKeyCode=function(a){a.set_int(this.triggerKey)};f.prototype.StringFromKeyCode=function(a,b){a.set_string(g(b))};k.exps=new f})();cr.plugins_.List=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.List.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] List plugin not supported on this platform - the object will not be created");else{this.elem=document.createElement("select");this.elem.id=this.properties[7];
jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.elem.title=this.properties[1];this.elem.disabled=0===this.properties[3];0===this.properties[4]&&(this.elem.size=2);this.elem.multiple=0!==this.properties[5];this.autoFontSize=0!==this.properties[6];0===this.properties[2]&&(jQuery(this.elem).hide(),this.visible=!1);if(this.properties[0]){var a=this.properties[0].split(";"),d;var b=0;for(d=a.length;b<d;b++){var e=document.createElement("option");e.text=a[b];this.elem.add(e)}}var f=
this;this.elem.onchange=function(){f.runtime.trigger(cr.plugins_.List.prototype.cnds.OnSelectionChanged,f)};this.elem.onclick=function(b){b.stopPropagation();f.runtime.isInUserInputEvent=!0;f.runtime.trigger(cr.plugins_.List.prototype.cnds.OnClicked,f);f.runtime.isInUserInputEvent=!1};this.elem.ondblclick=function(b){b.stopPropagation();f.runtime.isInUserInputEvent=!0;f.runtime.trigger(cr.plugins_.List.prototype.cnds.OnDoubleClicked,f);f.runtime.isInUserInputEvent=!1};this.elem.addEventListener("touchstart",
function(b){b.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(b){b.stopPropagation()},!1);this.elem.addEventListener("touchend",function(b){b.stopPropagation()},!1);jQuery(this.elem).mousedown(function(b){b.stopPropagation()});jQuery(this.elem).mouseup(function(b){b.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.isVisible=!0;this.updatePosition(!0);this.runtime.tickMe(this)}};e.saveToJSON=function(){var a=
{tooltip:this.elem.title,disabled:!!this.elem.disabled,items:[],sel:[]},d,b=a.items;var e=0;for(d=this.elem.length;e<d;e++)b.push(this.elem.options[e].text);b=a.sel;if(this.elem.multiple)for(e=0,d=this.elem.length;e<d;e++)this.elem.options[e].selected&&b.push(e);else b.push(this.elem.selectedIndex);return a};e.loadFromJSON=function(a){this.elem.title=a.tooltip;this.elem.disabled=a.disabled;for(var c=a.items;this.elem.length;)this.elem.remove(this.elem.length-1);var b;var e=0;for(b=c.length;e<b;e++){var f=
document.createElement("option");f.text=c[e];this.elem.add(f)}a=a.sel;if(this.elem.multiple)for(e=0,b=a.length;e<b;e++)a[e]<this.elem.length&&(this.elem.options[a[e]].selected=!0);else 1<=a.length&&(this.elem.selectedIndex=a[0])};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),b=this.layer.layerToCanvas(this.x,
this.y,!1),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),f=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),g=this.runtime.width/this.runtime.devicePixelRatio,h=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=e||0>=f||c>=g||b>=h?(this.isVisible&&jQuery(this.elem).hide(),this.isVisible=!1):(1>c&&(c=1),1>b&&(b=1),e>=g&&(e=g-1),f>=h&&(f=h-1),g=window.innerWidth,h=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==b||
this.lastRight!==e||this.lastBottom!==f||this.lastWinWidth!==g||this.lastWinHeight!==h?(this.lastLeft=c,this.lastTop=b,this.lastRight=e,this.lastBottom=f,this.lastWinWidth=g,this.lastWinHeight=h,this.isVisible||(jQuery(this.elem).show(),this.isVisible=!0),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,g=Math.round(b)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:g}),jQuery(this.elem).width(Math.round(e-c)),jQuery(this.elem).height(Math.round(f-
b)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.isVisible||(jQuery(this.elem).show(),this.isVisible=!0))}};e.draw=function(a){};e.drawGL=function(a){};a.prototype.CompareSelection=function(a,d){return cr.do_cmp(this.elem.selectedIndex,a,d)};a.prototype.OnSelectionChanged=function(){return!0};a.prototype.OnClicked=function(){return!0};a.prototype.OnDoubleClicked=function(){return!0};a.prototype.CompareSelectedText=function(a,
d){var b=this.elem.selectedIndex;if(0>b||b>=this.elem.length)return!1;b=this.elem.options[b].text;return d?b==a:cr.equals_nocase(b,a)};a.prototype.CompareTextAt=function(a,d,b){a=Math.floor(a);if(0>a||a>=this.elem.length)return!1;a=this.elem.options[a].text;return b?a==d:cr.equals_nocase(a,d)};k.cnds=new a;f.prototype.Select=function(a){this.runtime.isDomFree||(this.elem.selectedIndex=a)};f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||
(this.visible=0!==a)};f.prototype.SetEnabled=function(a){this.runtime.isDomFree||(this.elem.disabled=0===a)};f.prototype.SetFocus=function(){this.runtime.isDomFree||this.elem.focus()};f.prototype.SetBlur=function(){this.runtime.isDomFree||this.elem.blur()};f.prototype.SetCSSStyle=function(a,d){this.runtime.isDomFree||jQuery(this.elem).css(a,d)};f.prototype.AddItem=function(a){if(!this.runtime.isDomFree){var c=document.createElement("option");c.text=a;this.elem.add(c)}};f.prototype.AddItemAt=function(a,
d){if(!this.runtime.isDomFree){a=Math.floor(a);0>a&&(a=0);var b=document.createElement("option");b.text=d;a>=this.elem.length?this.elem.add(b):this.elem.add(b,this.elem.options[a])}};f.prototype.Remove=function(a){this.runtime.isDomFree||(a=Math.floor(a),this.elem.remove(a))};f.prototype.SetItemText=function(a,d){this.runtime.isDomFree||(a=Math.floor(a),0>a||a>=this.elem.length||(this.elem.options[a].text=d))};f.prototype.Clear=function(){this.runtime.isDomFree||(this.elem.innerHTML="")};k.acts=new f;
g.prototype.ItemCount=function(a){this.runtime.isDomFree?a.set_int(0):a.set_int(this.elem.length)};g.prototype.ItemTextAt=function(a,d){this.runtime.isDomFree?a.set_string(""):(d=Math.floor(d),0>d||d>=this.elem.length?a.set_string(""):a.set_string(this.elem.options[d].text))};g.prototype.SelectedIndex=function(a){this.runtime.isDomFree?a.set_int(0):a.set_int(this.elem.selectedIndex)};g.prototype.SelectedText=function(a){if(this.runtime.isDomFree)a.set_string("");else{var c=this.elem.selectedIndex;
0>c||c>=this.elem.length?a.set_string(""):a.set_string(this.elem.options[c].text)}};g.prototype.SelectedCount=function(a){if(this.runtime.isDomFree)a.set_int(0);else{var c,b=0;var e=0;for(c=this.elem.length;e<c;e++)this.elem.options[e].selected&&b++;a.set_int(b)}};g.prototype.SelectedIndexAt=function(a,d){if(this.runtime.isDomFree)a.set_int(0);else{d=Math.floor(d);var b,c=0,e=0;var f=0;for(b=this.elem.length;f<b;f++)if(this.elem.options[f].selected){if(c===d){e=f;break}c++}a.set_int(e)}};g.prototype.SelectedTextAt=
function(a,d){if(this.runtime.isDomFree)a.set_string("");else{d=Math.floor(d);var b,c=0,e="";var f=0;for(b=this.elem.length;f<b;f++)if(this.elem.options[f].selected){if(c===d){e=this.elem.options[f].text;break}c++}a.set_string(e)}};k.exps=new g})();cr.plugins_.Mouse=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.Mouse.prototype;k.Type=function(b){this.plugin=b;this.runtime=b.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(b){this.type=b;this.runtime=b.runtime;this.buttonMap=Array(4);this.triggerDir=this.triggerType=this.triggerButton=this.mouseYcanvas=this.mouseXcanvas=0;this.handled=!1};var e=k.Instance.prototype;e.onCreate=function(){var b=this;if(!this.runtime.isDomFree){jQuery(document).mousemove(function(a){b.onMouseMove(a)});
jQuery(document).mousedown(function(a){b.onMouseDown(a)});jQuery(document).mouseup(function(a){b.onMouseUp(a)});jQuery(document).dblclick(function(a){b.onDoubleClick(a)});var a=function(a){b.onWheel(a)};document.addEventListener("mousewheel",a,!1);document.addEventListener("DOMMouseScroll",a,!1)}};var c={left:0,top:0};e.onMouseMove=function(b){var a=this.runtime.isDomFree?c:jQuery(this.runtime.canvas).offset();this.mouseXcanvas=b.pageX-a.left;this.mouseYcanvas=b.pageY-a.top};e.mouseInGame=function(){return 0<
this.runtime.fullscreen_mode?!0:0<=this.mouseXcanvas&&0<=this.mouseYcanvas&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height};e.onMouseDown=function(b){this.mouseInGame()&&(this.buttonMap[b.which]=!0,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerButton=b.which-1,this.triggerType=0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,
this),this.runtime.isInUserInputEvent=!1)};e.onMouseUp=function(b){this.buttonMap[b.which]&&(this.runtime.had_a_click&&!this.runtime.isMobile&&b.preventDefault(),this.runtime.had_a_click=!0,this.buttonMap[b.which]=!1,this.runtime.isInUserInputEvent=!0,this.triggerButton=b.which-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this),this.runtime.isInUserInputEvent=!1)};e.onDoubleClick=function(b){this.mouseInGame()&&(b.preventDefault(),this.runtime.isInUserInputEvent=!0,this.triggerButton=
b.which-1,this.triggerType=1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.isInUserInputEvent=!1)};e.onWheel=function(b){this.triggerDir=0>(b.wheelDelta?b.wheelDelta:b.detail?-b.detail:0)?0:1;this.handled=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnWheel,this);this.runtime.isInUserInputEvent=!1;this.handled&&cr.isCanvasInputEvent(b)&&b.preventDefault()};
e.onWindowBlur=function(){var b;var a=0;for(b=this.buttonMap.length;a<b;++a)this.buttonMap[a]&&(this.buttonMap[a]=!1,this.triggerButton=a-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this))};a.prototype.OnClick=function(b,a){return b===this.triggerButton&&a===this.triggerType};a.prototype.OnAnyClick=function(){return!0};a.prototype.IsButtonDown=function(b){return this.buttonMap[b+1]};a.prototype.OnRelease=function(b){return b===this.triggerButton};a.prototype.IsOverObject=function(b){var a=
this.runtime.getCurrentCondition();return cr.xor(this.runtime.testAndSelectCanvasPointOverlap(b,this.mouseXcanvas,this.mouseYcanvas,a.inverted),a.inverted)};a.prototype.OnObjectClicked=function(b,a,c){return b!==this.triggerButton||a!==this.triggerType?!1:this.runtime.testAndSelectCanvasPointOverlap(c,this.mouseXcanvas,this.mouseYcanvas,!1)};a.prototype.OnWheel=function(b){this.handled=!0;return b===this.triggerDir};k.cnds=new a;var d=null;f.prototype.SetCursor=function(b){this.runtime.isDomFree||
(b="auto pointer text crosshair move help wait none".split(" ")[b],d!==b&&(d=b,document.body.style.cursor=b))};f.prototype.SetCursorSprite=function(b){this.runtime.isDomFree||this.runtime.isMobile||!b||(b=b.getFirstPicked())&&b.curFrame&&(b=b.curFrame,d!==b&&(d=b,b="url("+b.getDataUri()+") "+Math.round(b.hotspotX*b.width)+" "+Math.round(b.hotspotY*b.height)+", auto",document.body.style.cursor="",document.body.style.cursor=b))};k.acts=new f;g.prototype.X=function(b,a){if(cr.is_undefined(a)){a=this.runtime.getLayerByNumber(0);
var c=a.scale;var d=a.zoomRate;var e=a.parallaxX;var f=a.angle;a.scale=1;a.zoomRate=1;a.parallaxX=1;a.angle=0;b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0));a.scale=c;a.zoomRate=d;a.parallaxX=e;a.angle=f}else(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)):b.set_float(0)};g.prototype.Y=function(b,a){if(cr.is_undefined(a)){a=this.runtime.getLayerByNumber(0);var c=a.scale;var d=
a.zoomRate;var e=a.parallaxY;var f=a.angle;a.scale=1;a.zoomRate=1;a.parallaxY=1;a.angle=0;b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1));a.scale=c;a.zoomRate=d;a.parallaxY=e;a.angle=f}else(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)):b.set_float(0)};g.prototype.AbsoluteX=function(b){b.set_float(this.mouseXcanvas)};g.prototype.AbsoluteY=function(b){b.set_float(this.mouseYcanvas)};
k.exps=new g})();cr.plugins_.NodeWebkit=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=!1,e=null,c=null,d=null,b=null,l=null,n=null,q="",h="",m="",p="\\",v=[],u="",y="",z=cr.plugins_.NodeWebkit.prototype;z.Type=function(b){this.plugin=b;this.runtime=b.runtime};z.Type.prototype.onCreate=function(){};z.Instance=function(b){this.type=b;this.runtime=b.runtime};var x=z.Instance.prototype;x.onCreate=function(){k=this.runtime.isNWjs;var a=this;if(k){e=require("path");c=require("fs");d=require("os");l=require("child_process");n=window.process||
nw.process;"win32"!==n.platform&&(p="/");q=e.dirname(n.execPath)+p;h=d.homedir()+p;b=window.nwgui;m=n.mainModule.filename;var f=Math.max(m.lastIndexOf("/"),m.lastIndexOf("\\"));-1!==f&&(m=m.substr(0,f+1));window.ondrop=function(b){b.preventDefault();for(var c=0;c<b.dataTransfer.files.length;++c)u=b.dataTransfer.files[c].path,a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFileDrop,a);return!1};var g=document.getElementById("c2nwOpenFileDialog");g.onchange=function(b){y=g.value;a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnOpenDlg,
a);try{g.value=null}catch(N){}};g.oncancel=function(){a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnOpenDlgCancel,a)};var x=document.getElementById("c2nwChooseFolderDialog");x.onchange=function(b){y=x.value;a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFolderDlg,a);try{x.value=null}catch(N){}};x.oncancel=function(){a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFolderDlgCancel,a)};var t=document.getElementById("c2nwSaveDialog");t.onchange=function(b){y=t.value;a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnSaveDlg,
a);try{t.value=null}catch(N){}};t.oncancel=function(){a.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnSaveDlgCancel,a)}}};x.onDestroy=function(){};x.saveToJSON=function(){return{}};x.loadFromJSON=function(b){};a.prototype.PathExists=function(b){return k?c.existsSync(b):!1};a.prototype.OnFileDrop=function(){return!0};a.prototype.OnOpenDlg=function(){return!0};a.prototype.OnFolderDlg=function(){return!0};a.prototype.OnSaveDlg=function(){return!0};a.prototype.OnOpenDlgCancel=function(){return!0};
a.prototype.OnFolderDlgCancel=function(){return!0};a.prototype.OnSaveDlgCancel=function(){return!0};z.cnds=new a;f.prototype.WriteFile=function(b,a){if(k)try{c.writeFileSync(b,a,{encoding:"utf8"})}catch(D){}};f.prototype.RenameFile=function(b,a){if(k)try{c.renameSync(b,a)}catch(D){}};f.prototype.DeleteFile=function(b){if(k)try{c.unlinkSync(b)}catch(A){}};f.prototype.CopyFile=function(b,a){if(k&&b!==a)try{var d=c.readFileSync(b,{flags:"rb"});c.writeFileSync(a,d,{flags:"wb"})}catch(E){}};f.prototype.MoveFile=
function(b,a){if(k&&b!==a)try{var d=c.readFileSync(b,{flags:"rb"});c.writeFileSync(a,d,{flags:"wb"});c.existsSync(a)&&c.unlinkSync(b)}catch(E){}};f.prototype.RunFile=function(b){k&&l.exec(b,function(){})};f.prototype.ShellOpen=function(b){k&&nw.Shell.openItem(b)};f.prototype.OpenBrowser=function(b){if(k){switch(n.platform){case "win32":var a='start ""';break;case "darwin":a="open";break;default:a=e.join(__dirname,"../vendor/xdg-open")}l.exec(a+' "'+b.replace(/"/,'\\"')+'"')}};f.prototype.CreateFolder=
function(b){if(k)try{c.mkdirSync(b)}catch(A){}};f.prototype.AppendFile=function(b,a){if(k)try{c.appendFileSync(b,a,{encoding:"utf8"})}catch(D){}};f.prototype.ListFiles=function(b){if(k){try{v=c.readdirSync(b)}catch(A){v=[],console.warn("Error listing files at '"+b+"': ",A)}v||(v=[])}};f.prototype.ShowOpenDlg=function(b){if(k){var a=jQuery("#c2nwOpenFileDialog");a.attr("accept",b);a.trigger("click")}};f.prototype.ShowFolderDlg=function(b){k&&jQuery("#c2nwChooseFolderDialog").trigger("click")};f.prototype.ShowSaveDlg=
function(b){if(k){var a=jQuery("#c2nwSaveDialog");a.attr("accept",b);a.trigger("click")}};f.prototype.SetWindowX=function(a){k&&b&&(b.Window.get().x=a)};f.prototype.SetWindowY=function(a){k&&b&&(b.Window.get().y=a)};f.prototype.SetWindowWidth=function(a){k&&b&&(b.Window.get().width=a)};f.prototype.SetWindowHeight=function(a){k&&b&&(b.Window.get().height=a)};f.prototype.SetWindowTitle=function(a){k&&b&&(b.Window.get().title=a,document.title=a)};f.prototype.WindowMinimize=function(){if(k&&b){var a=
b.Window.get();setTimeout(function(){a.minimize()},100)}};f.prototype.WindowMaximize=function(){if(k&&b){var a=b.Window.get();setTimeout(function(){a.maximize()},100)}};f.prototype.WindowUnmaximize=function(){if(k&&b){var a=b.Window.get();setTimeout(function(){a.unmaximize()},100)}};f.prototype.WindowRestore=function(){if(k&&b){var a=b.Window.get();setTimeout(function(){a.restore()},100)}};f.prototype.WindowRequestAttention=function(a){k&&b&&b.Window.get().requestAttention(a?3:0)};f.prototype.WindowSetMaxSize=
function(a,c){k&&b&&b.Window.get().setMaximumSize(a,c)};f.prototype.WindowSetMinSize=function(a,c){k&&b&&b.Window.get().setMinimumSize(a,c)};f.prototype.WindowSetResizable=function(a){k&&b&&b.Window.get().setResizable(0!==a)};f.prototype.WindowSetAlwaysOnTop=function(a){k&&b&&b.Window.get().setAlwaysOnTop(0!==a)};f.prototype.ShowDevTools=function(){k&&b&&b.Window.get().showDevTools()};f.prototype.SetClipboardText=function(a){k&&b&&b.Clipboard.get().set(a)};f.prototype.ClearClipboard=function(){k&&
b&&b.Clipboard.get().clear()};z.acts=new f;g.prototype.AppFolder=function(b){b.set_string(q)};g.prototype.AppFolderURL=function(b){b.set_string("file://"+q)};g.prototype.ProjectFilesFolder=function(b){b.set_string(m)};g.prototype.ProjectFilesFolderURL=function(b){b.set_string("file://"+m)};g.prototype.UserFolder=function(b){b.set_string(h)};g.prototype.ReadFile=function(b,a){if(k){var d="";try{d=c.readFileSync(a,{encoding:"utf8"})}catch(E){}b.set_string(d)}else b.set_string("")};g.prototype.FileSize=
function(b,a){if(k){var d=0;try{var e=c.statSync(a);e&&(d=e.size||0)}catch(t){}b.set_int(d)}else b.set_int(0)};g.prototype.ListCount=function(b){b.set_int(v.length)};g.prototype.ListAt=function(b,a){a=Math.floor(a);0>a||a>=v.length?b.set_string(""):b.set_string(v[a])};g.prototype.DroppedFile=function(b){b.set_string(u)};g.prototype.ChosenPath=function(b){b.set_string(y)};g.prototype.WindowX=function(a){a.set_int(k&&b?b.Window.get().x:0)};g.prototype.WindowY=function(a){a.set_int(k&&b?b.Window.get().y:
0)};g.prototype.WindowWidth=function(a){a.set_int(k&&b?b.Window.get().width:0)};g.prototype.WindowHeight=function(a){a.set_int(k&&b?b.Window.get().height:0)};g.prototype.WindowTitle=function(a){a.set_string(k&&b?b.Window.get().title||"":0)};g.prototype.ClipboardText=function(a){a.set_string(k&&b?b.Clipboard.get().get()||"":0)};z.exps=new g})();cr.plugins_.Rex_InstanceBank2=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.plugins_.Rex_InstanceBank2.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};g.Instance.prototype.onCreate=function(){this.bank=new cr.plugins_.Rex_InstanceBank2.InstBankKlass(this);this.bank.ModePreserveCurrentInsts=!1};g.cnds=new function(){};g.acts=new a;a.prototype.CleanBank=function(){this.bank.CleanBank()};a.prototype.SaveInstances=
function(a){if(a){a=a.getCurrentSol().getObjects();var e,c=a.length;for(e=0;e<c;e++)this.bank.SaveInstance(a[e])}};a.prototype.LoadInstances=function(){this.bank.LoadAllInstances()};a.prototype.StringToBank=function(a){this.bank.JSON2Bank(a)};g.exps=new f;f.prototype.BankToString=function(a){var e=this.bank.ToString();a.set_string(e)}})();
(function(){function a(a,e){return a.zindex-e.zindex}var f={};cr.plugins_.Rex_InstanceBank2.InstBankKlass=function(a){this.plugin=a;this.runtime=a.runtime;this.bank={};this.min_uid=this.max_uid=null;this.uid_mark_table={};this.objtype_mark_table={};this.layer_mark_table={};this.ModePreserveCurrentInsts=!1};var g=cr.plugins_.Rex_InstanceBank2.InstBankKlass.prototype;g.CleanBank=function(){var a=this.bank,e;for(e in a)delete a[e];this.min_uid=this.max_uid=null};g.GetInstanceStatus=function(a){var e=
this.runtime.saveInstanceToJSON(a);e.sid=a.type.sid;return e};g.SaveInstance=function(a){if(null!=a){"number"==typeof a&&(a=this.runtime.getObjectByUID(a));var e=this.GetInstanceStatus(a);this.bank[a.uid.toString()]=e;if(a.type.is_contained){a=a.siblings;var c=[];e.siblings_uids=c;var d,b=a.length;for(d=0;d<b;d++)e=a[d],c.push(e.uid),this.bank[e.uid.toString()]=this.GetInstanceStatus(e)}}};g.ReassignObj2UIDMap=function(a,e){if(a.uid!=e){var c=this.runtime.objectsByUid;delete c[a.uid.toString()];c[e.toString()]=
a;a.uid=e}};g.GetShellInstance=function(a){var e=this.runtime.getObjectByUID(a);if(null!=e)return e;if(!this.ModePreserveCurrentInsts){e=this.bank[a];if(null==e)return;var c=e.sid,d=this.SID2Type(c),b=d.instances,f,g=b.length;for(f=0;f<g;f++)if(e=b[f],!this.bank.hasOwnProperty(e.uid.toString()))return a=parseInt(a,10),this.ReassignObj2UIDMap(e,a),e.uid=a,this.objtype_mark_table[c]=d,e;this.objtype_mark_table.hasOwnProperty(c)&&delete this.objtype_mark_table[c]}return this.CreateShellInstance(a,!1)};
g.CreateShellInstance=function(a,e){var c=this.bank[a];if(null!=c){var d=this.SID2Type(c.sid),b=null;if(d.plugin.is_world&&(b=this.runtime.running_layout.getLayerBySid(c.w.l),!b))return;a=parseInt(a,10);c=this.runtime.next_uid;this.runtime.next_uid=a;e=this.runtime.createInstanceFromInit(d.default_instance,b,!1,0,0,e);c>a&&(this.runtime.next_uid=c);return e}};g.LoadInstance_step1=function(a,e,c){var d=this.bank[e];if(null!=d){null==a&&(a=this.CreateShellInstance(e,c));this.runtime.loadInstanceFromJSON(a,
d);if(!c&&a.type.is_contained){c=d.siblings_uids;var b=c.length,f=a.siblings;for(d=0;d<b;d++)this.LoadInstance_step1(f[d],c[d].toString(),!0)}this.MaxUIDSet(e);this.MinUIDSet(e);this.uid_mark_table[e]=a;this.layer_mark_table[a.layer.name]=a.layer}};g.LoadInstance_step2=function(){var f,e;for(f in this.uid_mark_table){var c=this.uid_mark_table[f];c.afterLoad&&c.afterLoad();if(c.behavior_insts){var d=c.behavior_insts.length;for(e=0;e<d;e++){var b=c.behavior_insts[e];b.afterLoad&&b.afterLoad()}}}for(var g in this.layer_mark_table)c=
this.layer_mark_table[g],c.instances.sort(a),c.zindices_stale=!0;if(!this.ModePreserveCurrentInsts)for(var n in this.objtype_mark_table)for(c=this.objtype_mark_table[n],e=c.instances,b=e.length,d=0;d<b;d++)c=e[d],this.uid_mark_table.hasOwnProperty(c.uid.toString())||this.runtime.DestroyInstance(c);for(f in this.uid_mark_table)delete this.uid_mark_table[f];for(n in this.objtype_mark_table)delete this.objtype_mark_table[n];for(g in this.layer_mark_table)delete this.layer_mark_table[g]};g.LoadAllInstances=
function(){var a;for(a in this.bank)if(!this.uid_mark_table.hasOwnProperty(a)){var e=this.GetShellInstance(a);this.LoadInstance_step1(e,a,!1)}this.LoadInstance_step2()};g.SID2Type=function(a){null==f[a]&&(f[a]=this.runtime.getObjectTypeBySid(a));return f[a]};g.MaxUIDSet=function(a){if(null==this.max_uid||this.max_uid<a)this.max_uid=a};g.MinUIDSet=function(a){if(null==this.min_uid||this.min_uid>a)this.min_uid=a};g.ToString=function(){return JSON.stringify(this.bank)};g.JSON2Bank=function(a){""!=a&&
(this.bank=JSON.parse(a))}})();cr.plugins_.Rex_SysExt=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.Rex_SysExt.prototype;k.Type=function(b){this.plugin=b;this.runtime=b.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(b){this.type=b;this.runtime=b.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.tmp_insts=[]};e._pick_all=function(b){if(!b||!b.instances.length)return!1;b.getCurrentSol().select_all=!0;b.applySolToContainer();return!0};e._pick_inverse=function(b,a,c){if(!b||!b.instances.length)return!1;
var d=b.getCurrentSol();1==c&&(d.select_all=!0,cr.shallowAssignArray(d.instances,d.getObjects()));c=d.instances;var e=c.length,f,g=-1;for(f=0;f<e;f++){var k=c[f];if(k.uid==a){g=f;break}}-1!=g&&cr.arrayRemove(c,g);d.select_all=!1;b.applySolToContainer();return 0!=d.instances.length};e._quick_pick=function(b,a){if(b&&b.instances.length){a=this.runtime.getObjectByUID(a);var c=null!=a;if(c){var d=a.type.name;if(b.is_family){c=!1;var e=b.members,f=e.length,g;for(g=0;g<f;g++)if(d==e[g].name){c=!0;break}}else c=
d==b.name}d=b.getCurrentSol();c?d.pick_one(a):d.instances.length=0;d.select_all=!1;b.applySolToContainer();return c}};e._get_layer=function(b){return"number"==typeof b?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b)};var c=function(b,a){switch(a){case 0:b=b.uid;break;case 1:b=b.x;break;case 2:b=b.y;break;case 3:b=b.width;break;case 4:b=b.height;break;case 5:b=b.angle;break;case 6:b=b.opacity;break;default:b=0}return b};k.cnds=new a;a.prototype.PickAll=function(b){return this._pick_all(b)};
a.prototype.PickInverse=function(b,a,c){return this._pick_inverse(b,a,c)};a.prototype.QuickPickByUID=function(b,a){return this._quick_pick(b,a)};k.acts=new f;f.prototype.__PickByUID=function(b,a,c){if(b&&b.instances.length){var d=b.getCurrentSol();1==c&&(d.select_all=!0);c=d.getObjects();var e=c.length,f,g=!1;for(f=0;f<e;f++){var k=c[f];if(k.uid==a){g=!0;break}}g?d.pick_one(k):d.instances.length=0;d.select_all=!1;b.applySolToContainer()}};f.prototype.PickByPropCmp=function(b,a,d,e,f){if(b&&b.instances.length){b=
b.getCurrentSol();1==f&&(b.select_all=!0);f=b.getObjects();var h=f.length,g;for(g=this.tmp_insts.length=0;g<h;g++){var k=f[g];cr.do_cmp(c(k,a),d,e)&&this.tmp_insts.push(k)}cr.shallowAssignArray(b.instances,this.tmp_insts);b.select_all=!1}};f.prototype.__PickInverse=function(b,a,c){this._pick_inverse(b,a,c)};f.prototype.PickAll=function(b){b&&(b.getCurrentSol().select_all=!0,b.applySolToContainer())};f.prototype.PickByUID=function(b,a){var c,d;if(b&&(d=this.runtime.getObjectByUID(a))){var e=b.getCurrentSol();
if(e.select_all||-1!==e.instances.indexOf(d))if(b.is_family){var f=b.families;a=0;for(c=f.length;a<c;a++)if(f[a]===d.type){e.pick_one(d);b.applySolToContainer();break}}else d.type===b&&(e.pick_one(d),b.applySolToContainer())}};f.prototype.PickInverse=function(b,a,c){var d;if(b){var e=b.getCurrentSol();c&&(e.select_all=!0);if(e.select_all){e.select_all=!1;e.instances.length=0;var f=b.instances;c=0;for(d=f.length;c<d;c++){var g=f[c];g.uid!==a&&e.instances.push(g)}}else{f=c=0;for(d=e.instances.length;c<
d;c++)g=e.instances[c],e.instances[f]=g,g.uid!==a&&f++;e.instances.length=f}b.applySolToContainer()}};f.prototype.SetGroupActive=function(b,a){if(b=this.runtime.groups_by_name[b.toLowerCase()])switch(a){case 0:b.setGroupActive(!1);break;case 1:b.setGroupActive(!0);break;case 2:b.setGroupActive(!b.group_active)}};f.prototype.SetLayerVisible=function(b,a){if(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))a=1==a,b.visible!==a&&(b.visible=a,this.runtime.redraw=!0)};
f.prototype.SwapPosByUID=function(b,a){b=this.runtime.getObjectByUID(b);a=this.runtime.getObjectByUID(a);if(b&&a){var c=b.x,d=b.y,e=a.y;b.x=a.x;b.y=e;a.x=c;a.y=d;b.set_bbox_changed();a.set_bbox_changed()}};k.exps=new g;g.prototype.Eval=function(b,a){b.set_any(eval("("+a+")"))};g.prototype.ToHexString=function(b,a){b.set_string(a.toString(16))};g.prototype.ToDecimalMark=function(b,a,c){b.set_string(a.toLocaleString(c))};g.prototype.String2ByteCount=function(b,a){a=encodeURI(a).split(/%..|./).length-
1;b.set_int(a)};g.prototype.SubString=function(b,a,c,d){b.set_string(a.substring(c,d))};g.prototype.ToFixed=function(b,a,c){null==c&&(c=10);b.set_string(a.toFixed(c))};g.prototype.ToPrecision=function(b,a,c){null==c&&(c=10);b.set_string(a.toPrecision(c))};g.prototype.ToFixedNumber=function(b,a,c){null==c&&(c=10);a=a.toFixed(c);b.set_float(parseFloat(a))};g.prototype.Newline=function(b,a){null==a&&(a=1);var c,d="";for(c=0;c<a;c++)d+="\n";b.set_string(d)};g.prototype.NormalRandom=function(b,a,c){do{var d=
2*Math.random()-1;var e=2*Math.random()-1;e=d*d+e*e}while(1<e||0==e);b.set_float(a+d*Math.sqrt(-2*Math.log(e)/e)*c)};g.prototype.NormalRandomApproximation=function(b,a,c){for(var d=0,e=0;6>e;e++)d+=Math.random();b.set_float(a+(d-3)/3*c)};g.prototype.ReflectionAngle=function(b,a,c){c=cr.to_radians(c);var d=cr.to_radians(a);a=Math.cos(d);d=Math.sin(d);var e=Math.cos(c);c=Math.sin(c);var f=a*e+d*c;a=cr.angleTo(0,0,a-2*f*e,d-2*f*c);b.set_float(cr.to_degrees(a))};var d="0123456789bcdefghjkmnpqrstuvwxyz".split("");
g.prototype.RandomBase32=function(b,a){for(var c="",e=0;e<a;e++)c+=d[Math.floor(32*Math.random())];b.set_string(c)}})();cr.plugins_.Rex_TARP=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.Rex_TARP.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.timeline=null;this.timelineUid=-1;this.recorder=new cr.plugins_.Rex_TARP.RecorderKlass(this);this.player=new cr.plugins_.Rex_TARP.PlayerKlass(this)};e.onDestroy=function(){this.player.Stop()};e._timeline_get=
function(){if(null!=this.timeline)return this.timeline;var a=this.runtime.types,d;for(d in a){var b=a[d].instances[0];if(b instanceof cr.plugins_.Rex_TimeLine.prototype.Instance)return this.timeline=b}return null};e.saveToJSON=function(){return{tluid:null!=this.timeline?this.timeline.uid:-1,r:this.recorder.saveToJSON(),p:this.player.saveToJSON()}};e.loadFromJSON=function(a){this.timelineUid=a.tluid;this.recorder.loadFromJSON(a.r);this.player.loadFromJSON(a.p)};e.afterLoad=function(){this.timeline=
-1===this.timelineUid?null:this.runtime.getObjectByUID(this.timelineUid);this.timelineUid=-1;this.recorder.afterLoad();this.player.afterLoad()};k.cnds=new a;a.prototype.OnEnd=function(){return!0};a.prototype.IsPlaying=function(){var a=this.player.timer;return a?a.IsActive():!1};k.acts=new f;f.prototype.Setup=function(a){a=a.getFirstPicked();"TIMELINE"==a.check_name?this.timeline=a:alert("TARP should connect to a timeline object")};f.prototype.RecorderStart=function(){this.recorder.Start()};f.prototype.RecordAction=
function(a,d,b){this.recorder.Write(d,b,a)};f.prototype.RecordPause=function(){this.recorder.Pause()};f.prototype.RecorderResume=function(){this.recorder.Resume()};f.prototype.PlayerLoad=function(a){this.player.JSON2List(a)};f.prototype.PlayStart=function(a){this.player.Start(a)};f.prototype.PlayerStop=function(){this.player.Stop()};f.prototype.PlayerPause=function(){this.player.Pause()};f.prototype.PlayerResume=function(){this.player.Resume()};k.exps=new g;g.prototype.LatestRecordTime=function(a){a.set_float(this.recorder.LatestRecordTimeGet())};
g.prototype.RecorderElapsedTime=function(a){a.set_float(this.recorder.ElapsedTimeGet())};g.prototype.LatestPlayTime=function(a){a.set_float(this.player.LatestPlayTimeGet())};g.prototype.PlayerElapsedTime=function(a){a.set_float(this.player.ElapsedTimeGet())};g.prototype.RecorderList=function(a){a.set_string(this.recorder.List2JSON())};g.prototype.Offset=function(a){a.set_float(this.player.offset)};g.prototype.Export2Scenario=function(a){var c=this.recorder.recorder_list,b=[],e,f=c.length;for(e=0;e<
f;e++){var g=c[e];var h=[g[0],g[1]];var k=g[2];var p=k.length;for(g=0;g<p;g++)h.push(k[g]);b.push(h)}a.set_string(JSON.stringify(b))}})();
(function(){cr.plugins_.Rex_TARP.RecorderKlass=function(a){this.plugin=a;this.recorder_list=[];this.dt_start=0;this.wallclock=new g(a)};var a=cr.plugins_.Rex_TARP.RecorderKlass.prototype;a.Setup=function(a){this.wallclock.Init(this.plugin)};a.Start=function(){this.recorder_list.length=0;this.wallclock.Start();this.dt_start=this.wallclock.current_time_get()};a.Write=function(a,e,c){if(null==this.dt_pause){c=this.wallclock.current_time_get()+c;var d=c-this.dt_start,b=[];cr.shallowAssignArray(b,e);this.recorder_list.push([d,
a,b]);this.dt_start=c}};a.Pause=function(){this.wallclock.Pause()};a.Resume=function(){this.wallclock.Resume()};a.List2JSON=function(){return JSON.stringify(this.recorder_list)};a.LatestRecordTimeGet=function(){return this.wallclock.SampleTimeGet()};a.ElapsedTimeGet=function(){return this.wallclock.ElapsedTimeGet()};a.saveToJSON=function(){return{l:this.recorder_list,dts:this.dt_start,wc:this.wallclock.saveToJSON()}};a.loadFromJSON=function(a){this.recorder_list=a.l;this.dt_start=a.dts;this.wallclock.loadFromJSON(a.wc)};
a.afterLoad=function(){this.wallclock.afterLoad()};cr.plugins_.Rex_TARP.PlayerKlass=function(a){this.plugin=a;this.timer=null;this.player_list=[];this.offset=this.play_index=0;this.current_cmd=null;this.wallclock=new g(a)};a=cr.plugins_.Rex_TARP.PlayerKlass.prototype;a.Setup=function(a){this.wallclock.Init(this.plugin)};a.JSON2List=function(a){this.player_list=JSON.parse(a)};a.Start=function(a){this.offset=a;this.play_index=0;this.wallclock.Start();this._start_cmd()};a.Stop=function(){this.timer&&
this.timer.Remove()};a.Pause=function(){this.timer&&this.timer.Suspend();this.wallclock.Pause()};a.Resume=function(){this.timer&&this.timer.Resume();this.wallclock.Resume()};a.LatestPlayTimeGet=function(){return this.wallclock.SampleTimeGet()};a.ElapsedTimeGet=function(){return this.wallclock.ElapsedTimeGet()};a._start_cmd=function(){this.player_list.length>this.play_index?(this.current_cmd=this.player_list[this.play_index],this.play_index+=1,null==this.timer&&(this.timer=this.plugin._timeline_get().CreateTimer(f),
this.timer.plugin=this),this.timer.Start(this.current_cmd[0]+this.offset),this.wallclock.current_time_get()):this.plugin.runtime.trigger(cr.plugins_.Rex_TARP.prototype.cnds.OnEnd,this.plugin)};var f=function(){this.plugin.run()};a.run=function(){var a=this.current_cmd[1],e=this.current_cmd[2];this.plugin._timeline_get().RunCallback(a,e,!0);this._start_cmd()};a.saveToJSON=function(){return{tim:null!=this.timer?this.timer.saveToJSON():null,l:this.player_list,i:this.play_index,off:this.offset,cmd:this.current_cmd,
wc:this.wallclock.saveToJSON()}};a.loadFromJSON=function(a){this.timer_save=a.tim;this.player_list=a.l;this.play_index=a.i;this.offset=a.off;this.current_cmd=a.cmd;this.wallclock.loadFromJSON(a.wc)};a.afterLoad=function(){null==this.timer_save?this.timer=null:(this.timer=this.plugin._timeline_get().LoadTimer(this.timer_save,f),this.timer.plugin=this);this.timers_save=null;this.wallclock.afterLoad()};var g=function(a){this.plugin=a;this.sample_time={tick:null,time:null};this.pause_sum=this.start_time=
0};a=g.prototype;a.Init=function(){this.sample_time.tick=null;this.sample_time.time=null;this.pause_sum=this.start_time=0};a.Start=function(){this.start_time=this.current_time_get();this.dt_pause=null;this.pause_sum=0};a.current_time_get=function(){var a=this.plugin.runtime.tickcount;a!=this.sample_time.tick&&(this.sample_time.time=this.plugin._timeline_get().TimeGet(),this.sample_time.tick=a);return this.sample_time.time};a.Pause=function(){null==this.dt_pause&&(this.dt_pause=this.current_time_get())};
a.Resume=function(){var a=this.current_time_get()-this.dt_pause;this.dt_pause=null;this.pause_sum+=a};a.SampleTimeGet=function(){var a=this.sample_time.time;return a=null==a?0:a-this.start_time};a.ElapsedTimeGet=function(){return this.current_time_get()-this.start_time-this.pause_sum};a.saveToJSON=function(){return{samptim:this.sample_time,st:this.player_list,ps:this.pause_sum}};a.loadFromJSON=function(a){this.sample_time=a.samptim;this.start_time=a.st;this.pause_sum=a.ps};a.afterLoad=function(){}})();
cr.plugins_.Rex_TimeLine=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=function(){this.lines=[]},e=k.prototype;e.alloc=function(a,b){0<this.lines.length?(b=this.lines.pop(),a.LinkTimer(b)):b=a.CreateTimer(b);return b};e.free=function(a){a.timeline=null;this.lines.push(a)};cr.plugins_.Rex_TimeLine.timerCache=new k;k=cr.plugins_.Rex_TimeLine.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};e=k.Instance.prototype;
e.onCreate=function(){this.updateMode=this.properties[0];this.ManualMode=0===this.updateMode;this.GameTimeMode=1===this.updateMode;this.RealTimeMode=2===this.updateMode;this.updateManually=this.ManualMode;this.updateWithGameTime=this.GameTimeMode;this.lastRealTime=(this.updateWithRealTime=this.RealTimeMode)?(new Date).getTime():null;this.my_timescale=-1;this.timeline=new cr.plugins_.Rex_TimeLine.TimeLine;(this.GameTimeMode||this.RealTimeMode)&&this.runtime.tickMe(this);this.check_name="TIMELINE";
this.recycled||(this.timers={});this.timerCache=cr.plugins_.Rex_TimeLine.timerCache;this.exp_triggeredTimerName="";this.c2FnType=this.timersSave=null};e.onDestroy=function(){this.timeline.CleanAll();for(var a in this.timers)this.destroyLocalTimer(a)};e.tick=function(){if(this.GameTimeMode){if(this.updateWithGameTime){var a=this.runtime.getDt(this);this.timeline.Dispatch(a)}}else if(this.RealTimeMode){var b=(new Date).getTime();this.updateWithRealTime&&(a=(b-this.lastRealTime)/1E3,this.timeline.Dispatch(a));
this.lastRealTime=b}};e.CreateTimer=function(a){var b=new cr.plugins_.Rex_TimeLine.Timer(this.timeline);b.TimeoutHandlerSet(a);return b};e.LinkTimer=function(a){a.Reset(this.timeline);return a};e.LoadTimer=function(a,b){b=this.CreateTimer(b);b.loadFromJSON(a);b.afterLoad();return b};e.getC2FnType=function(a){null===this.c2FnType&&(this.c2FnType=window.c2_callRexFunction2?"c2_callRexFunction2":window.c2_callFunction?"c2_callFunction":"");return this.c2FnType};e.RunCallback=function(a,b,c){c=this.getC2FnType(c);
return""===c?null:window[c](a,b)};e.TimeGet=function(){return this.timeline.absTime};e.create_local_timer=function(a){var b=this.timers[a];null!=b?b.Remove():(b=this.timerCache.alloc(this,c),b.plugin=this,this.timers[a]=b);return b};e.destroyLocalTimer=function(a){var b=this.timers[a];null!=b&&(b.Remove(),delete this.timers[a],this.timerCache.free(b))};e.timer_cache_clean=function(){this.timerCache.lines.length=0};var c=function(){var a=this.plugin;a.exp_triggeredTimerName=this._cb.name;a.RunCallback(this._cb.command,
this._cb.params,!0);0===this._repeat_count?this.Start():1<this._repeat_count&&(--this._repeat_count,this.Start())};e._get_timer_cb_params=function(a){return{name:a,command:"",params:[]}};e.saveToJSON=function(){var a,b={};for(a in this.timers){var c=this.timers[a];b[a]={tim:c.saveToJSON(),cmd:c._cb.command,pams:c._cb.params,rc:c._repeat_count}}return{ts:this.my_timescale,ug:this.updateWithGameTime,tl:this.timeline.saveToJSON(),timers:b,lrt:this.lastRealTime,ft:this.c2FnType}};e.loadFromJSON=function(a){this.my_timescale=
a.ts;this.timeline.loadFromJSON(a.tl);this.timersSave=a.timers;this.lastRealTime=a.lrt;this.c2FnType=a.ft;this.onDestroy();this.timer_cache_clean()};e.afterLoad=function(){var a;for(a in this.timersSave){var b=this.timersSave[a];var e=this.LoadTimer(b.tim,c);e.plugin=this;e._cb=this._get_timer_cb_params(a);e._cb.command=b.cmd;e._cb.params=b.pams;e._repeat_count=b.rc}this.timersSave=null};k.cnds=new a;a.prototype.IsRunning=function(a){return(a=this.timers[a])?a.IsActive():!1};k.acts=new f;f.prototype.PushTimeLine=
function(a){this.updateManually&&this.timeline.Dispatch(a)};f.prototype.Setup_deprecated=function(){};f.prototype.CreateTimer_deprecated=function(){};f.prototype.StartTimer=function(a,b,c){if(a=this.timers[a])a._repeat_count=c,a.Start(b)};f.prototype.StartTrgTimer=function(a){var b=this.timers[this.exp_triggeredTimerName];b&&b.Start(a)};f.prototype.PauseTimer=function(a){(a=this.timers[a])&&a.Suspend()};f.prototype.ResumeTimer=function(a){(a=this.timers[a])&&a.Resume()};f.prototype.StopTimer=function(a){(a=
this.timers[a])&&a.Remove()};f.prototype.CleanTimeLine=function(){this.timeline.CleanAll()};f.prototype.DeleteTimer=function(a){this.destroyLocalTimer(a)};f.prototype.SetTimerParameter=function(a,b,c){(a=this.timers[a])&&(a._cb.params[b]=c)};f.prototype.PauseTimeLine=function(){this.GameTimeMode?this.updateWithGameTime=!1:this.RealTimeMode&&(this.updateWithRealTime=!1)};f.prototype.ResumeTimeLine=function(){this.GameTimeMode?this.updateWithGameTime=!0:this.RealTimeMode&&(this.updateWithRealTime=!0)};
f.prototype.CreateTimer=function(a,b,c){var d=this.create_local_timer(a);d._cb=this._get_timer_cb_params(a);d._cb.command=b;cr.shallowAssignArray(d._cb.params,c)};f.prototype.SetTimerParameters=function(a,b){(a=this.timers[a])&&cr.shallowAssignArray(a._cb.params,b)};f.prototype.SetTrgTimerParameters=function(a){var b=this.timers[this.exp_triggeredTimerName];b&&cr.shallowAssignArray(b._cb.params,a)};f.prototype.DeleteTrgTimer=function(){this.destroyLocalTimer(this.exp_triggeredTimerName)};f.prototype.PushTimeLineTo=
function(a){this.updateManually&&(a-=this.timeline.absTime,0>a||this.timeline.Dispatch(a))};f.prototype.SetupCallback=function(a){this.c2FnType=0===a?"c2_callFunction":"c2_callRexFunction2"};k.exps=new g;g.prototype.TimerRemainder=function(a,b){b=(b=this.timers[b])?b.RemainderTimeGet():0;a.set_float(b)};g.prototype.TimerElapsed=function(a,b){b=(b=this.timers[b])?b.ElapsedTimeGet():0;a.set_float(b)};g.prototype.TimerRemainderPercent=function(a,b){b=(b=this.timers[b])?b.RemainderTimePercentGet():0;
a.set_float(b)};g.prototype.TimerElapsedPercent=function(a,b){b=(b=this.timers[b])?b.ElapsedTimePercentGet():0;a.set_float(b)};g.prototype.TimeLineTime=function(a){a.set_float(this.timeline.absTime)};g.prototype.TriggeredTimerName=function(a){a.set_string(this.exp_triggeredTimerName)};g.prototype.TimerDelayTime=function(a){var b=this.timers[timer_name];b=b?b.DelayTimeGet():0;a.set_float(b)}})();
(function(){cr.plugins_.Rex_TimeLine.TimeLine=function(){this.CleanAll()};var a=cr.plugins_.Rex_TimeLine.TimeLine.prototype,f=function(a,f){a=a.absTime;f=f.absTime;return a<f?-1:a>f?1:0};a.CleanAll=function(){this.triggered_timer=null;this._timer_absTime=this.absTime=0;this._waitingTimerQueue=[];this._processTimerQueue=[];this._suspendTimerQueue=[];this._activateQueue=[this._waitingTimerQueue,this._processTimerQueue];this._allQueues=[this._waitingTimerQueue,this._processTimerQueue,this._suspendTimerQueue]};
a.CurrentTimeGet=function(){return this._timer_absTime};a.RegistTimer=function(a){this._add_timer_to_activate_lists(a)};a.RemoveTimer=function(a){this._removeTimerFromQueues(a,!1);a._idle()};a.Dispatch=function(a){this.absTime+=a;this._waitingTimerQueue.sort(f);a=this._waitingTimerQueue.length;var g,e=0;for(g=0;g<a;g++){var c=this._waitingTimerQueue[g];this._is_timer_time_out(c)&&(this._processTimerQueue.push(c),e+=1)}if(e){for(g=e;g<a;g++)this._waitingTimerQueue[g-e]=this._waitingTimerQueue[g];this._waitingTimerQueue.length-=
e}for(;0<this._processTimerQueue.length;)this._processTimerQueue.sort(f),this.triggered_timer=this._processTimerQueue.shift(),this._timer_absTime=this.triggered_timer.absTime,this.triggered_timer.DoHandle();this._timer_absTime=this.absTime};a.SuspendTimer=function(a){var f=this._removeTimerFromQueues(a,!0);f&&(this._suspendTimerQueue.push(a),a.__suspend__());return f};a.ResumeTimer=function(a){var f=!1,e=this._suspendTimerQueue.indexOf(a);-1!=e&&(cr.arrayRemove(this._suspendTimerQueue,e),a.__resume__(),
this.RegistTimer(a),f=!0);return f};a.SetTimescale=function(a,f){a.__setTimescale__(f);(f=this._removeTimerFromQueues(a,!0))&&this.RegistTimer(a);return f};a.ChangeTimerRate=function(a,f){a.__changeRate__(f);(f=this._removeTimerFromQueues(a,!0))&&this.RegistTimer(a);return f};a.saveToJSON=function(){return{at:this.absTime}};a.loadFromJSON=function(a){this.absTime=a.at};a._is_timer_time_out=function(a){return a.absTime<=this.absTime};a._add_timer_to_activate_lists=function(a){(this._is_timer_time_out(a)?
this._processTimerQueue:this._waitingTimerQueue).push(a)};a._removeTimerFromQueues=function(a,f){var e=!1;f=f?this._activateQueue:this._allQueues;var c,d=f.length;for(c=0;c<d;c++){var b=f[c];var g=b.indexOf(a);if(-1!=g){cr.arrayRemove(b,g);e=!0;break}}return e};cr.plugins_.Rex_TimeLine.Timer=function(a){this.Reset(a);this.extra={}};a=cr.plugins_.Rex_TimeLine.Timer.prototype;a.Reset=function(a){this.timeline=a;this.absTime=this._remainderTime=this.delayTime=0;this.timescale=1;this._idle();this._setAbsTimeout(0)};
a.Restart=function(a){null!=a&&(this.delayTime=a);this._setAbsTimeout(this.delayTime/this.timescale);this._isAlive?this._isActive||(this._remainderTime=this.absTime,this.Resume()):(this.timeline.RegistTimer(this),this._run())};a.Start=a.Restart;a.Suspend=function(){this.timeline.SuspendTimer(this)};a.Resume=function(){this.timeline.ResumeTimer(this)};a.SetTimescale=function(a){this._isActive&&a===this.timescale||this.timeline.SetTimescale(this,a)};a.ChangeRate=function(a){this.timeline.ChangeTimerRate(this,
a)};a.Remove=function(){this._isAlive&&this.timeline.RemoveTimer(this)};a.IsAlive=function(){return this._isAlive};a.IsActive=function(){return this._isAlive&&this._isActive};a.RemainderTimeGet=function(a){var f=this.IsActive()?this.absTime-this.timeline.CurrentTimeGet():this.IsAlive()?this._remainderTime:0;a||0===this.timescale&&1===this.timescale||(f*=this.timescale);return f};a.RemainderTimeSet=function(a){if(this.IsAlive()){var f=this.delayTime;if(0!==this.timescale||1!==this.timescale)f/=this.timescale;
this._remainderTime=cr.clamp(a,0,f);this.absTime=this.timeline.CurrentTimeGet()+this._remainderTime}};a.ElapsedTimeGet=function(){return this.delayTime-this.RemainderTimeGet()};a.RemainderTimePercentGet=function(){return 0==this.delayTime?0:this.RemainderTimeGet()/this.delayTime};a.ElapsedTimePercentGet=function(){return 0==this.delayTime?0:this.ElapsedTimeGet()/this.delayTime};a.ExpiredTimeGet=function(){return this.timeline.absTime-this.absTime};a.DelayTimeGet=function(){return this.delayTime};
a.TimeoutHandlerSet=function(a){this.OnTimeout=a};a.DoHandle=function(){this._idle();this.OnTimeout&&this.OnTimeout()};a.saveToJSON=function(){var a=this.RemainderTimeGet(!0);return{dt:this.delayTime,rt:a,ts:this.timescale,alive:this._isAlive,active:this._isActive,ex:this.extra}};a.loadFromJSON=function(a){this.delayTime=a.dt;this._isAlive=a.alive;this._isActive=a.active;this.timescale=a.ts;this.extra=a.ex;this.RemainderTimeSet(a.rt)};a.afterLoad=function(){this.IsAlive()&&(this.timeline.RegistTimer(this),
this.IsActive()||this.timeline.SuspendTimer(this))};a._idle=function(){this._isActive=this._isAlive=!1};a._run=function(){this._isActive=this._isAlive=!0};a._setAbsTimeout=function(a){this.absTime=this.timeline.CurrentTimeGet()+a};a.__suspend__=function(){this._remainderTime=this.absTime-this.timeline.CurrentTimeGet();this._isActive=!1};a.__resume__=function(){this._setAbsTimeout(this._remainderTime);this._isActive=!0};a.__setTimescale__=function(a){if(!(0>a)){var f=!1;0==a&&this._isActive?this.Suspend():
0<a&&!this._isActive?(this.Resume(),f=!0):0<a&&this._isActive&&(f=!0);f&&(this.__changeRate__(this.timescale/a),this.timescale=a)}};a.__changeRate__=function(a){if(this._isActive){var f=this.timeline.CurrentTimeGet();this.absTime=f+(this.absTime-f)*a}else this._remainderTime*=a}})();cr.plugins_.Rex_UID2Prop=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.plugins_.Rex_UID2Prop.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.alias2pv={}};k.onDestroy=function(){};k.add_alias=function(a,c,d){var b=this.alias2pv[a];if(null==b)b={},this.alias2pv[a]=b;else for(var e in b)delete b[e];if(c.is_family)for(e=c.members.length,a=0;a<e;a++){var f=
c.members[a];b[f.sid]=d+f.family_var_map[c.family_index]}else b[c.sid]=d};k.get_pv=function(a,c){if(null==a)return 0;c=this.alias2pv[c];if(null==c)return 0;c=c[a.type.sid];return null==c?0:a.instance_vars[c]};k.saveToJSON=function(){return{alias:this.alias2pv}};k.loadFromJSON=function(a){this.alias2pv=a.alias};g.cnds=new function(){};g.acts=new a;a.prototype.DefinePrivateVariableAlias=function(a,c,d){this.add_alias(a,c,d)};a.prototype.InstDestroy=function(a){(a=this.runtime.getObjectByUID(a))&&this.runtime.DestroyInstance(a)};
a.prototype.InstSetX=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&a.x!==c&&(a.x=c,a.set_bbox_changed())};a.prototype.InstSetY=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.y&&a.y!==c&&(a.y=c,a.set_bbox_changed())};a.prototype.InstSetPos=function(a,c,d){!(a=this.runtime.getObjectByUID(a))||null==a.x||a.x===c&&a.y===d||(a.x=c,a.y=d,a.set_bbox_changed())};a.prototype.InstSetPosToObject=function(a,c,d){if((a=this.runtime.getObjectByUID(a))&&null!=a.x){var b=this.runtime.getObjectByUID(c);
b&&(b.getImagePoint?(c=b.getImagePoint(d,!0),d=b.getImagePoint(d,!1)):(c=b.x,d=b.y),a.x!==c||a.y!==d)&&(a.x=c,a.y=d,a.set_bbox_changed())}};a.prototype.InstMoveForward=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&0!==c&&(a.x+=Math.cos(a.angle)*c,a.y+=Math.sin(a.angle)*c,a.set_bbox_changed())};a.prototype.InstMoveAtAngle=function(a,c,d){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&0!==d&&(a.x+=Math.cos(cr.to_radians(c))*d,a.y+=Math.sin(cr.to_radians(c))*d,a.set_bbox_changed())};a.prototype.InstSetWidth=
function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.width&&a.width!==c&&(a.width=c,a.set_bbox_changed())};a.prototype.InstSetHeight=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.height&&a.height!==c&&(a.height=c,a.set_bbox_changed())};a.prototype.InstSetSize=function(a,c,d){!(a=this.runtime.getObjectByUID(a))||null==a.width||a.width===c&&a.height===d||(a.width=c,a.height=d,a.set_bbox_changed())};a.prototype.InstSetAngle=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&
(c=cr.to_radians(cr.clamp_angle_degrees(c)),isNaN(c)||a.angle===c||(a.angle=c,a.set_bbox_changed()))};a.prototype.InstRotateClockwise=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&0!==c&&!isNaN(c)&&(a.angle+=cr.to_radians(c),a.angle=cr.clamp_angle(a.angle),a.set_bbox_changed())};a.prototype.InstRotateCounterclockwise=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&0!==c&&!isNaN(c)&&(a.angle-=cr.to_radians(c),a.angle=cr.clamp_angle(a.angle),a.set_bbox_changed())};
a.prototype.InstRotateTowardAngle=function(a,c,d){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&(c=cr.angleRotate(a.angle,cr.to_radians(d),cr.to_radians(c)),isNaN(c)||a.angle===c||(a.angle=c,a.set_bbox_changed()))};a.prototype.InstRotateTowardPosition=function(a,c,d,b){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&(c=cr.angleRotate(a.angle,Math.atan2(b-a.y,d-a.x),cr.to_radians(c)),isNaN(c)||a.angle===c||(a.angle=c,a.set_bbox_changed()))};a.prototype.InstSetTowardPosition=function(a,c,d){(a=
this.runtime.getObjectByUID(a))&&null!=a.angle&&(c=Math.atan2(d-a.y,c-a.x),isNaN(c)||a.angle===c||(a.angle=c,a.set_bbox_changed()))};a.prototype.InstSetOpacity=function(a,c){(a=this.runtime.getObjectByUID(a))&&null!=a.opacity&&(c/=100,0>c?c=0:1<c&&(c=1),c!==a.opacity&&(a.opacity=c,a.runtime.redraw=!0))};a.prototype.InstSetVisible=function(a){var c=this.runtime.getObjectByUID(uid);c&&null!=c.visible&&!a!==!c.visible&&(c.visible=a,c.runtime.redraw=!0)};g.exps=new f;f.prototype.X=function(a,c){c=this.runtime.getObjectByUID(c);
null==c||null==c.x?a.set_float(0):a.set_float(c.x)};f.prototype.Y=function(a,c){c=this.runtime.getObjectByUID(c);null==c||null==c.y?a.set_float(0):a.set_float(c.y)};f.prototype.Angle=function(a,c){c=this.runtime.getObjectByUID(c);null==c||null==c.angle?a.set_float(0):a.set_float(cr.to_clamped_degrees(c.angle))};f.prototype.Width=function(a,c){c=this.runtime.getObjectByUID(c);null==c||null==c.width?a.set_float(0):a.set_float(c.width)};f.prototype.Height=function(a,c){c=this.runtime.getObjectByUID(c);
null==c||null==c.height?a.set_float(0):a.set_float(c.height)};f.prototype.Opacity=function(a,c){c=this.runtime.getObjectByUID(c);null==c||null==c.opacity?a.set_float(0):a.set_float(c.opacity)};f.prototype.Visible=function(a,c){c=this.runtime.getObjectByUID(c);null==c||null==c.visible?a.set_float(0):a.set_float(c.visible)};f.prototype.ImgptX=function(a,c,d){c=this.runtime.getObjectByUID(c);null==c||null==c.getImagePoint?a.set_float(0):a.set_float(c.getImagePoint(d,!0))};f.prototype.ImgptY=function(a,
c,d){c=this.runtime.getObjectByUID(c);null==c||null==c.getImagePoint?a.set_float(0):a.set_float(c.getImagePoint(d,!1))};f.prototype.PV=function(a,c,d){c=this.runtime.getObjectByUID(c);a.set_any(this.get_pv(c,d))};f.prototype.DistanceTo=function(a,c,d){c=this.runtime.getObjectByUID(c);d=this.runtime.getObjectByUID(d);d=null==c||null==d||null==c.x||null==c.y||null==d.x||null==d.y?0:cr.distanceTo(c.x,c.y,d.x,d.y);a.set_float(d)};f.prototype.AngleTo=function(a,c,d){c=this.runtime.getObjectByUID(c);d=
this.runtime.getObjectByUID(d);d=null==c||null==d||null==c.x||null==c.y||null==d.x||null==d.y?0:cr.angleTo(c.x,c.y,d.x,d.y);a.set_float(cr.to_clamped_degrees(d))}})();cr.plugins_.Rex_UndoRedo=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.Rex_UndoRedo.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.handler=0===this.properties[0]?new c(this):new d(this);this.is_states_mode=0===this.properties[0];this.max_record_length=this.properties[1];this.recorder=[];this.cur_step=null;this.tmp_dict={};this.clean_all();
0===this.properties[2]&&(this.loadFromJSON=this.saveToJSON=null)};e.clean_all=function(){this.recorder.length=0;this.current_index=-1};e.Push=function(a){this.recorder.length-1==this.current_index?(this.current_index+=1,this.recorder.push(a)):(this.current_index+=1,this.recorder[this.current_index]=a,this.recorder.length=this.current_index+1);0<this.max_record_length&&this.recorder.length>this.max_record_length&&(this.recorder.shift(),--this.current_index)};e.Undo=function(a){return this.cur_step=
this.handler.Undo()};e.Redo=function(a){return this.cur_step=this.handler.Redo()};e.has_steps=function(){return-1!=this.current_index};e.steps2string=function(){return JSON.stringify(this.saveToJSON())};e.string2steps=function(a){""!=a&&(a=JSON.parse(a),this.loadFromJSON(a))};e.saveToJSON=function(){return{d:this.recorder,i:this.current_index}};e.loadFromJSON=function(a){this.recorder=a.d;this.current_index=a.i};k.cnds=new a;a.prototype.CanUndo=function(){return this.handler.CanUndo()};a.prototype.CanRedo=
function(){return this.handler.CanRedo()};a.prototype.ForEachStep=function(){var a=this.runtime.getCurrentEventStack(),c=a.current_event;a=a.isModifierAfterCnds();for(var d=this.current_index,e=this.cur_step,f=0;f<=d;f++)a&&this.runtime.pushCopySol(c.solModifiers),this.current_index=f,this.cur_step=this.recorder[f],c.retrigger(),a&&this.runtime.popSol(c.solModifiers);this.current_index=d;this.cur_step=e;return!1};k.acts=new f;f.prototype.CleanAll=function(){this.clean_all()};f.prototype.Push=function(a){if(null!=
a){var b={};b._=a}else b=this.tmp_dict,this.tmp_dict={};this.Push(b)};f.prototype.StringToSteps=function(a){this.string2steps(a)};f.prototype.SetDate=function(a,c){this.tmp_dict[a]=c};f.prototype.Undo=function(){this.Undo()};f.prototype.Redo=function(){this.Redo()};k.exps=new g;g.prototype.Undo=function(a){var b=this.Undo();b=null==b?0:b._;a.set_any(b)};g.prototype.Redo=function(a){var b=this.Redo();b=null==b?0:b._;a.set_any(b)};g.prototype.CurStep=function(a,c){null==this.cur_step?c=0:(null==c&&
(c="_"),c=this.cur_step[c]);a.set_any(c)};g.prototype.StepsCnt=function(a){a.set_int(this.recorder.length)};g.prototype.CurIndex=function(a){a.set_int(this.current_index)};g.prototype.ToString=function(a){a.set_string(this.steps2string())};var c=function(a){this.plugin=a};k=c.prototype;k.CanUndo=function(){return 0<=this.plugin.current_index};k.Undo=function(){if(!this.CanUndo())return 0;var a=this.plugin,c=a.recorder[a.current_index];--a.current_index;return c};k.CanRedo=function(){var a=this.plugin;
return a.current_index<a.recorder.length-1};k.Redo=function(){if(!this.CanRedo())return 0;var a=this.plugin;a.current_index+=1;return a.recorder[a.current_index]};var d=function(a){this.plugin=a};k=d.prototype;k.CanUndo=function(){return 0<this.plugin.current_index};k.Undo=function(){if(!this.CanUndo())return 0;var a=this.plugin;--a.current_index;return a.recorder[a.current_index]};k.CanRedo=function(){var a=this.plugin;return a.current_index<a.recorder.length-1};k.Redo=function(){if(!this.CanRedo())return 0;
var a=this.plugin;a.current_index+=1;return a.recorder[a.current_index]}})();cr.plugins_.Rex_canvas=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.Rex_canvas.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.wait_for_textures.push(this.texture_img))};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.visible=0===
this.properties[0];this.canvas=document.createElement("canvas");this.canvas.width=this.width;this.canvas.height=this.height;this.ctx=this.canvas.getContext("2d");this.ctx.drawImage(this.type.texture_img,0,0,this.width,this.height);this.update_tex=!0;this.rcTex=new cr.rect(0,0,0,0)};e.onDestroy=function(){this.ctx=null;jQuery(this.canvas).remove();this.canvas=null};e.draw=function(a){a.save();a.globalAlpha=this.opacity;var b=this.x,c=this.y;this.runtime.pixel_rounding&&(b=Math.round(b),c=Math.round(c));
0===b&&0===c||a.translate(b,c);0!==this.angle&&a.rotate(this.angle);a.drawImage(this.canvas,-(this.hotspotX*this.width),-(this.hotspotY*this.height),this.width,this.height);a.restore()};e.drawGL=function(a){this.update_tex&&(this.tex&&a.deleteTexture(this.tex),this.tex=a.loadTexture(this.canvas,!1,this.runtime.linearSampling),this.update_tex=!1);a.setTexture(this.tex);a.setOpacity(this.opacity);var b=this.bquad;if(this.runtime.pixel_rounding){var c=Math.round(this.x)-this.x,d=Math.round(this.y)-this.y;
a.quad(b.tlx+c,b.tly+d,b.trx+c,b.try_+d,b.brx+c,b.bry+d,b.blx+c,b.bly+d)}else a.quad(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly)};e.draw_instances=function(a,b,c){var d=b.ctx,e=b.canvas,f,h=a.length;for(f=0;f<h;f++){var g=a[f];if(0!=g.visible||0!=this.runtime.testOverlap(b,g)){d.save();d.scale(e.width/b.width,e.height/b.height);d.rotate(-b.angle);d.translate(-b.bquad.tlx,-b.bquad.tly);var k=g.compositeOp;g.compositeOp=c;d.globalCompositeOperation=c;g.draw(d);g.compositeOp=k;d.restore()}}};e.DrawObject=
function(a,b){a&&(this.update_bbox(),a=a.getCurrentSol(),this.draw_instances(a.select_all?a.type.instances:a.instances,this,b),this.update_tex=this.runtime.redraw=!0)};var c="source-over source-in source-out source-atop destination-over destination-in destination-out destination-atop lighter copy xor multiply screen overlay darken lighten color-dodge color-burn hard-light soft-light difference exclusion hue saturation color luminosity".split(" ");e.saveToJSON=function(){var a=this.canvas.width,b=
this.canvas.height,c=this.ctx.getImageData(0,0,a,b).data;c=window.RexC2ZlibU8Arr.u8a2String(c);return{w:a,h:b,d:c}};e.loadFromJSON=function(a){this.canvas.width=a.w;this.canvas.height=a.h;var b=window.RexC2ZlibU8Arr.string2u8a(a.d);a=this.ctx.createImageData(a.w,a.h);var c=a.data,d,e=c.length;for(d=0;d<e;d++)c[d]=b[d];this.ctx.putImageData(a,0,0);this.update_tex=this.runtime.redraw=!0};k.cnds=new a;a.prototype.OnURLLoaded=function(){return!0};k.acts=new f;f.prototype.Eval=function(a){eval("(function(ctx){"+
a+"})")(this.ctx);this.update_tex=this.runtime.redraw=!0};f.prototype.ResizeCanvas=function(a,b){this.canvas.width=a;this.canvas.height=b;this.update_tex=this.runtime.redraw=!0};f.prototype.ClearRect=function(a,b,c,d){this.ctx.clearRect(a,b,c,d);this.update_tex=this.runtime.redraw=!0};f.prototype.FillRect=function(a,b,c,d){this.ctx.fillRect(a,b,c,d);this.update_tex=this.runtime.redraw=!0};f.prototype.StrokeRect=function(a,b,c,d){this.ctx.strokeRect(a,b,c,d);this.update_tex=this.runtime.redraw=!0};
f.prototype.FillText=function(a,b,c){this.ctx.fillText(a,b,c);this.update_tex=this.runtime.redraw=!0};f.prototype.StrokeText=function(a,b,c){this.ctx.strokeText(a,b,c);this.update_tex=this.runtime.redraw=!0};f.prototype.SetLineWidth=function(a){this.ctx.lineWidth=a};var d=["butt","round","square"];f.prototype.SetLineCap=function(a){"number"===typeof a&&(a=d[a]);this.ctx.lineCap=a};var b=["bevel","round","miter"];f.prototype.SetLineCap=function(a){"number"===typeof cap&&(a=b[a]);this.ctx.lineJoin=
a};f.prototype.SetMiterLimit=function(a){this.ctx.miterLimit=a};f.prototype.SetFont=function(a){this.ctx.font=a};var l=["left","right","center","start","end"];f.prototype.SetTextAlign=function(a){"number"===typeof a&&(a=l[a]);this.ctx.textAlign=a};var n="top hanging middle alphabetic ideographic bottom".split(" ");f.prototype.SetTextBaseline=function(a){"number"===typeof a&&(a=n[a]);this.ctx.textBaseline=a};f.prototype.SetFillColor=function(a){this.ctx.fillStyle=a};f.prototype.SetStrokeColor=function(a){this.ctx.strokeStyle=
a};f.prototype.SetShadowBlur=function(a){this.ctx.shadowBlur=a};f.prototype.SetShadowColor=function(a){this.ctx.shadowColor=a};f.prototype.SetShadowOffsetX=function(a){this.ctx.shadowOffsetX=a};f.prototype.SetShadowOffsetY=function(a){this.ctx.shadowOffsetY=a};f.prototype.BeginPath=function(){this.ctx.beginPath()};f.prototype.ClosePath=function(){this.ctx.closePath()};f.prototype.MoveTo=function(a,b){this.ctx.moveTo(a,b)};f.prototype.LineTo=function(a,b){this.ctx.lineTo(a,b)};f.prototype.BezierCurveTo=
function(a,b,c,d,e,f){this.ctx.bezierCurveTo(a,b,c,d,e,f)};f.prototype.QuadraticCurveTo=function(a,b,c,d){this.ctx.quadraticCurveTo(a,b,c,d)};f.prototype.Arc=function(a,b,c,d,e,f){this.ctx.arc(a,b,c,cr.to_radians(d),cr.to_radians(e),1===f)};f.prototype.ArcTo=function(a,b,c,d,e){this.ctx.arcTo(a,b,c,d,e)};f.prototype.Rect=function(a,b,c,d){this.ctx.rect(a,b,c,d)};var q=["nonzero","evenodd"];f.prototype.Fill=function(a){"number"===typeof a&&(a=q[a]);this.ctx.fill(a);this.update_tex=this.runtime.redraw=
!0};f.prototype.Stroke=function(){this.ctx.stroke();this.update_tex=this.runtime.redraw=!0};f.prototype.Clip=function(a){"number"===typeof a&&(a=q[a]);this.ctx.clip(a)};f.prototype.EraseObject=function(a){this.DrawObject(a,"destination-out")};f.prototype.DrawObject=function(a,b){"number"===typeof b&&(b=c[b]);this.DrawObject(a,b)};f.prototype.LoadURL=function(a,b){var c=new Image,d=this;c.onload=function(){var a=!1;if(0===b&&(d.width!=c.width||d.height!=c.height))d.width=c.width,d.height=c.height,
a=!0;else if(2===b){var e=d.width/c.width,f=d.height/c.height;if(1<e&&1<f)d.width=c.width,d.height=c.height,a=!0;else if(1>e||1>f)a=e<f?e:f,d.width=c.width*a,d.height=c.height*a,a=!0}a&&(d.set_bbox_changed(),d.canvas.width=d.width,d.canvas.height=d.height);a=d.canvas;c.width!==a.width&&(a.width=c.width);c.height!==a.height&&(a.height=c.height);d.ctx.clearRect(0,0,c.width,c.height);d.ctx.drawImage(c,0,0,c.width,c.height);d.runtime.redraw=!0;d.update_tex=!0;d.runtime.trigger(cr.plugins_.Rex_canvas.prototype.cnds.OnURLLoaded,
d)};"data:"!==a.substr(0,5)&&(c.crossOrigin="anonymous");c.src=a};k.exps=new g;g.prototype.CanvasWidth=function(a){a.set_float(this.canvas.width)};g.prototype.CanvasHeight=function(a){a.set_float(this.canvas.height)};g.prototype.TextWidth=function(a,b){a.set_float(this.ctx.measureText(b).width)};g.prototype.ImageUrl=function(a){a.set_string(this.canvas.toDataURL())}})();
(function(){if(null==window.RexC2ZlibU8Arr){window.RexC2ZlibU8Arr={};var a=[];window.RexC2ZlibU8Arr.u8a2String=function(f){f=(new window.Zlib.Deflate(f)).compress();for(var g=0;g<f.length;g+=32768)a.push(String.fromCharCode.apply(null,f.subarray(g,g+32768)));f=a.join("");f=btoa(f);a.length=0;return f};window.RexC2ZlibU8Arr.string2u8a=function(a){a=atob(a);a=a.split("").map(function(a){return a.charCodeAt(0)});return(new window.Zlib.Inflate(a)).decompress()}}})();
cr.plugins_.Sprite=function(a){this.runtime=a};
(function(){function a(){if(0===this.datauri.length){var a=document.createElement("canvas");a.width=this.width;a.height=this.height;var b=a.getContext("2d");this.spritesheeted?b.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):b.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=a.toDataURL("image/png")}return this.datauri}function f(){}function g(a){a[0]=0;a[1]=0;a[2]=0;v.push(a)}function k(a,b){return a<b?""+a+","+b:""+b+","+a}function e(a,
b,c,d){b=b.uid;c=c.uid;var e=k(b,c);if(a.hasOwnProperty(e))a[e][2]=d;else{var f=v.length?v.pop():[0,0,0];f[0]=b;f[1]=c;f[2]=d;a[e]=f}}function c(a,b,c){b=k(b.uid,c.uid);a.hasOwnProperty(b)&&(g(a[b]),delete a[b])}function d(a,b,c){b=k(b.uid,c.uid);if(a.hasOwnProperty(b))return u=a[b][2],!0;u=-2;return!1}function b(a,b,c){if(!a)return!1;var d=0!==b||0!==c,e=!1,f=this.runtime.getCurrentCondition(),g=f.type;f=f.inverted;var h=a.getCurrentSol();var k=this.runtime.getCurrentEventStack().current_event.orblock;
h.select_all?(this.update_bbox(),D.copy(this.bbox),D.offset(b,c),this.runtime.getCollisionCandidates(this.layer,a,D,A),h=A):h=k?this.runtime.isCurrentConditionFirst()&&!h.else_instances.length&&h.instances.length?h.instances:h.else_instances:h.instances;z=a;r=g!==a&&!f;if(d){var l=this.x;var m=this.y;this.x+=b;this.y+=c;this.set_bbox_changed()}b=0;for(c=h.length;b<c;b++)if(k=h[b],this.runtime.testOverlap(this,k)){e=!0;if(f)break;g!==a&&x.add(k)}d&&(this.x=l,this.y=m,this.set_bbox_changed());cr.clearArray(A);
return e}function l(){}function n(){}var q=cr.plugins_.Sprite.prototype;q.Type=function(a){this.plugin=a;this.runtime=a.runtime};var h=q.Type.prototype;h.onCreate=function(){if(!this.is_family){var b,c;this.all_frames=[];this.has_loaded_textures=!1;var d=0;for(b=this.animations.length;d<b;d++){var e=this.animations[d];var f={};f.name=e[0];f.speed=e[1];f.loop=e[2];f.repeatcount=e[3];f.repeatto=e[4];f.pingpong=e[5];f.sid=e[6];f.frames=[];var h=0;for(c=e[7].length;h<c;h++){var g=e[7][h];var k={};k.texture_file=
g[0];k.texture_filesize=g[1];k.offx=g[2];k.offy=g[3];k.width=g[4];k.height=g[5];k.duration=g[6];k.hotspotX=g[7];k.hotspotY=g[8];k.image_points=g[9];k.poly_pts=g[10];k.pixelformat=g[11];k.spritesheeted=0!==k.width;k.datauri="";k.getDataUri=a;var l={left:0,top:0,right:1,bottom:1};k.sheetTex=l;k.webGL_texture=null;(l=this.runtime.findWaitingTexture(g[0]))?k.texture_img=l:(k.texture_img=new Image,k.texture_img.cr_src=g[0],k.texture_img.cr_filesize=g[1],k.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(k.texture_img,
g[0]));cr.seal(k);f.frames.push(k);this.all_frames.push(k)}cr.seal(f);this.animations[d]=f}}};h.updateAllCurrentTexture=function(){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.curWebGLTexture=c.curFrame.webGL_texture}};h.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.texture_img.c2webGL_texture=null;c.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};h.onRestoreWebGLContext=
function(){if(!this.is_family&&this.instances.length){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.webGL_texture=this.runtime.glwrap.loadTexture(c.texture_img,!1,this.runtime.linearSampling,c.pixelformat)}this.updateAllCurrentTexture()}};h.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.webGL_texture=this.runtime.glwrap.loadTexture(c.texture_img,
!1,this.runtime.linearSampling,c.pixelformat)}this.has_loaded_textures=!0}};h.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];this.runtime.glwrap.deleteTexture(c.webGL_texture);c.webGL_texture=null}this.has_loaded_textures=!1}};var m=[];h.preloadCanvas2D=function(a){var b;cr.clearArray(m);var c=0;for(b=this.all_frames.length;c<b;++c){var d=this.all_frames[c].texture_img;-1===
m.indexOf(d)&&(a.drawImage(d,0,0),m.push(d))}};q.Instance=function(a){this.type=a;this.runtime=a.runtime;a=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(a):this.collision_poly=new cr.CollisionPoly(a)};var p=q.Instance.prototype;p.onCreate=function(){this.visible=0===this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=0!==this.properties[3];this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=
this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var a=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(a.poly_pts);this.hotspotX=a.hotspotX;this.hotspotY=a.hotspotY;this.cur_anim_speed=this.cur_animation.speed;this.cur_anim_repeatto=this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||0===this.cur_anim_speed||(this.runtime.tickMe(this),
this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.animForwards=!0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var b,c;a=0;for(b=this.type.animations.length;a<b;a++){var d=this.type.animations[a];var e=0;for(c=d.frames.length;e<c;e++){var f=d.frames[e];0===f.width&&(f.width=f.texture_img.width,f.height=f.texture_img.height);
if(f.spritesheeted){var g=f.texture_img;var h=f.sheetTex;h.left=f.offx/g.width;h.top=f.offy/g.height;h.right=(f.offx+f.width)/g.width;h.bottom=(f.offy+f.height)/g.height;0===f.offx&&0===f.offy&&f.width===g.width&&f.height===g.height&&(f.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture};p.saveToJSON=function(){var a={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum,
rt:this.cur_anim_repeatto};this.animPlaying||(a.ap=this.animPlaying);this.animForwards||(a.af=this.animForwards);return a};p.loadFromJSON=function(a){var b=this.getAnimationBySid(a.a);b&&(this.cur_animation=b);this.cur_frame=a.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=a.cas;this.frameStart=a.fs;this.animRepeats=a.ar;this.animTimer.reset();this.animTimer.sum=a.at;this.animPlaying=
a.hasOwnProperty("ap")?a.ap:!0;this.animForwards=a.hasOwnProperty("af")?a.af:!0;a.hasOwnProperty("rt")?this.cur_anim_repeatto=a.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};p.animationFinish=function(a){this.cur_frame=a?0:this.cur_animation.frames.length-1;this.animPlaying=
!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};p.getNowTime=function(){return this.animTimer.sum};p.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&this.doChangeAnimFrame();var a=this.getNowTime(),
b=this.cur_animation,c=b.frames[this.cur_frame],d=c.duration/this.cur_anim_speed;this.animPlaying&&a>=this.frameStart+d&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=d,this.cur_frame>=b.frames.length&&(b.pingpong?(this.animForwards=!1,this.cur_frame=b.frames.length-2):b.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=b.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame&&(b.pingpong?(this.cur_frame=
1,this.animForwards=!0,b.loop||(this.animRepeats++,this.animRepeats>=b.repeatcount&&this.animationFinish(!0))):b.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=b.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=b.frames.length&&(this.cur_frame=b.frames.length-1),a>this.frameStart+b.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=a),a=b.frames[this.cur_frame],this.OnFrameChanged(c,
a),this.runtime.redraw=!0)};p.getAnimationByName=function(a){var b;var c=0;for(b=this.type.animations.length;c<b;c++){var d=this.type.animations[c];if(cr.equals_nocase(d.name,a))return d}return null};p.getAnimationBySid=function(a){var b;var c=0;for(b=this.type.animations.length;c<b;c++){var d=this.type.animations[c];if(d.sid===a)return d}return null};p.doChangeAnim=function(){var a=this.cur_animation.frames[this.cur_frame],b=this.getAnimationByName(this.changeAnimName);this.changeAnimName="";!b||
cr.equals_nocase(b.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=b,this.cur_anim_speed=b.speed,this.cur_anim_repeatto=b.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.animForwards=!0,this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0)};p.doChangeAnimFrame=
function(){var a=this.cur_animation.frames[this.cur_frame],b=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);b!==this.cur_frame&&(this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};p.OnFrameChanged=function(a,b){var c=a.width,d=a.height,e=b.width,f=b.height;
c!=e&&(this.width*=e/c);d!=f&&(this.height*=f/d);this.hotspotX=b.hotspotX;this.hotspotY=b.hotspotY;this.collision_poly.set_pts(b.poly_pts);this.set_bbox_changed();this.curFrame=b;this.curWebGLTexture=b.webGL_texture;c=0;for(d=this.behavior_insts.length;c<d;c++)if(e=this.behavior_insts[c],e.onSpriteFrameChanged)e.onSpriteFrameChanged(a,b);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};p.draw=function(a){a.globalAlpha=this.opacity;var b=this.curFrame,c=b.spritesheeted,
d=b.texture_img,e=this.x,f=this.y,g=this.width,h=this.height;if(0===this.angle&&0<=g&&0<=h)e-=this.hotspotX*g,f-=this.hotspotY*h,this.runtime.pixel_rounding&&(e=Math.round(e),f=Math.round(f)),c?a.drawImage(d,b.offx,b.offy,b.width,b.height,e,f,g,h):a.drawImage(d,e,f,g,h);else{this.runtime.pixel_rounding&&(e=Math.round(e),f=Math.round(f));a.save();var k=0<g?1:-1,l=0<h?1:-1;a.translate(e,f);1===k&&1===l||a.scale(k,l);a.rotate(this.angle*k*l);e=-(this.hotspotX*cr.abs(g));f=-(this.hotspotY*cr.abs(h));
c?a.drawImage(d,b.offx,b.offy,b.width,b.height,e,f,cr.abs(g),cr.abs(h)):a.drawImage(d,e,f,cr.abs(g),cr.abs(h));a.restore()}};p.drawGL_earlyZPass=function(a){this.drawGL(a)};p.drawGL=function(a){a.setTexture(this.curWebGLTexture);a.setOpacity(this.opacity);var b=this.curFrame,c=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,e=Math.round(this.y)-this.y;b.spritesheeted?a.quadTex(c.tlx+d,c.tly+e,c.trx+d,c.try_+e,c.brx+d,c.bry+e,c.blx+d,c.bly+e,b.sheetTex):a.quad(c.tlx+d,c.tly+
e,c.trx+d,c.try_+e,c.brx+d,c.bry+e,c.blx+d,c.bly+e)}else b.spritesheeted?a.quadTex(c.tlx,c.tly,c.trx,c.try_,c.brx,c.bry,c.blx,c.bly,b.sheetTex):a.quad(c.tlx,c.tly,c.trx,c.try_,c.brx,c.bry,c.blx,c.bly)};p.getImagePointIndexByName=function(a){var b=this.curFrame,c;var d=0;for(c=b.image_points.length;d<c;d++)if(cr.equals_nocase(a,b.image_points[d][0]))return d;return-1};p.getImagePoint=function(a,b){var c=this.curFrame,d=c.image_points;var e=cr.is_string(a)?this.getImagePointIndexByName(a):a-1;e=cr.floor(e);
if(0>e||e>=d.length)return b?this.x:this.y;a=(d[e][1]-c.hotspotX)*this.width;d=d[e][2];d=(d-c.hotspotY)*this.height;c=Math.cos(this.angle);e=Math.sin(this.angle);var f=a*c-d*e;d=d*c+a*e;a=f+this.x;d+=this.y;return b?a:d};var v=[],u=-2,y=[];f.prototype.OnCollision=function(a){if(!a)return!1;var b=this.runtime,f=b.getCurrentCondition(),h=f.type,k=null;f.extra.collmemory?k=f.extra.collmemory:(k={},f.extra.collmemory=k);f.extra.spriteCreatedDestroyCallback||(f.extra.spriteCreatedDestroyCallback=!0,b.addDestroyCallback(function(a){var b=
f.extra.collmemory;a=a.uid;var c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];if(d[0]===a||d[1]===a)g(b[c]),delete b[c]}}));var l=h.getCurrentSol(),m=a.getCurrentSol();l=l.getObjects();var r,q,A=this.runtime.tickcount,p=A-1,x=b.getCurrentEventStack().current_event;for(r=0;r<l.length;r++){var n=l[r];if(m.select_all){n.update_bbox();this.runtime.getCollisionCandidates(n.layer,a,n.bbox,y);var D=y;this.runtime.addRegisteredCollisionCandidates(n,a,D)}else D=m.getObjects();for(q=0;q<D.length;q++){var v=
D[q];if(b.testOverlap(n,v)||b.checkRegisteredCollision(n,v)){var E=d(k,n,v);E=!E||u<p;e(k,n,v,A);if(E){b.pushCopySol(x.solModifiers);E=h.getCurrentSol();var z=a.getCurrentSol();E.select_all=!1;z.select_all=!1;h===a?(E.instances.length=2,E.instances[0]=n,E.instances[1]=v,h.applySolToContainer()):(E.instances.length=1,z.instances.length=1,E.instances[0]=n,z.instances[0]=v,h.applySolToContainer(),a.applySolToContainer());x.retrigger();b.popSol(x.solModifiers)}}else c(k,n,v)}cr.clearArray(y)}return!1};
var z=null,x=new cr.ObjectSet,r=!1,A=[],D=new cr.rect(0,0,0,0);h.finish=function(a){if(r){if(a){var b=this.runtime.getCurrentEventStack().current_event.orblock;a=z.getCurrentSol();var c=x.valuesRef(),d;if(a.select_all){a.select_all=!1;cr.clearArray(a.instances);var e=0;for(d=c.length;e<d;++e)a.instances[e]=c[e];if(b)for(cr.clearArray(a.else_instances),e=0,d=z.instances.length;e<d;++e)c=z.instances[e],x.contains(c)||a.else_instances.push(c)}else if(b)for(b=a.instances.length,e=0,d=c.length;e<d;++e)a.instances[b+
e]=c[e],cr.arrayFindRemove(a.else_instances,c[e]);else cr.shallowAssignArray(a.instances,c);z.applySolToContainer()}x.clear();r=!1}};f.prototype.IsOverlapping=function(a){return b.call(this,a,0,0)};f.prototype.IsOverlappingOffset=function(a,c,d){return b.call(this,a,c,d)};f.prototype.IsAnimPlaying=function(a){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,a):cr.equals_nocase(this.cur_animation.name,a)};f.prototype.CompareFrame=function(a,b){return cr.do_cmp(this.cur_frame,
a,b)};f.prototype.CompareAnimSpeed=function(a,b){return cr.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,a,b)};f.prototype.OnAnimFinished=function(a){return cr.equals_nocase(this.animTriggerName,a)};f.prototype.OnAnyAnimFinished=function(){return!0};f.prototype.OnFrameChanged=function(){return!0};f.prototype.IsMirrored=function(){return 0>this.width};f.prototype.IsFlipped=function(){return 0>this.height};f.prototype.OnURLLoaded=function(){return!0};f.prototype.IsCollisionEnabled=
function(){return this.collisionsEnabled};q.cnds=new f;l.prototype.Spawn=function(a,b,c){if(a&&b&&(b=this.runtime.createInstance(a,b,this.getImagePoint(c,!0),this.getImagePoint(c,!1)))){"undefined"!==typeof b.angle&&(b.angle=this.angle,b.set_bbox_changed());this.runtime.isInOnDestroy++;var d;this.runtime.trigger(Object.getPrototypeOf(a.plugin).cnds.OnCreated,b);if(b.is_contained){var e=0;for(d=b.siblings.length;e<d;e++){var f=b.siblings[e];this.runtime.trigger(Object.getPrototypeOf(f.type.plugin).cnds.OnCreated,
f)}}this.runtime.isInOnDestroy--;e=this.runtime.getCurrentAction();c=!1;if(cr.is_undefined(e.extra.Spawn_LastExec)||e.extra.Spawn_LastExec<this.runtime.execcount)c=!0,e.extra.Spawn_LastExec=this.runtime.execcount;if(a!=this.type&&(a=a.getCurrentSol(),a.select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=b):a.instances.push(b),b.is_contained))for(e=0,d=b.siblings.length;e<d;e++)f=b.siblings[e],a=f.type.getCurrentSol(),a.select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=f):a.instances.push(f)}};
l.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};l.prototype.StopAnim=function(){this.animPlaying=!1};l.prototype.StartAnim=function(a){this.animPlaying=!0;this.frameStart=this.getNowTime();1===a&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};l.prototype.SetAnim=function(a,b){this.changeAnimName=
a;this.changeAnimFrom=b;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};l.prototype.SetAnimFrame=function(a){this.changeAnimFrame=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnimFrame()};l.prototype.SetAnimSpeed=function(a){this.cur_anim_speed=cr.abs(a);this.animForwards=0<=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};l.prototype.SetAnimRepeatToFrame=function(a){a=Math.floor(a);
0>a&&(a=0);a>=this.cur_animation.frames.length&&(a=this.cur_animation.frames.length-1);this.cur_anim_repeatto=a};l.prototype.SetMirrored=function(a){a=cr.abs(this.width)*(0===a?-1:1);this.width!==a&&(this.width=a,this.set_bbox_changed())};l.prototype.SetFlipped=function(a){a=cr.abs(this.height)*(0===a?-1:1);this.height!==a&&(this.height=a,this.set_bbox_changed())};l.prototype.SetScale=function(a){var b=this.curFrame,c=b.width*a*(0>this.width?-1:1);a=b.height*a*(0>this.height?-1:1);if(this.width!==
c||this.height!==a)this.width=c,this.height=a,this.set_bbox_changed()};l.prototype.LoadURL=function(a,b,c){var d=new Image,e=this,f=this.curFrame;d.onload=function(){f.texture_img.src===d.src?e.runtime.glwrap&&e.curFrame===f&&(e.curWebGLTexture=f.webGL_texture):(f.texture_img=d,f.offx=0,f.offy=0,f.width=d.width,f.height=d.height,f.spritesheeted=!1,f.datauri="",f.pixelformat=0,e.runtime.glwrap&&(f.webGL_texture&&e.runtime.glwrap.deleteTexture(f.webGL_texture),f.webGL_texture=e.runtime.glwrap.loadTexture(d,
!1,e.runtime.linearSampling),e.curFrame===f&&(e.curWebGLTexture=f.webGL_texture),e.type.updateAllCurrentTexture()));0===b&&(e.width=d.width,e.height=d.height,e.set_bbox_changed());e.runtime.redraw=!0;e.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,e)};"data:"!==a.substr(0,5)&&0===c&&(d.crossOrigin="anonymous");this.runtime.setImageSrc(d,a)};l.prototype.SetCollisions=function(a){this.collisionsEnabled!==(0!==a)&&((this.collisionsEnabled=0!==a)?this.set_bbox_changed():(this.collcells.right>=
this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};q.acts=new l;n.prototype.AnimationFrame=function(a){a.set_int(this.cur_frame)};n.prototype.AnimationFrameCount=function(a){a.set_int(this.cur_animation.frames.length)};n.prototype.AnimationName=function(a){a.set_string(this.cur_animation.name)};n.prototype.AnimationSpeed=function(a){a.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};n.prototype.ImagePointX=function(a,
b){a.set_float(this.getImagePoint(b,!0))};n.prototype.ImagePointY=function(a,b){a.set_float(this.getImagePoint(b,!1))};n.prototype.ImagePointCount=function(a){a.set_int(this.curFrame.image_points.length)};n.prototype.ImageWidth=function(a){a.set_float(this.curFrame.width)};n.prototype.ImageHeight=function(a){a.set_float(this.curFrame.height)};q.exps=new n})();cr.plugins_.Text=function(a){this.runtime=a};
(function(){function a(){return q.length?q.pop():{}}function f(a){var b;var c=0;for(b=a.length;c<b;c++)q.push(a[c]);cr.clearArray(a)}function g(a){return a.length&&" "===a.charAt(a.length-1)?a.substring(0,a.length-1):a}function k(){}function e(){}function c(){}var d=cr.plugins_.Text.prototype;d.onCreate=function(){d.acts.SetWidth=function(a){this.width!==a&&(this.width=a,this.text_changed=!0,this.set_bbox_changed())}};d.Type=function(a){this.plugin=a;this.runtime=a.runtime};var b=d.Type.prototype;
b.onCreate=function(){};b.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.mycanvas=null;c.myctx=null;c.mytex=null}}};d.Instance=function(a){this.type=a;this.runtime=a.runtime;this.recycled?cr.clearArray(this.lines):this.lines=[];this.text_changed=!0};b=d.Instance.prototype;var l={};b.onCreate=function(){this.text=this.properties[0];this.visible=0===this.properties[1];this.font=this.properties[2];this.color=this.properties[3];
this.halign=this.properties[4];this.valign=this.properties[5];this.wrapbyword=0===this.properties[7];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.line_height_offset=this.properties[8];this.fontstyle=this.facename="";this.textHeight=this.textWidth=this.ptSize=0;this.parseFont();this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1);this.runtime.glwrap&&
this.runtime.tickMe(this)};b.parseFont=function(){var a=this.font.split(" "),b;for(b=0;b<a.length;b++)if("pt"===a[b].substr(a[b].length-2,2)){this.ptSize=parseInt(a[b].substr(0,a[b].length-2));this.pxHeight=Math.ceil(this.ptSize/72*96)+4;0<b&&(this.fontstyle=a[b-1]);this.facename=a[b+1];for(b+=2;b<a.length;b++)this.facename+=" "+a[b];break}};b.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,
fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};b.loadFromJSON=function(a){this.text=a.t;this.font=a.f;this.color=a.c;this.halign=a.ha;this.valign=a.va;this.wrapbyword=a.wr;this.line_height_offset=a.lho;this.facename=a.fn;this.fontstyle=a.fs;this.ptSize=a.ps;this.pxHeight=a.pxh;this.textWidth=a.tw;this.textHeight=a.th;this.last_render_tick=a.lrt;this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height};
b.tick=function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var a=this.layer;this.update_bbox();var b=this.bbox;if(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};b.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};b.updateFont=function(){this.font=
this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename;this.text_changed=!0;this.runtime.redraw=!0};b.draw=function(a,b){a.font=this.font;a.textBaseline="top";a.fillStyle=this.color;a.globalAlpha=b?1:this.opacity;if(b){var c=Math.abs(this.layer.getScale());a.save();a.scale(c,c)}if(this.text_changed||this.width!==this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,a,this.width,this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();c=b?0:this.bquad.tlx;
var d=b?0:this.bquad.tly;this.runtime.pixel_rounding&&(c=c+.5|0,d=d+.5|0);0===this.angle||b||(a.save(),a.translate(c,d),a.rotate(this.angle),d=c=0);var e=d+this.height,f=this.pxHeight;f+=this.line_height_offset;var g;1===this.valign?d+=Math.max(this.height/2-this.lines.length*f/2,0):2===this.valign&&(d+=Math.max(this.height-this.lines.length*f-2,0));for(g=0;g<this.lines.length;g++){var h=c;1===this.halign?h=c+(this.width-this.lines[g].width)/2:2===this.halign&&(h=c+(this.width-this.lines[g].width));
a.fillText(this.lines[g].text,h,d);d+=f;if(d>=e-f)break}(0!==this.angle||b)&&a.restore();this.last_render_tick=this.runtime.tickcount};b.drawGL=function(a){if(!(1>this.width||1>this.height)){var b=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var c=this.layer.getScale(),d=this.layer.getAngle(),e=this.rcTex,f=c*this.width,g=c*this.height,h=Math.ceil(f),k=Math.ceil(g),l=Math.abs(h),q=Math.abs(k),n=this.runtime.draw_width/2,t=this.runtime.draw_height/2;this.myctx||(this.mycanvas=
document.createElement("canvas"),this.mycanvas.width=l,this.mycanvas.height=q,this.lastwidth=l,this.lastheight=q,b=!0,this.myctx=this.mycanvas.getContext("2d"));if(l!==this.lastwidth||q!==this.lastheight)this.mycanvas.width=l,this.mycanvas.height=q,this.mytex&&(a.deleteTexture(this.mytex),this.mytex=null),b=!0;b&&(this.myctx.clearRect(0,0,l,q),this.draw(this.myctx,!0),this.mytex||(this.mytex=a.createEmptyTexture(l,q,this.runtime.linearSampling,this.runtime.isMobile)),a.videoToTexture(this.mycanvas,
this.mytex,this.runtime.isMobile));this.lastwidth=l;this.lastheight=q;a.setTexture(this.mytex);a.setOpacity(this.opacity);a.resetModelView();a.translate(-n,-t);a.updateModelView();var w=this.bquad;b=this.layer.layerToCanvas(w.tlx,w.tly,!0,!0);l=this.layer.layerToCanvas(w.tlx,w.tly,!1,!0);q=this.layer.layerToCanvas(w.trx,w.try_,!0,!0);n=this.layer.layerToCanvas(w.trx,w.try_,!1,!0);t=this.layer.layerToCanvas(w.brx,w.bry,!0,!0);var N=this.layer.layerToCanvas(w.brx,w.bry,!1,!0),P=this.layer.layerToCanvas(w.blx,
w.bly,!0,!0);w=this.layer.layerToCanvas(w.blx,w.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===d){var Q=(b+.5|0)-b,B=(l+.5|0)-l;b+=Q;l+=B;q+=Q;n+=B;t+=Q;N+=B;P+=Q;w+=B}0===this.angle&&0===d?(q=b+h,n=l,t=q,N=l+k,P=b,w=N,e.right=1,e.bottom=1):(e.right=f/h,e.bottom=g/k);a.quadTex(b,l,q,n,t,N,P,w,e);a.resetModelView();a.scale(c,c);a.rotateZ(-this.layer.getAngle());a.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);a.updateModelView();
this.last_render_tick=this.runtime.tickcount}};var n=[];d.TokeniseWords=function(a){cr.clearArray(n);for(var b="",c,d=0;d<a.length;)if(c=a.charAt(d),"\n"===c)b.length&&(n.push(b),b=""),n.push("\n"),++d;else if(" "===c||"\t"===c||"-"===c){do b+=a.charAt(d),d++;while(d<a.length&&(" "===a.charAt(d)||"\t"===a.charAt(d)));n.push(b);b=""}else d<a.length&&(b+=c,d++);b.length&&n.push(b)};var q=[];d.WordWrap=function(b,c,d,e,g){if(b&&b.length)if(2>=e)f(c);else{if(100>=b.length&&-1===b.indexOf("\n")){var h=
d.measureText(b).width;if(h<=e){f(c);c.push(a());c[0].text=b;c[0].width=h;return}}this.WrapText(b,c,d,e,g)}else f(c)};d.WrapText=function(b,c,d,e,f){f&&(this.TokeniseWords(b),b=n);var h="",k,l=0;for(k=0;k<b.length;k++)if("\n"===b[k]){l>=c.length&&c.push(a());h=g(h);var m=c[l];m.text=h;m.width=d.measureText(h).width;l++;h=""}else{var A=h;h+=b[k];m=d.measureText(h).width;m>=e&&(l>=c.length&&c.push(a()),A=g(A),m=c[l],m.text=A,m.width=d.measureText(A).width,l++,h=b[k],f||" "!==h||(h=""))}h.length&&(l>=
c.length&&c.push(a()),h=g(h),m=c[l],m.text=h,m.width=d.measureText(h).width,l++);for(k=l;k<c.length;k++)q.push(c[k]);c.length=l};k.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};d.cnds=new k;e.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.text!==a&&(this.text=a,this.text_changed=!0,this.runtime.redraw=!0)};e.prototype.AppendText=function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);if(a=a.toString())this.text+=
a,this.text_changed=!0,this.runtime.redraw=!0};e.prototype.SetFontFace=function(a,b){var c="";switch(b){case 1:c="bold";break;case 2:c="italic";break;case 3:c="bold italic"}if(a!==this.facename||c!==this.fontstyle)this.facename=a,this.fontstyle=c,this.updateFont()};e.prototype.SetFontSize=function(a){this.ptSize!==a&&(this.ptSize=a,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())};e.prototype.SetFontColor=function(a){a="rgb("+cr.GetRValue(a).toString()+","+cr.GetGValue(a).toString()+
","+cr.GetBValue(a).toString()+")";a!==this.color&&(this.color=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};e.prototype.SetWebFont=function(a,b){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var c=this,d=function(){c.runtime.redraw=!0;c.text_changed=!0};if(l.hasOwnProperty(b)){if(a="'"+a+"'",this.facename!==a)for(this.facename=a,this.updateFont(),a=1;10>a;a++)setTimeout(d,100*a),setTimeout(d,
1E3*a)}else{var e=document.createElement("link");e.href=b;e.rel="stylesheet";e.type="text/css";e.onload=d;document.getElementsByTagName("head")[0].appendChild(e);l[b]=!0;this.facename="'"+a+"'";this.updateFont();for(a=1;10>a;a++)setTimeout(d,100*a),setTimeout(d,1E3*a)}}};e.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};d.acts=new e;c.prototype.Text=function(a){a.set_string(this.text)};c.prototype.FaceName=
function(a){a.set_string(this.facename)};c.prototype.FaceSize=function(a){a.set_int(this.ptSize)};c.prototype.TextWidth=function(a){var b=0,c;var d=0;for(c=this.lines.length;d<c;d++){var e=this.lines[d].width;b<e&&(b=e)}a.set_int(b)};c.prototype.TextHeight=function(a){a.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};d.exps=new c})();cr.plugins_.TextBox=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.TextBox.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype,c="text password email number tel url".split(" ");-1<navigator.userAgent.indexOf("MSIE 9")&&(c[2]="text",c[3]="text",c[4]="text",c[5]="text");e.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Textbox plugin not supported on this platform - the object will not be created");
else{6===this.properties[7]?(this.elem=document.createElement("textarea"),jQuery(this.elem).css("resize","none")):(this.elem=document.createElement("input"),this.elem.type=c[this.properties[7]]);this.elem.id=this.properties[9];jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.elem.autocomplete="off";this.elem.value=this.properties[0];this.elem.placeholder=this.properties[1];this.elem.title=this.properties[2];this.elem.disabled=0===this.properties[4];this.elem.readOnly=
1===this.properties[5];this.elem.spellcheck=1===this.properties[6];this.autoFontSize=0!==this.properties[8];this.element_hidden=!1;0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var a=function(a){return function(){a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,a)}}(this);this.elem.oninput=a;-1!==navigator.userAgent.indexOf("MSIE")&&(this.elem.oncut=a);this.elem.onclick=function(a){return function(b){b.stopPropagation();a.runtime.isInUserInputEvent=
!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.ondblclick=function(a){return function(b){b.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnDoubleClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchend",
function(a){a.stopPropagation()},!1);jQuery(this.elem).mousedown(function(a){a.stopPropagation()});jQuery(this.elem).mouseup(function(a){a.stopPropagation()});jQuery(this.elem).keydown(function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});jQuery(this.elem).keyup(function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)}};e.saveToJSON=function(){return{text:this.elem.value,
placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,spellcheck:!!this.elem.spellcheck}};e.loadFromJSON=function(a){this.elem.value=a.text;this.elem.placeholder=a.placeholder;this.elem.title=a.tooltip;this.elem.disabled=a.disabled;this.elem.readOnly=a.readonly;this.elem.spellcheck=a.spellcheck};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=
function(a){if(!this.runtime.isDomFree){var b=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||b>=f||c>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):
(1>b&&(b=1),1>c&&(c=1),d>=f&&(d=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==b||this.lastTop!==c||this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||this.lastWinHeight!==g?(this.lastLeft=b,this.lastTop=c,this.lastRight=d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(b)+jQuery(this.runtime.canvas).offset().left,f=Math.round(c)+jQuery(this.runtime.canvas).offset().top,
jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-b)),jQuery(this.elem).height(Math.round(e-c)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1))}};e.draw=function(a){};e.drawGL=function(a){};a.prototype.CompareText=function(a,b){return this.runtime.isDomFree?!1:0===b?cr.equals_nocase(this.elem.value,
a):this.elem.value===a};a.prototype.OnTextChanged=function(){return!0};a.prototype.OnClicked=function(){return!0};a.prototype.OnDoubleClicked=function(){return!0};k.cnds=new a;f.prototype.SetText=function(a){this.runtime.isDomFree||(this.elem.value=a)};f.prototype.SetPlaceholder=function(a){this.runtime.isDomFree||(this.elem.placeholder=a)};f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};
f.prototype.SetEnabled=function(a){this.runtime.isDomFree||(this.elem.disabled=0===a)};f.prototype.SetReadOnly=function(a){this.runtime.isDomFree||(this.elem.readOnly=0===a)};f.prototype.SetFocus=function(){this.runtime.isDomFree||this.elem.focus()};f.prototype.SetBlur=function(){this.runtime.isDomFree||this.elem.blur()};f.prototype.SetCSSStyle=function(a,b){this.runtime.isDomFree||jQuery(this.elem).css(a,b)};f.prototype.ScrollToBottom=function(){this.runtime.isDomFree||(this.elem.scrollTop=this.elem.scrollHeight)};
k.acts=new f;g.prototype.Text=function(a){this.runtime.isDomFree?a.set_string(""):a.set_string(this.elem.value)};k.exps=new g})();cr.plugins_.TiledBg=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.TiledBg.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};var e=k.Type.prototype;e.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.waitForImageLoad(this.texture_img,this.texture_file),this.webGL_texture=this.pattern=null)};e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};e.onRestoreWebGLContext=function(){if(!this.is_family&&
this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat));var a;var d=0;for(a=this.instances.length;d<a;d++)this.instances[d].webGL_texture=this.webGL_texture}};e.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};e.unloadTextures=
function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};e.preloadCanvas2D=function(a){a.drawImage(this.texture_img,0,0)};k.Instance=function(a){this.type=a;this.runtime=a.runtime};e=k.Instance.prototype;e.onCreate=function(){this.visible=0===this.properties[0];this.rcTex=new cr.rect(0,0,0,0);this.has_own_texture=!1;this.texture_img=this.type.texture_img;this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=
this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)};e.afterLoad=function(){this.has_own_texture=!1;this.texture_img=this.type.texture_img};e.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};e.draw=function(a){a.globalAlpha=this.opacity;a.save();a.fillStyle=this.pattern;var c=
this.x,b=this.y;this.runtime.pixel_rounding&&(c=Math.round(c),b=Math.round(b));var e=-(this.hotspotX*this.width),f=-(this.hotspotY*this.height),g=e%this.texture_img.width,h=f%this.texture_img.height;0>g&&(g+=this.texture_img.width);0>h&&(h+=this.texture_img.height);a.translate(c,b);a.rotate(this.angle);a.translate(g,h);a.fillRect(e-g,f-h,this.width,this.height);a.restore()};e.drawGL_earlyZPass=function(a){this.drawGL(a)};e.drawGL=function(a){a.setTexture(this.webGL_texture);a.setOpacity(this.opacity);
var c=this.rcTex;c.right=this.width/this.texture_img.width;c.bottom=this.height/this.texture_img.height;var b=this.bquad;if(this.runtime.pixel_rounding){var e=Math.round(this.x)-this.x,f=Math.round(this.y)-this.y;a.quadTex(b.tlx+e,b.tly+f,b.trx+e,b.try_+f,b.brx+e,b.bry+f,b.blx+e,b.bly+f,c)}else a.quadTex(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly,c)};a.prototype.OnURLLoaded=function(){return!0};k.cnds=new a;f.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);
cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};f.prototype.LoadURL=function(a,d){var b=new Image,c=this;b.onload=function(){c.texture_img=b;c.runtime.glwrap?(c.has_own_texture&&c.webGL_texture&&c.runtime.glwrap.deleteTexture(c.webGL_texture),c.webGL_texture=c.runtime.glwrap.loadTexture(b,!0,c.runtime.linearSampling)):c.pattern=c.runtime.ctx.createPattern(b,"repeat");c.has_own_texture=!0;c.runtime.redraw=!0;c.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded,c)};"data:"!==
a.substr(0,5)&&0===d&&(b.crossOrigin="anonymous");this.runtime.setImageSrc(b,a)};k.acts=new f;g.prototype.ImageWidth=function(a){a.set_float(this.texture_img.width)};g.prototype.ImageHeight=function(a){a.set_float(this.texture_img.height)};k.exps=new g})();cr.plugins_.Touch=function(a){this.runtime=a};
(function(){function a(a){q=a.x;h=a.y;m=a.z}function f(a,b,c,d){var e=p.length?p.pop():new g;e.init(a,b,c,d);return e}function g(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function k(a){return a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||a.originalEvent&&a.originalEvent.sourceCapabilities&&a.originalEvent.sourceCapabilities.firesTouchEvents}function e(){}function c(){}
function d(){}var b=cr.plugins_.Touch.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.mouseDown=!1};var l=b.Instance.prototype,n={left:0,top:0};l.findTouch=function(a){var b;var c=0;for(b=this.touches.length;c<b;c++)if(this.touches[c].id===a)return c;return-1};var q=0,h=0,m=0,p=[];g.prototype.init=function(a,b,c,d){var e=cr.performance_now();this.starttime=this.lasttime=
this.time=e;this.startx=a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=c;this.startindex=d;this.tooFarForHold=this.triggeredHold=!1};g.prototype.update=function(a,b,c,d,e,f){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=c;this.width=d;this.height=e;this.pressure=f;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};g.prototype.maybeTriggerHold=function(a,
b){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,a),a.getTouchIndex=0)};var v=-1E3,u=-1E3,y=-1E4;g.prototype.maybeTriggerTap=function(a,
b){if(!this.triggeredHold){var c=cr.performance_now();333>=c-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=c-y&&25>cr.distanceTo(v,u,this.x,this.y)?(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,a),u=v=-1E3,y=-1E4):(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,
a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,a),v=this.x,u=this.y,y=c),a.getTouchIndex=0)}};l.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_permission=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=
0!==this.properties[0];var b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,c=document;this.runtime.isDirectCanvas?c=b=window.Canvas:this.runtime.isCocoonJs&&(c=b=window);var d=this;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),b.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),c.addEventListener("pointerup",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("pointercancel",function(a){d.onPointerEnd(a,
!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",function(a){d.onPointerStart(a)},!1),b.addEventListener("MSPointerMove",
function(a){d.onPointerMove(a)},!1),c.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("MSPointerCancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(b.addEventListener("touchstart",function(a){d.onTouchStart(a)},!1),b.addEventListener("touchmove",function(a){d.onTouchMove(a)},
!1),c.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),c.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},f=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},g=Windows.Devices.Sensors.Accelerometer.getDefault();g&&(g.reportInterval=Math.max(g.minimumReportInterval,16),g.addEventListener("readingchanged",
e));var h=Windows.Devices.Sensors.Inclinometer.getDefault();h&&(h.reportInterval=Math.max(h.minimumReportInterval,16),h.addEventListener("readingchanged",f));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(g&&g.removeEventListener("readingchanged",e),h&&h.removeEventListener("readingchanged",f)):(g&&g.addEventListener("readingchanged",e),h&&h.addEventListener("readingchanged",f))},!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=
a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&(jQuery(document).mousemove(function(a){d.onMouseMove(a)}),jQuery(document).mousedown(function(a){d.onMouseDown(a)}),
jQuery(document).mouseup(function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this)};l.onPointerMove=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),c=cr.performance_now();if(0<=b){var d=this.runtime.isDomFree?n:jQuery(this.runtime.canvas).offset();
b=this.touches[b];2>c-b.time||b.update(c,a.pageX-d.left,a.pageY-d.top,a.width||0,a.height||0,a.pressure||0)}}};l.onPointerStart=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.runtime.isDomFree?n:jQuery(this.runtime.canvas).offset(),c=a.pageX-b.left;b=a.pageY-b.top;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(f(c,b,a.pointerId,this.trigger_index));
this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=c;this.curTouchY=b;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};l.onPointerEnd=function(a,b){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),a=this.findTouch(a.pointerId),
this.trigger_index=0<=a?this.touches[a].startindex:-1,this.trigger_id=0<=a?this.touches[a].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=a&&(b||this.touches[a].maybeTriggerTap(this,a),100>p.length&&p.push(this.touches[a]),this.touches.splice(a,1)),this.runtime.isInUserInputEvent=!1)};l.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),
c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];var f=this.findTouch(e.identifier);if(0<=f){var g=this.runtime.isDomFree?n:jQuery(this.runtime.canvas).offset();f=this.touches[f];2>b-f.time||f.update(b,e.pageX-g.left,e.pageY-g.top,2*(e.radiusX||e.webkitRadiusX||e.mozRadiusX||e.msRadiusX||0),2*(e.radiusY||e.webkitRadiusY||e.mozRadiusY||e.msRadiusY||0),e.force||e.webkitForce||e.mozForce||e.msForce||0)}}};l.onTouchStart=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&
a.preventDefault();var b=this.runtime.isDomFree?n:jQuery(this.runtime.canvas).offset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];var g=this.findTouch(e.identifier);if(-1===g){g=e.pageX-b.left;var h=e.pageY-b.top;this.trigger_index=this.touches.length;this.trigger_id=e.identifier;this.touches.push(f(g,h,e.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,
this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=g;this.curTouchY=h;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};l.onTouchEnd=function(a,b){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();this.runtime.isInUserInputEvent=!0;var c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];e=this.findTouch(e.identifier);0<=e&&(this.trigger_index=this.touches[e].startindex,
this.trigger_id=this.touches[e].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),b||this.touches[e].maybeTriggerTap(this,e),100>p.length&&p.push(this.touches[e]),this.touches.splice(e,1))}this.runtime.isInUserInputEvent=!1};l.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==m?90*m:this.orient_alpha};l.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&
0!==h?90*h:this.orient_beta};l.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==q?90*q:this.orient_gamma};l.onMouseDown=function(a){k(a)||(this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!0)};l.onMouseMove=function(a){if(this.mouseDown&&!k(a))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};l.onMouseUp=function(a){a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();
this.runtime.had_a_click=!0;k(a)||(this.onTouchEnd({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!1)};l.tick2=function(){var a,b=cr.performance_now();var c=0;for(a=this.touches.length;c<a;++c){var d=this.touches[c];d.time<=b-50&&(d.lasttime=b);d.maybeTriggerHold(this,c)}};e.prototype.OnTouchStart=function(){return!0};e.prototype.OnTouchEnd=function(){return!0};e.prototype.IsInTouch=function(){return this.touches.length};e.prototype.OnTouchObject=function(a){return a?
this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};var z=[];e.prototype.IsTouchingObject=function(a){if(!a)return!1;var b=a.getCurrentSol(),c=b.getObjects(),d,e;var f=0;for(d=c.length;f<d;f++){var g=c[f];g.update_bbox();var h=0;for(e=this.touches.length;h<e;h++){var k=this.touches[h];var l=g.layer.canvasToLayer(k.x,k.y,!0);k=g.layer.canvasToLayer(k.x,k.y,!1);if(g.contains_pt(l,k)){z.push(g);break}}}return z.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,
z),a.applySolToContainer(),cr.clearArray(z),!0):!1};e.prototype.CompareTouchSpeed=function(a,b,c){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var d=this.touches[a];a=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;var e=0;0<d&&(e=a/d);return cr.do_cmp(e,b,c)};e.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};e.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};e.prototype.CompareOrientation=
function(a,b,c){a=0===a?this.getAlpha():1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,c)};e.prototype.CompareAcceleration=function(a,b,c){var d=0;0===a?d=this.acc_g_x:1===a?d=this.acc_g_y:2===a?d=this.acc_g_z:3===a?d=this.acc_x:4===a?d=this.acc_y:5===a&&(d=this.acc_z);return cr.do_cmp(d,b,c)};e.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.OnNthTouchEnd=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.HasNthTouch=
function(a){a=Math.floor(a);return this.touches.length>=a+1};e.prototype.OnHoldGesture=function(){return!0};e.prototype.OnTapGesture=function(){return!0};e.prototype.OnDoubleTapGesture=function(){return!0};e.prototype.OnHoldGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnDoubleTapGestureObject=
function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnPermissionGranted=function(a){return this.trigger_permission===a};e.prototype.OnPermissionDenied=function(a){return this.trigger_permission===a};b.cnds=new e;c.prototype.RequestPermission=function(a){var b=this,c=Promise.resolve(!0);0===a?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(c=window.DeviceOrientationEvent.requestPermission().then(function(a){return"granted"===
a})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(c=window.DeviceMotionEvent.requestPermission().then(function(a){return"granted"===a}));c.then(function(c){b.trigger_permission=a;c?b.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted,b):b.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied,b)})};b.acts=new c;d.prototype.TouchCount=function(a){a.set_int(this.touches.length)};d.prototype.X=function(a,b){var c=this.getTouchIndex;if(0>c||c>=
this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxX;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0));b.scale=d;b.zoomRate=e;b.parallaxX=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0)):a.set_float(0)};d.prototype.XAt=
function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,
this.touches[b].y,!0)):a.set_float(0)};d.prototype.XForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,
b.y,!0)):a.set_float(0)};d.prototype.Y=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxY;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1));b.scale=d;b.zoomRate=e;b.parallaxY=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?
a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1)):a.set_float(0)};d.prototype.YAt=function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):
this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};d.prototype.YForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):
this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};d.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};d.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};d.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};d.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):
a.set_float(0)};d.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};d.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};d.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0>=c?a.set_float(0):a.set_float(b/c)}};d.prototype.SpeedForID=
function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0>=c?a.set_float(0):a.set_float(b/c)}};d.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};d.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,
b.lasty,b.x,b.y))))};d.prototype.Alpha=function(a){a.set_float(this.getAlpha())};d.prototype.Beta=function(a){a.set_float(this.getBeta())};d.prototype.Gamma=function(a){a.set_float(this.getGamma())};d.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};d.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};d.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};d.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};d.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};
d.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};d.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};d.prototype.TouchID=function(a){a.set_float(this.trigger_id)};d.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};d.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};d.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};
b.exps=new d})();cr.plugins_.UserMedia=function(a){this.runtime=a};
(function(){function a(a){if(a)if(a.stop)a.stop();else{a=a.getTracks();for(var b=0,c=a.length;b<c;++b){var d=a[b];d.stop&&d.stop()}}}function f(){!t&&A&&(E=A.getVoices(),t=!0)}function g(){f();return E?E.length:0}function k(a){f();return!E||0>a||a>=E.length?null:E[a]}function e(){}function c(){}function d(){}var b=cr.plugins_.UserMedia.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};var l=b.Type.prototype;l.onCreate=function(){};l.onRestoreWebGLContext=function(){if(!this.is_family&&
this.instances.length){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.video_active&&0<=c.v.videoWidth&&0<=c.v.videoHeight&&(c.webGL_texture=this.runtime.glwrap.createEmptyTexture(c.v.videoWidth,c.v.videoHeight,this.runtime.linearSampling))}}};b.Instance=function(a){this.type=a;this.runtime=a.runtime};l=b.Instance.prototype;var n=!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia;window.URL||(window.URL=window.webkitURL||window.mozURL||window.msURL);var q=
[],h=[],m=!1,p=!(!window.webkitSpeechRecognition&&!window.speechRecognition),v=-1,u=null,y=null,z="",x=[],r="",A=window.speechSynthesis||window.webkitSpeechSynthesis||window.mozSpeechSynthesis||window.msSpeechSynthesis,D=window.SpeechSynthesisUtterance||window.webkitSpeechSynthesisUtterance||window.mozSpeechSynthesisUtterance||window.msSpeechSynthesisUtterance,E=null,t=!1;l.onCreate=function(){var a=this;if(this.v=document.createElement("video"))this.v.crossOrigin="anonymous",this.v.autoplay=!0,this.v.addEventListener("canplaythrough",
function(){a.video_active&&(a.video_ready=!0)});cr.setGLBlend(this,0,this.runtime.gl);this.audio_active=this.video_active=!1;this.media_stream=null;this.runtime.tickMe(this);this.snapshot_data="";this.webGL_texture=null;this.lastDecodedFrame=-1;this.video_ready=!1;this.viaCtx=this.viaCanvas=null;this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge;this.speechRecognition=null;this.interimTranscript=this.finalTranscript="";this.isRecognisingSpeech=!1;this.lastSpeechError="";if(this.runtime.isWinJS&&
!this.runtime.isWindows8Capable){var b=Windows.Devices.Sensors.LightSensor.getDefault();if(b){var c=b.minimumReportInterval;b.reportInterval=16<c?c:16;b.addEventListener("readingchanged",function(b){v=b.reading.illuminanceInLux;a.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeviceLight,a)})}}else window.addEventListener("devicelight",function(b){v=b.value;a.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeviceLight,a)})};l.onDestroy=function(){this.media_stream&&(a(this.media_stream),
this.media_stream=null,this.audio_active=this.video_ready=this.video_active=!1);this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null};l.tick=function(){this.video_active&&this.video_ready&&(this.runtime.redraw=!0)};l.draw=function(a){a.globalAlpha=this.opacity;a.save();a.fillStyle="#000";a.fillRect(this.x,this.y,this.width,this.height);if(this.video_active&&this.video_ready){var b=this.v.videoWidth/
this.v.videoHeight,c=this.width,d=this.height,e=0,f=0;if(c/d>b){var g=d*b;b=d;e=Math.floor((c-g)/2);0>e&&(e=0)}else g=c,b=c/b,f=Math.floor((d-b)/2),0>f&&(f=0);try{a.drawImage(this.v,this.x+e,this.y+f,g,b)}catch(L){}}a.restore()};l.drawGL=function(a){a.setBlend(this.srcBlend,this.destBlend);a.setOpacity(this.opacity);var b=this.bquad;a.setTexture(null);a.quad(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly);if(!(!this.video_active||!this.video_ready||0>=this.v.videoWidth||0>=this.v.videoHeight)){this.webGL_texture||
(this.webGL_texture=a.createEmptyTexture(this.v.videoWidth,this.v.videoHeight,this.runtime.linearSampling));b=this.v.webkitDecodedFrameCount||this.v.mozParsedFrames;var c=!1;b?b>this.lastDecodedFrame&&(c=!0,this.lastDecodedFrame=b):c=!0;c&&(this.useViaCanvasWorkaround?(this.viaCtx||(this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=this.v.videoWidth,this.viaCanvas.height=this.v.videoHeight,this.viaCtx=this.viaCanvas.getContext("2d")),this.viaCtx.drawImage(this.v,0,0),a.videoToTexture(this.viaCanvas,
this.webGL_texture)):a.videoToTexture(this.v,this.webGL_texture));c=this.v.videoWidth/this.v.videoHeight;var d=this.width,e=this.height,f=0,g=0;d/e>c?(b=e*c,c=e,f=Math.floor((d-b)/2),0>f&&(f=0)):(b=d,c=d/c,g=Math.floor((e-c)/2),0>g&&(g=0));d=this.x+f;g=this.y+g;b=d+b;c=g+c;a.setTexture(this.webGL_texture);a.quad(d,g,b,g,b,c,d,c)}};e.prototype.OnApproved=function(){return!0};e.prototype.OnDeclined=function(){return!0};e.prototype.SupportsUserMedia=function(){return n};e.prototype.SupportsSpeechRecognition=
function(){return p};e.prototype.OnSpeechRecognitionStart=function(){return!0};e.prototype.OnSpeechRecognitionEnd=function(){return!0};e.prototype.OnSpeechRecognitionError=function(){return!0};e.prototype.OnSpeechRecognitionResult=function(){return!0};e.prototype.IsRecognisingSpeech=function(){return this.isRecognisingSpeech};e.prototype.OnDeviceLight=function(){return!0};e.prototype.SupportsSpeechSynthesis=function(){return!!A&&!!D};e.prototype.IsSpeaking=function(){return A&&A.speaking};e.prototype.OnMediaSources=
function(){return!0};e.prototype.OnCanvasRecordingReady=function(){return!0};e.prototype.SupportsCanvasRecording=function(){return this.runtime.canvas&&this.runtime.canvas.captureStream&&"undefined"!==typeof MediaRecorder};e.prototype.IsCanvasRecordFormatSupported=function(a){a=0===a?"video/webm;codecs=vp8":"video/webm;codecs=vp9";return"undefined"===typeof MediaRecorder?!1:MediaRecorder.isTypeSupported?!!MediaRecorder.isTypeSupported(a):MediaRecorder.canRecordMimeType?!!MediaRecorder.canRecordMimeType(a):
!1};b.cnds=new e;c.prototype.RequestCamera=function(a,b,c){if(!m&&n){m=!0;var d=this;a=Math.floor(a);var e={};e.video=0>a||a>=h.length?{}:{deviceId:{exact:h[a].deviceId}};0<b&&0<c&&(e.video.width=Math.floor(b),e.video.height=Math.floor(c));navigator.mediaDevices.getUserMedia(e).then(function(a){d.media_stream=a;d.video_ready=!1;"undefined"!==typeof d.v.srcObject?d.v.srcObject=a:d.v.src=window.URL.createObjectURL(a);d.v.play();d.video_active=!0;m=!1;d.lastDecodedFrame=-1;d.runtime.glwrap&&d.webGL_texture&&
(d.runtime.glwrap.deleteTexture(d.webGL_texture),d.webGL_texture=null);d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnApproved,d)}).catch(function(a){m=!1;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeclined,d)})}};c.prototype.RequestMic=function(a,b){if(!m&&n){m=!0;var c=this;b=Math.floor(b);var d={};d.audio=0>b||b>=q.length?!0:{optional:[{deviceId:q[b].deviceId}]};navigator.mediaDevices.getUserMedia(d).then(function(b){c.media_stream=b;window.c2OnAudioMicStream&&window.c2OnAudioMicStream(b,
a);c.audio_active=!0;m=!1;c.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnApproved,c)}).catch(function(){m=!1;c.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeclined,c)})}};c.prototype.Stop=function(){this.media_stream&&(a(this.media_stream),this.media_stream=null,this.audio_active=this.video_ready=this.video_active=!1)};c.prototype.Snapshot=function(a,b){if(this.video_active&&this.video_ready){var c=document.createElement("canvas");c.width=this.v.videoWidth;c.height=this.v.videoHeight;
c.getContext("2d").drawImage(this.v,0,0,this.v.videoWidth,this.v.videoHeight);this.snapshot_data=c.toDataURL(0===a?"image/png":"image/jpeg",b/100)}};c.prototype.RequestSpeechRecognition=function(a,b,c){if(p){window.webkitSpeechRecognition?this.speechRecognition=new window.webkitSpeechRecognition:window.speechRecognition&&(this.speechRecognition=new window.speechRecognition);this.speechRecognition.lang=a;this.speechRecognition.continuous=0===b;this.speechRecognition.interimResults=0===c;this.isRecognisingSpeech=
!1;this.finalTranscript=this.interimTranscript="";var d=this;this.speechRecognition.onstart=function(){d.isRecognisingSpeech=!0;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionStart,d)};this.speechRecognition.onend=function(){d.isRecognisingSpeech=!1;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionEnd,d)};this.speechRecognition.onerror=function(a){d.isRecognisingSpeech=!1;d.lastSpeechError=a.error||"unknown";d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionError,
d)};this.speechRecognition.onresult=function(a){var b;d.interimTranscript="";for(b=a.resultIndex;b<a.results.length;++b)a.results[b].isFinal?d.finalTranscript+=a.results[b][0].transcript:d.interimTranscript+=a.results[b][0].transcript;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionResult,d)};this.speechRecognition.start()}};c.prototype.StepSpeechRecognition=function(){this.speechRecognition&&(this.speechRecognition.stop(),this.speechRecognition=null)};c.prototype.SpeakText=
function(a,b,c,d,e,g){if(A&&D){a=new D(a);b&&(a.lang=b);if(c){a:{f();if(E){var h;b=0;for(h=E.length;b<h;++b){var k=E[b];if(k.voiceURI===c){b=k;break a}}}b=null}a.voice=b;a.voiceURI=c}c=Math.pow(10,d/20);0>c&&(c=0);1<c&&(c=1);a.volume=c;a.rate=e;a.pitch=g;A.speak(a)}};c.prototype.StopSpeaking=function(){A&&A.cancel()};c.prototype.PauseSpeaking=function(){A&&A.pause()};c.prototype.ResumeSpeaking=function(){A&&A.resume()};c.prototype.GetMediaSources=function(){var a=this;cr.clearArray(q);cr.clearArray(h);
var b=function(b){var c;var d=0;for(c=b.length;d<c;++d){var e=b[d];var f=e.kind;"audio"===f||"audioinput"===f?q.push(e):("video"===f||"videoinput"===f)&&h.push(e);a.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnMediaSources,a)}};navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(b):window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&window.MediaStreamTrack.getSources(b)};c.prototype.StartRecordingCanvas=function(b,c,d){if(!u&&
!y&&this.runtime.canvas&&this.runtime.canvas.captureStream&&"undefined"!==typeof window.MediaRecorder){y=0<d?this.runtime.canvas.captureStream(d):this.runtime.canvas.captureStream();cr.clearArray(x);z=0===b?"video/webm;codecs=vp8":"video/webm;codecs=vp9";var e=this;try{u=new window.MediaRecorder(y,{bitsPerSecond:1E3*c,mimeType:z})}catch(B){a(y);y=null;return}u.ondataavailable=function(a){x.push(a.data)};u.onerror=function(a){console.error("Recording error: ",a)};u.onwarning=function(a){console.warn("Recording warning: ",
a)};u.onstop=function(a){a=new Blob(x,{type:z});r&&URL.revokeObjectURL(r);r=URL.createObjectURL(a);e.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnCanvasRecordingReady,e)};window.setTimeout(function(){u.start()},100)}};c.prototype.StopRecordingCanvas=function(){u&&(u.stop(),u=null,a(y),y=null)};b.acts=new c;d.prototype.VideoWidth=function(a){a.set_int(this.v?this.v.videoWidth:0)};d.prototype.VideoHeight=function(a){a.set_int(this.v?this.v.videoHeight:0)};d.prototype.SnapshotURL=function(a){a.set_string(this.snapshot_data)};
d.prototype.FinalTranscript=function(a){a.set_string(this.finalTranscript)};d.prototype.InterimTranscript=function(a){a.set_string(this.interimTranscript)};d.prototype.SpeechError=function(a){a.set_string(this.lastSpeechError)};d.prototype.AmbientLux=function(a){a.set_float(v)};d.prototype.VoiceCount=function(a){a.set_int(g())};d.prototype.VoiceNameAt=function(a,b){b=Math.floor(b);b=k(b);a.set_string(b?b.name:"")};d.prototype.VoiceLangAt=function(a,b){b=Math.floor(b);b=k(b);a.set_string(b?b.lang:
"")};d.prototype.VoiceURIAt=function(a,b){b=Math.floor(b);b=k(b);a.set_string(b?b.voiceURI:"")};d.prototype.AudioSourceCount=function(a){a.set_int(q.length)};d.prototype.AudioSourceLabelAt=function(a,b){b=Math.floor(b);0>b||b>=q.length?a.set_string(""):a.set_string(q[b].label||"")};d.prototype.CameraSourceCount=function(a){a.set_int(h.length)};d.prototype.CameraSourceLabelAt=function(a,b){b=Math.floor(b);0>b||b>=h.length?a.set_string(""):a.set_string(h[b].label||"")};d.prototype.CameraSourceFacingAt=
function(a,b){b=Math.floor(b);0>b||b>=h.length?a.set_string(""):a.set_string(h[b].facing||h[b].facingMode||"")};d.prototype.CanvasRecordingURL=function(a){a.set_string(r)};b.exps=new d})();if(void 0===window)var window="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window;var __CONSTRUCT2_RUNTIME2__=!0,__CONSTRUCT3_RUNTIME2__=!1,__CONSTRUCT3_RUNTIME3__=!1,__DEBUG__=!1;cr.plugins_.ValerypopoffJSPlugin=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.ValerypopoffJSPlugin.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){function a(a,b){if(void 0===document)a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"'document' is not defined. You're probably launching the game in a Worker. Workers are not supported yet. Export project with 'Use worker' option unchecked in the 'Advanced' section of the 'Project properties' panel."});
else{var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",b);c.onreadystatechange=function(){"complete"==this.readyState&&a.sciptsToLoad--};c.onload=function(){a.sciptsToLoad--};c.onerror=function(){a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"Probably file not found"})};document.getElementsByTagName("head")[0].appendChild(c)}}this.returnValue=void 0;this.sciptsToLoad=
0;this.Aliases={};this.construct_compare_function_prefix="ConstructCompare_";this.AliasDotpartsCache={count:0,max_count:4096,Dotparts:{},AliasNames:{},AliasTrailers:{},IsAlias:{}};this.NonAliasDotpartsCache={count:0,max_count:2048,Dotparts:{}};if(""!=this.properties[0]){var b=[];b=__CONSTRUCT2_RUNTIME2__?this.properties[0].split(";"):this.properties[0].split(/[;\n\r]/);for(var c=0;c<b.length;c++)if(b[c]=b[c].trim(),0!=b[c].length&&(this.sciptsToLoad++,__CONSTRUCT2_RUNTIME2__&&a(this,b[c]),__CONSTRUCT3_RUNTIME2__&&
a(this,this.runtime.getLocalFileUrl(b[c])),__CONSTRUCT3_RUNTIME3__)){var d=this;void 0!==d._runtime.GetAssetManager().LoadProjectFileUrl?d._runtime.GetAssetManager().LoadProjectFileUrl(b[c]).then(function(b){a(d,b)},function(a){d.ShowError({debug_caller:"Including '"+b[c]+"' script to the page",caller_name:"Including '"+b[c]+"' script to the page",error_message:a.message})}).catch(function(a){d.ShowError({debug_caller:"Including '"+b[c]+"' script to the page",caller_name:"Including '"+b[c]+"' script to the page",
error_message:a.message})}):a(d,d._runtime.GetAssetManager().GetLocalFileUrl(b[c]))}}};e.draw=function(a){};e.drawGL=function(a){};var c=function(a){for(var b=[],d=0,e=0,f=0,g=a.length;f<g;f++)"["==a[f]?d++:"]"==a[f]?e++:"."==a[f]&&d==e&&b.push(f);var k=[],l=b.length-1;b.forEach(function(c,d,e){e=a.substring(b[d-1]+1,c);""!=e&&k.push(e);d==l&&(e=a.substring(c+1),""!=e&&k.push(e))});0==k.length&&k.push(a);k.forEach(function(a,b,d){"["==a[0]&&(d[b]=c(a.substring(1,a.length-1)))});return k},d=function(a,
b){return a=a.replace(/#[0-9]+/g,function(a){a=b[a.substr(1)];return"string"===typeof a?"'"+a+"'":a})},b=function(a,b){a+="(";if(b)for(var c=0,d=b.length;c<d;++c)a="string"===typeof b[c]?a+"'"+b[c]+"'":a+b[c],c!=b.length-1&&(a+=",");return a+")"},l={Value:function(a,b){var c=b[0];b.splice(0,1);var d=this.ParseJS(c,!0,a);if(d.error)ret.set_any(void 0);else{var e=void 0;try{e=d.end}catch(u){this.ShowError({debug_caller:"Value",caller_name:a,"show-alias-expression":d.alias_found,alias_expression:d.trimmed_code,
error_message:u.message});ret.set_any(void 0);return}"function"==typeof d.end&&(e=this.CallJSfunction(c,b,!1,a,d));return e}},CallJSfunction:function(a,c,d,e,f){void 0===d&&(d=!0);void 0===e&&(e="'Call function' action");f=void 0===f?this.ParseJS(a,!0,e):f;if(!f.error)if(0<=a.indexOf("(")||0<=a.indexOf(")"))a={debug_caller:"CallJSfunction",caller_name:e,error_message:"'"+f.trimmed_code+"' must be a function name, not a function call. Remove parentheses."},f.alias_found&&(a["show-alias-expression"]=
!0,a.alias_expression=f.trimmed_code),this.ShowError(a);else{var g=void 0;try{g=f.end.apply(f.context,c)}catch(y){y instanceof TypeError&&0<=y.message.indexOf("apply")&&0<=y.message.indexOf("undefined")&&(y.message=a+" is undefined");a={debug_caller:"CallJSfunction",caller_name:e,error_message:y.message};f.alias_found?(a["show-alias-expression"]=!0,a.alias_expression=b(f.trimmed_code,c),a["show-code"]=!0,a.code=b(this.Aliases[f.alias_name].js+f.alias_trailer,c)):(a["show-code"]=!0,a.code=b(f.trimmed_code,
c));this.ShowError(a);return}d&&(this.returnValue=g);return g}},CallAlias:function(a,b,c,d){void 0===c&&(c=!0);void 0===d&&(d="'Call alias' action");a=this.ParseJS(a,!0,d);if(!a.error)return this.CallJSfunction(this.Aliases[a.alias_name].js+a.alias_trailer,b,c,d,a)},ShowError:function(a){var b="ValerypopoffJS plugin: Error in "+a.caller_name+"\n";b+="--------------------- \n";__DEBUG__&&(b+="DEBUG CALLER: "+a.debug_caller+"\n",b+="--------------------- \n");a["show-alias-expression"]&&(b+="Alias expression: "+
a.alias_expression+"\n",b+="--------------------- \n");a["show-code"]&&(b+="JS code: "+a.code+"\n",b+="--------------------- \n");b+=a.error_message;console.error(b)},Resolve:function(a,b,c,d,e){for(var f=window,g=f,h="",k=0,l=a.length;k<l;k++){h=a[k];if("object"==typeof h){h=this.Resolve(h,b,c,d,e);if(h.error)return{error:!0};h=h.end;try{g=g[h]}catch(A){return a={debug_caller:"Resolve",caller_name:b,error_message:A.message,"show-code":!0,code:c},d&&(a["show-alias-expression"]=!0,a.code=this.Aliases[d].js+
e,a.alias_expression=c),this.ShowError(a),{error:!0}}}else try{f==window?/^[$A-Z_][0-9A-Z_$]*$/i.test(h)?g=g[h]:("'"==h[0]&&(h=h.substring(1,h.length-1)),g=h):g=g[h]}catch(A){return a={debug_caller:"Resolve",caller_name:b,error_message:A.message,"show-code":!0,code:c},d&&(a["show-alias-expression"]=!0,a.code=this.Aliases[d].js+e,a.alias_expression=c),this.ShowError(a),{error:!0}}k<l-1&&(f=g)}return{error:!1,context:f,end:g,endname:h}},ParseJS:function(a,b,d){b=!1;var e=void 0,f=void 0;a=a.trim().replace(/\s*([\.\[\]])\s*/g,
"$1");var g=this.AliasDotpartsCache;if(g.Dotparts[a]){var h=g.Dotparts[a];g.IsAlias[a]&&(b=!0,e=g.AliasNames[a],f=g.AliasTrailers[a])}else{e=a.split(/[\.\[]/)[0];f=a.substring(e.length);this.Aliases[e]?(b=!0,h=f?c(this.Aliases[e].dotstring+f.split("[").join(".[")):c(this.Aliases[e].dotstring)):(f=e=void 0,h=c(a.split("[").join(".[")));if(g.count>=g.max_count)for(var k in g.Dotparts)if(delete g.Dotparts[k],g.IsAlias[k]&&(delete g.AliasNames[k],delete g.AliasTrailers[k],delete g.IsAlias[k]),g.count--,
g.count<=g.max_count)break;g.Dotparts[a]=h;b&&(g.AliasNames[a]=e,g.AliasTrailers[a]=f,g.IsAlias[a]=!0);g.count++}d=this.Resolve(h,d,a,e,f);return{error:d.error,end:d.end,endname:d.endname,context:d.context,trimmed_code:a,alias_found:b,alias_name:e,alias_trailer:f}}},n;for(n in l)e[n]=l[n];l={C2CompareFunctionReturnValue:function(a,b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareFunctionReturnValue.call(this,c,d,b,a)},C2CompareAliasCallReturnValue:function(a,
b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareAliasCallReturnValue.call(this,c,d,b,a)},C2CompareExecReturnWithParams:function(a,b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareExecReturnWithParams.call(this,c,d,b,a)},C2CompareValue:function(a,b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareValue.call(this,c,d,b,a)},CompareExecReturnWithParams:function(a,
b,c,e){var f=void 0;b.length&&(a=d(a,b));try{f=eval(a)}catch(u){this.ShowError({debug_caller:"CompareExecReturnWithParams",caller_name:"'Compare JS code Completion value' condition",error_message:u.message,"show-code":!0,code:a});return}"boolean"===typeof f&&(f=f?1:0);return cr.do_cmp(f,c,e)},CompareFunctionReturnValue:function(a,b,c,d){a=this.CallJSfunction(a,b,!1,"'Compare Function return value' condition");"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,c,d)},CompareStoredReturnValue:function(a,
b){var c=this.returnValue;"boolean"===typeof c&&(c=c?1:0);return cr.do_cmp(c,a,b)},AllScriptsLoaded:function(){return 0>=this.sciptsToLoad?!0:!1},CompareValue:function(a,b,c,d){a=this.Value("'Compare Value' condition",[].concat(a,b));"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,c,d)},CompareAliasValue:function(a,b,c){var d=this.ParseJS(a,!0,"'Set alias' action");if(!d.alias_found)b={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition",error_message:"No such alias '"+a+"'"},
this.ShowError(b);else if(!d.error)if((a=d.context[this.construct_compare_function_prefix+d.endname])&&"object"==typeof d.context)try{return a.call(d.context,b,c)}catch(v){b={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition","show-alias-expression":!0,alias_expression:d.trimmed_code,error_message:"Error in user defined '"+this.construct_compare_function_prefix+d.endname+"' function: "+v.message},this.ShowError(b)}else return d=d.end,"boolean"===typeof d&&(d=d?1:0),cr.do_cmp(d,
b,c)},CompareAliasCallReturnValue:function(a,b,c,d){a=this.CallAlias(a,b,!1,"'Compare Alias Call return value' condition");"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,c,d)}};for(n in l)a.prototype[n]=l[n];k.cnds=new a;l={ExecuteJSWithParams:function(a,b){this.returnValue=void 0;a=a.replace(/#[0-9]+/g,function(a){a=b[a.substr(1)];return"string"===typeof a?"'"+a+"'":a});try{this.returnValue=eval(a)}catch(m){this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:"'Execute JS code' action",
"show-code":!0,code:a,error_message:m.message})}},CallJSfunction:function(a,b,c,d,e){this.CallJSfunction(a,b,c,d,e)},SetValue:function(a,b){var c=this.ParseJS(a,!0,"'Set value' action");if(!c.error)try{c.context[c.endname]=b}catch(p){a+="=",this.ShowError({debug_caller:"SetValue",caller_name:"'Set value' action","show-alias-expression":c.alias_found,alias_expression:c.trimmed_code,"show-code":!0,code:"string"==typeof b?a+"'"+b+"'":a+b,error_message:p.message})}},Call:function(a,b,c,d){this.CallJSfunction(a,
b,!0,"'Call' action")},InitAlias:function(a,b){a=a.trim();b=b.trim();if(0==b.length)a={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Javascript string of alias '"+a+"' must not be empty."},this.ShowError(a);else if(0<=a.indexOf(".")||0<=a.indexOf("[")||0<=a.indexOf("]"))a={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Alias name must not contain '.', '[' or ']' signs: '"+a+"'"},this.ShowError(a);else if(void 0!=this.Aliases[a])a={debug_caller:"InitAlias",
caller_name:"'Init alias' action",error_message:"Alias '"+a+"' already exists"},this.ShowError(a);else{var c={};c.js=b;c.dotstring=b.split("[").join(".[");this.Aliases[a]=c}},SetAlias:function(a,b){var c=this.ParseJS(a,!0,"'Set alias' action");if(!c.alias_found)b={debug_caller:"SetAlias",caller_name:"'Set alias' action",error_message:"No such alias '"+c.trimmed_code+"'"},this.ShowError(b);else if(!c.error)try{c.context[c.endname]=b}catch(p){a+="=",b={debug_caller:"SetAlias",caller_name:"'Set alias' action",
"show-alias-expression":!0,alias_expression:c.trimmed_code,"show-code":!0,code:"string"==typeof b?a+"'"+b+"'":a+b,error_message:p.message},this.ShowError(b)}},CallAlias:function(a,b,c,d){this.CallAlias(a,b,c,d)}};for(n in l)f.prototype[n]=l[n];k.acts=new f;l={JSCodeValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+
1];a.pop()}c=a[0];a.splice(0,1);a.length&&(c=d(c,a));a=void 0;try{a=eval(c)}catch(p){this.ShowError({debug_caller:"JSCodeValue",caller_name:"'JSCodeValue' expression","show-code":!0,code:c,error_message:p.message});b.set_any(void 0);return}if("boolean"==typeof a){if(b.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(b.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},StoredReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},
set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}if("boolean"===typeof this.returnValue){if(b.set_any(this.returnValue?1:0),__CONSTRUCT3_RUNTIME3__)return this.returnValue?1:0}else if(b.set_any(this.returnValue),__CONSTRUCT3_RUNTIME3__)return this.returnValue},FunctionReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},
set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}c=a[0];var d=this.ParseJS(c,!1,"'FunctionReturnValue' expression");a.splice(0,1);if(d.error)b.set_any(void 0);else{var e=void 0;e=this.CallJSfunction(c,a,!1,"'FunctionReturnValue' expression",d);if("boolean"===typeof e){if(b.set_any(e?1:0),__CONSTRUCT3_RUNTIME3__)return e?1:0}else if(b.set_any(e),__CONSTRUCT3_RUNTIME3__)return e}},Value:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b=
{set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}a=this.Value("'Value' expression",a);if("boolean"===typeof a){if(b.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(b.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},AliasValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};
else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}a=this.ParseJS(a[0],!0,"'AliasValue' expression");if(a.alias_found)if(a.error)b.set_any(void 0);else{c=void 0;try{c=a.end}catch(p){a={debug_caller:"AliasValue",caller_name:"'AliasValue' expression","show-alias-expression":!0,alias_expression:a.trimmed_code,error_message:p.message};this.ShowError(a);b.set_any(void 0);return}if("boolean"===typeof c){if(b.set_any(c?1:0),__CONSTRUCT3_RUNTIME3__)return c?1:0}else if(b.set_any(c),__CONSTRUCT3_RUNTIME3__)return c}else a=
{debug_caller:"AliasValue",caller_name:"'AliasValue' expression",error_message:"No such alias '"+a.trimmed_code+"'"},this.ShowError(a),b.set_any(void 0)},AliasCallReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}c=a[0];var d=this.ParseJS(c,!0,"'AliasCallValue' expression");a.splice(0,1);if(d.alias_found)if(d.error)b.set_any(void 0);
else{var e=void 0;e=this.CallJSfunction(c,a,!1,"'AliasCallValue' expression",d);if("boolean"===typeof e){if(b.set_any(e?1:0),__CONSTRUCT3_RUNTIME3__)return e?1:0}else if(b.set_any(e),__CONSTRUCT3_RUNTIME3__)return e}else this.ShowError({debug_caller:"AliasCallValue",caller_name:"'AliasCallValue' expression",error_message:"No such alias '"+d.trimmed_code+"'"}),b.set_any(void 0)}};for(n in l)g.prototype[n]=l[n];k.exps=new g;e.EXPS=k.exps;e.CNDS=k.cnds;e.ACTS=k.acts})();
function flood_fill(a,f,g,k,e,c){function d(b){return p==a[b]&&v==a[b+1]&&u==a[b+2]}function b(b){a[b]=n;a[b+1]=q;a[b+2]=h;a[b+3]=255}function l(a){d(m+4*a)?z[a]||(y.push([k+a,e]),z[a]=!0):z[a]&&(z[a]=!1)}if(!(0>k||k>f||0>e||e>g)){c=$("<div></div>").css("background-color",c).css("background-color");"transparent"==c&&(c="rgb(0,0,0)");c=c.slice(4,-1).split(",");var n=c[0],q=c[1],h=c[2],m=4*(e*f+k),p=a[m],v=a[m+1],u=a[m+2];if(n!=p||q!=v||h!=u)for(var y=[[k,e]];y.length;){c=y.pop();k=c[0];e=c[1];for(m=
4*(e*f+k);0<=e--&&d(m);)m-=4*f;m+=4*f;++e;var z=[];z[-1]=!1;for(z[1]=!1;e++<g-1&&d(m);)b(m),0<k&&l(-1),k<f-1&&l(1),m+=4*f}}}cr.plugins_.c2canvas=function(a){this.runtime=a};
(function(){var a=cr.plugins_.c2canvas.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.wait_for_textures.push(this.texture_img))};a.Instance=function(a){this.type=a;this.runtime=a.runtime};var f=a.Instance.prototype,g="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");
f.effectToCompositeOp=function(a){return 0>=a||11<=a?"source-over":g[a-1]};f.updateBlend=function(a){var e=this.runtime.gl;if(e)switch(this.srcBlend=e.ONE,this.destBlend=e.ONE_MINUS_SRC_ALPHA,a){case 1:this.destBlend=this.srcBlend=e.ONE;break;case 3:this.srcBlend=e.ONE;this.destBlend=e.ZERO;break;case 4:this.srcBlend=e.ONE_MINUS_DST_ALPHA;this.destBlend=e.ONE;break;case 5:this.srcBlend=e.DST_ALPHA;this.destBlend=e.ZERO;break;case 6:this.srcBlend=e.ZERO;this.destBlend=e.SRC_ALPHA;break;case 7:this.srcBlend=
e.ONE_MINUS_DST_ALPHA;this.destBlend=e.ZERO;break;case 8:this.srcBlend=e.ZERO;this.destBlend=e.ONE_MINUS_SRC_ALPHA;break;case 9:this.srcBlend=e.DST_ALPHA;this.destBlend=e.ONE_MINUS_SRC_ALPHA;break;case 10:this.srcBlend=e.ONE_MINUS_DST_ALPHA,this.destBlend=e.SRC_ALPHA}};f.onCreate=function(){this.visible=0===this.properties[0];this.compositeOp=this.effectToCompositeOp(this.properties[1]);this.updateBlend(this.properties[1]);this.canvas=document.createElement("canvas");this.canvas.width=this.width;
this.canvas.height=this.height;this.ctx=this.canvas.getContext("2d");this.ctx.drawImage(this.type.texture_img,0,0,this.width,this.height);this.tCanvas=document.createElement("canvas");this.tCtx=this.tCanvas.getContext("2d");this.update_tex=!0;this.rcTex=new cr.rect(0,0,0,0)};f.onDestroy=function(){};f.saveToJSON=function(){return{canvas_w:this.canvas.width,canvas_h:this.canvas.height,image:this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data}};f.loadFromJSON=function(a){for(var e=
this.canvas.width=a.canvas_w,c=this.canvas.height=a.canvas_h,d=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data,b=0;b<c;++b)for(var f=0;f<e;++f)for(var g=4*(b*e+f),k=0;4>k;++k)d[g+k]=a.image[g+k]};f.draw_instances=function(a,e){for(var c in a)if(0!=a[c].visible||0!=this.runtime.testOverlap(this,a[c]))e.save(),e.scale(this.canvas.width/this.width,this.canvas.height/this.height),e.rotate(-this.angle),e.translate(-this.bquad.tlx,-this.bquad.tly),e.globalCompositeOperation=a[c].compositeOp,
void 0!==a[c].type.pattern&&void 0!==a[c].type.texture_img&&(a[c].pattern=e.createPattern(a[c].type.texture_img,"repeat")),a[c].draw(e),e.restore()};f.draw=function(a){a.save();a.globalAlpha=this.opacity;a.globalCompositeOperation=this.compositeOp;var e=this.x,c=this.y;this.runtime.pixel_rounding&&(e=Math.round(e),c=Math.round(c));a.translate(e,c);a.rotate(this.angle);a.drawImage(this.canvas,-(this.hotspotX*this.width),-(this.hotspotY*this.height),this.width,this.height);a.restore()};f.drawGL=function(a){a.setBlend(this.srcBlend,
this.destBlend);this.update_tex&&(this.tex&&a.deleteTexture(this.tex),this.tex=a.loadTexture(this.canvas,!1,this.runtime.linearSampling),this.update_tex=!1);a.setTexture(this.tex);a.setOpacity(this.opacity);var e=this.bquad;if(this.runtime.pixel_rounding){var c=Math.round(this.x)-this.x,d=Math.round(this.y)-this.y;a.quad(e.tlx+c,e.tly+d,e.trx+c,e.try_+d,e.brx+c,e.bry+d,e.blx+c,e.bly+d)}else a.quad(e.tlx,e.tly,e.trx,e.try_,e.brx,e.bry,e.blx,e.bly)};a.cnds={};a.acts={};f=a.acts;f.SetEffect=function(a){this.compositeOp=
this.effectToCompositeOp(a);this.update_tex=this.runtime.redraw=!0};f.DrawPoint=function(a,e,c){var d=this.ctx;d.fillStyle=c;d.fillRect(a,e,1,1);this.update_tex=this.runtime.redraw=!0};f.ResizeCanvas=function(a,e){this.canvas.width=a;this.canvas.height=e;this.update_tex=this.runtime.redraw=!0};f.PasteObject=function(a){var e=this.ctx;this.update_bbox();a=a.getCurrentSol();this.draw_instances(a.select_all?a.type.instances:a.instances,e);this.update_tex=this.runtime.redraw=!0};f.PasteLayer=function(a){if(!a||
!a.visible)return!1;var e=this.ctx;this.update_bbox();this.tCanvas.width=this.canvas.width;this.tCanvas.height=this.canvas.height;var c=this.tCtx;c.clearRect(0,0,this.tCanvas.width,this.tCanvas.height);this.draw_instances(a.instances,c);e.drawImage(this.tCanvas,0,0,this.width,this.height);this.update_tex=this.runtime.redraw=!0};f.DrawBox=function(a,e,c,d,b){this.ctx.fillStyle=b;this.ctx.fillRect(a,e,c,d);this.update_tex=this.runtime.redraw=!0};f.DrawLine=function(a,e,c,d,b,f){var g=this.ctx;g.strokeStyle=
b;g.lineWidth=f;g.beginPath();g.moveTo(a,e);g.lineTo(c,d);g.stroke();this.update_tex=this.runtime.redraw=!0};f.ClearCanvas=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.update_tex=this.runtime.redraw=!0};f.FillColor=function(a){this.ctx.fillStyle=a;this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.update_tex=this.runtime.redraw=!0};f.fillGradient=function(a,e,c){var d=this.ctx,b=this.canvas.width,f=this.canvas.height;switch(a){case 0:var g=d.createLinearGradient(0,
0,b,0);break;case 1:g=d.createLinearGradient(0,0,0,f);break;case 2:g=d.createLinearGradient(0,0,b,f);break;case 3:g=d.createLinearGradient(b,0,0,f);break;case 4:g=d.createRadialGradient(b/2,f/2,0,b/2,f/2,Math.sqrt(b*b+f*f)/2)}try{g.addColorStop(0,e)}catch(q){g.addColorStop(0,"black")}try{g.addColorStop(1,c)}catch(q){g.addColorStop(1,"black")}this.ctx.fillStyle=g;this.ctx.fillRect(0,0,b,f);this.update_tex=this.runtime.redraw=!0};f.beginPath=function(){this.ctx.beginPath()};f.drawPath=function(a,e){var c=
this.ctx;c.strokeStyle=a;c.lineWidth=e;c.stroke();this.update_tex=this.runtime.redraw=!0};f.setLineSettings=function(a,e){var c=this.ctx;c.lineCap=["butt","round","square"][a];c.lineJoin=["round","bevel","milet"][e]};f.fillPath=function(a){this.ctx.fillStyle=a;this.ctx.fill();this.update_tex=this.runtime.redraw=!0};f.moveTo=function(a,e){this.ctx.moveTo(a,e)};f.lineTo=function(a,e){this.ctx.lineTo(a,e)};f.arc=function(a,e,c,d,b,f){this.ctx.arc(a,e,c,cr.to_radians(d),cr.to_radians(b),1==f)};f.drawCircle=
function(a,e,c,d,b){var f=this.ctx;f.strokeStyle=d;f.lineWidth=b;f.beginPath();f.arc(a,e,c,0,cr.to_radians(360),!0);f.stroke();this.update_tex=this.runtime.redraw=!0};f.bezierCurveTo=function(a,e,c,d,b,f){this.ctx.bezierCurveTo(a,e,c,d,b,f)};f.quadraticCurveTo=function(a,e,c,d){this.ctx.quadraticCurveTo(a,e,c,d)};f.rectPath=function(a,e,c,d){this.ctx.rect(a,e,c,d)};f.FloodFill=function(a,e,c){var d=this.ctx,b=d.getImageData(0,0,this.canvas.width,this.canvas.height);flood_fill(b.data,this.canvas.width,
this.canvas.height,a,e,c);d.putImageData(b,0,0);this.update_tex=this.runtime.redraw=!0};f.setLineDash=function(a,e){this.ctx.setLineDash([a,e])};a.exps={};a=a.exps;a.rgbaAt=function(a,e,c){e=this.ctx.getImageData(e,c,1,1).data;a.set_string("rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]/255+")")};a.redAt=function(a,e,c){e=this.ctx.getImageData(e,c,1,1).data;a.set_int(e[0])};a.greenAt=function(a,e,c){e=this.ctx.getImageData(e,c,1,1).data;a.set_int(e[1])};a.blueAt=function(a,e,c){e=this.ctx.getImageData(e,
c,1,1).data;a.set_int(e[2])};a.alphaAt=function(a,e,c){e=this.ctx.getImageData(e,c,1,1).data;a.set_int(100*e[3]/255)};a.imageUrl=function(a){a.set_string(this.canvas.toDataURL())};a.AsJSON=function(a){a.set_string(JSON.stringify({c2array:!0,size:[1,1,this.canvas.width*this.canvas.height*4],data:[[this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data]]}))}})();cr.plugins_.filechooser=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}function k(a,c){if(!a)return null;c=Math.floor(c);return 0>c||c>=a.length?null:a[c]}var e=cr.plugins_.filechooser.prototype;e.Type=function(a){this.plugin=a;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a){this.type=a;this.runtime=a.runtime};var c=e.Instance.prototype,d=window.URL||window.webkitURL||window.mozURL||window.msURL;c.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] File Chooser plugin not supported on this platform - the object will not be created");
else{this.elem=document.createElement("input");this.elem.type="file";this.elem.setAttribute("accept",this.properties[0]);0!==this.properties[1]&&this.elem.setAttribute("multiple","");this.elem.id=this.properties[3];jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.element_hidden=!1;0===this.properties[2]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var a=this;this.elem.onchange=function(){a.runtime.trigger(cr.plugins_.filechooser.prototype.cnds.OnChanged,
a)};this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)}};c.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};c.tick=function(){this.updatePosition()};c.updatePosition=function(a){if(!this.runtime.isDomFree){var b=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||b>=f||c>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>b&&(b=1),1>c&&(c=1),d>=f&&(d=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==b||this.lastTop!==c||this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||
this.lastWinHeight!==g?(this.lastLeft=b,this.lastTop=c,this.lastRight=d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(b)+jQuery(this.runtime.canvas).offset().left,f=Math.round(c)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-b)),jQuery(this.elem).height(Math.round(e-c))):this.element_hidden&&
(jQuery(this.elem).show(),this.element_hidden=!1))}};c.draw=function(a){};c.drawGL=function(a){};a.prototype.OnChanged=function(){return!0};e.cnds=new a;f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetCSSStyle=function(a,c){this.runtime.isDomFree||jQuery(this.elem).css(a,c)};f.prototype.ReleaseFile=function(a){!this.runtime.isDomFree&&d&&d.revokeObjectURL&&d.revokeObjectURL(a)};e.acts=new f;g.prototype.FileCount=function(a){a.set_int(this.runtime.isDomFree?
0:this.elem.files.length||0)};g.prototype.FileNameAt=function(a,c){c=this.runtime.isDomFree?null:k(this.elem.files,c);a.set_string(c?c.name||"":"")};g.prototype.FileSizeAt=function(a,c){c=this.runtime.isDomFree?null:k(this.elem.files,c);a.set_int(c?c.size||0:0)};g.prototype.FileTypeAt=function(a,c){c=this.runtime.isDomFree?null:k(this.elem.files,c);a.set_string(c?c.type||"":"")};g.prototype.FileURLAt=function(a,c){(c=this.runtime.isDomFree?null:k(this.elem.files,c))?c.c2url?a.set_string(c.c2url):
d&&d.createObjectURL?(c.c2url=d.createObjectURL(c),a.set_string(c.c2url)):a.set_string(""):a.set_string("")};e.exps=new g})();cr.plugins_.pix_dialogs=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.pix_dialogs.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){self=this;self.currID;self.getValue};e.onDestroy=function(){};e.saveToJSON=function(){return{}};e.loadFromJSON=function(a){};e.draw=function(a){};e.drawGL=function(a){};a.prototype.dialogConfirmed=function(a){return self.currID==
a?!0:!1};a.prototype.dialogCancelled=function(a){return self.currID==a?!0:!1};k.cnds=new a;f.prototype.openDialog=function(a,d,b,e){self.currID=d;var c;0==a?c=confirm(b):1==a?c=prompt(b,e):2==a&&alert(b);0==a&&1==c?self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self):2==a?self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self):null!==c&&!1!==c?(self.getValue=c,self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self)):
self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogCancelled,self)};k.acts=new f;g.prototype.getValue=function(a){a.set_any(self.getValue)};k.exps=new g})();cr.plugins_.progressbar=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.progressbar.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Progress Bar plugin not supported on this platform - the object will not be created"):(this.elem=document.createElement("progress"),this.value=this.properties[0],
this.max=this.properties[1],0<this.max&&0<=this.value&&(this.elem.max=this.max,this.elem.value=this.value),this.elem.id=this.properties[4],this.elem.title=this.properties[2],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.elem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.progressbar.prototype.cnds.OnClicked,
a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchend",function(a){a.stopPropagation()},!1),jQuery(this.elem).mousedown(function(a){a.stopPropagation()}),jQuery(this.elem).mouseup(function(a){a.stopPropagation()}),this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0,this.updatePosition(!0),
this.runtime.tickMe(this))};e.saveToJSON=function(){return{v:this.elem.value,m:this.elem.max}};e.loadFromJSON=function(a){this.elem.value=a.v;this.elem.max=a.m};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),b=this.layer.layerToCanvas(this.x,this.y,!1),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!0),f=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),g=this.runtime.width/this.runtime.devicePixelRatio,h=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=e||0>=f||c>=g||b>=h?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>c&&(c=1),1>b&&(b=1),e>=g&&(e=g-1),f>=h&&(f=h-1),g=window.innerWidth,h=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==b||this.lastRight!==e||this.lastBottom!==f||this.lastWinWidth!==g||
this.lastWinHeight!==h?(this.lastLeft=c,this.lastTop=b,this.lastRight=e,this.lastBottom=f,this.lastWinWidth=g,this.lastWinHeight=h,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,g=Math.round(b)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:g}),jQuery(this.elem).width(Math.round(e-c)),jQuery(this.elem).height(Math.round(f-b))):this.element_hidden&&
(jQuery(this.elem).show(),this.element_hidden=!1))}};e.draw=function(a){};e.drawGL=function(a){};a.prototype.OnClicked=function(){return!0};a.prototype.CompareProgress=function(a,d){return this.isDomFree?!1:cr.do_cmp(this.elem.value,a,d)};k.cnds=new a;f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetCSSStyle=function(a,d){this.runtime.isDomFree||jQuery(this.elem).css(a,d)};
f.prototype.SetProgress=function(a){this.runtime.isDomFree||(this.value=a,this.elem.max=this.max,this.elem.value=this.value)};f.prototype.SetMaximum=function(a){this.runtime.isDomFree||(this.max=a,this.elem.max=this.max,this.elem.value=this.value)};f.prototype.SetIndeterminate=function(){this.runtime.isDomFree||(this.elem.removeAttribute("value"),this.elem.removeAttribute("max"))};k.acts=new f;g.prototype.Progress=function(a){a.set_float(this.runtime.isDomFree?0:this.elem.value)};g.prototype.Maximum=
function(a){a.set_float(this.runtime.isDomFree?0:this.elem.max)};k.exps=new g})();cr.plugins_.rex_TouchWrap=function(a){this.runtime=a};
(function(){function a(a){q=a.x;h=a.y;m=a.z}function f(a,b,c,d){var e=p.length?p.pop():new k;e.init(a,b,c,d);return e}function g(a){100>p.length&&p.push(a)}function k(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function e(){}function c(){}function d(){}var b=cr.plugins_.rex_TouchWrap.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};b.Type.prototype.onCreate=
function(){};b.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.touchDown=this.mouseDown=!1;this.check_name="TOUCHWRAP";this.cursor={x:null,y:null};this._callbackObjs=[];this.fake_ret={value:0,set_any:function(a){this.value=a},set_int:function(a){this.value=a},set_float:function(a){this.value=a}}};var l=b.Instance.prototype,n={left:0,top:0};l.findTouch=function(a){var b;var c=0;for(b=this.touches.length;c<b;c++)if(this.touches[c].id===a)return c;return-1};var q=0,h=0,m=
0,p=[];k.prototype.init=function(a,b,c,d){var e=cr.performance_now();this.starttime=this.lasttime=this.time=e;this.startx=a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=c;this.startindex=d;this.tooFarForHold=this.triggeredHold=!1};k.prototype.update=function(a,b,c,d,e,f){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=c;this.width=d;this.height=e;this.pressure=f;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,
this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};k.prototype.maybeTriggerHold=function(a,b){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnHoldGestureObject,
a),a.getTouchIndex=0)};var v=-1E3,u=-1E3,y=-1E4;k.prototype.maybeTriggerTap=function(a,b){if(!this.triggeredHold){var c=cr.performance_now();333>=c-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=c-y&&25>cr.distanceTo(v,u,this.x,this.y)?(a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnDoubleTapGestureObject,
a),u=v=-1E3,y=-1E4):(a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTapGestureObject,a),v=this.x,u=this.y,y=c),a.getTouchIndex=0)}};l.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=
this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=0!==this.properties[0];var b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,c=document;this.runtime.isDirectCanvas?c=b=window.Canvas:this.runtime.isCocoonJs&&(c=b=window);var d=this;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),b.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),c.addEventListener("pointerup",function(a){d.onPointerEnd(a,
!1)},!1),c.addEventListener("pointercancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",
function(a){d.onPointerStart(a)},!1),b.addEventListener("MSPointerMove",function(a){d.onPointerMove(a)},!1),c.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("MSPointerCancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(b.addEventListener("touchstart",function(a){d.onTouchStart(a)},
!1),b.addEventListener("touchmove",function(a){d.onTouchMove(a)},!1),c.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),c.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},f=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},g=Windows.Devices.Sensors.Accelerometer.getDefault();g&&(g.reportInterval=
Math.max(g.minimumReportInterval,16),g.addEventListener("readingchanged",e));var h=Windows.Devices.Sensors.Inclinometer.getDefault();h&&(h.reportInterval=Math.max(h.minimumReportInterval,16),h.addEventListener("readingchanged",f));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(g&&g.removeEventListener("readingchanged",e),h&&h.removeEventListener("readingchanged",f)):(g&&g.addEventListener("readingchanged",e),h&&h.addEventListener("readingchanged",f))},
!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&
(document.addEventListener("mousemove",function(a){d.onMouseMove(a)}),document.addEventListener("mousedown",function(a){d.onMouseDown(a)}),document.addEventListener("mouseup",function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this);this.enable=1==this.properties[1];this.lastTouchY=this.lastTouchX=null};l.getCanvasOffset=function(){this.runtime.isDomFree||
(n.left=this.runtime.canvas.offsetLeft,n.top=this.runtime.canvas.offsetTop);return n};l.onPointerMove=function(a){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),c=cr.performance_now(),d=this._callbackObjs.length;if(0<=b){var e=this.getCanvasOffset();b=this.touches[b];if(!(2>c-b.time))for(b.update(c,a.pageX-e.left,a.pageY-e.top,a.width||0,a.height||0,a.pressure||0),c=a.pageX-e.left,e=a.pageY-e.top,
a=0;a<d;a++)this._callbackObjs[a].OnTouchMove&&this._callbackObjs[a].OnTouchMove(b.identifier,c,e)}}};l.onPointerStart=function(a){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.getCanvasOffset(),c=a.pageX-b.left;b=a.pageY-b.top;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(f(c,b,a.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=
!0;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchStart,this);this.curTouchX=c;this.curTouchY=b;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchObject,this);c=this._callbackObjs.length;for(a=0;a<c;a++)this._callbackObjs[a].OnTouchStart&&this._callbackObjs[a].OnTouchStart(this.trigger_id,this.curTouchX,this.curTouchY);this.runtime.isInUserInputEvent=!1}};l.onPointerEnd=function(a,
b){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();a=this.findTouch(a.pointerId);this.trigger_index=0<=a?this.touches[a].startindex:-1;this.trigger_id=0<=a?this.touches[a].id:-1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchEnd,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchEnd,this);0<=a&&(this.lastTouchX=this.touches[a].x,
this.lastTouchY=this.touches[a].y,this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchReleasedObject,this));var c=this._callbackObjs.length,d;for(d=0;d<c;d++)this._callbackObjs[d].OnTouchEnd&&this._callbackObjs[d].OnTouchEnd(this.trigger_id);0<=a&&(b||this.touches[a].maybeTriggerTap(this,a),g(this.touches[a]),this.touches.splice(a,1));this.runtime.isInUserInputEvent=!1}};l.onTouchMove=function(a){if(this.enable){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),c,d=
this._callbackObjs.length;var e=0;for(c=a.changedTouches.length;e<c;e++){var f=a.changedTouches[e];var g=this.findTouch(f.identifier);if(0<=g){var h=this.getCanvasOffset();g=this.touches[g];if(!(2>b-g.time)){g.update(b,f.pageX-h.left,f.pageY-h.top,2*(f.radiusX||f.webkitRadiusX||f.mozRadiusX||f.msRadiusX||0),2*(f.radiusY||f.webkitRadiusY||f.mozRadiusY||f.msRadiusY||0),f.force||f.webkitForce||f.mozForce||f.msForce||0);g=f.pageX-h.left;var k=f.pageY-h.top;for(h=0;h<d;h++)this._callbackObjs[h].OnTouchMove&&
this._callbackObjs[h].OnTouchMove(f.identifier,g,k)}}}}};l.onTouchStart=function(a){if(this.enable){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.getCanvasOffset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var c,d=this._callbackObjs.length;var e=0;for(c=a.changedTouches.length;e<c;e++){var g=a.changedTouches[e];var h=this.findTouch(g.identifier);if(-1===h){h=g.pageX-b.left;var k=g.pageY-b.top;this.trigger_index=this.touches.length;this.trigger_id=g.identifier;
this.touches.push(f(h,k,g.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchStart,this);this.curTouchX=h;this.curTouchY=k;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchObject,this);for(g=0;g<d;g++)this._callbackObjs[g].OnTouchStart&&this._callbackObjs[g].OnTouchStart(this.trigger_id,this.curTouchX,this.curTouchY)}}this.runtime.isInUserInputEvent=
!1}};l.onTouchEnd=function(a,b){if(this.enable){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();this.runtime.isInUserInputEvent=!0;var c,d=this._callbackObjs.length,e;var f=0;for(c=a.changedTouches.length;f<c;f++){var h=a.changedTouches[f];h=this.findTouch(h.identifier);if(0<=h){this.trigger_index=this.touches[h].startindex;this.trigger_id=this.touches[h].id;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchEnd,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchEnd,
this);this.lastTouchX=this.touches[h].x;this.lastTouchY=this.touches[h].y;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchReleasedObject,this);for(e=0;e<d;e++)this._callbackObjs[e].OnTouchEnd&&this._callbackObjs[e].OnTouchEnd(this.trigger_id);b||this.touches[h].maybeTriggerTap(this,h);g(this.touches[h]);this.touches.splice(h,1)}}this.runtime.isInUserInputEvent=!1}};l.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==m?90*m:this.orient_alpha};l.getBeta=
function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==h?90*h:this.orient_beta};l.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==q?90*q:this.orient_gamma};l.updateCursor=function(a){var b=this.getCanvasOffset();this.cursor.x=a.pageX-b.left;this.cursor.y=a.pageY-b.top};l.onMouseDown=function(a){if(this.enable){this.updateCursor(a);this.mouseDown=!0;a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();var b=this.findTouch(0);
-1!==b&&(g(this.touches[b]),cr.arrayRemove(this.touches,b));this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})}};l.onMouseMove=function(a){if(this.enable&&(this.updateCursor(a),this.mouseDown))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};l.onMouseUp=function(a){this.enable&&(this.updateCursor(a),this.mouseDown=!1,a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault(),this.runtime.had_a_click=!0,this.onTouchEnd({changedTouches:[{pageX:a.pageX,
pageY:a.pageY,identifier:0}]}))};l.tick2=function(){if(this.enable){var a,b=cr.performance_now();var c=0;for(a=this.touches.length;c<a;++c){var d=this.touches[c];d.time<=b-50&&(d.lasttime=b);d.maybeTriggerHold(this,c)}this.lastTouchY=this.lastTouchX=null}};e.prototype.OnTouchStart=function(){return!0};e.prototype.OnTouchEnd=function(){return!0};e.prototype.IsInTouch=function(){return this.IsInTouch()};e.prototype.OnTouchObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,
this.curTouchY,!1):!1};var z=[];e.prototype.IsTouchingObject=function(a){if(this.IsInTouch()){if(!a)return!1;var b=a.getCurrentSol(),c=b.getObjects(),d,e;var f=0;for(d=c.length;f<d;f++){var g=c[f];g.update_bbox();var h=0;for(e=this.touches.length;h<e;h++){var k=this.touches[h];var l=g.layer.canvasToLayer(k.x,k.y,!0);k=g.layer.canvasToLayer(k.x,k.y,!1);if(g.contains_pt(l,k)){z.push(g);break}}}return z.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,z),a.applySolToContainer(),cr.clearArray(z),
!0):!1}};e.prototype.CompareTouchSpeed=function(a,b,c){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var d=this.touches[a];a=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;var e=0;0<d&&(e=a/d);return cr.do_cmp(e,b,c)};e.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};e.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};e.prototype.CompareOrientation=function(a,b,c){a=0===a?this.getAlpha():
1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,c)};e.prototype.CompareAcceleration=function(a,b,c){var d=0;0===a?d=this.acc_g_x:1===a?d=this.acc_g_y:2===a?d=this.acc_g_z:3===a?d=this.acc_x:4===a?d=this.acc_y:5===a&&(d=this.acc_z);return cr.do_cmp(d,b,c)};e.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.OnNthTouchEnd=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.HasNthTouch=function(a){a=Math.floor(a);return this.touches.length>=
a+1};e.prototype.OnHoldGesture=function(){return!0};e.prototype.OnTapGesture=function(){return!0};e.prototype.OnDoubleTapGesture=function(){return!0};e.prototype.OnHoldGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnDoubleTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,
this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnTouchReleasedObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.lastTouchX,this.lastTouchY,!1):!1};b.cnds=new e;b.acts=new c;c.prototype.SetEnable=function(a){this.enable=1==a};d.prototype.TouchCount=function(a){a.set_int(this.touches.length)};d.prototype.X=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;
var e=b.zoomRate;var f=b.parallaxX;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0));b.scale=d;b.zoomRate=e;b.parallaxX=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0)):a.set_float(0)};d.prototype.XAt=function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=
this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0)):a.set_float(0)};d.prototype.XForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);
else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!0)):a.set_float(0)};d.prototype.Y=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);
else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxY;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1));b.scale=d;b.zoomRate=e;b.parallaxY=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1)):a.set_float(0)};d.prototype.YAt=function(a,b,c){b=Math.floor(b);
if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};
d.prototype.YForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};
d.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};d.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};d.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};d.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):a.set_float(0)};d.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||
b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};d.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};d.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0===c?a.set_float(0):a.set_float(b/c)}};d.prototype.SpeedForID=function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var c=
this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0===c?a.set_float(0):a.set_float(b/c)}};d.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};d.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};d.prototype.Alpha=function(a){a.set_float(this.getAlpha())};
d.prototype.Beta=function(a){a.set_float(this.getBeta())};d.prototype.Gamma=function(a){a.set_float(this.getGamma())};d.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};d.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};d.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};d.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};d.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};d.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};
d.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};d.prototype.TouchID=function(a){a.set_float(this.trigger_id)};d.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};d.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};d.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};b.exps=new d;l.HookMe=function(a){this._callbackObjs.push(a)};
l.UnHookMe=function(a){cr.arrayFindRemove(this._callbackObjs,a)};l.IsInTouch=function(){return 0<this.touches.length};var x=cr.plugins_.rex_TouchWrap.prototype.exps;l.TouchCount=function(){x.TouchCount.call(this,this.fake_ret);return this.fake_ret.value};l.X=function(a){x.X.call(this,this.fake_ret,a);return this.fake_ret.value};l.XAt=function(a,b){x.XAt.call(this,this.fake_ret,a,b);return this.fake_ret.value};l.XForID=function(a,b){x.XForID.call(this,this.fake_ret,a,b);return this.fake_ret.value};
l.Y=function(a){x.Y.call(this,this.fake_ret,a);return this.fake_ret.value};l.YAt=function(a,b){x.YAt.call(this,this.fake_ret,a,b);return this.fake_ret.value};l.YForID=function(a,b){x.YForID.call(this,this.fake_ret,a,b);return this.fake_ret.value};l.AbsoluteX=function(){x.AbsoluteX.call(this,this.fake_ret);return this.fake_ret.value};l.AbsoluteXAt=function(a){x.AbsoluteXAt.call(this,this.fake_ret,a);return this.fake_ret.value};l.AbsoluteXForID=function(a){x.AbsoluteXForID.call(this,this.fake_ret,a);
return this.fake_ret.value};l.AbsoluteY=function(){x.AbsoluteY.call(this,this.fake_ret);return this.fake_ret.value};l.AbsoluteYAt=function(a){x.AbsoluteYAt.call(this,this.fake_ret,a);return this.fake_ret.value};l.AbsoluteYForID=function(a){x.AbsoluteYForID.call(this,this.fake_ret,a);return this.fake_ret.value};l.CursorX=function(a){if(null==this.cursor.x)return null;if(cr.is_undefined(a)){var b=this.runtime.getLayerByNumber(0);var c=b.scale;var d=b.zoomRate;var e=b.parallaxX;var f=b.angle;b.scale=
1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a=b.canvasToLayer(this.cursor.x,this.cursor.y,!0);b.scale=c;b.zoomRate=d;b.parallaxX=e;b.angle=f}else a=(b=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.canvasToLayer(this.cursor.x,this.cursor.y,!0):0;return a};l.CursorY=function(a){if(null==this.cursor.y)return null;if(cr.is_undefined(a)){var b=this.runtime.getLayerByNumber(0);var c=b.scale;var d=b.zoomRate;var e=b.parallaxX;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=
1;b.angle=0;a=b.canvasToLayer(this.cursor.x,this.cursor.y,!1);b.scale=c;b.zoomRate=d;b.parallaxX=e;b.angle=f}else a=(b=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.canvasToLayer(this.cursor.x,this.cursor.y,!1):0;return a};l.CursorAbsoluteX=function(){return this.cursor.x};l.CursorAbsoluteY=function(){return this.cursor.y}})();cr.plugins_.rex_bbcodeText=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.rex_bbcodeText.prototype;k.onCreate=function(){k.acts.SetWidth=function(a){this.width!==a&&(this.width=a,this.set_bbox_changed(),this.isCanvasSizeLocked||this.render_text(this.is_force_render))}};k.Type=function(a){this.plugin=a;this.runtime=a.runtime};var e=k.Type.prototype;e.onCreate=function(){};e.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.mycanvas=
null;c.myctx=null;c.mytex=null}}};k.Instance=function(a){this.type=a;this.runtime=a.runtime;this.text_changed=!0};e=k.Instance.prototype;var c={},d=["miter","round","bevel"];e.onCreate=function(){this.text="";this.set_text(this.properties[0]);this.visible=0===this.properties[1];this.font=this.properties[2];this.color=this.properties[3];this.halign=this.properties[4];this.valign=this.properties[5];this.textShadow="";this.wrapbyword=0===this.properties[7];this.lastwrapwidth=this.lastwidth=this.width;
this.lastheight=this.height;this.line_height_offset=this.properties[8];this.baseLine_mode=this.properties[9];this.vshift=this.properties[10];this.is_force_render=1===this.properties[11];this.LockCanvasSize(1===this.properties[12],this.width,this.height);this.fontstyle=this.facename="";this.textHeight=this.textWidth=this.ptSize=0;this.parseFont();this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=
new cr.rect(0,0,1,1);this.runtime.glwrap&&this.runtime.tickMe(this);this._tag=null;this.recycled||(this.canvas_text=new l);this.canvas_text.Reset(this);this.canvas_text.textBaseline=0===this.baseLine_mode?"alphabetic":"top";this.canvas_text.stroke.lineWidth=this.properties[13];this.canvas_text.stroke.lineJoin=d[this.properties[14]];this.canvas_text.underline.thickness=this.properties[15];this.canvas_text.underline.offset=this.properties[16];this.setShadow(this.properties[17],this.properties[18],this.properties[19],
this.properties[20]);this.canvas_text.backgroundColor=this.properties[21];this.text&&this.render_text(this.is_force_render)};e.parseFont=function(){var a=this.font.split(" "),b;for(b=0;b<a.length;b++)if("pt"===a[b].substr(a[b].length-2,2)){this.ptSize=parseInt(a[b].substr(0,a[b].length-2));this.pxHeight=Math.ceil(this.ptSize/72*96)+4;0<b&&(this.fontstyle=a[b-1]);this.facename=a[b+1];for(b+=2;b<a.length;b++)this.facename+=" "+a[b];break}};e.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,
ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,vs:this.vshift,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,ts:this.textShadow,lrt:this.last_render_tick,bl:this.canvas_text.textBaseline,txtObj:this.canvas_text.saveToJSON(),isLcs:this.isCanvasSizeLocked,lcw:this.lockedCanvasWidth,lch:this.lockedCanvasHeight}};e.loadFromJSON=function(a){this.text=a.t;this.font=a.f;this.color=a.c;this.halign=a.ha;this.valign=a.va;
this.wrapbyword=a.wr;this.line_height_offset=a.lho;this.vshift=a.vs;this.facename=a.fn;this.fontstyle=a.fs;this.ptSize=a.ps;this.pxHeight=a.pxh;this.textWidth=a.tw;this.textHeight=a.th;this.textShadow=a.ts;this.last_render_tick=a.lrt;this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.canvas_text.textBaseline=a.bl;this.canvas_text.loadFromJSON(a.txtObj);this.isCanvasSizeLocked=a.isLcs;this.lockedCanvasWidth=a.lcw;this.lockedCanvasHeight=a.lch};e.tick=
function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var a=this.layer;this.update_bbox();var b=this.bbox;if(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};e.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};e.updateFont=function(){this.font=
this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename;this.render_text(this.is_force_render)};e.draw=function(a,b,c){var d=!1,e=this.isCanvasSizeLocked?this.lockedCanvasWidth:this.width,f=this.isCanvasSizeLocked?this.lockedCanvasHeight:this.height;a.globalAlpha=b?1:this.opacity;if(b){var g=this.layer.getScale();d||(a.save(),d=!0);a.scale(g,g)}if(this.text_changed||e!==this.lastwrapwidth)this.canvas_text.text_changed=!0,this.text_changed=!1,this.lastwrapwidth=e;this.update_bbox();g=b?0:this.bquad.tlx;
var h=b?0:this.bquad.tly;this.runtime.pixel_rounding&&(g=g+.5|0,h=h+.5|0);if(!b){var k=e!==this.width||f!==this.height;if((b=0!==this.angle)||k){d||(a.save(),d=!0);if(k){k=this.width/e;var l=this.height/f;a.scale(k,l);a.translate(g/k,h/l);h=g=0}b&&(0===g&&0===h||a.translate(g,h),a.rotate(this.angle))}}b=this.pxHeight;b+=this.line_height_offset*this.runtime.devicePixelRatio;this.canvas_text.canvas=a.canvas;this.canvas_text.context=a;this.canvas_text.default_propScope.family=this.facename;this.canvas_text.default_propScope.ptSize=
this.ptSize.toString()+"pt";this.canvas_text.default_propScope.style=this.fontstyle;this.canvas_text.default_propScope.color=this.color;this.canvas_text.default_propScope.shadow=this.textShadow;this.canvas_text.lineHeight=b;this.canvas_text.textInfo.text=this.text;this.canvas_text.textInfo.x=g;this.canvas_text.textInfo.y=h;this.canvas_text.textInfo.boxWidth=e;this.canvas_text.textInfo.boxHeight=f;this.canvas_text.textInfo.ignore=c;this.canvas_text.drawText();d&&a.restore();this.last_render_tick=this.runtime.tickcount};
e.drawGL=function(a){if(!(1>this.width||1>this.height)){var b=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var c=this.layer.getScale(),d=this.layer.getAngle(),e=this.rcTex,f=c*this.width,g=c*this.height,h=Math.ceil(f),k=Math.ceil(g),l=this.runtime.draw_width/2,m=this.runtime.draw_height/2,n=this.isCanvasSizeLocked?Math.ceil(c*this.lockedCanvasWidth):h,q=this.isCanvasSizeLocked?Math.ceil(c*this.lockedCanvasHeight):k;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=
n,this.mycanvas.height=q,this.lastwidth=n,this.lastheight=q,b=!0,this.myctx=this.mycanvas.getContext("2d"));if(n!==this.lastwidth||q!==this.lastheight)this.mycanvas.width=n,this.mycanvas.height=q,this.mytex&&(a.deleteTexture(this.mytex),this.mytex=null),b=!0;b&&(this.myctx.clearRect(0,0,n,q),this.draw(this.myctx,!0),this.mytex||(this.mytex=a.createEmptyTexture(h,k,this.runtime.linearSampling,this.runtime.isMobile)),a.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile));this.lastwidth=n;
this.lastheight=q;a.setTexture(this.mytex);a.setOpacity(this.opacity);a.resetModelView();a.translate(-l,-m);a.updateModelView();var p=this.bquad;b=this.layer.layerToCanvas(p.tlx,p.tly,!0,!0);l=this.layer.layerToCanvas(p.tlx,p.tly,!1,!0);m=this.layer.layerToCanvas(p.trx,p.try_,!0,!0);n=this.layer.layerToCanvas(p.trx,p.try_,!1,!0);q=this.layer.layerToCanvas(p.brx,p.bry,!0,!0);var M=this.layer.layerToCanvas(p.brx,p.bry,!1,!0),r=this.layer.layerToCanvas(p.blx,p.bly,!0,!0);p=this.layer.layerToCanvas(p.blx,
p.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===d){var u=(b+.5|0)-b,t=(l+.5|0)-l;b+=u;l+=t;m+=u;n+=t;q+=u;M+=t;r+=u;p+=t}0===this.angle&&0===d?(m=b+h,n=l,q=m,M=l+k,r=b,p=M,e.right=1,e.bottom=1):(e.right=f/h,e.bottom=g/k);a.quadTex(b,l,m,n,q,M,r,p,e);a.resetModelView();a.scale(c,c);a.rotateZ(-this.layer.getAngle());a.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);a.updateModelView();this.last_render_tick=this.runtime.tickcount}};
e._get_webgl_ctx=function(){var a=this.myctx;if(!a){this.mycanvas=document.createElement("canvas");a=Math.ceil(this.layer.getScale()*this.width);var b=Math.ceil(this.layer.getAngle()*this.height);this.mycanvas.width=a;this.mycanvas.height=b;this.lastwidth=a;this.lastheight=b;a=this.myctx=this.mycanvas.getContext("2d")}return a};e.fake_render=function(){var a=this.runtime.enableWebGL?this._get_webgl_ctx():this.runtime.ctx;this.draw(a,null,!0)};e.render_text=function(a){a&&(this.text_changed=!0,this.fake_render());
this.text_changed=!0;this.runtime.redraw=!0};e.set_text=function(a){this.text!==a&&(this.text=a,this.render_text(this.is_force_render))};e.setShadow=function(a,b,c,d){d=d.replace(/ /g,"");this.textShadow=a.toString()+"px "+b.toString()+"px "+c.toString()+"px "+d};e.LockCanvasSize=function(a,b,c){this.isCanvasSizeLocked=a;this.lockedCanvasWidth=b;this.lockedCanvasHeight=c};e.getRawText=function(a){return this.canvas_text.getRawText(a)};e.getSubText=function(a,b,c){return this.canvas_text.getSubText(a,
b,c)};e.copyPensMgr=function(a){return this.canvas_text.copyPensMgr(a)};k.cnds=new a;a.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};k.acts=new f;f.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);this.set_text(a.toString())};f.prototype.AppendText=function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);a=a.toString();0<a.length&&this.set_text(this.text+a)};f.prototype.SetFontFace=function(a,b){var c="";switch(b){case 1:c=
"bold";break;case 2:c="italic";break;case 3:c="bold italic"}if(a!==this.facename||c!==this.fontstyle)this.facename=a,this.fontstyle=c,this.updateFont()};f.prototype.SetFontSize=function(a){this.ptSize!==a&&(this.ptSize=a,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())};f.prototype.SetFontColor=function(a){a="number"==typeof a?"rgb("+cr.GetRValue(a).toString()+","+cr.GetGValue(a).toString()+","+cr.GetBValue(a).toString()+")":a;a!==this.color&&(this.color=a,this.render_text(this.is_force_render))};
f.prototype.SetWebFont=function(a,b){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var d=this,e=function(){d.runtime.redraw=!0;d.text_changed=!0},f="'"+a+"'";if(c.hasOwnProperty(b)){if(this.facename!==f)for(this.facename=f,this.updateFont(),a=1;10>a;a++)setTimeout(e,100*a),setTimeout(e,1E3*a)}else for(f=document.createElement("link"),f.href=b,f.rel="stylesheet",f.type="text/css",f.onload=e,document.getElementsByTagName("head")[0].appendChild(f),
c[b]=!0,this.facename="'"+a+"'",this.updateFont(),a=1;10>a;a++)setTimeout(e,100*a),setTimeout(e,1E3*a)}};f.prototype.SetEffect=function(a){this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.render_text(this.is_force_render)};f.prototype.SetFontStyle=function(a){var b="";switch(a){case 1:b="bold";break;case 2:b="italic";break;case 3:b="bold italic"}b!==this.fontstyle&&(this.fontstyle=b,this.updateFont())};f.prototype.SetFontFace2=function(a){a!==this.facename&&(this.facename=
a,this.updateFont())};f.prototype.SetLineHeight=function(a){this.line_height_offset!==a&&(this.line_height_offset=a,this.render_text(this.is_force_render))};f.prototype.SetHorizontalAlignment=function(a){this.halign!==a&&(this.halign=a,this.render_text(this.is_force_render))};f.prototype.SetVerticalAlignment=function(a){this.valign!==a&&(this.valign=a,this.render_text(this.is_force_render))};f.prototype.SetWrapping=function(a){a=0===a;this.wrapbyword!==a&&(this.wrapbyword=a,this.render_text(this.is_force_render))};
f.prototype.SetShadow=function(a,b,c,d){this.setShadow(a,b,c,d);this.render_text(this.is_force_render)};f.prototype.SetThickness=function(a){a!==this.canvas_text.underline.thickness&&(this.canvas_text.underline.thickness=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetOffsetY=function(a){a!==this.canvas_text.underline.offset&&(this.canvas_text.underline.offset=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetStrokeLineWidth=function(a){a!==this.canvas_text.stroke.lineWidth&&
(this.canvas_text.stroke.lineWidth=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetStrokeLineJoin=function(a){a=d[a];a!==this.canvas_text.stroke.lineJoin&&(this.canvas_text.stroke.lineJoin=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetBackgroundColor=function(a){a!==this.canvas_text.backgroundColor&&(this.canvas_text.backgroundColor=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.LockCanvasSize=function(a,b){this.LockCanvasSize(!0,a,b)};f.prototype.UnLockCanvasSize=
function(){this.LockCanvasSize(!1)};f.prototype.AddImage=function(a,b,c){b&&(window.RexImageBank.AddImage(a,b.getFirstPicked(),c),this.render_text(this.is_force_render))};f.prototype.RemoveImage=function(a){window.RexImageBank.RemoveImage(a);this.render_text(this.is_force_render)};f.prototype.RemoveAll=function(){window.RexImageBank.RemoveAll();this.render_text(this.is_force_render)};k.exps=new g;g.prototype.Text=function(a,b,c){b=null==b&&null==c?this.text:this.getSubText(b,c);a.set_string(b)};g.prototype.FaceName=
function(a){a.set_string(this.facename)};g.prototype.FaceSize=function(a){a.set_int(this.ptSize)};g.prototype.TextWidth=function(a){a.set_int(this.canvas_text.getTextWidth())};g.prototype.TextHeight=function(a){var b=this.canvas_text.getLines().length*(this.pxHeight+this.line_height_offset)-this.line_height_offset;0===this.baseLine_mode&&(b+=this.vshift);a.set_float(b)};g.prototype.RawText=function(a){a.set_string(this.canvas_text.getRawText())};g.prototype.LastClassPropValue=function(a,b,c){var d,
e=this.canvas_text.getLastPen();e&&(d=e.prop[b]);d||(d=c||0);a.set_any(d)};e=function(){this.lines=[]};var b=e.prototype;b.allocLine=function(){return 0<this.lines.length?this.lines.pop():null};b.freeLine=function(a){this.lines.push(a)};b.freeAllLines=function(a){var b;var c=0;for(b=a.length;c<b;c++)this.freeLine(a[c]);a.length=0};var l=function(){this.context=this.canvas=null;this.savedClasses={};this.textInfo={text:"",x:0,y:0,boxWidth:0,boxHeight:0,ignore:null};this.pensMgr=new C;this.text_changed=
!0;this.default_propScope={family:"Verdana",weight:"",ptSize:"12pt",color:"#000000",style:"normal",shadow:""};this.stroke={lineWidth:1,lineJoin:"miter"};this.underline={thickness:1,offset:0};this.textAlign="start";this.lineHeight="16";this.textBaseline="alphabetic";this.backgroundColor=""};b=l.prototype;b.Reset=function(a){this.plugin=a};b.getLines=function(){return this.pensMgr.getLines()};b.apply_propScope=function(a){if(this.isTextMode(a)){var b;a.hasOwnProperty("b")||a.hasOwnProperty("i")?a.b&&
a.i?b="bold italic":a.b?b="bold":a.i&&(b="italic"):b=this.default_propScope.weight;var c=a.weight||this.default_propScope.weight,d=this.getTextSize(a);this.context.font=b+" "+c+" "+d+" "+(a.family||this.default_propScope.family);b=this.getFillColor(a);"none"!==b.toLowerCase()&&(this.context.fillStyle=b);b=this.getStokeColor(a);"none"!==b.toLowerCase()&&(this.context.strokeStyle=b,this.context.lineWidth=this.stroke.lineWidth,this.context.lineJoin=this.stroke.lineJoin,this.context.miterLimit=2)}a=a.shadow?
this.default_propScope.shadow:"";""!==a&&(a=a.split(" "),this.context.shadowOffsetX=parseFloat(a[0].replace("px","")),this.context.shadowOffsetY=parseFloat(a[1].replace("px","")),this.context.shadowBlur=parseFloat(a[2].replace("px","")),this.context.shadowColor=a[3])};b.isTextMode=function(a){return!a.hasOwnProperty("img")};b.getTextSize=function(a){return a.hasOwnProperty("size")?a.size:this.default_propScope.ptSize};b.getFillColor=function(a){return a.hasOwnProperty("color")?a.color:this.default_propScope.color};
b.getStokeColor=function(a){return a.hasOwnProperty("stroke")?a.stroke:"none"};b.draw_pen=function(a,b,c){var d=this.context;d.save();this.apply_propScope(a.prop);b+=a.x;c+=a.y;var e=a.prop.u;e&&(e=!0===e?this.getFillColor(a.prop):e,this.draw_underline(a.text,b,c,this.getTextSize(a.prop),e));if(a.prop.hasOwnProperty("img")){if(a=window.RexImageBank.GetImage(a.prop.img))c+=a.yoffset,"alphabetic"==this.textBaseline&&(c-=this.lineHeight),d.drawImage(a.img,b,c,a.width,a.height)}else"none"!==this.getStokeColor(a.prop).toLowerCase()&&
d.strokeText(a.text,b,c),"none"!==this.getFillColor(a.prop).toLowerCase()&&d.fillText(a.text,b,c);d.restore()};b.draw_underline=function(a,b,c,d,e){var f=this.context;a=f.measureText(a).width;c+=this.underline.offset;"top"===this.textBaseline&&(c+=parseInt(d));f.beginPath();f.strokeStyle=e;f.lineWidth=this.underline.thickness;f.moveTo(b,c);f.lineTo(b+a,c);f.stroke()};b.preProcess=function(){if(""!==this.backgroundColor){var a=this.context;a.fillStyle=this.backgroundColor;a.fillRect(0,0,this.textInfo.boxWidth,
this.textInfo.boxHeight)}};b.drawPens=function(a,b){var c=b.boxWidth,d=b.boxHeight,e=b.x,f=b.y;b=a.getLines();var g=b.length;d=1===this.plugin.valign?Math.max((d-g*this.lineHeight)/2,0):2===this.plugin.valign?Math.max(d-g*this.lineHeight-2,0):0;d+=f;"alphabetic"==this.textBaseline&&(d+=this.plugin.vshift*this.plugin.runtime.devicePixelRatio);var h;for(f=0;f<g;f++){var k=a.getLineWidth(f);if(0!==k){k=1===this.plugin.halign?(c-k)/2:2===this.plugin.halign?c-k:0;k+=e;var l=b[f];var m=l.length;for(h=0;h<
m;h++){var n=l[h];""!==n.text&&this.draw_pen(n,k,d)}}}};b.postProcess=function(){};var n=[],q=function(a,b){var c=/\[b\]|\[\/b\]|\[i\]|\[\/i\]|\[size=(\d+)\]|\[\/size\]|\[color=([a-z]+|#[0-9abcdef]+)\]|\[\/color\]|\[u\]|\[u=([a-z]+|#[0-9abcdef]+)\]|\[\/u\]|\[shadow\]|\[\/shadow\]|\[stroke=([a-z]+|#[0-9abcdef]+)\]|\[\/stroke\]|\[img=([^\]]+)\]|\[\/img\]/ig;n.length=0;for(var d,e=0,f=a.length,g;;){d=c.exec(a);if(!d)break;d=d[0];g=c.lastIndex-d.length;e<g&&n.push(a.substring(e,g));null==b&&n.push(d);
e=c.lastIndex}e<f&&n.push(a.substring(e,f));return n},h=/\[b\]/i,m=/\[\/b\]/i,p=/\[i\]/i,v=/\[\/i\]/i,u=/\[size=(\d+)\]/i,y=/\[\/size\]/i,z=/\[color=([a-z]+|#[0-9abcdef]+)\]/i,x=/\[\/color\]/i,r=/\[u\]/i,A=/\[u=([a-z]+|#[0-9abcdef]+)\]/i,D=/\[\/u\]/i,E=/\[shadow\]/i,t=/\[\/shadow\]/i,w=/\[stroke=([a-z]+|#[0-9abcdef]+)\]/i,N=/\[\/stroke\]/i,P=/\[img=([^\]]+)\]/i,Q=/\[\/img\]/i,B={};b.updatePens=function(a,b,c){null==b&&(b=this.textInfo);a.freePens();var d=b.text;b=b.boxWidth;if(""!==d){var e=0,f=0;
d=q(d);if(0!==d.length){var g,k=d.length;for(g=0;g<k;g++){var l=d[g];if(h.test(l))I(B,!0,"b",!0);else if(m.test(l))I(B,!1,"b");else if(p.test(l))I(B,!0,"i",!0);else if(v.test(l))I(B,!1,"i");else if(u.test(l))l=l.match(u),I(B,!0,"size",l[1]+"pt");else if(y.test(l))I(B,!1,"size");else if(z.test(l))l=l.match(z),I(B,!0,"color",l[1]);else if(x.test(l))I(B,!1,"color");else if(r.test(l))l.match(r),I(B,!0,"u",!0);else if(A.test(l))l=l.match(A),I(B,!0,"u",l[1]);else if(D.test(l))I(B,!1,"u");else if(E.test(l))I(B,
!0,"shadow",!0);else if(t.test(l))I(B,!1,"shadow");else if(w.test(l))l=l.match(w),I(B,!0,"stroke",l[1]);else if(N.test(l))I(B,!1,"stroke");else if(P.test(l)){l=l.match(P);l=l[1];var n=window.RexImageBank.GetImage(l);n&&(I(B,!0,"img",l),c?a.addPen(null,null,null,null,B,0):(n.width>b-(e-0)&&(e=0,f+=this.lineHeight),a.addPen(null,e,f,n.width,B,0),e+=n.width),I(B,!1,"img"))}else if(Q.test(l))I(B,!1,"img");else if(c)a.addPen(l,null,null,null,B,0);else{this.context.save();this.apply_propScope(B);a:{var M=
l;n=this.context;var U=b,C=this.plugin.wrapbyword,F=e-0;l=S;O.freeAllLines(l);if(M&&M.length&&!(2>=U)){if(100>=M.length&&-1===M.indexOf("\n")){var R=n.measureText(M).width;if(R<=U-F){O.freeAllLines(l);l.push(O.newline(M,R,L));break a}}if(C){J.length=0;var G="";for(var H=0;H<M.length;)if(R=M.charAt(H),"\n"===R)G.length&&(J.push(G),G=""),J.push("\n"),++H;else if(" "===R||"\t"===R||"-"===R){do G+=M.charAt(H),H++;while(H<M.length&&(" "===M.charAt(H)||"\t"===M.charAt(H)));J.push(G);G=""}else H<M.length&&
(G+=R,H++);G.length&&J.push(G);M=J}H=M;var K="",T=H.length,Y=0;for(M=0;M<T;M++)"\n"===H[M]?(Y>=l.length&&l.push(O.newline(K,n.measureText(K).width,1)),Y++,K="",F=0):(G=K,K+=H[M],R=n.measureText(K).width,R>=U-F&&(Y>=l.length&&l.push(O.newline(G,n.measureText(G).width,2)),Y++,K=H[M],C||" "!==K||(K=""),F=0));K.length&&(Y>=l.length&&l.push(O.newline(K,n.measureText(K).width,L)),Y++);for(M=Y;M<l.length;M++)O.freeLine(l[M]);l.length=Y}}n=l.length;for(U=0;U<n;U++)C=l[U],a.addPen(C.text,e,f,C.width,B,C.newLineMode),
C.newLineMode!==L?(e=0,f+=this.lineHeight):e+=C.width;this.context.restore()}}for(var aa in B)delete B[aa]}}};var I=function(a,b,c,d){!0===b?a[c]=d:a.hasOwnProperty(c)&&delete a[c];return a};b.drawText=function(){var a=this.textInfo;this.text_changed&&(this.updatePens(this.pensMgr,a),this.text_changed=!1);a.ignore||(this.context.textBaseline=this.textBaseline,this.context.textAlign=this.textAlign,this.preProcess(),this.drawPens(this.pensMgr,a),this.postProcess())};var H=null;b.getSubText=function(a,
b,c){if(null==c)return this.pensMgr.getSliceTagText(a,b);null===H&&(H=new C);var d=this.textInfo.text;this.textInfo.text=c;this.updatePens(H,this.textInfo,!0);this.textInfo.text=d;return H.getSliceTagText(a,b)};b.getRawText=function(a){if(null==a)return this.pensMgr.getRawText();a=q(a,1);if(0===a.length)return"";var b,c=a.length,d="";for(b=0;b<c;b++)d+=a[b];return d};b.copyPensMgr=function(a){return this.pensMgr.copy(a)};b.getTextWidth=function(a){null==a&&(a=this.pensMgr);return a.getMaxLineWidth()};
b.getLastPen=function(a){null==a&&(a=this.pensMgr);return a.getLastPen()};b.defineClass=function(a,b){this.savedClasses[a]=b;return!0};b.getClass=function(a){return this.savedClasses[a]};b.trim=function(a){var b;a=a.replace(/^\s\s*/,"");var c=/\s/;for(b=a.length;c.test(a.charAt(--b)););return a.slice(0,b+1)};b.saveToJSON=function(){return{cls:this.savedClasses,stroke:[this.stroke.lineWidth,this.stroke.lineJoin],u:[this.underline.thickness,this.underline.offset],bgc:this.backgroundColor}};b.loadFromJSON=
function(a){this.savedClasses=a.cls;this.stroke.lineWidth=a.stroke[0];this.stroke.lineJoin=a.stroke[1];this.underline.thickness=a.u[0];this.underline.offset=a.u[1];this.backgroundColor=a.bgc};var L=0,O=new e;O.newline=function(a,b,c){var d=this.allocLine()||{};d.text=a;d.width=b;d.newLineMode=c;return d};var S=[],J=[],G=new e,F=new e,C=function(){this.pens=[];this.lines=[]};e=C.prototype;e.freePens=function(){var a,b=this.lines.length;for(a=0;a<b;a++)this.lines[a].length=0;G.freeAllLines(this.pens);
F.freeAllLines(this.lines)};e.addPen=function(a,b,c,d,e,f){var g=G.allocLine();null===g&&(g=new K);g.setPen(a,b,c,d,e,f);a=this.pens[this.pens.length-1];g.startIndex=null==a?0:a.getNextStartIndex();this.pens.push(g);a=this.lines[this.lines.length-1];null==a&&(a=F.allocLine()||[],this.lines.push(a));a.push(g);f!==L&&(a=F.allocLine()||[],this.lines.push(a))};e.getPens=function(){return this.pens};e.getLastPen=function(){return this.pens[this.pens.length-1]};e.getLines=function(){return this.lines};
e.getLineStartChartIndex=function(a){a=this.lines[a];return null==a?0:a[0].startIndex};e.getLineEndChartIndex=function(a){for(var b=!1,c;0<=a&&!(c=this.lines[a],b=null!=c&&0<c.length);a--);return b?c[c.length-1].getEndIndex():0};e.copy=function(a){null==a&&(a=new C);a.freePens();var b,c=this.lines.length,d;for(b=0;b<c;b++){var e=this.lines[b];var f=e.length;for(d=0;d<f;d++){var g=e[d];a.addPen(g.text,g.x,g.y,g.width,g.prop,g.newLineMode)}}return a};e.getLineWidth=function(a){a=this.lines[a];return a?
(a=a[a.length-1])?a.getLastX():0:0};e.getMaxLineWidth=function(){var a=0,b,c=this.lines.length;for(b=0;b<c;b++){var d=this.getLineWidth(b);d>a&&(a=d)}return a};e.getRawText=function(){var a="",b,c=this.pens.length;for(b=0;b<c;b++)a+=this.pens[b].getRawText();return a};e.getRawTextLength=function(){var a=0,b,c=this.pens.length;for(b=0;b<c;b++)a+=this.pens[b].getRawText().length;return a};e.getSliceTagText=function(a,b){null==a&&(a=0);if(null==b){b=this.getLastPen();if(null==b)return"";b=b.getEndIndex()}var c=
"",d,e=this.pens.length,f,g;for(d=0;d<e;d++){var h=this.pens[d];var k=h.getRawText();var l=h.startIndex;var m=h.getNextStartIndex();if(!(m<a)){(f=l>=a&&m<b)||(k=k.substring(a-l,b-l));l=void 0;f=h.prop;null==g&&(g=T);for(l in g)f.hasOwnProperty(l)||(k="[/"+l+"]"+k);var n="";for(l in f)g[l]!==f[l]&&(n="size"===l?n+("[size="+f[l].replace("pt","")+"]"):"color"===l||"stroke"===l||"img"===l?n+("["+l+"="+f[l]+"]"):"u"===l?!0===f[l]?n+"[u]":n+("[u="+f[l]+"]"):n+("["+l+"]"));c+=n+k;g=h.prop;if(m>=b)break}}return c};
var T={},K=function(){this.width=this.y=this.x=this.text=null;this.prop={};this.startIndex=this.newLineMode=null};e=K.prototype;e.setPen=function(a,b,c,d,e,f,g){this.text=a;this.x=b;this.y=c;this.width=d;a=this.prop;null==a&&(a={});for(var h in a)e.hasOwnProperty(h)||delete a[h];for(h in e)a[h]=e[h];this.newLineMode=f;this.startIndex=g};e.getRawText=function(){var a=this.text||"";1==this.newLineMode&&(a+="\n");return a};e.getNextStartIndex=function(){return this.startIndex+this.getRawText().length};
e.getEndIndex=function(){return this.getNextStartIndex()-1};e.getLastX=function(){return this.x+this.width};e=function(){this.images={}};b=e.prototype;b.AddImage=function(a,b,c){var d=b?b.canvas?b.canvas:b.curFrame&&b.curFrame.texture_img?b.curFrame.texture_img:null:null;b&&(this.images[a]={img:d,width:b.width,height:b.height,yoffset:c})};b.GetImage=function(a,b){return this.images[a]};b.RemoveImage=function(a){this.images.hasOwnProperty(a)&&delete this.images[a]};b.RemoveAll=function(){for(var a in this.images)delete this.images[a]};
window.RexImageBank=new e})();cr.plugins_.sirg_fancyBox=function(a){this.runtime=a};
(function(){function a(){}var f=cr.plugins_.sirg_fancyBox.prototype;f.Type=function(a){this.plugin=a;this.runtime=a.runtime};f.Type.prototype.onCreate=function(){};f.Instance=function(a){this.type=a;this.runtime=a.runtime};var g=f.Instance.prototype;g.onCreate=function(){};g.onDestroy=function(){};g.saveToJSON=function(){return{}};g.loadFromJSON=function(a){};g.draw=function(a){};g.drawGL=function(a){};f.cnds=new function(){};a.prototype.ShowFancyBoxInline=function(a,e,c,d,b){switch(c){case 0:c="float";
break;case 1:c="inside";break;case 2:c="outside";break;case 3:c="over";break;default:c="outside"}jQuery.fancybox({type:"inline",content:b,title:1==e?a:null,helpers:{title:{type:c,position:1==d?"top":"bottom"}}})};a.prototype.ShowFancyBoxAjax=function(a,e,c,d,b){switch(c){case 0:c="float";break;case 1:c="inside";break;case 2:c="outside";break;case 3:c="over";break;default:c="outside"}jQuery.fancybox({type:"ajax",href:b,title:1==e?a:null,helpers:{title:{type:c,position:1==d?"top":"bottom"}}})};a.prototype.ShowFancyBoxIframe=
function(a,e,c,d,b){switch(c){case 0:c="float";break;case 1:c="inside";break;case 2:c="outside";break;case 3:c="over";break;default:c="outside"}jQuery.fancybox({type:"iframe",href:b,title:1==e?a:null,helpers:{title:{type:c,position:1==d?"top":"bottom"}}})};a.prototype.ShowFancyBoxSwf=function(a,e,c,d,b){switch(c){case 0:c="float";break;case 1:c="inside";break;case 2:c="outside";break;case 3:c="over";break;default:c="outside"}jQuery.fancybox({type:"swf",href:b,title:1==e?a:null,helpers:{title:{type:c,
position:1==d?"top":"bottom"}}})};a.prototype.ShowFancyBoxImage=function(a,e,c,d,b){switch(c){case 0:c="float";break;case 1:c="inside";break;case 2:c="outside";break;case 3:c="over";break;default:c="outside"}jQuery.fancybox({type:"image",href:b,title:1==e?a:null,helpers:{title:{type:c,position:1==d?"top":"bottom"}}})};a.prototype.ShowFancyBoxHtml=function(a,e,c,d,b){switch(c){case 0:c="float";break;case 1:c="inside";break;case 2:c="outside";break;case 3:c="over";break;default:c="outside"}jQuery.fancybox({type:"html",
content:b,title:1==e?a:null,helpers:{title:{type:c,position:1==d?"top":"bottom"}}})};a.prototype.ShowFancyBoxSimple=function(a){jQuery.fancybox({type:"inline",content:a})};f.acts=new a;f.exps=new function(){}})();cr.plugins_.sliderbar=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.plugins_.sliderbar.prototype;k.Type=function(a){this.plugin=a;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Slider Bar plugin not supported on this platform - the object will not be created"):(this.elem=document.createElement("input"),this.elem.type="range",this.elem.max=
this.properties[2],this.elem.min=this.properties[1],this.elem.step=this.properties[3],this.elem.value=this.properties[0],this.elem.disabled=0===this.properties[6],this.elem.id=this.properties[7],this.elem.title=this.properties[4],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.element_hidden=!1,0===this.properties[5]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.elem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=
!0;a.runtime.trigger(cr.plugins_.sliderbar.prototype.cnds.OnClicked,a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.onchange=function(a){return function(c){a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.sliderbar.prototype.cnds.OnChanged,a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchend",function(a){a.stopPropagation()},
!1),jQuery(this.elem).mousedown(function(a){a.stopPropagation()}),jQuery(this.elem).mouseup(function(a){a.stopPropagation()}),jQuery(this.elem).keydown(function(a){a.stopPropagation()}),jQuery(this.elem).keyup(function(a){a.stopPropagation()}),this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0,this.updatePosition(!0),this.runtime.tickMe(this))};e.saveToJSON=function(){return{v:this.elem.value,mi:this.elem.min,ma:this.elem.max,s:this.elem.step}};e.loadFromJSON=
function(a){this.elem.min=a.mi;this.elem.max=a.ma;this.elem.step=a.s;this.elem.value=a.v};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),b=this.layer.layerToCanvas(this.x,this.y,!1),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),f=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!1),g=this.runtime.width/this.runtime.devicePixelRatio,h=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=e||0>=f||c>=g||b>=h?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>c&&(c=1),1>b&&(b=1),e>=g&&(e=g-1),f>=h&&(f=h-1),g=window.innerWidth,h=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==b||this.lastRight!==e||this.lastBottom!==f||this.lastWinWidth!==g||this.lastWinHeight!==h?(this.lastLeft=c,this.lastTop=b,this.lastRight=
e,this.lastBottom=f,this.lastWinWidth=g,this.lastWinHeight=h,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,g=Math.round(b)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:g}),jQuery(this.elem).width(Math.round(e-c)),jQuery(this.elem).height(Math.round(f-b))):this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1))}};e.draw=function(a){};
e.drawGL=function(a){};a.prototype.OnClicked=function(){return!0};a.prototype.OnChanged=function(){return!0};a.prototype.CompareValue=function(a,d){return this.isDomFree?!1:cr.do_cmp(parseFloat(this.elem.value),a,d)};k.cnds=new a;f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetCSSStyle=function(a,d){this.runtime.isDomFree||jQuery(this.elem).css(a,d)};f.prototype.SetValue=
function(a){this.runtime.isDomFree||(this.elem.value=a)};f.prototype.SetMaximum=function(a){this.runtime.isDomFree||(this.elem.max=a)};f.prototype.SetMinimum=function(a){this.runtime.isDomFree||(this.elem.min=a)};f.prototype.SetStep=function(a){this.runtime.isDomFree||(this.elem.step=a)};f.prototype.SetEnabled=function(a){this.runtime.isDomFree||(this.elem.disabled=0===a)};k.acts=new f;g.prototype.Value=function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.value)||0)};g.prototype.Maximum=
function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.max)||0)};g.prototype.Minimum=function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.min)||0)};g.prototype.Step=function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.step)||0)};k.exps=new g})();
var toggle_css='<style type="text/css"> .switch5 { -webkit-tap-highlight-color : rgba(0,0,0,0); background-color: #fff; float: right; height: 28px; width: 77px; border-radius: 20px; margin-top: -5px; box-shadow: inset 0 1px 3px #BABABA, inset -5px 13px 0.5px 0px rgba(232, 232, 232, 0.6), inset -1px 1px 2px rgba(0, 0, 0, 0.7), inset 1px 2px 1px 0px rgba(0, 0, 0, 1); overflow: hidden; } .switch5 input[type=checkbox] { display: none; } .switch5::before { content: ""; display: block; height: 28px; \twidth: 0px; position: absolute; border-radius: 20px; -webkit-box-shadow: inset 0 1px 2px #0059ac, inset 4px 11px 0.5px 2px rgba(0, 101, 189, 0.5), inset -1px 1px 2px rgba(0, 0, 0, 0.7), inset 0px 1px 1px rgba(0, 0, 0, 1.0); box-shadow: inset 0 1px 2px #0059ac, inset 4px 11px 0.5px 2px rgba(0, 101, 189, 0.5), inset -1px 1px 2px rgba(0, 0, 0, 0.7), inset 0px 1px 1px rgba(0, 0, 0, 1.0);\tbackground-color: #2a94ec; } .switch5.on::before { width: 77px; } .switch5 > .thumb { display: block; width: 25px; height: 25px; position: relative; top: 0.5; left: 1; \tz-index: 3; border: solid 1px #818181; border-radius: 28px; box-shadow: inset 0 1px 1px white, inset 0 -1px 1px white, 0 0px 1px rgba(0, 0, 0, 0.8); background-color: #CECECE; background-image: -webkit-linear-gradient(#CECECE, #FBFBFB); background-image: -moz-linear-gradient(#CECECE, #FBFBFB); background-image: -o-linear-gradient(#CECECE, #FBFBFB); -o-transition: all 0.125s ease-in-out; -webkit-transition: all 0.125s ease-in-out; -moz-transition: all 0.125s ease-in-out; -o-transform: translateX(0px); -webkit-transform: translate3d(0,0,0); -moz-transform: translateX(0px); } .switch5.on > .thumb { -webkit-transform: translate3d(49px,0,0); -o-transform: translateX(49px); -moz-transform: translateX(49px); } .switch5 > .thumb::before { content: ""; display: block; height: 14px; width: 2px; background-color: white; box-shadow: 0px -0.5px 0.5px #000; border: none; position: absolute; top: 6px; left: -24px; } .switch5 > .thumb::after { content: ""; display: block; height: 10px; width: 10px; border-radius: 10px; border: solid 2px #777;\tposition: absolute; right: -32px; top: 6px; }  .switch4 { -webkit-tap-highlight-color : rgba(0,0,0,0); background-color: #fff; float: right; height: 28px; width: 90px; border-radius: 4px; margin-top: -5px; box-shadow: inset 0 1px 3px #BABABA, inset 4px 13px 0.5px 0px rgba(232, 232, 232, 0.6), inset 1px 2px 1px 0px rgba(0, 0, 0, 1); overflow: hidden; } .switch4 input[type=checkbox] { display: none; } .switch4::before { content: ""; display: block; height: 28px; width: 0px; position: absolute; border-radius: 4px; -webkit-box-shadow: inset 0 1px 4px #0059ac, inset -5px 10px 4px 3px rgba(0, 101, 189, 0.6), inset -30px 1px 2px rgba(0, 0, 0, 0.4), inset 0px 1px 1px rgba(0, 0, 0, 1.0); box-shadow:  inset 0 1px 4px #0059ac, inset -5px 10px 4px 3px rgba(0, 101, 189, 0.6), inset -30px 1px 2px rgba(0, 0, 0, 0.4), inset 0px 1px 1px rgba(0, 0, 0, 1.0); background-color: #2a94ec; } .switch4.on::before { width: 77px; } .switch4 > .thumb { display: block; \twidth: 39px; height: 26px; position: relative; top: 0; left: 0; z-index: 3; border: solid 1px #818181; border-radius: 4px; box-shadow: inset 0 1px 1px white, inset 0 -1px 1px white, 0 0px 2px rgba(0, 0, 0, 0.6); background-color: #CECECE; background-image: -webkit-linear-gradient(#CECECE, #FBFBFB); background-image: -moz-linear-gradient(#CECECE, #FBFBFB); background-image: -o-linear-gradient(#CECECE, #FBFBFB); -o-transition: all 0.125s ease-in-out; -webkit-transition: all 0.125s ease-in-out; -moz-transition: all 0.125s ease-in-out; -o-transform: translateX(0px); -webkit-transform: translate3d(0,0,0); -moz-transform: translateX(0px); } .switch4.on > .thumb { -webkit-transform: translate3d(49px,0,0); -o-transform: translateX(49px); -moz-transform: translateX(49px); left: -1; } .switch4 > .thumb::before { content: ""; display: block;\theight: 14px; width: 2px; background-color: white;\t box-shadow: 0px -0.5px 0.5px #000; border: none; position: absolute; top: 6px; left: -24px; } .switch4 > .thumb::after { content: ""; display: block; height: 10px; width: 10px; border-radius: 10px; border: solid 2px #777; position: absolute; right: -32px; top: 6px; } </style>',toggle_t=
0;cr.plugins_.togglebutton=function(a){this.runtime=a};
(function(){var a=cr.plugins_.togglebutton.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a){this.type=a;this.runtime=a.runtime;this.triggerToggle=this.triggerID=null};var f=a.Instance.prototype;f.onCreate=function(){this.iOS_version=[!0,!1][this.properties[0]];this.toggle_status=[!0,!1][this.properties[1]];var a=document.createElement("span");a.id="togglebutton_"+this.uid;a.style.zIndex=this.properties[2];1==this.toggle_status&&
1==this.iOS_version?a.className="switch4 on":0==this.toggle_status&&1==this.iOS_version?a.className="switch4":1==this.toggle_status&&0==this.iOS_version?a.className="switch5 on":0==this.toggle_status&&0==this.iOS_version&&(a.className="switch5");var f=document.createElement("span");f.className="thumb";var e=document.createElement("input");e.type="checkbox";jQuery(a).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");a.appendChild(f);a.appendChild(e);++toggle_t;1==toggle_t&&jQuery(toggle_css).appendTo("head");
a.onclick=function(c){return function(){c.triggerID="togglebutton_"+c.uid;c.triggerToggle="switch4 on"==a.className||"switch5 on"==a.className?1:0;"switch4 on"==a.className?a.className="switch4":"switch5 on"==a.className?a.className="switch5":"switch4"==a.className?a.className="switch4 on":"switch5"==a.className&&(a.className="switch5 on");c.runtime.trigger(cr.plugins_.togglebutton.prototype.cnds.toggleStatus,c)}}(this);document.addEventListener("touchmove",function(a){a.preventDefault()},!1);a.addEventListener("touchstart",
function(a){a.stopPropagation()},!1);this.updatePosition();this.runtime.tickMe(this)};f.draw=function(){};f.drawGL=function(a){};f.onDestroy=function(){jQuery(this.elem).remove();this.elem=null};f.tick=function(){this.updatePosition()};f.updatePosition=function(){this.elem=document.getElementById("togglebutton_"+this.uid);var a=this.layer.layerToCanvas(this.x,this.y,!0),f=this.layer.layerToCanvas(this.x,this.y,!1),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),c=this.layer.layerToCanvas(this.x+
this.width,this.y+this.height,!1);if(!this.visible||!this.layer.visible||0>=e||0>=c||a>=this.runtime.width||f>=this.runtime.height)jQuery(this.elem).hide();else{jQuery(this.elem).show();var d=Math.round(a)+jQuery(this.runtime.canvas).offset().left,b=Math.round(f)+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).offset({left:d,top:b});jQuery(this.elem).width(e-a);jQuery(this.elem).height(c-f)}};a.acts={};f=a.acts;f.set_toggleStatus=function(a){var f=document.getElementById("togglebutton_"+
this.uid);if(!f)return!1;0===a&&1==this.iOS_version?f.className="switch4 on":1===a&&1==this.iOS_version?f.className="switch4":0===a&&0==this.iOS_version?f.className="switch5 on":1===a&&0==this.iOS_version&&(f.className="switch5")};f.switch_toggleStatus=function(){var a=document.getElementById("togglebutton_"+this.uid);switch(a.className){case "switch4 on":a.className="switch4";break;case "switch4":a.className="switch4 on";break;case "switch5 on":a.className="switch5";break;case "switch5":a.className=
"switch5 on"}};a.cnds={};a.cnds.toggleStatus=function(a){return"togglebutton_"+this.uid==this.triggerID&&this.triggerToggle==a};a.exps={}})();cr.plugins_.video=function(a){this.runtime=a};
(function(){function a(a){return a&&!a.paused&&!a.ended&&0<a.currentTime}function f(){var a=m.slice(0);cr.clearArray(m);var b,c;var d=0;for(b=a.length;d<b;++d){var e=a[d];(c=e.play())&&c.catch(function(a){g(e)})}}function g(a){-1===m.indexOf(a)&&m.push(a)}function k(a){0>a&&(a=0);1<a&&(a=1);return Math.log(a)/Math.log(10)*20}function e(){}function c(){}function d(){}var b=cr.plugins_.video.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};var l=b.Type.prototype;l.onCreate=function(){};
l.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;++b){var c=this.instances[b];c.webGL_texture=null}}};l=document.createElement("video");var n=!!l.canPlayType("video/webm"),q=!!l.canPlayType("video/ogg"),h=!!l.canPlayType("video/mp4");l=null;b.Instance=function(a){this.type=a;this.runtime=a.runtime};l=b.Instance.prototype;var m=[];document.addEventListener("touchend",f,!0);document.addEventListener("click",f,!0);document.addEventListener("keydown",f,
!0);l.queueVideoPlay=function(a){if(this.video){var b=this;if(a){try{var c=this.video.play()}catch(x){g(this.video);return}c?c.catch(function(a){b.video&&g(b.video)}):this.useNextTouchWorkaround&&!this.runtime.isInUserInputEvent&&g(this.video)}else a=m.indexOf(this.video),0<=a&&m.splice(a,1)}};l.onCreate=function(){this.webm_src=this.properties[0];this.ogv_src=this.properties[1];this.mp4_src=this.properties[2];this.autoplay=this.properties[3];this.playInBackground=0!==this.properties[4];this.videoWasPlayingOnSuspend=
!1;this.video=document.createElement("video");this.video.crossOrigin="anonymous";this.video.playsInline=!0;this.webGL_texture=null;this.currentTrigger=-1;this.viaCtx=this.viaCanvas=null;this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge;var a=this;this.video.addEventListener("canplay",function(){a.currentTrigger=0;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("canplaythrough",function(){a.currentTrigger=1;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,
a)});this.video.addEventListener("ended",function(){a.currentTrigger=2;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("error",function(){a.currentTrigger=3;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("loadstart",function(){a.currentTrigger=4;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("playing",function(){a.currentTrigger=5;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,
a)});this.video.addEventListener("pause",function(){a.currentTrigger=6;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("stalled",function(){a.currentTrigger=7;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.useNextTouchWorkaround=(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))&&!this.runtime.isCrosswalk&&!this.runtime.isDomFree;0===this.autoplay?(this.video.autoplay=
!1,this.video.preload="none"):1===this.autoplay?(this.video.autoplay=!1,this.video.preload="auto"):2===this.autoplay&&(this.video.autoplay=!0);this.setSource(this.webm_src,this.ogv_src,this.mp4_src);2===this.autoplay&&this.queueVideoPlay(!0);this.visible=0!==this.properties[5];this.runtime.tickMe(this);this.recycled||(a=this,this.runtime.addSuspendCallback(function(b){a.onSuspend(b)}))};l.onSuspend=function(b){!this.playInBackground&&this.video&&(b?a(this.video)&&(this.queueVideoPlay(!1),this.video.pause(),
this.videoWasPlayingOnSuspend=!0):this.videoWasPlayingOnSuspend&&(this.queueVideoPlay(!0),this.videoWasPlayingOnSuspend=!1))};l.setSource=function(a,b,c){var d="";n&&a?d=a:q&&b?d=b:h&&c&&(d=c);d&&(this.runtime.isAbsoluteUrl(d)||(d=d.toLowerCase()),this.video.src=d);this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null};l.onDestroy=function(){this.queueVideoPlay(!1);a(this.video)&&this.video.pause();
this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null;this.video.src="";this.video=null};l.tick=function(){a(this.video)&&(this.runtime.redraw=!0)};l.saveToJSON=function(){return{s:this.video.src||"",p:!!a(this.video),t:this.video.currentTime||0}};l.loadFromJSON=function(a){if(a&&"undefined"!==typeof a.s){var b=a.s;this.setSource(b,b,b);try{this.video.currentTime=a.t}catch(z){}a.p?this.queueVideoPlay(!0):
(this.queueVideoPlay(!1),this.video.pause())}};l.draw=function(a){if(this.video){var b=this.video.videoWidth,c=this.video.videoHeight;if(!(0>=b||0>=c)){var d=b/c;b=this.width;c=this.height;var e=0,f=0;if(b/c>d){var g=c*d;d=c;e=Math.floor((b-g)/2);0>e&&(e=0)}else g=b,d=b/d,f=Math.floor((c-d)/2),0>f&&(f=0);a.globalAlpha=this.opacity;a.drawImage(this.video,this.x+e,this.y+f,g,d)}}};var p=new cr.rect(0,0,0,0),v=new cr.quad;l.drawGL=function(a){if(this.video){var b=this.video.videoWidth,c=this.video.videoHeight;
if(!(0>=b||0>=c)){var d=b/c,e=this.width,f=this.height,g=0,h=0;if(e/f>d){var k=f*d;d=f;g=Math.floor((e-k)/2);0>g&&(g=0)}else k=e,d=e/d,h=Math.floor((f-d)/2),0>h&&(h=0);this.webGL_texture||(this.webGL_texture=a.createEmptyTexture(b,c,this.runtime.linearSampling,!1,!1));this.useViaCanvasWorkaround?(this.viaCtx||(this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=b,this.viaCanvas.height=c,this.viaCtx=this.viaCanvas.getContext("2d")),this.viaCtx.drawImage(this.video,0,0),a.videoToTexture(this.viaCanvas,
this.webGL_texture)):a.videoToTexture(this.video,this.webGL_texture);a.setBlend(this.srcBlend,this.destBlend);a.setOpacity(this.opacity);a.setTexture(this.webGL_texture);p.set(this.x+g,this.y+h,this.x+g+k,this.y+h+d);v.set_from_rect(p);a.quad(v.tlx,v.tly,v.trx,v.try_,v.brx,v.bry,v.blx,v.bly)}}};e.prototype.IsPlaying=function(){return a(this.video)};e.prototype.IsPaused=function(){return this.video.paused};e.prototype.HasEnded=function(){return this.video.ended};e.prototype.IsMuted=function(){return this.video.muted};
e.prototype.OnPlaybackEvent=function(a){return this.currentTrigger===a};b.cnds=new e;c.prototype.SetSource=function(a,b,c){this.setSource(a,b,c);this.video.load()};c.prototype.SetPlaybackTime=function(a){try{this.video.currentTime=a}catch(y){console&&console.error&&console.error("Exception setting video playback time: ",y)}};c.prototype.SetLooping=function(a){this.video.loop=0!==a};c.prototype.SetMuted=function(a){this.video.muted=0!==a};c.prototype.SetVolume=function(a){var b=this.video;a=Math.pow(10,
a/20);0>a&&(a=0);1<a&&(a=1);b.volume=a};c.prototype.Pause=function(){this.queueVideoPlay(!1);this.video.pause()};c.prototype.Play=function(){this.queueVideoPlay(!0)};b.acts=new c;d.prototype.PlaybackTime=function(a){a.set_float(this.video.currentTime||0)};d.prototype.Duration=function(a){a.set_float(this.video.duration||0)};d.prototype.Volume=function(a){a.set_float(k(this.video.volume||0))};b.exps=new d})();
cr.behaviors.DragnDrop=function(a){this.runtime=a;var f=this;this.runtime.isDomFree||(jQuery(document).mousemove(function(a){f.onMouseMove(a)}),jQuery(document).mousedown(function(a){f.onMouseDown(a)}),jQuery(document).mouseup(function(a){f.onMouseUp(a)}));a=0<this.runtime.fullscreen_mode?document:this.runtime.canvas;this.runtime.isDirectCanvas?a=window.Canvas:this.runtime.isCocoonJs&&(a=window);"undefined"!==typeof PointerEvent?(a.addEventListener("pointerdown",function(a){f.onPointerStart(a)},!1),
a.addEventListener("pointermove",function(a){f.onPointerMove(a)},!1),a.addEventListener("pointerup",function(a){f.onPointerEnd(a)},!1),a.addEventListener("pointercancel",function(a){f.onPointerEnd(a)},!1)):window.navigator.msPointerEnabled?(a.addEventListener("MSPointerDown",function(a){f.onPointerStart(a)},!1),a.addEventListener("MSPointerMove",function(a){f.onPointerMove(a)},!1),a.addEventListener("MSPointerUp",function(a){f.onPointerEnd(a)},!1),a.addEventListener("MSPointerCancel",function(a){f.onPointerEnd(a)},
!1)):(a.addEventListener("touchstart",function(a){f.onTouchStart(a)},!1),a.addEventListener("touchmove",function(a){f.onTouchMove(a)},!1),a.addEventListener("touchend",function(a){f.onTouchEnd(a)},!1),a.addEventListener("touchcancel",function(a){f.onTouchEnd(a)},!1))};
(function(){function a(a){var b;var c=0;for(b=a.behavior_insts.length;c<b;c++)if(a.behavior_insts[c]instanceof k.Instance)return a.behavior_insts[c];return null}function f(){}function g(){}var k=cr.behaviors.DragnDrop.prototype,e={left:0,top:0};k.onMouseDown=function(a){if(1===a.which)this.onInputDown("leftmouse",a.pageX,a.pageY)};k.onMouseMove=function(a){if(1===a.which)this.onInputMove("leftmouse",a.pageX,a.pageY)};k.onMouseUp=function(a){if(1===a.which)this.onInputUp("leftmouse")};k.onTouchStart=
function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b;var c=0;for(b=a.changedTouches.length;c<b;c++){var d=a.changedTouches[c];var e=d.identifier;this.onInputDown(e?e.toString():"<none>",d.pageX,d.pageY)}};k.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b;var c=0;for(b=a.changedTouches.length;c<b;c++){var d=a.changedTouches[c];var e=d.identifier;this.onInputMove(e?e.toString():"<none>",d.pageX,d.pageY)}};k.onTouchEnd=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&
a.preventDefault();var b;var c=0;for(b=a.changedTouches.length;c<b;c++){var d=a.changedTouches[c];d=d.identifier;this.onInputUp(d?d.toString():"<none>")}};k.onPointerStart=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),this.onInputDown(a.pointerId.toString(),a.pageX,a.pageY))};k.onPointerMove=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&a.preventDefault(),
this.onInputMove(a.pointerId.toString(),a.pageX,a.pageY))};k.onPointerEnd=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),this.onInputUp(a.pointerId.toString()))};k.onInputDown=function(c,b,f){var d=this.runtime.isDomFree?e:jQuery(this.runtime.canvas).offset();b-=d.left;f-=d.top;d=this.my_instances.valuesRef();var g,h=null;var k=0;for(g=d.length;k<g;k++){var l=d[k];var v=a(l);if(v.enabled&&!v.dragging){v=
l.layer.canvasToLayer(b,f,!0);var u=l.layer.canvasToLayer(b,f,!1);l.update_bbox();if(l.contains_pt(v,u))if(h)l.layer.index>h.layer.index?(h=l,y=v,z=u):l.layer.index===h.layer.index&&l.get_zindex()>h.get_zindex()&&(h=l,y=v,z=u);else{h=l;var y=v;var z=u}}}if(h)a(h).onDown(c,y,z)};k.onInputMove=function(c,b,f){var d=this.runtime.isDomFree?e:jQuery(this.runtime.canvas).offset();b-=d.left;f-=d.top;var g=this.my_instances.valuesRef(),h;var k=0;for(h=g.length;k<h;k++){var l=g[k];var v=a(l);!v.enabled||!v.dragging||
v.dragging&&v.dragsource!==c||(d=l.layer.canvasToLayer(b,f,!0),l=l.layer.canvasToLayer(b,f,!1),v.onMove(d,l))}};k.onInputUp=function(c){var b=this.my_instances.valuesRef(),d;var e=0;for(d=b.length;e<d;e++){var f=b[e];f=a(f);if(f.dragging&&f.dragsource===c)f.onUp()}};k.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};var c=k.Instance.prototype;
c.onCreate=function(){this.dragging=!1;this.dy=this.dx=0;this.dragsource="<none>";this.axes=this.properties[0];this.enabled=0!==this.properties[1]};c.saveToJSON=function(){return{enabled:this.enabled}};c.loadFromJSON=function(a){this.enabled=a.enabled;this.dragging=!1};c.onDown=function(a,b,c){this.dx=b-this.inst.x;this.dy=c-this.inst.y;this.dragging=!0;this.dragsource=a;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDragStart,this.inst);this.runtime.isInUserInputEvent=
!1};c.onMove=function(a,b){a-=this.dx;b-=this.dy;if(0===this.axes){if(this.inst.x!==a||this.inst.y!==b)this.inst.x=a,this.inst.y=b,this.inst.set_bbox_changed()}else 1===this.axes?this.inst.x!==a&&(this.inst.x=a,this.inst.set_bbox_changed()):2===this.axes&&this.inst.y!==b&&(this.inst.y=b,this.inst.set_bbox_changed())};c.onUp=function(){this.dragging=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDrop,this.inst);this.runtime.isInUserInputEvent=!1};
c.tick=function(){};f.prototype.IsDragging=function(){return this.dragging};f.prototype.OnDragStart=function(){return!0};f.prototype.OnDrop=function(){return!0};f.prototype.IsEnabled=function(){return!!this.enabled};k.cnds=new f;g.prototype.SetEnabled=function(a){this.enabled=0!==a;this.enabled||(this.dragging=!1)};g.prototype.Drop=function(){if(this.dragging)this.onUp()};k.acts=new g;k.exps=new function(){}})();cr.behaviors.Fade=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Fade.prototype;k.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.activeAtStart=1===this.properties[0];this.setMaxOpacity=!1;this.fadeInTime=this.properties[1];this.waitTime=this.properties[2];this.fadeOutTime=this.properties[3];
this.destroy=this.properties[4];this.stage=this.activeAtStart?0:3;this.recycled?this.stageTime.reset():this.stageTime=new cr.KahanAdder;this.maxOpacity=this.inst.opacity?this.inst.opacity:1;this.activeAtStart&&(0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0))};e.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}};e.loadFromJSON=function(a){this.fadeInTime=
a.fit;this.waitTime=a.wt;this.fadeOutTime=a.fot;this.stage=a.s;this.stageTime.reset();this.stageTime.sum=a.st;this.maxOpacity=a.mo};e.tick=function(){this.stageTime.add(this.runtime.getDt(this.inst));0===this.stage&&(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity&&(this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeInEnd,this.inst)));1===this.stage&&
this.stageTime.sum>=this.waitTime&&(this.stage=2,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnWaitEnd,this.inst));2===this.stage&&0!==this.fadeOutTime&&(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,0>this.inst.opacity&&(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),1===this.destroy&&this.runtime.DestroyInstance(this.inst)))};
e.doStart=function(){this.stage=0;this.stageTime.reset();0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0)};a.prototype.OnFadeOutEnd=function(){return!0};a.prototype.OnFadeInEnd=function(){return!0};a.prototype.OnWaitEnd=function(){return!0};k.cnds=new a;f.prototype.StartFade=function(){this.activeAtStart||this.setMaxOpacity||(this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.setMaxOpacity=!0);3===this.stage&&this.doStart()};
f.prototype.RestartFade=function(){this.doStart()};f.prototype.SetFadeInTime=function(a){0>a&&(a=0);this.fadeInTime=a};f.prototype.SetWaitTime=function(a){0>a&&(a=0);this.waitTime=a};f.prototype.SetFadeOutTime=function(a){0>a&&(a=0);this.fadeOutTime=a};k.acts=new f;g.prototype.FadeInTime=function(a){a.set_float(this.fadeInTime)};g.prototype.WaitTime=function(a){a.set_float(this.waitTime)};g.prototype.FadeOutTime=function(a){a.set_float(this.fadeOutTime)};k.exps=new g})();
cr.behaviors.Flash=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.behaviors.Flash.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.timeleft=this.stagetimeleft=this.stage=this.offtime=this.ontime=0};k.saveToJSON=function(){return{ontime:this.ontime,offtime:this.offtime,stage:this.stage,stagetimeleft:this.stagetimeleft,
timeleft:this.timeleft}};k.loadFromJSON=function(a){this.ontime=a.ontime;this.offtime=a.offtime;this.stage=a.stage;this.stagetimeleft=a.stagetimeleft;this.timeleft=a.timeleft;null===this.timeleft&&(this.timeleft=Infinity)};k.tick=function(){if(!(0>=this.timeleft)){var a=this.runtime.getDt(this.inst);this.timeleft-=a;0>=this.timeleft?(this.timeleft=0,this.inst.visible=!0,this.runtime.redraw=!0,this.runtime.trigger(cr.behaviors.Flash.prototype.cnds.OnFlashEnded,this.inst)):(this.stagetimeleft-=a,0>=
this.stagetimeleft&&(0===this.stage?(this.inst.visible=!1,this.stage=1,this.stagetimeleft+=this.offtime):(this.inst.visible=!0,this.stage=0,this.stagetimeleft+=this.ontime),this.runtime.redraw=!0))}};a.prototype.IsFlashing=function(){return 0<this.timeleft};a.prototype.OnFlashEnded=function(){return!0};g.cnds=new a;f.prototype.Flash=function(a,c,d){this.ontime=a;this.offtime=c;this.stage=1;this.stagetimeleft=c;this.timeleft=d;this.inst.visible=!1;this.runtime.redraw=!0};f.prototype.StopFlashing=function(){this.timeleft=
0;this.inst.visible=!0;this.runtime.redraw=!0};g.acts=new f;g.exps=new function(){}})();cr.behaviors.Pin=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Pin.prototype;k.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.pinObject=null;this.pinObjectUid=-1;this.mode=this.lastKnownAngle=this.theirStartAngle=this.myStartAngle=this.pinDist=this.pinAngle=0;var a=this;this.recycled||
(this.myDestroyCallback=function(c){a.onInstanceDestroyed(c)});this.runtime.addDestroyCallback(this.myDestroyCallback)};e.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,pa:this.pinAngle,pd:this.pinDist,msa:this.myStartAngle,tsa:this.theirStartAngle,lka:this.lastKnownAngle,m:this.mode}};e.loadFromJSON=function(a){this.pinObjectUid=a.uid;this.pinAngle=a.pa;this.pinDist=a.pd;this.myStartAngle=a.msa;this.theirStartAngle=a.tsa;this.lastKnownAngle=a.lka;this.mode=a.m};e.afterLoad=
function(){this.pinObject=-1===this.pinObjectUid?null:this.runtime.getObjectByUID(this.pinObjectUid);this.pinObjectUid=-1};e.onInstanceDestroyed=function(a){this.pinObject==a&&(this.pinObject=null)};e.onDestroy=function(){this.pinObject=null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};e.tick=function(){};e.tick2=function(){if(this.pinObject){this.lastKnownAngle!==this.inst.angle&&(this.myStartAngle=cr.clamp_angle(this.myStartAngle+(this.inst.angle-this.lastKnownAngle)));var a=this.inst.x,
d=this.inst.y;if(3===this.mode||4===this.mode){var b=cr.distanceTo(this.inst.x,this.inst.y,this.pinObject.x,this.pinObject.y);if(b>this.pinDist||4===this.mode&&b<this.pinDist)d=cr.angleTo(this.pinObject.x,this.pinObject.y,this.inst.x,this.inst.y),a=this.pinObject.x+Math.cos(d)*this.pinDist,d=this.pinObject.y+Math.sin(d)*this.pinDist}else a=this.pinObject.x+Math.cos(this.pinObject.angle+this.pinAngle)*this.pinDist,d=this.pinObject.y+Math.sin(this.pinObject.angle+this.pinAngle)*this.pinDist;this.lastKnownAngle=
b=cr.clamp_angle(this.myStartAngle+(this.pinObject.angle-this.theirStartAngle));0!==this.mode&&1!==this.mode&&3!==this.mode&&4!==this.mode||this.inst.x===a&&this.inst.y===d||(this.inst.x=a,this.inst.y=d,this.inst.set_bbox_changed());0!==this.mode&&2!==this.mode||this.inst.angle===b||(this.inst.angle=b,this.inst.set_bbox_changed())}};a.prototype.IsPinned=function(){return!!this.pinObject};k.cnds=new a;f.prototype.Pin=function(a,d){a&&(a=a.getFirstPicked(this.inst))&&(this.pinObject=a,this.pinAngle=
cr.angleTo(a.x,a.y,this.inst.x,this.inst.y)-a.angle,this.pinDist=cr.distanceTo(a.x,a.y,this.inst.x,this.inst.y),this.lastKnownAngle=this.myStartAngle=this.inst.angle,this.theirStartAngle=a.angle,this.mode=d)};f.prototype.Unpin=function(){this.pinObject=null};k.acts=new f;g.prototype.PinnedUID=function(a){a.set_int(this.pinObject?this.pinObject.uid:-1)};k.exps=new g})();cr.behaviors.Rex_CanvasExt=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Rex_CanvasExt.prototype;k.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){var a=this.properties[0];1===a&&(this.my_saveToJSON=this.zlib_saveToJSON,this.my_loadFromJSON=this.zlib_loadFromJSON);0!==a&&(this.inst.saveToJSON=
this.my_saveToJSON,this.inst.loadFromJSON=this.my_loadFromJSON)};e.tick=function(){};e.zlib_saveToJSON=function(){var a=this.canvas.width,d=this.canvas.height,b=this.ctx.getImageData(0,0,a,d).data;b=window.RexC2ZlibU8Arr.u8a2String(b);return{w:a,h:d,d:b}};e.zlib_loadFromJSON=function(a){this.canvas.width=a.w;this.canvas.height=a.h;var c=window.RexC2ZlibU8Arr.string2u8a(a.d);a=this.ctx.createImageData(a.w,a.h);var b=a.data,e,f=b.length;for(e=0;e<f;e++)b[e]=c[e];this.ctx.putImageData(a,0,0);this.update_tex=
!0};e.draw_instances=function(a,d,b){var c=d.ctx,e=d.canvas,f,g=a.length;for(f=0;f<g;f++){var k=a[f];if(0!=k.visible||0!=this.runtime.testOverlap(d,k)){c.save();c.scale(e.width/d.width,e.height/d.height);c.rotate(-d.angle);c.translate(-d.bquad.tlx,-d.bquad.tly);var p=k.compositeOp;k.compositeOp=b;c.globalCompositeOperation=b;k.draw(c);k.compositeOp=p;c.restore()}}};k.cnds=new a;a.prototype.OnURLLoaded=function(){return!0};k.acts=new f;f.prototype.JSONLoad=function(a){try{var c=JSON.parse(a)}catch(b){return}this.my_loadFromJSON.call(this.inst,
c);this.inst.runtime.redraw=!0;this.inst.update_tex=!0};f.prototype.EraseObject=function(a){var c=this.inst;this.inst.update_bbox();a=a.getCurrentSol();this.draw_instances(a.select_all?a.type.instances:a.instances,c,"destination-out");this.inst.runtime.redraw=!0;this.inst.update_tex=!0};f.prototype.LoadURL=function(a,d,b){var c=new Image,e=this;c.onload=function(){var a=e.inst,b=!1;if(0===d&&(a.width!=c.width||a.height!=c.height))a.width=c.width,a.height=c.height,b=!0;else if(2===d){var f=a.width/
c.width,g=a.height/c.height;if(1<f&&1<g)a.width=c.width,a.height=c.height,b=!0;else if(1>f||1>g)b=f<g?f:g,a.width=c.width*b,a.height=c.height*b,b=!0}b&&(a.set_bbox_changed(),a.canvas.width=a.width,a.canvas.height=a.height);b=a.canvas;c.width!==b.width&&(b.width=c.width);c.height!==b.height&&(b.height=c.height);a.ctx.clearRect(0,0,c.width,c.height);a.ctx.drawImage(c,0,0,c.width,c.height);e.runtime.redraw=!0;a.update_tex=!0;e.runtime.trigger(cr.behaviors.Rex_CanvasExt.prototype.cnds.OnURLLoaded,a)};
"data:"!==a.substr(0,5)&&0===b&&(c.crossOrigin="anonymous");this.runtime.setImageSrc(c,a)};f.prototype.Eval=function(a){a=eval("(function(ctx){"+a+"})");var c=this.inst;a(c.ctx);c.runtime.redraw=!0;c.update_tex=!0};f.prototype.SetShadow=function(a,d,b,e){var c=this.inst.ctx;c.shadowOffsetX=a;c.shadowOffsetY=d;c.shadowBlur=b;c.shadowColor=e};k.exps=new g;g.prototype.AsJSON=function(a){var c=this.my_saveToJSON.call(this.inst);a.set_string(JSON.stringify(c))}})();
(function(){if(null==window.RexC2ZlibU8Arr){window.RexC2ZlibU8Arr={};var a=[];window.RexC2ZlibU8Arr.u8a2String=function(f){f=(new window.Zlib.Deflate(f)).compress();for(var g=0;g<f.length;g+=32768)a.push(String.fromCharCode.apply(null,f.subarray(g,g+32768)));f=a.join("");f=btoa(f);a.length=0;return f};window.RexC2ZlibU8Arr.string2u8a=function(a){a=atob(a);a=a.split("").map(function(a){return a.charCodeAt(0)});return(new window.Zlib.Inflate(a)).decompress()}}})();
cr.behaviors.Rex_DragDrop2=function(a){this.runtime=a};
(function(){function a(a){var b;var c=0;for(b=a.behavior_insts.length;c<b;c++)if(a.behavior_insts[c]instanceof e.Instance)return a.behavior_insts[c];return null}function f(){}function g(){}function k(){}var e=cr.behaviors.Rex_DragDrop2.prototype;e.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime;this.touchwrap=null};e.TouchWrapGet=function(){if(null!=this.touchwrap)return this.touchwrap;var a=this.runtime.types,b;for(b in a){var c=a[b].instances[0];if(c instanceof cr.plugins_.rex_TouchWrap.prototype.Instance)return this.touchwrap=
c,this.touchwrap.HookMe(this),this.touchwrap}};e.OnTouchStart=function(a,b,c){this.DragDetecting(b,c,a)};e.OnTouchEnd=function(b){var c=this.my_instances.valuesRef(),d,e=c.length,f;for(d=0;d<e;d++)if(f=c[d])f=a(f),null!=f&&f.drag_info.touch_src==b&&f.drag_info.is_on_dragged&&f.DragSrcSet(null)};var c=[];e.DragDetecting=function(b,d,e){var f=this.my_instances.valuesRef(),g,h=f.length,k;for(g=c.length=0;g<h;g++)if(k=f[g]){var l=a(k);if(null!=l&&l.enabled&&!l.drag_info.is_on_dragged){var m=k.layer.canvasToLayer(b,
d,!0);var n=k.layer.canvasToLayer(b,d,!1);k.update_bbox();k.contains_pt(m,n)&&c.push(l)}}h=c.length;if(0==h)return!1;b=c[0];d=b.inst;for(g=1;g<h;g++)if(l=c[g],f=l.inst,f.layer.index>d.layer.index||f.layer.index==d.layer.index&&f.get_zindex()>d.get_zindex())b=l,d=f;b.DragSrcSet(e);c.length=0;return!0};e.Type.prototype.onCreate=function(){};e.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime;this.behavior.TouchWrapGet()};var d=e.Instance.prototype;d.onCreate=
function(){this.enabled=1===this.properties[0];this.move_axis=this.properties[1];this.setAxisAngle(this.properties[2]);this.recycled||(this.drag_info=new q(this));this.drag_info.init(this)};d.setAxisAngle=function(a){this.axis_angle=a;this.axis_rad=cr.to_clamped_radians(this.axis_angle)};var b={},l={};d.tick=function(){if(this.enabled&&this.drag_info.is_on_dragged){var a=this.inst,c=this.drag_info,d=this.GetTouchX(),e=this.GetTouchY(),f=c.pre_x!=d||c.pre_y!=e;if(f){if(0===this.move_axis){var g=d+
c.drag_dx;var h=e+c.drag_dy}else 0===this.axis_rad?1===this.move_axis?(g=d+c.drag_dx,h=a.y):(g=a.x,h=e+c.drag_dy):(b.x=a.x,b.y=a.y,l.x=d+c.drag_dx,l.y=e+c.drag_dy,n(l,b,-this.axis_rad),1===this.move_axis?l.y=b.y:l.x=b.x,n(l,b,this.axis_rad),g=l.x,h=l.y);a.x=g;a.y=h;a.set_bbox_changed();c.pre_x=d;c.pre_y=e}this.drag_info.IsMovingSet(f)}};var n=function(a,b,c){c=cr.angleTo(b.x,b.y,a.x,a.y)+c;var d=cr.distanceTo(b.x,b.y,a.x,a.y);a.x=b.x+d*Math.cos(c);a.y=b.y+d*Math.sin(c);return a};d.GetTouchX=function(){return-1==
this.drag_info.touch_src?0:this.behavior.TouchWrapGet().XForID(this.drag_info.touch_src,this.inst.layer.index)};d.GetTouchY=function(){return-1==this.drag_info.touch_src?0:this.behavior.TouchWrapGet().YForID(this.drag_info.touch_src,this.inst.layer.index)};d.DragSrcSet=function(a){this.drag_info.DragSrcSet(a)};var q=function(a){},h=q.prototype;h.init=function(a){this.plugin=a;this.touch_src=-1;this.drag_dy=this.drag_dx=this.pre_y=this.pre_x=0;this.is_on_dragged=!1;this.drag_start_y=this.drag_start_x=
0;this.inst_start_x=a.inst.x;this.inst_start_y=a.inst.y;this.is_moving=!1};h.DragSrcSet=function(a){if(null==a)this.is_on_dragged=!1,this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDrop,this.plugin.inst),this.touch_src=-1;else{this.is_on_dragged=!0;this.touch_src=a;a=this.plugin.inst;var b=this.plugin.GetTouchX(),c=this.plugin.GetTouchY();this.drag_dx=a.x-b;this.drag_dy=a.y-c;this.pre_x=b;this.pre_y=c;this.drag_start_x=b;this.drag_start_y=c;this.inst_start_x=a.x;this.inst_start_y=
a.y;this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDragStart,this.plugin.inst)}this.IsMovingSet(!1)};h.ForceDrop=function(){this.is_on_dragged&&(this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDrop,this.plugin.inst),this.is_on_dragged=!1)};h.IsMovingSet=function(a){!this.is_moving&&a?this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDragMoveStart,this.plugin.inst):this.is_moving&&!a&&this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDragMoveEnd,
this.plugin.inst);this.is_moving=a};h.DragDistance=function(){if(!this.is_on_dragged)return 0;var a=this.drag_start_x,b=this.drag_start_y,c=this.plugin.GetTouchX(),d=this.plugin.GetTouchY();return cr.distanceTo(a,b,c,d)};h.DragAngle=function(){if(!this.is_on_dragged)return 0;var a=this.drag_start_x,b=this.drag_start_y,c=this.plugin.GetTouchX(),d=this.plugin.GetTouchY();a=cr.angleTo(a,b,c,d);return a=cr.to_clamped_degrees(a)};d.saveToJSON=function(){return{en:this.enabled,aa:this.axis_angle}};d.loadFromJSON=
function(a){this.enabled=a.en;this.setAxisAngle(a.aa)};e.cnds=new f;f.prototype.OnDragStart=function(){return!0};f.prototype.OnDrop=function(){return!0};f.prototype.IsDragging=function(){return this.drag_info.is_on_dragged};f.prototype.OnDragMoveStart=function(){return!0};f.prototype.OnDragMove=function(){return!0};f.prototype.IsDraggingMoving=function(){return this.drag_info.is_moving};f.prototype.OnDragMoveEnd=function(){return!0};f.prototype.CompareDragDistance=function(a,b){return this.drag_info.is_on_dragged?
cr.do_cmp(this.drag_info.DragDistance(),a,b):!1};f.prototype.CompareDragAngle=function(a,b){return this.drag_info.is_on_dragged?cr.do_cmp(this.drag_info.DragAngle(),a,b):!1};f.prototype.IsEnabled=function(){return this.enabled};e.acts=new g;g.prototype.SetEnabled=function(a){this.enabled=0!==a;this.drag_info.ForceDrop()};g.prototype.ForceDrop=function(){this.drag_info.ForceDrop()};g.prototype.TryDrag=function(){if(!this.drag_info.is_on_dragged){var a=this.behavior.TouchWrapGet();if(a.IsInTouch()){a=
a.touches;var b=a.length,c,d=this.inst;d.update_bbox();for(c=0;c<b;c++){var e=a[c];var f=d.layer.canvasToLayer(e.x,e.y,!0);e=d.layer.canvasToLayer(e.x,e.y,!1);if(d.contains_pt(f,e)){this.DragSrcSet(c);break}}}}};g.prototype.SetAxisAngle=function(a){this.setAxisAngle(a)};e.exps=new k;k.prototype.X=function(a){a.set_float(this.GetTouchX())};k.prototype.Y=function(a){a.set_float(this.GetTouchY())};k.prototype.AbsoluteX=function(a){var b=-1==this.drag_info.touch_src?0:this.behavior.touchwrap.AbsoluteXForID(this.drag_info.touch_src);
a.set_float(b)};k.prototype.AbsoluteY=function(a){var b=-1==this.drag_info.touch_src?0:this.behavior.touchwrap.AbsoluteYForID(this.drag_info.touch_src);a.set_float(b)};k.prototype.Activated=function(a){a.set_int(this.enabled?1:0)};k.prototype.StartX=function(a){a.set_float(this.drag_info.inst_start_x)};k.prototype.StartY=function(a){a.set_float(this.drag_info.inst_start_y)};k.prototype.DragStartX=function(a){a.set_float(this.drag_info.drag_start_x)};k.prototype.DragStartY=function(a){a.set_float(this.drag_info.drag_start_y)};
k.prototype.InstStartX=function(a){a.set_float(this.drag_info.inst_start_x)};k.prototype.InstStartY=function(a){a.set_float(this.drag_info.inst_start_y)};k.prototype.DragDistance=function(a){a.set_float(this.drag_info.DragDistance())};k.prototype.DragAngle=function(a){a.set_float(this.drag_info.DragAngle())};k.prototype.AxisAngle=function(a){a.set_float(this.axis_angle)}})();cr.behaviors.Rex_MoveTo=function(a){this.runtime=a};
(function(){function a(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function f(){}function g(){}function k(){}var e=cr.behaviors.Rex_MoveTo.prototype;e.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var c=e.Instance.prototype;c.onCreate=function(){this.enabled=1===
this.properties[0];this.recycled||(this.moveParams={});this.moveParams.max=this.properties[1];this.moveParams.acc=this.properties[2];this.moveParams.dec=this.properties[3];this.soildStopEnable=1===this.properties[4];this.isContinueMode=1===this.properties[5];this.recycled||(this.target={x:0,y:0,a:0});this.isMoving=!1;this.remainDt=this.remainDistance=this.currentSpeed=0;this.recycled||(this.prePosition={x:0,y:0});this.prePosition.x=0;this.prePosition.y=0;this.movingAngleData=d(this.movingAngleData);
this.movingAngleStartData=d(this.movingAngleStartData);this.lastTick=null;this.isMyCall=!1};var d=function(a){null==a&&(a={});a.x=0;a.y=0;a.a=-1;return a};c.tick=function(){this.remainDt=0;if(this.enabled&&this.isMoving){var a=this.runtime.getDt(this.inst);this.move(a)}};c.move=function(a){if(0!=a){this.prePosition.x===this.inst.x&&this.prePosition.y===this.inst.y||this.resetCurrentPosition();var b=!1;0!=this.moveParams.dec&&(b=this.currentSpeed*this.currentSpeed/(2*this.moveParams.dec)>=this.remainDistance);
b=b?-this.moveParams.dec:this.moveParams.acc;0!=b&&this.setCurrentSpeed(this.currentSpeed+b*a);a*=this.currentSpeed;this.remainDistance-=a;b=!1;var c=this.target.a,d=Math.cos(c);c=Math.sin(c);0>=this.remainDistance||0>=this.currentSpeed?(b=!0,this.inst.x=this.target.x,this.inst.y=this.target.y,0<this.currentSpeed&&(this.remainDt=-this.remainDistance/this.currentSpeed),this.getMovingAngle(),this.setCurrentSpeed(0),this.remainDistance=0):(this.inst.x+=a*d,this.inst.y+=a*c);this.inst.set_bbox_changed();
var e=!1;if(this.soildStopEnable){var f=this.runtime.testOverlapSolid(this.inst);f&&(this.runtime.registerCollision(this.inst,f),this.runtime.pushOutSolid(this.inst,-d,-c,Math.max(a,50)),e=!0)}this.prePosition.x=this.inst.x;this.prePosition.y=this.inst.y;e?(this.isMoving=!1,this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_MoveTo.prototype.cnds.OnSolidStop,this.inst),this.isMyCall=!1):b&&(this.isMoving=!1,this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_MoveTo.prototype.cnds.OnHitTarget,
this.inst),this.isMyCall=!1)}};c.tick2=function(){this.movingAngleData.x=this.inst.x;this.movingAngleData.y=this.inst.y};c.setCurrentSpeed=function(a){null!=a?this.currentSpeed=a>this.moveParams.max?this.moveParams.max:a:0==this.moveParams.acc&&(this.currentSpeed=this.moveParams.max)};c.resetCurrentPosition=function(){var a=this.target.x-this.inst.x,c=this.target.y-this.inst.y;this.target.a=Math.atan2(c,a);this.remainDistance=Math.sqrt(a*a+c*c);this.prePosition.x=this.inst.x;this.prePosition.y=this.inst.y};
c.setTargetPos=function(a,c){this.target.x=a;this.target.y=c;this.setCurrentSpeed(null);this.resetCurrentPosition();this.movingAngleData.x=this.inst.x;this.movingAngleData.y=this.inst.y;this.isMoving=!0;this.movingAngleStartData.x=this.inst.x;this.movingAngleStartData.y=this.inst.y;this.movingAngleStartData.a=cr.to_clamped_degrees(cr.angleTo(this.inst.x,this.inst.y,a,c));this.isContinueMode&&this.move(this.remainDt)};c.isTickChanged=function(){var a=this.runtime.tickcount,c=this.lastTick!=a;this.lastTick=
a;return c};c.getMovingAngle=function(a){if(this.isTickChanged()){a=this.inst.x-this.movingAngleData.x;var b=this.inst.y-this.movingAngleData.y;if(0!=a||0!=b)this.movingAngleData.a=cr.to_clamped_degrees(Math.atan2(b,a))}return this.movingAngleData.a};c.saveToJSON=function(){return{en:this.enabled,v:a(this.moveParams),t:a(this.target),is_m:this.isMoving,c_spd:this.currentSpeed,rd:this.remainDistance,pp:a(this.prePosition),ma:a(this.movingAngleData),ms:a(this.movingAngleStartData),lt:this.lastTick}};
c.loadFromJSON=function(a){this.enabled=a.en;this.moveParams=a.v;this.target=a.t;this.isMoving=a.is_m;this.currentSpeed=a.c_spd;this.remainDistance=a.rd;this.prePosition=a.pp;this.movingAngleData=a.ma;this.movingAngleStartData=a.ms;this.lastTick=a.lt};e.cnds=new f;f.prototype.OnHitTarget=function(){return this.isMyCall};f.prototype.CompareSpeed=function(a,c){return cr.do_cmp(this.currentSpeed,a,c)};f.prototype.OnMoving=function(){return!1};f.prototype.IsMoving=function(){return this.enabled&&this.isMoving};
f.prototype.CompareMovingAngle=function(a,c){return-1!=this.getMovingAngle()?cr.do_cmp(this.getMovingAngle(),a,c):!1};f.prototype.OnSolidStop=function(){return this.isMyCall};e.acts=new g;g.prototype.SetEnabled=function(a){this.enabled=1===a};g.prototype.SetMaxSpeed=function(a){this.moveParams.max=a;this.setCurrentSpeed(null)};g.prototype.SetAcceleration=function(a){this.moveParams.acc=a;this.setCurrentSpeed(null)};g.prototype.SetDeceleration=function(a){this.moveParams.dec=a};g.prototype.SetTargetPos=
function(a,c){this.setTargetPos(a,c)};g.prototype.SetCurrentSpeed=function(a){this.setCurrentSpeed(a)};g.prototype.SetTargetPosOnObject=function(a){a&&(a=a.getFirstPicked(),null!=a&&this.setTargetPos(a.x,a.y))};g.prototype.SetTargetPosByDeltaXY=function(a,c){this.setTargetPos(this.inst.x+a,this.inst.y+c)};g.prototype.SetTargetPosByDistanceAngle=function(a,c){c=cr.to_clamped_radians(c);this.setTargetPos(this.inst.x+a*Math.cos(c),this.inst.y+a*Math.sin(c))};g.prototype.Stop=function(){this.isMoving=
!1};g.prototype.SetTargetPosOnUID=function(a){a=this.runtime.getObjectByUID(a);null!=a&&this.setTargetPos(a.x,a.y)};g.prototype.SetStopBySolid=function(a){this.soildStopEnable=1===a};e.exps=new k;k.prototype.Activated=function(a){a.set_int(this.enabled?1:0)};k.prototype.Speed=function(a){a.set_float(this.currentSpeed)};k.prototype.MaxSpeed=function(a){a.set_float(this.moveParams.max)};k.prototype.Acc=function(a){a.set_float(this.moveParams.acc)};k.prototype.Dec=function(a){a.set_float(this.moveParams.dec)};
k.prototype.TargetX=function(a){a.set_float(this.target.x)};k.prototype.TargetY=function(a){a.set_float(this.target.y)};k.prototype.MovingAngle=function(a){a.set_float(this.getMovingAngle())};k.prototype.MovingAngleStart=function(a){a.set_float(this.movingAngleStartData.a)}})();cr.behaviors.Rex_Rotate=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Rex_Rotate.prototype;k.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.enable=1==this.properties[0];this.direction=this.properties[1];this.speed=this.properties[2];this.acc=this.properties[3]};e.tick=function(){if(this.enable){var a=
this.runtime.getDt(this.inst);this.speed+=this.acc*a;0!=this.speed&&(a*=this.speed,0==this.direction&&(a=-a),this.inst.angle+=cr.to_clamped_radians(a),this.inst.set_bbox_changed())}};e.saveToJSON=function(){return{en:this.enable,d:this.direction,s:this.speed,a:this.acc}};e.loadFromJSON=function(a){this.enable=a.en;this.direction=a.d;this.speed=a.s;this.acc=a.a};k.cnds=new a;a.prototype.CompareSpeed=function(a,d){return cr.do_cmp(this.speed,a,d)};k.acts=new f;f.prototype.SetActivated=function(a){this.enable=
1==a};f.prototype.SetDirection=function(a){this.direction=a};f.prototype.SetSpeed=function(a){this.speed=a};f.prototype.SetAcceleration=function(a){this.acc=a};k.exps=new g;g.prototype.Speed=function(a){a.set_float(this.speed)};g.prototype.Acceleration=function(a){a.set_float(this.acc)};g.prototype.Activated=function(a){a.set_int(this.enable?1:0)}})();cr.behaviors.Rex_TouchArea2=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Rex_TouchArea2.prototype;k.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};var e=k.Type.prototype;e.onCreate=function(){this.touchwrap=null};e.TouchWrapGet=function(){if(null==this.touchwrap){var a=this.runtime.types,d;for(d in a){var b=a[d].instances[0];if(null!=b&&"TOUCHWRAP"==b.check_name){this.touchwrap=b;break}}}};k.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=
a.runtime;a.TouchWrapGet()};e=k.Instance.prototype;e.onCreate=function(){this.enabled=1===this.properties[0];this.is_touched=!1;this.cur_touchY=this.cur_touchX=-1;this.delta_touchY=this.delta_touchX=0;this._distance=this._vectorY=this._vectorX=this.start_touchY=this.start_touchX=-1};e.tick=function(){if(this.enabled){var a=this.type.touchwrap,d=a.touches,b=d.length,e=!1,f=this.inst;f.update_bbox();var g=this.cur_touchX,h=this.cur_touchY;if(a.IsInTouch())for(a=0;a<b;a++){var k=d[a];var p=f.layer.canvasToLayer(k.x,
k.y,!0);k=f.layer.canvasToLayer(k.x,k.y,!1);if(f.contains_pt(p,k)){this.cur_touchX=p;this.cur_touchY=k;e=!0;break}}this._distance=this._vectorY=this._vectorX=-1;d=this.is_touched;this.is_touched=e;d&&e?(this.delta_touchX=this.cur_touchX-g,this.delta_touchY=this.cur_touchY-h):this.delta_touchY=this.delta_touchX=0;!d&&e&&(this.start_touchX=this.cur_touchX,this.start_touchY=this.cur_touchY,this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchStart,f));g==this.cur_touchX&&h==this.cur_touchY||
this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchMoving,f);d&&!e&&this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchEnd,f)}};e._dist_get=function(){-1==this._distance&&(this._distance=cr.distanceTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY));return this._distance};e._unit_vecXY_get=function(){if(-1==this._vectorX&&-1==this._vectorY)if(this.start_touchX==this.cur_touchX&&this.start_touchY==this.cur_touchY)this._vectorY=this._vectorX=
0;else{var a=cr.angleTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY);this._vectorX=Math.cos(a);this._vectorY=Math.sin(a)}};e._currx_get=function(){return this.is_touched?this.cur_touchX:-1};e._curry_get=function(){return this.is_touched?this.cur_touchY:-1};e._startx_get=function(){return this.is_touched?this.start_touchX:-1};e._starty_get=function(){return this.is_touched?this.start_touchY:-1};e._distance_get=function(){return this.is_touched?this._dist_get():-1};e._angle_get=
function(){if(this.is_touched){var a=cr.angleTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY);a=cr.to_clamped_degrees(a)}else a=-1;return a};e._vectorx_get=function(){if(this.is_touched){this._unit_vecXY_get();var a=this._vectorX}else a=0;return a};e._vectory_get=function(){if(this.is_touched){this._unit_vecXY_get();var a=this._vectorY}else a=0;return a};k.cnds=new a;a.prototype.OnTouchStart=function(){return!0};a.prototype.OnTouchEnd=function(){return!0};a.prototype.IsInTouch=
function(){return this.is_touched};a.prototype.OnTouchMoving=function(){return!0};a.prototype.CompareDragDistance=function(a,d){return this.is_touched?cr.do_cmp(this._distance_get(),a,d):!1};a.prototype.CompareDragAngle=function(a,d){return this.is_touched?cr.do_cmp(this._angle_get(),a,d):!1};k.acts=new f;f.prototype.SetEnabled=function(a){this.enabled=0!==a};k.exps=new g;g.prototype.X=function(a){a.set_float(this._currx_get())};g.prototype.Y=function(a){a.set_float(this._curry_get())};g.prototype.StartX=
function(a){a.set_float(this._startx_get())};g.prototype.StartY=function(a){a.set_float(this._starty_get())};g.prototype.Distance=function(a){a.set_float(this._distance_get())};g.prototype.Angle=function(a){a.set_float(this._angle_get())};g.prototype.VectorX=function(a){a.set_float(this._vectorx_get())};g.prototype.VectorY=function(a){a.set_float(this._vectory_get())};g.prototype.DeltaX=function(a){a.set_float(this.delta_touchX)};g.prototype.DeltaY=function(a){a.set_float(this.delta_touchY)}})();
cr.behaviors.Rex_layouter_text=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.behaviors.Rex_layouter_text.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.check_name="LAYOUTER";this.content="";this.charObjectSID=-1;this.char2frameindex={};this.setChar2FrameIndex(this.properties[0]);this.spriteObjType=
null;this.spriteIndex=0};k.setChar2FrameIndex=function(a){for(var c in this.char2frameindex)delete this.char2frameindex[c];var d,b=a.length;for(d=0;d<b;d++)c=a.charAt(d),this.char2frameindex[c]=d};k.tick=function(){};k.getCharObject=function(){null==this.spriteObjType&&(this.spriteObjType=this.runtime.getObjectTypeBySid(this.charObjectSID));return this.spriteObjType};k.getSpriteInst=function(){for(var a=null,c=this.inst.sprites,d=c.length;this.spriteIndex<d&&!(a=this.runtime.getObjectByUID(c[this.spriteIndex]),
this.spriteIndex+=1,a instanceof cr.plugins_.Sprite.prototype.Instance);)a=null;return a};k.setText=function(a){var c=this.getCharObject();if(c){this.content=a;var d=cr.plugins_.Sprite.prototype.acts.SetAnimFrame,b=cr.plugins_.Sprite.prototype.acts.SetAnimSpeed,e,f=a.length;this.spriteIndex=0;var g=[],h=null;for(e=0;e<f;e++){var k=this.getSpriteInst();null==k&&(k=this.inst.createInstance(c,0,0),g.push(k),h=0);var p=a.charAt(e);p=this.char2frameindex[p];null==p&&(p=-1);k.cur_frame!=p&&d.call(k,p);
0!=k.cur_anim_speed&&b.call(k,0)}if(null==h){for(k=this.getSpriteInst();null!=k;)g.push(k),k=this.getSpriteInst();0<g.length&&(h=1)}0==h?this.inst.addInsts(g):1==h&&this.inst.destroy_insts(g)}};k.saveToJSON=function(){return{t:this.content,csid:this.charObjectSID,c2fi:this.char2frameindex}};k.loadFromJSON=function(a){this.content=a.t;this.charObjectSID=a.csid;this.char2frameindex=a.c2fi};g.cnds=new function(){};g.acts=new a;a.prototype.SetCharacterObject=function(a){a&&(this.spriteObjType=a,this.charObjectSID=
a.sid)};a.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.content!==a&&this.setText(a)};g.exps=new f;f.prototype.Value=function(a){a.set_float(this.value)}})();cr.behaviors.Rex_pinOffsetXY=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Rex_pinOffsetXY.prototype;k.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var e=k.Instance.prototype;e.onCreate=function(){this.pinObject=null;this.pinObjectUid=-1;this.pinOffsetY=this.pinOffsetX=0;var a=this;this.recycled||(this.myDestroyCallback=function(c){a.onInstanceDestroyed(c)});
this.runtime.addDestroyCallback(this.myDestroyCallback)};e.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,offx:this.pinOffsetX,offy:this.pinOffsetY}};e.loadFromJSON=function(a){this.pinObjectUid=a.uid;this.pinOffsetX=a.offx;this.pinOffsetY=a.offy};e.afterLoad=function(){this.pinObject=-1===this.pinObjectUid?null:this.runtime.getObjectByUID(this.pinObjectUid);this.pinObjectUid=-1};e.onInstanceDestroyed=function(a){this.pinObject==a&&(this.pinObject=null)};e.onDestroy=function(){this.pinObject=
null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};e.tick=function(){};e.tick2=function(){if(this.pinObject){var a=this.pinObject.x+this.pinOffsetX,d=this.pinObject.y+this.pinOffsetY;if(this.inst.x!==a||this.inst.y!==d)this.inst.x=a,this.inst.y=d,this.inst.set_bbox_changed()}};k.cnds=new a;a.prototype.IsPinned=function(){return!!this.pinObject};k.acts=new f;f.prototype.Pin=function(a,d,b){a&&(a=a.getFirstPicked(this.inst))&&(null==d&&(d=this.inst.x-a.x),null==b&&(b=this.inst.y-a.y),
this.pinObject=a,this.pinOffsetX=d,this.pinOffsetY=b)};f.prototype.Unpin=function(){this.pinObject=null};k.exps=new g;g.prototype.PinnedUID=function(a){a.set_int(this.pinObject?this.pinObject.uid:-1)}})();cr.behaviors.Rex_text_properties=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.behaviors.Rex_text_properties.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.text_type=this.get_text_type()};k.tick=function(){};k.get_text_type=function(){return cr.plugins_.Text&&this.inst instanceof cr.plugins_.Text.prototype.Instance?
"Text":cr.plugins_.Spritefont2&&this.inst instanceof cr.plugins_.Spritefont2.prototype.Instance?"Spritefont2":cr.plugins_.TextBox&&this.inst instanceof cr.plugins_.TextBox.prototype.Instance?"TextBox":cr.plugins_.rex_TagText&&this.inst instanceof cr.plugins_.rex_TagText.prototype.Instance?"rex_TagText":cr.plugins_.rex_bbcodeText&&this.inst instanceof cr.plugins_.rex_bbcodeText.prototype.Instance?"rex_bbcodeText":""};k._get_webgl_ctx=function(){var a=this.inst,c=a.myctx;if(!c){a.mycanvas=document.createElement("canvas");
c=Math.ceil(a.layer.getScale()*a.width);var d=Math.ceil(a.layer.getAngle()*a.height);a.mycanvas.width=c;a.mycanvas.height=d;a.lastwidth=c;a.lastheight=d;a.myctx=a.mycanvas.getContext("2d");c=a.myctx}return c};k.drawText=function(){var a=this.inst,c=this.runtime.enableWebGL?this._get_webgl_ctx():this.runtime.ctx;a.draw(c)};g.cnds=new function(){};g.acts=new a;a.prototype.SetHorizontalAlignment=function(a){"Spritefont2"===this.text_type?cr.plugins_.Spritefont2.prototype.acts.SetHAlign.call(this.inst,
a):(this.inst.halign!=a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0),this.inst.halign=a)};a.prototype.SetVerticalAlignment=function(a){"Spritefont2"===this.text_type?cr.plugins_.Spritefont2.prototype.acts.SetVAlign.call(this.inst,a):(this.inst.valign!=a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0),this.inst.valign=a)};a.prototype.SetWrapping=function(a){a=0===a;"Spritefont2"===this.text_type?this.inst.wrapbyword!=a&&(this.inst.text_changed=!0,this.runtime.redraw=!0):this.inst.wrapbyword!=
a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0);this.inst.wrapbyword=a};a.prototype.SetLineHeight=function(a){"Spritefont2"===this.text_type?cr.plugins_.Spritefont2.prototype.acts.SetLineHeight.call(this.inst,a):(this.inst.line_height_offset!=a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0),this.inst.line_height_offset=a)};a.prototype.SetFontFace=function(a,c){if("Spritefont2"!==this.text_type){var d="";switch(c){case 1:d="bold";break;case 2:d="italic";break;case 3:d="bold italic"}c=
this.inst;if(a!==c.facename||d!==c.fontstyle)c.facename=a,c.fontstyle=d,c.updateFont()}};g.exps=new f;f.prototype.LineBreakContent=function(a){this.drawText();if("Text"===this.text_type||"Spritefont2"===this.text_type)var c=this.inst.lines.join("\n");else if("rex_TagText"===this.text_type||"rex_bbcodeText"===this.text_type){c=this.inst.copyPensMgr();for(var d=c.getLines().length,b=[],e=0;e<d;e++){var f=c.getLineStartChartIndex(e),g=c.getLineEndChartIndex(e);f=c.getSliceTagText(f,g+1);b.push(f)}c=
b.join("\n")}a.set_string(c)}})();cr.behaviors.Rex_text_resize=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.behaviors.Rex_text_resize.prototype;g.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.isAutoResize=1===this.properties[0];this.minWidth=this.properties[1];this.minHeight=this.properties[2];this.maxWidth=this.inst.width;this.maxHeight=this.inst.height;
this.isResizeNow=!1;this.backgroundObjects={};this.preWidth=this.inst.width;this.preHeight=this.inst.height;this.bgInstsSave=null;this.textObjType=this.getTextObjType();this.FnGetTextHeight=this.getFnGetTextHeight();this.FnGetTextWidth=this.getFnGetTextWidth();this.recycled||(this.myDestroyCallback=function(a){return function(c){a.onInstanceDestroyed(c)}}(this));this.runtime.addDestroyCallback(this.myDestroyCallback)};k.onInstanceDestroyed=function(a){a=a.uid;this.backgroundObjects.hasOwnProperty(a)&&
delete this.backgroundObjects[a]};k.onDestroy=function(){for(var a in this.backgroundObjects)delete this.backgroundObjects[a];this.runtime.removeDestroyCallback(this.myDestroyCallback)};k.tick=function(){};k.tick2=function(){this.isAutoResize&&this.isTextChanged()&&this.resize()};k.forceDrawing=function(){var a=this.inst,d=this.runtime.enableWebGL?this.getWebglCtx():this.runtime.ctx;a.width=this.maxWidth;a.set_bbox_changed();a.draw(d);a.text_changed=!0;a.runtime.redraw=!0};k.getWebglCtx=function(){var a=
this.inst,d=a.myctx;if(!d){a.mycanvas=document.createElement("canvas");d=Math.ceil(a.layer.getScale()*a.width);var b=Math.ceil(a.layer.getAngle()*a.height);a.mycanvas.width=d;a.mycanvas.height=b;a.lastwidth=d;a.lastheight=b;a.myctx=a.mycanvas.getContext("2d");d=a.myctx}return d};k.resize=function(){this.forceDrawing();this.resizeMyself()&&(this.resizeBackground(),this.saveCurrentSize(),this.runtime.trigger(cr.behaviors.Rex_text_resize.prototype.cnds.OnSizeChanged,this.inst))};k.resizeMyself=function(){var a=
this.getTextWidth()+1;a=cr.clamp(a,this.minWidth,this.maxWidth);var d=this.getTextHeight()+1;d<this.minHeight&&(d=this.minHeight);var b=this.inst,e=!1;if(a!==b.width||d!==b.height)this.setInstSize(a,d),e=!0;return e};k.getTextObjType=function(){return cr.plugins_.Text&&this.inst instanceof cr.plugins_.Text.prototype.Instance?1:cr.plugins_.Spritefont2&&this.inst instanceof cr.plugins_.Spritefont2.prototype.Instance?2:cr.plugins_.rex_TagText&&this.inst instanceof cr.plugins_.rex_TagText.prototype.Instance?
10:cr.plugins_.rex_bbcodeText&&this.inst instanceof cr.plugins_.rex_bbcodeText.prototype.Instance?11:cr.plugins_.SpriteFontPlus&&this.inst instanceof cr.plugins_.SpriteFontPlus.prototype.Instance?4:0};k.setInstSize=function(a,d){var b=this.inst;b.width=a;b.height=d;b.set_bbox_changed();switch(this.textObjType){case 1:b.lastwrapwidth=a;break;case 2:b.lastwrapwidth=a;break;case 10:b.lastwrapwidth=a;break;case 11:b.lastwrapwidth=a}};k.resizeBackground=function(){var a=this.inst.width-this.maxWidth,d=
this.inst.height-this.maxHeight,b;for(b in this.backgroundObjects){var e=this.backgroundObjects[b];var f=e.inst;var g=e.rm;var h=e.maxw+a;e=e.maxh+d;if(0===g){if(f.width!==h||f.height!==e)f.height=e,f.width=h,f.set_bbox_changed()}else 1===g&&f.height!==e&&(f.height=e,f.set_bbox_changed())}};k.saveCurrentSize=function(){this.preWidth=this.inst.width;this.preHeight=this.inst.height};k.getFnGetTextHeight=function(){switch(this.textObjType){case 1:return cr.plugins_.Text.prototype.exps.TextHeight;case 2:return cr.plugins_.Spritefont2.prototype.exps.TextHeight;
case 10:return cr.plugins_.rex_TagText.prototype.exps.TextHeight;case 11:return cr.plugins_.rex_bbcodeText.prototype.exps.TextHeight}};k.getFnGetTextWidth=function(){switch(this.textObjType){case 1:return cr.plugins_.Text.prototype.exps.TextWidth;case 2:return cr.plugins_.Spritefont2.prototype.exps.TextWidth;case 10:return cr.plugins_.rex_TagText.prototype.exps.TextWidth;case 11:return cr.plugins_.rex_bbcodeText.prototype.exps.TextWidth}};var e={value:0,set_any:function(a){this.value=a},set_int:function(a){this.value=
a},set_float:function(a){this.value=a},set_string:function(a){this.value=a}};k.getTextHeight=function(){this.FnGetTextHeight.call(this.inst,e);return e.value};k.getTextWidth=function(){this.FnGetTextWidth.call(this.inst,e);return e.value};k.isTextChanged=function(){switch(this.textObjType){case 1:return this.inst.text_changed;case 2:return this.inst.text_changed;case 10:return this.inst.text_changed;case 11:return this.inst.text_changed}};k.saveToJSON=function(){var a,d={};for(a in this.backgroundObjects){var b=
this.backgroundObjects[a];d[a]={rm:b.rm,maxw:b.maxw,maxh:b.maxh}}return{minw:this.minWidth,minh:this.minHeight,maxw:this.maxWidth,maxh:this.maxHeight,pw:this.preWidth,ph:this.preHeight,bg:d}};k.loadFromJSON=function(a){this.minWidth=a.minw;this.minHeight=a.minh;this.maxWidth=a.maxw;this.maxHeight=a.maxh;this.preWidth=a.pw;this.preHeight=a.ph;this.bgInstsSave=a.bg};k.afterLoad=function(){for(var a in this.backgroundObjects)delete this.backgroundObjects[a];for(a in this.bgInstsSave){a=parseInt(a);var d=
this.runtime.getObjectByUID(a);this.backgroundObjects[a]=this.bgInstsSave[a];this.backgroundObjects[a].inst=d}this.bgInstsSave=null};g.cnds=new a;a.prototype.OnSizeChanged=function(){return!0};g.acts=new f;f.prototype.Resize=function(){this.resize()};f.prototype.SetMaxWidth=function(a){this.maxWidth=a};f.prototype.SetMinWidth=function(a){this.minWidth=a};f.prototype.SetMinHeight=function(a){this.minHeight=a};f.prototype.AddBackground=function(a,d){a&&(a=a.getFirstPicked())&&(this.backgroundObjects[a.uid]=
{inst:a,rm:d,maxw:a.width,maxh:a.height})};g.exps=new function(){}})();cr.behaviors.Rex_text_typing=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}var k=cr.behaviors.Rex_text_typing.prototype;k.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};var e=k.Type.prototype;e.onCreate=function(){this.timeline=null;this.timelineUid=-1};e.getTimeline=function(){if(null!=this.timeline)return this.timeline;var a=this.runtime.types,b;for(b in a){var c=a[b].instances[0];if(c instanceof cr.plugins_.Rex_TimeLine.prototype.Instance)return this.timeline=c}return null};k.Instance=function(a,
b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};e=k.Instance.prototype;e.onCreate=function(){this.typeMode=this.properties[0];this.isLineBreak=1===this.properties[1];this.typingTimer=null;this.typingIndex=this.typingSpeed=0;this.content="";this.typingContent=null;this.rawTextLength=0;this.timerSave=null;this.textType=this.getTextObjType();this.FnSetText=this.getFnSetText(this.textType)};e.getTextObjType=function(){return cr.plugins_.Text&&this.inst instanceof cr.plugins_.Text.prototype.Instance?
1:cr.plugins_.Spritefont2&&this.inst instanceof cr.plugins_.Spritefont2.prototype.Instance?2:cr.plugins_.TextBox&&this.inst instanceof cr.plugins_.TextBox.prototype.Instance?3:cr.plugins_.rex_TagText&&this.inst instanceof cr.plugins_.rex_TagText.prototype.Instance?10:cr.plugins_.rex_bbcodeText&&this.inst instanceof cr.plugins_.rex_bbcodeText.prototype.Instance?11:cr.plugins_.SpriteFontPlus&&this.inst instanceof cr.plugins_.SpriteFontPlus.prototype.Instance?4:0};e.getFnSetText=function(a){return 1===
a?cr.plugins_.Text.prototype.acts.SetText:2===a?cr.plugins_.Spritefont2.prototype.acts.SetText:3===a?cr.plugins_.TextBox.prototype.acts.SetText:10===a?cr.plugins_.rex_TagText.prototype.acts.SetText:11===this.textType?cr.plugins_.rex_bbcodeText.prototype.acts.SetText:4===this.textType?cr.plugins_.SpriteFontPlus.prototype.acts.SetText:null};e.onDestroy=function(){this.removeTypingTimer()};e.removeTypingTimer=function(){null!=this.typingTimer&&this.typingTimer.Remove()};e.tick=function(){};e.getRawTextLength=
function(a){return 1===this.textType||2===this.textType||4===this.textType||3===this.textType?a.length:10===this.textType||11===this.textType?this.inst.getRawText(a).length:0};e.getSubString=function(a,b,c){null==b&&(b=0);null==c&&(c=this.getRawTextLength(a));if(b>c){var d=b;b=c;c=d}if(1==this.textType||2==this.textType||4===this.textType||3==this.textType)var e=a.slice(b,c);else if(10===this.textType||11===this.textType)e=this.inst.getSubText(b,c,a);return e};e.getTypingString=function(a,b,c){if(0===
c)var d=this.getSubString(a,0,b);else if(1===c)d=this.rawTextLength,d=this.getSubString(a,d-b,d);else if(2===c)c=Math.floor(this.rawTextLength/2-b/2),d=this.getSubString(a,c,c+b);else if(3===c){var e=Math.floor(b/2);0<e?(d=this.rawTextLength,c=d-e,d=this.getSubString(a,c,d)):d="";b-=e;0<b?(c=0,a=this.getSubString(a,c,c+b)):a="";d=a+d}return d};e.SetText=function(a){null!=this.FnSetText&&this.FnSetText.call(this.inst,a)};e.getTimer=function(){var a=this.typingTimer;null==a&&(a=this.type.getTimeline().CreateTimer(c),
a.plugin=this);return a};e.startTyping=function(a,b,c){this.content=a;this.isLineBreak&&(a=this.lineBreakContent(a));this.rawTextLength=this.getRawTextLength(a);0!=b?(null==c&&(c=1),this.typingTimer=this.getTimer(),this.typingContent=a,this.typingSpeed=b,this.typingIndex=c,this.typingTimer.Start(0)):(this.typingIndex=this.rawTextLength,a=this.getTypingString(a,this.typingIndex,this.typeMode),this.SetText(a),this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTypingCompleted,this.inst))};
var c=function(){this.plugin.typing()};e.typing=function(){var a=this.getTypingString(this.typingContent,this.typingIndex,this.typeMode);this.SetText(a);this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTextTyping,this.inst);this.typingIndex+=1;this.typingIndex<=this.rawTextLength?this.typingTimer.Restart(this.typingSpeed):(this.typingIndex=this.rawTextLength,this.typingContent=null,this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTypingCompleted,this.inst))};e.isTyping=
function(){return this.typingTimer?this.typingTimer.IsActive():!1};e.getWebglCtx=function(){var a=this.inst,b=a.myctx;if(!b){a.mycanvas=document.createElement("canvas");b=Math.ceil(a.layer.getScale()*a.width);var c=Math.ceil(a.layer.getAngle()*a.height);a.mycanvas.width=b;a.mycanvas.height=c;a.lastwidth=b;a.lastheight=c;a.myctx=a.mycanvas.getContext("2d");b=a.myctx}return b};e.drawText=function(a){this.SetText(a);a=this.inst;var b=this.runtime.enableWebGL?this.getWebglCtx():this.runtime.ctx;a.draw(b)};
e.lineBreakContent=function(a){this.drawText(a);if(1===this.textType)var b=this.inst.lines.join("\n");else if(2===this.textType||4===this.textType){a=this.inst.lines.length;b=[];for(var c=0;c<a;c++)b.push(this.inst.lines[c].text);b=b.join("\n")}else if(10===this.textType||11===this.textType){var d=this.inst.copyPensMgr();a=d.getLines().length;var e=!1;b="";for(c=0;c<a;c++){e&&(b+="\n");e=d.getLineStartChartIndex(c);var f=d.getLineEndChartIndex(c);e=d.getSliceTagText(e,f+1);b+=e;e=-1===e.indexOf("\n")}}return b||
""};e.saveToJSON=function(){return{c:this.content,tc:this.typingContent,spd:this.typingSpeed,i:this.typingIndex,tim:null!=this.typingTimer?this.typingTimer.saveToJSON():null,tluid:null!=this.type.timeline?this.type.timeline.uid:-1}};e.loadFromJSON=function(a){this.content=a.c;this.typingContent=a.tc;this.typingSpeed=a.spd;this.typingIndex=a.i;this.timerSave=a.tim;this.type.timelineUid=a.tluid};e.afterLoad=function(){this.type.timeline=-1===this.type.timelineUid?null:this.runtime.getObjectByUID(this.type.timelineUid);
null==this.timerSave?this.typingTimer=null:(this.typingTimer=this.type.timeline.LoadTimer(this.timerSave,c),this.typingTimer.plugin=this);this.timers_save=null};k.cnds=new a;a.prototype.OnTextTyping=function(){return!0};a.prototype.OnTypingCompleted=function(){return!0};a.prototype.IsTextTyping=function(){return this.isTyping()};k.acts=new f;f.prototype.SetupTimer=function(a){a=a.instances[0];"TIMELINE"==a.check_name?this.type.timeline=a:alert("Text-typing should connect to a timeline object")};f.prototype.TypeText=
function(a,b){"number"===typeof a&&(a=Math.round(1E10*a)/1E10);this.startTyping(a.toString(),b)};f.prototype.SetTypingSpeed=function(a){if(this.typingSpeed!==a){this.typingSpeed=a;var b=this.typingTimer;null!=b&&b.IsActive()&&b.Restart(a)}};f.prototype.StopTyping=function(a){this.removeTypingTimer();a&&(this.SetText(this.content),this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTypingCompleted,this.inst))};f.prototype.AppendText=function(a){var b=this.rawTextLength;"number"===typeof a&&
(a=Math.round(1E10*a)/1E10);this.isTyping()||this.startTyping(this.content+a.toString(),this.typingSpeed,b)};f.prototype.Pause=function(){null!=this.typingTimer&&this.typingTimer.Suspend()};f.prototype.Resume=function(){null!=this.typingTimer&&this.typingTimer.Resume()};k.exps=new g;g.prototype.TypingSpeed=function(a){a.set_float(this.typingSpeed)};g.prototype.TypingIndex=function(a){a.set_float(this.typingIndex-1)};g.prototype.Content=function(a){a.set_string(this.content)};g.prototype.LastTypingCharacter=
function(a){a.set_string(this.content.charAt(this.typingIndex-1))}})();cr.behaviors.Rotate=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.behaviors.Rotate.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.speed=cr.to_radians(this.properties[0]);this.acc=cr.to_radians(this.properties[1])};k.saveToJSON=function(){return{speed:this.speed,acc:this.acc}};k.loadFromJSON=
function(a){this.speed=a.speed;this.acc=a.acc};k.tick=function(){var a=this.runtime.getDt(this.inst);0!==a&&(0!==this.acc&&(this.speed+=this.acc*a),0!==this.speed&&(this.inst.angle=cr.clamp_angle(this.inst.angle+this.speed*a),this.inst.set_bbox_changed()))};g.cnds=new function(){};a.prototype.SetSpeed=function(a){this.speed=cr.to_radians(a)};a.prototype.SetAcceleration=function(a){this.acc=cr.to_radians(a)};g.acts=new a;f.prototype.Speed=function(a){a.set_float(cr.to_degrees(this.speed))};f.prototype.Acceleration=
function(a){a.set_float(cr.to_degrees(this.acc))};g.exps=new f})();cr.behaviors.Textbox_Plus=function(a){this.runtime=a};
(function(){function a(){}function f(){}function g(){}function k(){}var e=cr.behaviors.Textbox_Plus.prototype;e.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a,b){this.inst=b;this.type=a;this.behavior=a.behavior;this.runtime=a.runtime;this.trigger_once=!0;this.autoFontSize=0;this.class=""};var c=e.Instance.prototype;c.onCreate=function(){};c.Style=function(){var a=this.inst;this.inst.elem.addEventListener("focus",
function(b){setTimeout(function(){b.stopPropagation();a.runtime.trigger(cr.behaviors.Textbox_Plus.prototype.cnds.OnFocus,a)},0)},!1);this.inst.elem.addEventListener("blur",function(b){setTimeout(function(){b.stopPropagation();a.runtime.trigger(cr.behaviors.Textbox_Plus.prototype.cnds.OnBlur,a)},0)},!1);this.inst.elem.maxLength=0<this.properties[14]?this.properties[14]:1E6;this.inst.elem.style.textAlign=["left","center","right"][this.properties[5]];this.inst.elem.style.background=this.properties[7]?
this.properties[17]:"none";this.inst.elem.style.border=this.properties[8]?this.properties[18]:"none";this.inst.elem.style.textDecoration=["no","underline","line-through","overline"][this.properties[11]];this.inst.elem.style.textTransform=["no","capitalize","lowercase","uppercase"][this.properties[13]];this.inst.elem.style.borderRadius=this.properties[19];this.inst.elem.style.outline=this.properties[20];this.inst.elem.style.padding=this.properties[21];this.inst.elem.style.textShadow=this.properties[22];
this.inst.elem.style.boxShadow=this.properties[23];for(var b=this.properties[0].split(" "),c=0;c<b.length;c++)this.class.match(b[c])||(this.class+=this.class.length?" "+b[c]:b[c]);this.inst.elem.setAttribute("class",this.class);this.inst.elem.style.color="rgb("+(this.properties[4]&255)+","+(this.properties[4]>>8&255)+","+(this.properties[4]>>16&255)+")";this.properties[10]||(this.inst.elem.disabled=!0,$(this.inst.elem).css("user-select","none"),$(this.inst.elem).css("cursor","default"));this.properties[9]||
(this.inst.elem.disabled=!1,$(this.inst.elem).bind("contextmenu",function(a){a.preventDefault();return!1}));this.properties[12]&&this.inst.elem.setAttribute("onkeypress","return cr.behaviors.Textbox_Plus.prototype.fncs.OnKey(this, event, "+this.properties[12]+", '"+this.properties[24]+"')");"textarea"===this.inst.elem.type&&(c=[0,2,1.01][this.properties[6]])&&(b=this.inst.elem.offsetHeight,this.inst.elem.style.height=0,c=Math.max(0,b/c-this.inst.elem.scrollHeight/c),this.inst.elem.style.paddingTop=
c+"px",this.inst.elem.style.height=b-c+"px");this.properties[15]?(b=document.createElement("link"),b.href=this.properties[15],b.rel="stylesheet",b.type="text/css","undefined"!=typeof b&&(document.getElementsByTagName("head")[0].appendChild(b),this.inst.elem.style.fontFamily=this.properties[16]||"PlayLive")):(this.inst.elem.style.fontFamily=this.properties[2]||"Arial",this.inst.elem.style.fontWeight=1==this.properties[3]||3==this.properties[3]?"bold":"none",this.inst.elem.style.fontStyle=1<this.properties[3]?
"italic":"none");switch(this.properties[1]){case 0:this.autoFontSize=-1;break;case 1:this.autoFontSize=.2;break;case 2:this.autoFontSize=.4;break;case 3:this.autoFontSize=.1;break;case 4:this.autoFontSize=0;break;case 5:this.autoFontSize=.5}this.updatePosition()};c.onDestroy=function(){};c.saveToJSON=function(){return{}};c.loadFromJSON=function(a){};c.tick=function(){this.runtime.getDt(this.inst);this.trigger_once&&(this.trigger_once=!1,this.Style())};c.updatePosition=function(){.5==this.autoFontSize?
jQuery(this.inst.elem).css("font-size",this.inst.layer.getScale(!0)/this.runtime.devicePixelRatio+this.autoFontSize+"em"):-1!=this.autoFontSize&&jQuery(this.inst.elem).css("font-size",this.inst.layer.getScale(!0)/this.runtime.devicePixelRatio-this.autoFontSize+"em")};a.prototype.OnKey=function(a,b,c,e){a=b.which?b.which:b.keyCode;e=-1!=e.indexOf(String.fromCharCode(a))||13==a&&-1!=e.indexOf("  ")?!0:!1;if(1==c)return e||64<a&&91>a||96<a&&123>a?!0:!1;if(2==c)return e||47<a&&58>a?!0:!1;if(3==c)return e||
47<a&&58>a||64<a&&91>a||96<a&&123>a?!0:!1;if(4==c)return e?!0:!1};e.fncs=new a;f.prototype.OnFocus=function(){return!0};f.prototype.OnBlur=function(){return!0};e.cnds=new f;g.prototype.AddClass=function(a){if(this.runtime.isDomFree)return!1;a=a.split(" ");for(var b=0;b<a.length;b++)this.class.match(a[b])||(this.class+=this.class.length?" "+a[b]:a[b]);this.inst.elem.setAttribute("class",this.class)};g.prototype.RemClass=function(a){if(this.runtime.isDomFree)return!1;a=a.split(" ");for(var b=0;b<a.length;b++)this.class=
this.class.replace(a[b],"").replace("  "," ").trim();this.inst.elem.setAttribute("class",this.class)};g.prototype.AppendText=function(a){if(this.runtime.isDomFree)return!1;this.inst.elem.value+=a;this.inst.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,this.inst)};g.prototype.Selectable=function(a){this.runtime.isDomFree||(this.inst.elem.disabled=a?!1:!0,$(this.frame).css("user-select",a?"auto":"none"),$(this.frame).css("cursor",a?"auto":"default"))};g.prototype.SelectAll=function(){this.runtime.isDomFree||
this.inst.elem.select()};g.prototype.ScrollTop=function(){this.runtime.isDomFree||(this.inst.elem.scrollTop=0)};g.prototype.ScrollBottom=function(){this.runtime.isDomFree||(this.inst.elem.scrollTop=this.elem.scrollHeight)};g.prototype.ScrollTo=function(a){this.runtime.isDomFree||(this.frame.scrollTop=this.frame.scrollHeight,this.frame.scrollTop*=a/100)};g.prototype.ScrollToPosition=function(a){this.runtime.isDomFree||(this.frame.scrollTop=a)};e.acts=new g;k.prototype.ID=function(a){a.set_string(this.inst.elem.id)};
k.prototype.Class=function(a){a.set_string(this.class)};k.prototype.ScrollHeight=function(a){a.set_float(this.inst.elem.scrollHeight)};k.prototype.ScrollPosition=function(a){a.set_float(this.inst.elem.scrollTop)};e.exps=new k})();cr.behaviors.bound=function(a){this.runtime=a};
(function(){var a=cr.behaviors.bound.prototype;a.Type=function(a,g){this.behavior=a;this.objtype=g;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a,g){this.type=a;this.behavior=a.behavior;this.inst=g;this.runtime=a.runtime;this.mode=0};a=a.Instance.prototype;a.onCreate=function(){this.mode=this.properties[0]};a.tick=function(){};a.tick2=function(){this.inst.update_bbox();var a=this.inst.bbox,g=this.inst.layer.layout,k=!1;0===this.mode?(0>this.inst.x&&(this.inst.x=
0,k=!0),0>this.inst.y&&(this.inst.y=0,k=!0),this.inst.x>g.width&&(this.inst.x=g.width,k=!0),this.inst.y>g.height&&(this.inst.y=g.height,k=!0)):(0>a.left&&(this.inst.x-=a.left,k=!0),0>a.top&&(this.inst.y-=a.top,k=!0),a.right>g.width&&(this.inst.x-=a.right-g.width,k=!0),a.bottom>g.height&&(this.inst.y-=a.bottom-g.height,k=!0));k&&this.inst.set_bbox_changed()}})();cr.behaviors.solid=function(a){this.runtime=a};
(function(){function a(){}function f(){}var g=cr.behaviors.solid.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var k=g.Instance.prototype;k.onCreate=function(){this.inst.extra.solidEnabled=0!==this.properties[0]};k.tick=function(){};a.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled};g.cnds=new a;f.prototype.SetEnabled=
function(a){this.inst.extra.solidEnabled=!!a};g.acts=new f})();
cr.getObjectRefTable=function(){return[cr.plugins_.togglebutton,cr.plugins_.AJAX,cr.plugins_.CSS_import,cr.plugins_.Dictionary,cr.plugins_.c2canvas,cr.plugins_.filechooser,cr.plugins_.Function,cr.plugins_.Button,cr.plugins_.Browser,cr.plugins_.Mouse,cr.plugins_.Keyboard,cr.plugins_.List,cr.plugins_.pix_dialogs,cr.plugins_.NodeWebkit,cr.plugins_.rex_bbcodeText,cr.plugins_.progressbar,cr.plugins_.Rex_canvas,cr.plugins_.Rex_InstanceBank2,cr.plugins_.Rex_SysExt,cr.plugins_.Rex_TimeLine,cr.plugins_.rex_TouchWrap,
cr.plugins_.Rex_TARP,cr.plugins_.Rex_UndoRedo,cr.plugins_.Text,cr.plugins_.Rex_UID2Prop,cr.plugins_.Sprite,cr.plugins_.TextBox,cr.plugins_.TiledBg,cr.plugins_.sirg_fancyBox,cr.plugins_.sliderbar,cr.plugins_.Touch,cr.plugins_.UserMedia,cr.plugins_.video,cr.plugins_.ValerypopoffJSPlugin,cr.behaviors.Textbox_Plus,cr.behaviors.Flash,cr.behaviors.solid,cr.behaviors.Rex_pinOffsetXY,cr.behaviors.Pin,cr.behaviors.DragnDrop,cr.behaviors.Rotate,cr.behaviors.Rex_MoveTo,cr.behaviors.Rex_text_resize,cr.behaviors.Rex_text_properties,
cr.behaviors.Rex_DragDrop2,cr.behaviors.Rex_layouter_text,cr.behaviors.Rex_CanvasExt,cr.behaviors.Fade,cr.behaviors.Rex_Rotate,cr.behaviors.Rex_text_typing,cr.behaviors.bound,cr.behaviors.Rex_TouchArea2,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.Function.prototype.cnds.OnFunction,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.Call,cr.plugins_.Dictionary.prototype.exps.AsJSON,cr.system_object.prototype.acts.Wait,cr.plugins_.List.prototype.acts.AddItem,cr.plugins_.TextBox.prototype.exps.Text,
cr.plugins_.List.prototype.exps.AsJSON,cr.plugins_.List.prototype.acts.Remove,cr.plugins_.List.prototype.exps.SelectedIndex,cr.plugins_.List.prototype.acts.Select,cr.plugins_.Function.prototype.acts.CallFunction,cr.plugins_.Sprite.prototype.acts.SetOpacity,cr.system_object.prototype.acts.SetVar,cr.plugins_.List.prototype.exps.X,cr.plugins_.List.prototype.exps.Y,cr.plugins_.List.prototype.acts.Clear,cr.plugins_.List.prototype.acts.LoadFromJsonString,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.StoredReturnValue,
cr.plugins_.List.prototype.acts.SetPos,cr.plugins_.List.prototype.acts.AddItemAt,cr.plugins_.List.prototype.acts.SetEnabled,cr.plugins_.Dictionary.prototype.acts.JSONLoad,cr.plugins_.List.prototype.exps.SelectedText,cr.system_object.prototype.exps.left,cr.system_object.prototype.cnds.Compare,cr.system_object.prototype.exps.layoutname,cr.behaviors.Rex_MoveTo.prototype.acts.SetTargetPos,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.behaviors.DragnDrop.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.acts.Destroy,
cr.plugins_.Sprite.prototype.acts.SetSize,cr.plugins_.Rex_TARP.prototype.acts.PlayerStop,cr.system_object.prototype.acts.RestartLayout,cr.system_object.prototype.cnds.CompareVar,cr.plugins_.Sprite.prototype.acts.SetPos,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Sprite.prototype.exps.Y,cr.plugins_.Sprite.prototype.acts.SetAngle,cr.plugins_.TiledBg.prototype.acts.SetVisible,cr.system_object.prototype.acts.SetLayerVisible,cr.plugins_.TextBox.prototype.acts.SetText,cr.plugins_.Text.prototype.acts.SetVisible,
cr.behaviors.Rotate.prototype.acts.SetSpeed,cr.plugins_.Sprite.prototype.acts.RotateClockwise,cr.plugins_.TextBox.prototype.acts.SetPlaceholder,cr.plugins_.Text.prototype.acts.Destroy,cr.plugins_.c2canvas.prototype.acts.ClearCanvas,cr.plugins_.Sprite.prototype.acts.SetInstanceVar,cr.behaviors.Pin.prototype.acts.Pin,cr.behaviors.Pin.prototype.acts.Unpin,cr.plugins_.video.prototype.acts.SetSource,cr.plugins_.filechooser.prototype.exps.FileURLAt,cr.plugins_.filechooser.prototype.acts.ReleaseFile,cr.plugins_.filechooser.prototype.exps.Count,
cr.plugins_.video.prototype.acts.SetVisible,cr.plugins_.video.prototype.acts.SetPlaybackTime,cr.plugins_.sliderbar.prototype.acts.SetValue,cr.plugins_.Text.prototype.acts.SetText,cr.plugins_.filechooser.prototype.exps.FileNameAt,cr.plugins_.video.prototype.acts.Pause,cr.plugins_.Sprite.prototype.acts.SetX,cr.plugins_.List.prototype.exps.Count,cr.plugins_.List.prototype.exps.SelectedTextAt,cr.plugins_.Dictionary.prototype.cnds.ForEachKey,cr.system_object.prototype.exps.tokenat,cr.plugins_.Dictionary.prototype.exps.CurrentKey,
cr.plugins_.List.prototype.acts.SetItemText,cr.plugins_.TextBox.prototype.acts.SetVisible,cr.plugins_.filechooser.prototype.exps.FileTypeAt,cr.plugins_.togglebutton.prototype.cnds.CompareInstanceVar,cr.plugins_.List.prototype.cnds.CompareSelectedText,cr.plugins_.video.prototype.acts.Play,cr.plugins_.progressbar.prototype.acts.SetIndeterminate,cr.system_object.prototype.exps["int"],cr.system_object.prototype.exps.zeropad,cr.system_object.prototype.exps.abs,cr.plugins_.video.prototype.exps.PlaybackTime,
cr.plugins_.Sprite.prototype.exps.Width,cr.plugins_.progressbar.prototype.acts.SetMaximum,cr.plugins_.video.prototype.exps.Duration,cr.system_object.prototype.cnds.For,cr.plugins_.List.prototype.exps.ItemCount,cr.system_object.prototype.acts.AddVar,cr.plugins_.List.prototype.exps.ItemTextAt,cr.system_object.prototype.exps.replace,cr.system_object.prototype.exps.time,cr.plugins_.Rex_InstanceBank2.prototype.acts.CleanBank,cr.plugins_.Dictionary.prototype.acts.AddKey,cr.plugins_.c2canvas.prototype.exps.imageUrl,
cr.plugins_.Rex_InstanceBank2.prototype.acts.SaveInstances,cr.plugins_.Rex_InstanceBank2.prototype.exps.BankToString,cr.plugins_.Rex_TimeLine.prototype.acts.ResumeTimeLine,cr.plugins_.Rex_TimeLine.prototype.acts.PauseTimeLine,cr.plugins_.Rex_TARP.prototype.acts.PlayerResume,cr.plugins_.Rex_TARP.prototype.acts.PlayerPause,cr.plugins_.Dictionary.prototype.cnds.HasKey,cr.plugins_.Rex_TARP.prototype.acts.PlayerLoad,cr.plugins_.Dictionary.prototype.exps.Get,cr.plugins_.Rex_TARP.prototype.acts.PlayStart,
cr.system_object.prototype.exps.urldecode,cr.behaviors.Rex_MoveTo.prototype.acts.Stop,cr.plugins_.Rex_TARP.prototype.exps.RecorderList,cr.plugins_.Rex_TARP.prototype.acts.Setup,cr.plugins_.Rex_TARP.prototype.acts.RecorderStart,cr.plugins_.Rex_SysExt.prototype.exps.SubString,cr.system_object.prototype.acts.GoToLayoutByName,cr.behaviors.Rex_CanvasExt.prototype.acts.LoadURL,cr.plugins_.Rex_InstanceBank2.prototype.acts.LoadInstances,cr.plugins_.Rex_InstanceBank2.prototype.acts.StringToBank,cr.plugins_.Function.prototype.exps.Param,
cr.plugins_.Dictionary.prototype.acts.DeleteKey,cr.plugins_.Sprite.prototype.acts.MoveToTop,cr.behaviors.Rex_MoveTo.prototype.acts.SetMaxSpeed,cr.behaviors.Rex_MoveTo.prototype.acts.SetEnabled,cr.system_object.prototype.acts.SetLayerOpacity,cr.plugins_.Rex_UndoRedo.prototype.acts.CleanAll,cr.behaviors.Rex_CanvasExt.prototype.acts.EraseObject,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.plugins_.Rex_TARP.prototype.cnds.IsPlaying,cr.system_object.prototype.acts.CreateObject,cr.plugins_.Text.prototype.acts.MoveToTop,
cr.plugins_.Dictionary.prototype.acts.Clear,cr.system_object.prototype.acts.ResetPersisted,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.ExecuteJSWithParams,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,cr.plugins_.Sprite.prototype.cnds.PickByUID,cr.plugins_.Sprite.prototype.cnds.IsVisible,cr.behaviors.Rex_pinOffsetXY.prototype.acts.Unpin,cr.plugins_.Sprite.prototype.acts.SetCollisions,cr.plugins_.Touch.prototype.exps.X,cr.plugins_.Touch.prototype.exps.Y,cr.plugins_.Sprite.prototype.cnds.IsOverlapping,
cr.behaviors.Rex_MoveTo.prototype.cnds.IsMoving,cr.behaviors.DragnDrop.prototype.cnds.IsDragging,cr.behaviors.Rex_pinOffsetXY.prototype.acts.Pin,cr.behaviors.Rex_pinOffsetXY.prototype.cnds.IsPinned,cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,cr.plugins_.Touch.prototype.cnds.OnTouchEnd,cr.system_object.prototype.cnds.IsMobile,cr.plugins_.Browser.prototype.cnds.IsPortraitLandscape,cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,cr.plugins_.Sprite.prototype.acts.SetPosToObject,
cr.plugins_.Sprite.prototype.exps.UID,cr.system_object.prototype.cnds.LayerVisible,cr.plugins_.Sprite.prototype.cnds.CompareOpacity,cr.behaviors.Rex_DragDrop2.prototype.acts.SetEnabled,cr.plugins_.Text.prototype.exps.UID,cr.system_object.prototype.acts.SubVar,cr.plugins_.pix_dialogs.prototype.acts.openDialog,cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,cr.plugins_.Browser.prototype.cnds.IsOnline,cr.plugins_.sirg_fancyBox.prototype.acts.ShowFancyBoxHtml,cr.plugins_.sirg_fancyBox.prototype.acts.ShowFancyBoxIframe,
cr.plugins_.Browser.prototype.acts.GoToURLWindow,cr.plugins_.List.prototype.acts.SetVisible,cr.plugins_.List.prototype.cnds.CompareTextAt,cr.system_object.prototype.exps.len,cr.behaviors.Rex_text_properties.prototype.acts.SetWrapping,cr.plugins_.Text.prototype.acts.SetFontSize,cr.plugins_.Text.prototype.acts.SetFontFace,cr.plugins_.Text.prototype.acts.SetFontColor,cr.plugins_.Text.prototype.cnds.PickByUID,cr.behaviors.Textbox_Plus.prototype.cnds.OnFocus,cr.plugins_.TextBox.prototype.acts.SetCSSStyle,
cr.plugins_.Text.prototype.exps.Text,cr.system_object.prototype.exps.rgb,cr.system_object.prototype.acts.SnapshotCanvas,cr.system_object.prototype.cnds.OnCanvasSnapshot,cr.plugins_.Browser.prototype.acts.InvokeDownload,cr.system_object.prototype.exps.canvassnapshot,cr.system_object.prototype.exps.random,cr.plugins_.c2canvas.prototype.acts.setLineDash,cr.plugins_.c2canvas.prototype.acts.setLineSettings,cr.plugins_.Sprite.prototype.acts.SetAnimFrame,cr.plugins_.Sprite.prototype.exps.AnimationFrame,
cr.plugins_.Sprite.prototype.acts.StopAnim,cr.plugins_.List.prototype.cnds.OnSelectionChanged,cr.system_object.prototype.acts.GoToLayout,cr.system_object.prototype.cnds.OnLayoutStart,cr.plugins_.sliderbar.prototype.acts.SetCSSStyle,cr.plugins_.progressbar.prototype.acts.SetCSSStyle,cr.plugins_.Rex_UndoRedo.prototype.acts.Push,cr.plugins_.UserMedia.prototype.cnds.SupportsCanvasRecording,cr.plugins_.filechooser.prototype.acts.SetVisible,cr.plugins_.video.prototype.acts.SetVolume,cr.plugins_.Dictionary.prototype.cnds.IsEmpty,
cr.plugins_.TextBox.prototype.acts.SetReadOnly,cr.system_object.prototype.cnds.OnLayoutEnd,cr.plugins_.AJAX.prototype.acts.SetHeader,cr.system_object.prototype.exps.str,cr.system_object.prototype.exps.tickcount,cr.plugins_.AJAX.prototype.acts.Request,cr.plugins_.AJAX.prototype.cnds.OnComplete,cr.plugins_.AJAX.prototype.exps.LastData,cr.plugins_.AJAX.prototype.cnds.OnError,cr.behaviors.Rex_Rotate.prototype.acts.SetActivated,cr.behaviors.Flash.prototype.acts.Flash,cr.plugins_.rex_bbcodeText.prototype.acts.SetText,
cr.behaviors.Rex_text_typing.prototype.acts.TypeText,cr.behaviors.Fade.prototype.acts.RestartFade,cr.plugins_.video.prototype.acts.Destroy,cr.plugins_.Touch.prototype.cnds.IsInTouch,cr.system_object.prototype.exps.distance,cr.plugins_.c2canvas.prototype.acts.beginPath,cr.plugins_.Touch.prototype.cnds.OnTouchStart,cr.plugins_.Sprite.prototype.acts.RotateTowardAngle,cr.system_object.prototype.exps.clamp,cr.system_object.prototype.exps.dt,cr.plugins_.Sprite.prototype.exps.Angle,cr.system_object.prototype.exps.angle,
cr.system_object.prototype.cnds.EveryTick,cr.plugins_.c2canvas.prototype.acts.DrawLine,cr.plugins_.c2canvas.prototype.acts.lineTo,cr.plugins_.c2canvas.prototype.acts.drawPath,cr.plugins_.c2canvas.prototype.acts.PasteObject,cr.plugins_.video.prototype.cnds.IsVisible,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,cr.plugins_.Rex_UndoRedo.prototype.exps.Undo,cr.plugins_.Rex_UndoRedo.prototype.exps.Redo,cr.plugins_.Text.prototype.cnds.IsVisible,cr.system_object.prototype.exps.floor,cr.plugins_.progressbar.prototype.acts.SetProgress,
cr.behaviors.DragnDrop.prototype.cnds.OnDrop,cr.system_object.prototype.exps.round,cr.system_object.prototype.exps.unlerp,cr.plugins_.filechooser.prototype.exps.FileCount,cr.plugins_.video.prototype.acts.SetPos,cr.plugins_.UserMedia.prototype.acts.StartRecordingCanvas,cr.plugins_.UserMedia.prototype.acts.StopRecordingCanvas,cr.plugins_.UserMedia.prototype.cnds.OnCanvasRecordingReady,cr.plugins_.UserMedia.prototype.exps.CanvasRecordingURL,cr.plugins_.video.prototype.cnds.IsPaused,cr.plugins_.filechooser.prototype.cnds.OnChanged,
cr.plugins_.AJAX.prototype.cnds.OnProgress,cr.plugins_.Browser.prototype.acts.InvokeDownloadString,cr.behaviors.Fade.prototype.acts.StartFade,cr.plugins_.togglebutton.prototype.cnds.toggleStatus,cr.plugins_.togglebutton.prototype.acts.SetInstanceVar,cr.plugins_.video.prototype.cnds.OnPlaybackEvent,cr.plugins_.video.prototype.acts.SetMuted,cr.plugins_.video.prototype.cnds.IsPlaying,cr.plugins_.TextBox.prototype.cnds.OnTextChanged,cr.plugins_.TextBox.prototype.cnds.OnClicked,cr.system_object.prototype.acts.SetTimescale,
cr.plugins_.Rex_TARP.prototype.cnds.OnEnd,cr.plugins_.List.prototype.cnds.CompareSelection,cr.plugins_.TextBox.prototype.acts.SetEnabled,cr.plugins_.Rex_canvas.prototype.exps.X,cr.plugins_.Rex_canvas.prototype.exps.Y,cr.plugins_.Rex_TARP.prototype.acts.RecordAction]};
